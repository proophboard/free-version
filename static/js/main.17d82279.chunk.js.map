{"version":3,"sources":["theme/img/cody.svg","../node_modules/typescript/lib sync","theme/img/inspect-avatar.png","theme/img/prooph-software-logo-icon.png","api/ConfiguredJwtVerify.ts","api/ConfiguredAxios.ts","api/ConfiguredSocket.ts","Auth/service/tokenCache.ts","api/util.ts","i18n.tsx","core/hooks/useOnBodyClick.ts","NotificationSystem/model/NotificationMessage.ts","NotificationSystem/actions/constants.ts","NotificationSystem/actions/commands.ts","NotificationSystem/actions/events.ts","NotificationSystem/components/Notifications.tsx","NotificationSystem/selectors/message.ts","NotificationSystem/containers/NotificationsContainer.tsx","routes.ts","User/actions/constants.ts","User/actions/commands.ts","User/actions/api.ts","User/actions/events.ts","api/constants.ts","api/actions.ts","api/MessageBox.ts","User/actions/queries.ts","User/model/Account.ts","core/validation/either.ts","core/validation/predicates.ts","User/model/IioUserInfo.ts","User/model/Role.ts","User/model/RoleMap.ts","User/model/UserInfo.ts","User/saga/LazyLoadInspectioUserInfo.ts","Organization/actions/api.ts","Organization/model/OrganizationInvitation.ts","Organization/actions/constants.ts","Organization/actions/commands.ts","Organization/actions/events.ts","Organization/actions/queries.ts","Organization/model/Organization.ts","Organization/model/UserOrganizationInfo.ts","core/reducer/applyAggregateChanged.ts","Organization/reducers/applyOrganizationEvents.ts","Organization/reducers/applyOrganizationInvitationEvents.ts","Organization/reducers/applyUserOrganizationInfoEvents.ts","Organization/reducers/index.ts","Organization/sagas/demoteUserToOrganizationMember.ts","Organization/sagas/fetchOrganizationFlow.ts","Organization/sagas/fetchUserOrganizations.ts","Organization/sagas/inviteUserToOrganization.ts","Organization/sagas/promoteUserToOrganizationAdmin.ts","Organization/sagas/removeGuestFromOrganization.ts","Organization/sagas/removeUserFromOrganization.ts","Organization/sagas/renameOrganization.ts","Organization/sagas/resendUserOrganizationInvitation.ts","Organization/sagas/revokeUserOrganizationInvitation.ts","Organization/sagas/setUpExplicitOrganization.ts","Organization/sagas/turnGuestIntoMember.ts","Organization/index.ts","User/saga/switchActiveOrganization.ts","User/selectors/iioUserInfo.ts","User/saga/SyncUsernameFlow.ts","User/saga/UpdateProfileFlow.tsx","User/saga/UpsertUserSettingFlow.ts","Organization/selectors/selectOrganization.ts","standalone/storage/StandaloneIndexedDB.ts","standalone/util.ts","standalone/storage/StandaloneStorageManager.ts","User/selectors/currentUser.ts","User/components/UserAvatarUploadModal.tsx","User/components/UserProfileEditForm.tsx","User/components/UserProfilePaswordForm.tsx","User/components/UserProfile.tsx","InspectioBoards/actions/constants.ts","InspectioBoards/service/json/json-comment-wrapper.ts","InspectioBoards/model/Playshot.ts","InspectioBoards/model/Graph.ts","InspectioBoards/service/playshot-storage.ts","InspectioBoards/service/Cody/PlayServer.ts","InspectioBoards/actions/api.ts","InspectioBoards/actions/commands.ts","InspectioBoards/actions/events.ts","InspectioBoards/actions/queries.ts","Organization/selectors/selectUserOrganizationInfo.ts","InspectioBoards/service/cody-wizard/node/names.ts","InspectioBoards/model/BoardPermissionForUser.ts","InspectioBoards/model/BoardVersion.ts","InspectioBoards/model/Board.ts","InspectioBoards/service/cody-wizard/json-schema/is-json-schema.ts","InspectioBoards/service/cody-wizard/json-schema/is-json-schema-array.ts","InspectioBoards/service/cody-wizard/json-schema/is-json-schema-object.ts","InspectioBoards/service/cody-wizard/json-schema/is-json-schema-primitive.ts","InspectioBoards/service/cody-wizard/json-schema/is-json-schema-ref.ts","InspectioBoards/service/cody-wizard/vo/get-vo-metadata.ts","InspectioBoards/service/cody-wizard/vo/is-list-vo.ts","InspectioBoards/service/cody-wizard/vo/is-state-vo.ts","InspectioBoards/service/cody-wizard/vo/get-schema-ref-name.ts","InspectioBoards/service/cody-wizard/schema/shorthand.ts","InspectioBoards/service/cody-wizard/schema/schema.ts","InspectioBoards/service/cody-wizard/json-schema/is-json-schema-string.ts","InspectioBoards/service/cody-wizard/vo/get-schema-definition-id.ts","InspectioBoards/service/cody-wizard/command/get-command-metadata.ts","InspectioBoards/service/cody-wizard/event/get-event-metadata.ts","InspectioBoards/service/cody-wizard/node/get-single-node-of-type.ts","InspectioBoards/service/cody-wizard/event/is-aggregate-event.ts","InspectioBoards/service/cody-wizard/node/find-parent-by-type.ts","InspectioBoards/service/cody-wizard/node/detect-service.ts","InspectioBoards/service/cody-wizard/node/fqcn.ts","InspectioBoards/service/cody-wizard/node/metadata.ts","InspectioBoards/model/ElementsTree.ts","InspectioBoards/model/HistoryEntry.ts","InspectioBoards/model/BoardGraphElement.ts","InspectioBoards/model/BoardChanged.ts","InspectioTeams/model/TeamInvitation.ts","InspectioBoards/model/BoardInvitation.ts","InspectioBoards/model/BoardPermissionForTeam.ts","InspectioBoards/model/BoardSnapshot.ts","InspectioTeams/actions/api.ts","InspectioTeams/actions/constants.ts","InspectioTeams/actions/commands.ts","InspectioTeams/actions/events.ts","InspectioTeams/model/Team.ts","InspectioTeams/reducers/applyTeamEvents.ts","InspectioTeams/reducers/applyTeamInvitationEvents.ts","InspectioTeams/reducers/index.ts","InspectioTeams/sagas/loadUserTeams.ts","InspectioTeams/sagas/addTeam.ts","InspectioTeams/sagas/adminGrantTeamAccessToBoard.ts","InspectioTeams/sagas/changeTeamDescription.ts","InspectioTeams/sagas/deleteTeam.ts","InspectioTeams/sagas/inviteUserToTeam.ts","InspectioTeams/sagas/removeMemberFromTeam.ts","InspectioTeams/sagas/renameTeam.ts","InspectioTeams/selectors/TeamInvitation.ts","InspectioTeams/sagas/resendTeamInvitation.ts","InspectioTeams/sagas/revokeTeamInvitation.ts","InspectioTeams/sagas/refreshUserTeams.ts","InspectioTeams/sagas/moveTeamToOrganization.ts","InspectioTeams/index.ts","InspectioBoards/components/BoardOverview/Sorting.tsx","InspectioTeams/selectors/selectTeam.ts","User/selectors/userSettings.ts","InspectioBoards/selectors/boardList.ts","InspectioBoards/selectors/tags.ts","InspectioBoards/components/AddBoardForm.tsx","InspectioBoards/components/constants.ts","InspectioBoards/components/AddBoardModal.tsx","InspectioBoards/components/AddBoardButton.tsx","InspectioBoards/components/AddBoardCard.tsx","core/dateTime.ts","InspectioBoards/components/BoardCard.tsx","InspectioBoards/components/BoardOverviewSearch.tsx","InspectioBoards/components/BoardOverview/Filter.tsx","InspectioBoards/components/BoardOverview/HeaderBar.tsx","InspectioBoards/components/BoardOverview/TeamFilter.tsx","InspectioBoards/components/LoadingBoardCard.tsx","InspectioBoards/components/NewDomainModal.tsx","InspectioBoards/components/StandaloneExampleBoardCard.tsx","InspectioBoards/components/BoardOverview/MaintenanceMessage.tsx","InspectioBoards/components/BoardOverview.tsx","InspectioBoards/components/ConfirmBoardDeletionForm.tsx","InspectioBoards/selectors/boardClient.ts","InspectioBoards/components/EditBoard/BoardClientConfiguration/BoardClientNotConfiguredMessage.tsx","InspectioBoards/components/EditBoard/BoardClientConfiguration/BoardClientTable.tsx","core/copyToClipboard.ts","InspectioBoards/components/EditBoard/BoardClientConfiguration.tsx","InspectioBoards/selectors/boardPermission.ts","InspectioBoards/components/EditBoard/BoardPermissionsForTeamsTableEntry.tsx","InspectioBoards/components/EditBoard/BoardPermissionsForTeamsTable.tsx","InspectioBoards/components/EditBoard/BoardPermissionsTableEntry.tsx","InspectioBoards/components/EditBoard/BoardPermissionsTable.tsx","core/components/SecondaryButton/index.tsx","User/components/UserAvatar.tsx","InspectioBoards/selectors/boardInvitation.ts","InspectioBoards/components/EditBoard/OpenBoardInvitationsTableEntry.tsx","InspectioBoards/components/EditBoard/OpenBoardInvitationsTable.tsx","InspectioBoards/components/EditBoard/ShareBoardForm.tsx","InspectioBoards/components/EditBoard/ShareBoardWithTeamForm.tsx","Socket/actions/constants.ts","Socket/actions/actions.ts","Socket/model/Status.ts","Auth/actions/constants.ts","Auth/actions/commands.ts","Auth/actions/events.ts","Auth/sagas/tokenRefreshFlow.ts","Auth/selectors/auth.ts","Socket/sagas/socketFlow.ts","Socket/selectors/status.ts","InspectioBoards/selectors/board.ts","InspectioBoards/components/EditBoard/BoardPermissionsForAnyoneTableEntry.tsx","InspectioBoards/components/EditBoard/BoardPermissionsForOrganizationMembersTableEntry.tsx","InspectioBoards/components/EditBoard/BoardPermissionsForAnyoneTable.tsx","core/readFile.ts","InspectioBoards/components/EditBoard/BoardPermissionsMenu.tsx","InspectioBoards/model/StickyTemplate.ts","InspectioBoards/model/DefaultStickyTemplate.ts","InspectioBoards/selectors/StickyTemplate.ts","core/convertJsonSchemaToEditorValue.ts","InspectioBoards/service/jsonrepair/utils/JSONRepairError.ts","InspectioBoards/service/jsonrepair/utils/stringUtils.ts","InspectioBoards/service/jsonrepair/jsonrepair.ts","core/components/CodeEditor/JexlFlavouredJSON.ts","core/components/CodeEditor/CodeEditor.tsx","InspectioBoards/hooks/useGraph.tsx","InspectioBoards/components/EditBoard/BoardStickyConfiguration/BoardStickySchemaEditor.tsx","InspectioBoards/components/EditBoard/BoardStickyConfiguration/BoardStickyAdvancedConfig.tsx","theme/palette.ts","InspectioBoards/components/CellIcon.tsx","InspectioBoards/components/EditBoard/BoardStickyConfiguration/BoardStickySelection.tsx","InspectioBoards/components/EditBoard/BoardStickyConfiguration/BoardStickyTemplateEditor.tsx","InspectioBoards/components/EditBoard/BoardStickyTemplates.tsx","core/components/EditableTextline/index.tsx","InspectioBoards/components/EditBoard/MoveBoardMenu.tsx","InspectioBoards/components/EditBoardForm.tsx","InspectioBoards/components/EditBoard/BoardTags.tsx","InspectioBoards/components/EditBoard/CodySuggestEnabled.tsx","InspectioBoards/components/EditBoard/EventModelingEnabled.tsx","InspectioBoards/model/HistoryState.ts","InspectioBoards/selectors/boardHistory.ts","InspectioBoards/containers/EditBoardContainer.tsx","InspectioBoards/components/EditBoard.tsx","Layout/actions/constants.ts","Layout/actions/commands.ts","InspectioBoards/hooks/useMouseSync.ts","InspectioBoards/service/Cody/AxiosServer.ts","InspectioBoards/service/Cody/Command.ts","InspectioBoards/service/Cody/Event.ts","InspectioBoards/service/Cody.ts","InspectioBoards/sagas/prepareBoardHistoryFlow.ts","InspectioBoards/sagas/loadBoardHistoryFlow.ts","InspectioBoards/service/RealtimeBoardSync.ts","InspectioBoards/service/RemoteMouseSync.ts","InspectioBoards/model/BoardTimer.ts","InspectioBoards/selectors/boardGraphElement.ts","InspectioBoards/components/MxGraphBoardLink.tsx","core/imageCrop.ts","InspectioBoards/components/MxGraphImageUpload.tsx","InspectioBoards/components/MxGraphTaskLink.tsx","BoardAgent/services/BoardAgent.ts","InspectioBoards/service/cody-wizard/tagger.ts","Layout/reducers/applySidebarActions.ts","Layout/selectors/sidebar.ts","InspectioBoards/service/cody-wizard/aggregate/get-aggregate-metadata.ts","InspectioBoards/components/CodyEngineWizard/Step/StateVO/IdentifierSelect.tsx","InspectioBoards/service/cody-wizard/vo/get-connected-event-if-possible.ts","InspectioBoards/service/cody-wizard/vo/get-connected-value-object-source-if-possible.ts","InspectioBoards/service/cody-wizard/vo/is-vo-stored-in-db.ts","InspectioBoards/service/cody-wizard/vo/is-state-vo-candidate.ts","InspectioBoards/service/cody-wizard/vo/get-connected-ui-target-if-possible.ts","InspectioBoards/selectors/elementsTree.ts","InspectioBoards/hooks/useElementsTree.ts","InspectioBoards/service/cody-wizard/dependencies/suggest-dependencies-for-node.ts","Layout/selectors/sidebar-editor.ts","InspectioBoards/service/cody-wizard/vo/get-ref-vo.ts","InspectioBoards/components/CodyEngineWizard/Editor/ExpandButton.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/shorthand-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/SchemaEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/jexl-expressions.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/prop-mapping.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine-definitions.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/assign-variable.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/call-service.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/filters.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/find-information-rules.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/log-message.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/throw-error.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/business-rules-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/record-event.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/foreach.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/execute-rules.ts","InspectioBoards/components/CodyEngineWizard/Editor/BusinessRulesEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/dependencies-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/DependenciesEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/EditorDivider.tsx","Layout/selectors/sidebar-divider.ts","InspectioBoards/components/CodyEngineWizard/Editor/Divider/BusinessRulesEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Divider/DependenciesEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Suggestion/CodySuggestButton.tsx","InspectioBoards/components/CodyEngineWizard/Step/Aggregate.tsx","InspectioBoards/service/cody-wizard/schema/schema-from-node-description-parser.ts","InspectioBoards/service/cody-wizard/schema/get-schema-from-node-description.ts","InspectioBoards/components/CodyEngineWizard/Editor/Divider/SchemaEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Divider/UiSchemaEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/StreamIdEditor.tsx","InspectioBoards/service/cody-wizard/vo/is-queryable-item-vo.ts","InspectioBoards/service/cody-wizard/vo/is-queryable-vo.ts","InspectioBoards/components/CodyEngineWizard/Editor/Typeahead/elements-tree-lookup.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/css-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/ui-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/UiSchemaEditor.tsx","InspectioBoards/components/CodyEngineWizard/Step/AdvancedButton.tsx","InspectioBoards/components/CodyEngineWizard/Step/AggregateCommand/AggregateCommandToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AggregateCommand/DeleteHistoryToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AggregateCommand/DeleteStateToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AggregateCommand/NewAggregateToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AggregateCommand/StreamLockingToggle.tsx","InspectioBoards/service/cody-wizard/ui/get-ui-metadata.ts","InspectioBoards/components/CodyEngineWizard/Editor/Divider/ProjectionEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Divider/ResolverEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/initialize-rules-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/InitializeRulesEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/change-information-rules.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/projection-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/ProjectionEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/QuerySchemaEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/resolve-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/ResolveEditor.tsx","InspectioBoards/components/CodyEngineWizard/Step/AnyVO/CollectionInput.tsx","InspectioBoards/components/CodyEngineWizard/Step/AnyVO/EntityVoToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AnyVO/ProjectionToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AnyVO/QueryableToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/AnyVO/StoredVoToggle.tsx","InspectioBoards/components/CodyEngineWizard/Step/StateVO/NamespaceInput.tsx","InspectioBoards/components/CodyEngineWizard/Step/AnyVo.tsx","InspectioBoards/service/cody-wizard/vo/is-entity-collection.ts","InspectioBoards/components/CodyEngineWizard/Step/DddCommand.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/event-apply-rules-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/EventApplyRulesEditor.tsx","InspectioBoards/components/CodyEngineWizard/Step/DddEvent.tsx","InspectioBoards/service/cody-wizard/policy/get-policy-metadata.ts","InspectioBoards/service/cody-wizard/node/mark-as-connected.ts","InspectioBoards/service/cody-wizard/rule-engine/configuration.ts","InspectioBoards/components/CodyEngineWizard/Editor/Divider/ProcessorEditorDivider.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/policy-rules-schema.ts","InspectioBoards/components/CodyEngineWizard/Editor/Validation/rule-engine/trigger-command.ts","InspectioBoards/components/CodyEngineWizard/Editor/PolicyRulesEditor.tsx","InspectioBoards/components/CodyEngineWizard/Node/NodeSelect.tsx","InspectioBoards/components/CodyEngineWizard/Node/MultipleNodeSelect.tsx","InspectioBoards/components/CodyEngineWizard/Step/Policy.tsx","InspectioBoards/service/cody-wizard/context/policy-context/cody-suggestions.ts","InspectioBoards/service/cody-wizard/context/policy-context.ts","InspectioBoards/components/CodyEngineWizard/Step/Feature/StatusSelect.tsx","InspectioBoards/components/CodyEngineWizard/Step/Feature/TaskLinkInput.tsx","InspectioBoards/components/CodyEngineWizard/Step/Feature.tsx","InspectioBoards/service/cody-wizard/vo/get-default-ui-table-schema.ts","InspectioBoards/components/CodyEngineWizard/Step/StateVO.tsx","InspectioBoards/service/cody-wizard/context/wizard-context.ts","InspectioBoards/components/CodyEngineWizard/Editor/PageContentEditor.tsx","InspectioBoards/components/CodyEngineWizard/Editor/Validation/ui-config.ts","InspectioBoards/components/CodyEngineWizard/Editor/UiConfigEditor.tsx","InspectioBoards/components/CodyEngineWizard/Step/Ui/UiAccessibleFromSelect.tsx","InspectioBoards/components/CodyEngineWizard/Step/Ui.tsx","InspectioBoards/service/cody-wizard/node/mark-as-disconnected.ts","InspectioBoards/service/cody-wizard/context/ddd-action/cody-suggestions.ts","InspectioBoards/service/cody-wizard/context/ddd-action.ts","InspectioBoards/service/cody-wizard/context/feature-context.ts","InspectioBoards/service/cody-wizard/context/information-context.ts","InspectioBoards/service/cody-wizard/context/ui.ts","InspectioBoards/service/cody-wizard/ui/is-ddd-action-ui.ts","InspectioBoards/service/cody-wizard/feature/is-ddd-action-or-policy-feature.ts","InspectioBoards/service/cody-wizard/node/is-valid.ts","InspectioBoards/service/cody-wizard/step/step-header.ts","InspectioBoards/selectors/RunCodyOn.ts","InspectioBoards/components/CodyConsole/CodyEmoji.tsx","InspectioBoards/components/CodyConsole/CodyMessage.tsx","InspectioBoards/components/CodyConsole/definitions.ts","InspectioBoards/components/CodyEngineWizard/Step/ActiveStepIcon.tsx","InspectioBoards/components/CodyEngineWizard/CodyMonitor/CodyStepElement.tsx","InspectioBoards/components/CodyEngineWizard/CodyMonitor/RunCody.tsx","InspectioBoards/components/CodyEngineWizard/CodyMonitor/RunCodyOnSelect.tsx","InspectioBoards/components/CodyEngineWizard/Step/NextStep.tsx","InspectioBoards/components/CodyEngineWizard/Step/PreviousStep.tsx","InspectioBoards/components/CodyEngineWizard/Unsupported/UnsupportedNode.tsx","InspectioBoards/components/CodyEngineWizard/WizardModal.tsx","InspectioBoards/service/cody-wizard/step/step-wiki-link.ts","InspectioBoards/service/cody-wizard/graph-suggestions/initialize-cody-graph-suggestions.ts","InspectioBoards/components/MxGraphBoard.tsx","InspectioBoards/components/MxGraphBoard/initializeGraphEditor.ts","InspectioBoards/containers/MxGraphBoardContainer.tsx","InspectioBoards/sagas/adminChangeTeamBoardPermissions.ts","InspectioBoards/sagas/changeBoardAbbreviationFlow.ts","InspectioBoards/sagas/changeBoardPermissionsFlow.ts","InspectioBoards/sagas/changeResponsibleTeamFlow.ts","core/localStorage.ts","InspectioBoards/sagas/deleteBoardFlow.ts","InspectioBoards/sagas/fetchBoardClientFlow.ts","InspectioBoards/sagas/fetchBoardGraphElementsFlow.ts","InspectioBoards/sagas/fetchBoardPermissionsFlow.ts","InspectioBoards/sagas/fetchBoardStickyTemplates.ts","InspectioBoards/sagas/fetchOpenBoardInvitationsFlow.ts","InspectioBoards/model/PlayshotSummary.ts","InspectioBoards/sagas/fetchPlayshotSummaryListFlow.ts","InspectioBoards/sagas/fetchUserBoardFlow.ts","User/model/UserSettings.ts","User/saga/LoadUserSettingsFlow.ts","InspectioBoards/sagas/fetchUserBoardsFlow.ts","InspectioBoards/sagas/importExistingBoardFlow.ts","InspectioBoards/sagas/importNewBoardFlow.ts","InspectioBoards/sagas/importStickyTemplates.ts","InspectioBoards/sagas/installUserBoardFlow.ts","InspectioBoards/sagas/moveUserBoardToOrganization.ts","InspectioBoards/sagas/renameBoardFlow.ts","InspectioBoards/sagas/resendBoardInvitationFlow.ts","InspectioBoards/sagas/revokeAccessToBoardFlow.ts","InspectioBoards/sagas/revokeBoardInvitationFlow.ts","InspectioBoards/sagas/saveBoardFlow.ts","InspectioBoards/sagas/setBoardTagsFlow.ts","InspectioBoards/sagas/shareBoardFlow.ts","InspectioBoards/sagas/shareBoardWithAnyoneFlow.ts","InspectioBoards/sagas/shareBoardWithOrganizationMembersFlow.ts","InspectioBoards/storage/BoardsIndexedDB.ts","InspectioBoards/storage/useBoardsStorageManager.ts","InspectioBoards/storage/BoardsStorageManager.ts","InspectioBoards/sagas/storeOverviewSettingsFlow.ts","InspectioBoards/sagas/syncElementsTreeFlow.ts","InspectioBoards/sagas/toggleCodySuggestEnabled.ts","InspectioBoards/sagas/toggleEventModelingEnabled.ts","InspectioBoards/sagas/updateStickyTemplate.ts","InspectioBoards/index.ts","InspectioTeams/components/TeamOverview.tsx","InspectioBoards/components/MaxLengthLabel.tsx","InspectioBoards/components/BoardHistoryEntry.tsx","InspectioBoards/components/BoardHistoryGroup.tsx","InspectioBoards/components/BoardHistory.tsx","InspectioBoards/components/BoardInvitation.tsx","InspectioTeams/components/TeamInvitation.tsx","InspectioTeams/components/AddBoardToTeamModal.tsx","InspectioTeams/components/BoardEntry.tsx","InspectioTeams/components/EditableTeamHeader.tsx","InspectioTeams/components/OpenInvitation.tsx","InspectioTeams/components/OpenInvitationList.tsx","InspectioTeams/components/InviteUserToTeamModal.tsx","InspectioTeams/components/MemberEntry.tsx","InspectioTeams/components/MoveTeamMenu.tsx","InspectioTeams/components/TeamCard.tsx","InspectioTeams/components/AddTeamCard.tsx","InspectioTeams/components/JoinedTeamCard.tsx","InspectioTeams/components/TeamOverview/TeamTab.tsx","Layout/Sidebar/SharedBoardsItem.tsx","User/components/TopmenuLiteMode.tsx","InspectioBoards/components/BoardTopMenu.tsx","InspectioBoards/components/InviteUserToBoardModal.tsx","InspectioBoards/components/ShareBoardButton.tsx","User/components/TopmenuAvatar.tsx","Layout/Breadcrumb/BoardCrumb.tsx","Layout/Breadcrumb/BoardOverviewCrumb.tsx","Layout/Breadcrumb/OrganizationOverviewCrumb.tsx","Layout/Breadcrumb/TeamOverviewCrumb.tsx","Layout/Breadcrumb/UpdatesCrumb.tsx","Layout/Breadcrumb/UserProfileCrumb.tsx","Layout/TopMenu.tsx","InspectioBoards/components/BoardQuotaReachedModal.tsx","Layout/Sidebar/AddBoard.tsx","InspectioTeams/components/AddTeamToBoardModal.tsx","Layout/Sidebar/BoardListItem.tsx","Layout/Sidebar/ImportBoard.tsx","Layout/Sidebar/ShowMoreBoardsItem.tsx","Layout/Sidebar/BoardList.tsx","Layout/Sidebar/BoardOverview.tsx","Feedback/components/FeedbackModal.tsx","Layout/Sidebar/Feedback.tsx","Feedback/actions/api.ts","InspectioBoards/components/MxGraphBoardSearch.tsx","InspectioBoards/components/BoardElementDetails.tsx","InspectioBoards/components/CodyConsole/UserInput.tsx","Layout/Sidebar/Logo.tsx","Layout/Sidebar/Search.tsx","Updates/components/UpdateListEntry.tsx","Updates/components/UpdatePage.tsx","Layout/Sidebar/Updates.tsx","Layout/Sidebar/Upgrade.tsx","standalone/components/Layout/Sidebar/OverviewSidebar.tsx","InspectioBoards/components/LeafIcon.tsx","InspectioBoards/components/BoardTreeView/BoardLayer.tsx","InspectioBoards/components/BoardTreeView/BoardTreeLeaf.tsx","InspectioBoards/components/BoardTreeView/BoardTree.tsx","InspectioBoards/components/BoardTreeView.tsx","standalone/components/Layout/Sidebar/WorkspaceSidebar.tsx","Layout/Sidebar/CollapseToggle.tsx","Layout/Sidebar/AddTeam.tsx","Layout/Sidebar/TeamListItem.tsx","Layout/Sidebar/TeamList.tsx","Layout/Sidebar/TeamOverview.tsx","User/components/SideMenuOrganizationSwitch.tsx","Layout/Sidebar/Organization.tsx","Layout/Sidebar/Copyright.tsx","Layout/Sidebar/OverviewSidebar.tsx","Layout/Sidebar/WorkspaceSidebar.tsx","Layout/Sidebar.tsx","InspectioBoards/reducers/applyActiveGraphElementActions.ts","InspectioBoards/selectors/activeGraphElement.ts","standalone/components/CollaborationInfoModal.tsx","InspectioBoards/components/BoardElementDetails/ElementConnections.tsx","InspectioBoards/components/MxGraphBoard/clickRange.ts","InspectioBoards/components/CodyEngineWizard/Step/PolicyEvent.tsx","InspectioBoards/components/CodyEngineWizard/Step/SelectContext.tsx","InspectioBoards/components/BoardElementDetails/MetadataCodyWizard.tsx","InspectioBoards/components/BoardElementDetails/BoardElementMetadata.tsx","Organization/components/AcceptOrganizationInvitation.tsx","InspectioBoards/components/CodyConsole/InspectIoMessage.tsx","InspectioBoards/components/CodyConsole/UserMessage.tsx","InspectioBoards/components/CodyConsole.tsx","Organization/selectors/selectOrganizationInvitation.ts","Organization/components/Invitations/OpenOrganizationInvitation.tsx","Organization/components/InviteUserToOrganisationModal.tsx","Organization/components/OrganizationMemberEntry.tsx","Organization/components/OrganisationManagement.tsx","Organization/components/OrganizationOverview.tsx","InspectioBoards/components/BoardImportFromLink.tsx","InspectioBoards/components/MxGraphBoardRedirect.tsx","InspectioBoards/components/MxGraphBoard/BoardTimer.tsx","InspectioBoards/selectors/PlayshotSummary.ts","InspectioBoards/service/playshot/descriptions.ts","InspectioBoards/components/SideBySideDetails.tsx","InspectioBoards/service/async-iterable/make-async-iterable.ts","InspectioBoards/service/playshot/definition-id.ts","InspectioBoards/service/playshot/registry-id-to-data-reference.ts","InspectioBoards/service/json/schema/convert-json-schema-to-shorthand-if-possible.ts","InspectioBoards/service/playshot/default-service.ts","InspectioBoards/service/playshot/diff/graph-manipulation.ts","InspectioBoards/service/playshot/diff/commands/prepare-diff-command.ts","InspectioBoards/service/playshot/diff/commands/CommandAdded.ts","InspectioBoards/service/cody-wizard/node/get-node-by-id-or-fqcn.ts","InspectioBoards/service/playshot/diff/commands/CommandMetadataChanged.ts","InspectioBoards/service/playshot/diff/commands/CommandRenamed.ts","InspectioBoards/service/playshot/run-apply-tasks.ts","InspectioBoards/service/playshot/diff/commands/CommandRemoved.ts","InspectioBoards/service/playshot/diff/events/prepare-diff-event.ts","InspectioBoards/service/playshot/diff/events/EventAdded.ts","InspectioBoards/service/playshot/diff/events/EventMetadataChanged.ts","InspectioBoards/service/playshot/diff/events/EventRenamed.ts","InspectioBoards/service/playshot/diff/events/EventRemoved.ts","InspectioBoards/service/playshot/cody-error.ts","InspectioBoards/service/playshot/diff/information/prepare-diff-information.ts","InspectioBoards/service/playshot/diff/information/InformationAdded.ts","InspectioBoards/service/playshot/diff/information/InformationMetadataChanged.ts","InspectioBoards/service/playshot/diff/information/InformationRenamed.ts","InspectioBoards/service/playshot/diff/information/InformationRemoved.ts","InspectioBoards/service/playshot/rule-definitions.ts","InspectioBoards/service/playshot/diff/information/get-view-runtime-information.ts","InspectioBoards/service/playshot/diff/pages/apply-slices.ts","InspectioBoards/service/playshot/action-definitions.ts","InspectioBoards/service/playshot/diff/pages/PageAdded.ts","InspectioBoards/service/playshot/diff/pages/PageMetadataChanged.ts","InspectioBoards/service/playshot/diff/pages/PageRemoved.ts","InspectioBoards/service/playshot/compare-playshots.ts","InspectioBoards/service/playshot/diff/pages/compare-pages.ts","InspectioBoards/service/playshot/diff/commands/compare-commands.ts","InspectioBoards/service/playshot/diff/events/compare-events.ts","InspectioBoards/service/playshot/diff/information/compare-information.ts","InspectioBoards/components/MxGraphBoard/PlayshotDiffEditor.tsx","InspectioBoards/components/MxGraphBoard/PlayshotChangedDiff.tsx","InspectioBoards/components/MxGraphBoard/PlayshotTableRow.tsx","InspectioBoards/components/MxGraphBoard/PlayshotModal.tsx","App.tsx","standalone/components/Layout/BoardTopMenu.tsx","standalone/components/ShareBoardButton.tsx","standalone/components/Layout/TopMenu.tsx","AppStandalone.tsx","Auth/reducers/applyAuth.ts","Auth/reducers/index.ts","InspectioBoards/reducers/applyBoardActions.ts","InspectioBoards/reducers/applyBoardClientActions.ts","InspectioBoards/reducers/applyBoardGraphElementActions.ts","InspectioBoards/reducers/applyBoardInvitationActions.ts","InspectioBoards/reducers/applyBoardPermissionsForTeamsActions.ts","InspectioBoards/reducers/applyBoardPermissionsForUsersActions.ts","InspectioBoards/reducers/applyElementsTreeActions.ts","InspectioBoards/reducers/applyOverviewActions.ts","InspectioBoards/reducers/manageBoardHistory.ts","InspectioBoards/reducers/StickyTemplate.ts","InspectioBoards/reducers/applyPlayshotEvents.ts","InspectioBoards/reducers/index.ts","InspectioBoards/reducers/applyLoadingBoards.ts","InspectioBoards/reducers/applyInitialBoardListLoaded.ts","InspectioBoards/reducers/RunCodyOn.ts","Layout/reducers/index.ts","NotificationSystem/reducers/applyNotify.ts","NotificationSystem/reducers/index.ts","Socket/reducers/applyStatusActions.ts","Socket/reducers/index.ts","User/reducers/applyIioUsersActions.ts","User/reducers/applyUserActions.ts","User/reducers/applyUserSettingsActions.ts","User/reducers/index.ts","reducer.ts","standalone/sagas/deleteBoardFlow.ts","standalone/sagas/editBoardFlow.ts","standalone/sagas/fetchBoardStickyTemplates.ts","standalone/sagas/fetchPlayshotSummaryListFlow.ts","standalone/sagas/fetchUserBoardsFlow.ts","standalone/sagas/fetchUserBoardFlow.ts","standalone/sagas/importExistingBoardFlow.ts","standalone/sagas/importNewBoardFlow.ts","standalone/sagas/importStickyTemplates.ts","standalone/sagas/installUserBoardFlow.ts","standalone/sagas/loadBoardHistoryFlow.ts","standalone/sagas/saveBoardFlow.ts","standalone/sagas/updateStickyTemplate.ts","standalone/sagas/upsertUserSettingFlow.ts","standalone/sagas/index.ts","saga.ts","configureStore.ts","history.ts","notify.tsx","index.tsx","i18n/index.js"],"names":["module","exports","__webpack_require__","p","webpackEmptyContext","req","e","Error","code","keys","resolve","id","getKey","ConfiguredJwtVerify","token","Promise","reject","jwt","verify","error","verifiedToken","console","log","configuredAxios","axios","create","baseURL","io","path","autoConnect","multiplex","reconnection","transportOptions","polling","extraHeaders","getToken","distributeNewToken","defaults","headers","Authorization","configuredSocket","opts","expiresDate","Date","setTime","getTime","document","cookie","toUTCString","retry","_ref","Object","asyncToGenerator","regenerator_default","a","mark","_callee","ctor","maxRetries","delay","response","retries","_args","arguments","wrap","_context","prev","next","length","undefined","sent","abrupt","res","setTimeout","stop","this","_x","apply","axiosApiPromise","messageName","payload","api","post","then","catch","userManagementApiPromise","resources","require","i18n","use","LngDetector","init","detection","order","caches","excludeCacheFor","fallbackLng","debug","react","wait","useOnBodyClick","onClick","useEffect","getElementsByTagName","addEventListener","removeEventListener","defaultMessageProps","title","message","level","position","autoDismiss","dismissible","handled","uid","action","hideProgressBar","Message","_Record","data","classCallCheck","uuid","possibleConstructorReturn","getPrototypeOf","call","inherits","createClass","key","value","set","Record","NOTIFY","notify","info","tOpts","msg","NotificationModel","publishMessageHandled","toast","TYPE","INFO","POSITION","BOTTOM_LEFT","notificationsSelector","state","props","getIn","fromJS","mapStateToProps","getNotifications","createSelector","messages","makeMapStateTopPropsNotifications","currentlyVisible","showUnhandledMessages","onHandled","filter","forEach","includes","push","react_default","createElement","t","type","autoClose","onClose","markAsHandled","withNamespaces","compose","connect","dispatch","bindActionCreators","sendNotify","Command","Event","lifecycle","componentDidMount","componentDidUpdate","_ref2","react_toastify_lib","inspectio","userProfile","compileInspectioBoardWorkspace","boardUid","isInspectioBoardWorkspace","pathname","search","inspectioEditBoard","compileInspectioBoardEdit","BoardRedirect","makeWorkspaceDeeplinkFacory","cellId","getHostUrlPart","concat","window","location","protocol","host","SERVER_CONTEXT","SIGN_IN","FETCH_USER","LOAD_IIO_USERS_INFO","IIO_USERS_INFO_LOADED","USER_SETTINGS_LOADED","USER_SETTING_UPSERTED","UPDATE_PROFILE","UPDATE_PASSWORD","UPSERT_USER_SETTING","SWITCH_ACTIVE_ORGANIZATION","ACTIVE_ORGANIZATION_SWITCHED","signIn","user","updateProfile","successCb","updatePassword","password","upsertUserSetting","switchActiveOrganization","organizationId","getUser","userId","syncUsername","username","email","avatarUrl","name","getInspectioUsersInfo","userIds","getInspectioUserInfoByEmail","getUserSettings","String","displayName","companyName","jobTitle","temporary","uploadAvatar","file","deleteAvatar","delete","iioUsersInfoLoaded","usersInfo","userSettingsLoaded","userSettings","userSettingUpserted","activeOrganizationSwitched","SEND_HTTP_REQUEST","sendHttpRequest","request","responseActionType","metadata","responseAction","webData","resetWebData","getMessageBoxRequestConfig","url","method","Content-Type","JSON","stringify","responseType","fetchUser","ApiAction","loadUsersInfo","TYPE_FREE","TYPE_BASIC","TYPE_PREMIUM","TYPE_CUSTOM","defaultUserProps","accountType","assertAccountType","fromString","Account","fromUserToken","roles","freeAccount","otherAccount","match","replace","isEqualOrBetterThan","other","isFailure","val","tag","isSuccess","Failure","Success","validate","_len","predicates","Array","_key","_i","_ref3","slicedToArray","execValidate","_len2","_key2","exec","func","execForEach","list","newList","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","Symbol","iterator","done","item","result","err","return","pipe","_len5","funcs","_key5","_i2","eitherFunc","hasKey","obj","_","isArray","isJSON","parse","AGGREGATE_TYPE","defaultIioUserInfoProps","anonymous","aggregateType","createIioUserInfoFromServerData","validatedData","IioUserInfo","objectSpread","createAnonymous","generateDefaultAvatarUrl","TYPE_ANONYMOUS","TYPE_USER","TYPE_ADMIN","fromtString","role","Role","anonymousRole","assertRoleType","withAnonymous","RoleMap","roleMap","Map","RoleModel","fromToken","map","isEmpty","has","equals","givenName","familyName","RoleMapModel","account","AccountModel","quota","teamQuota","activeOrganization","signedIn","UserInfo","onLoadUsersInfo","onResponse","lazyLoadInspectioUserInfo","Action","LazyLoadInspectioUserInfo_marked","rawUserInfoList","userInfoList","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","rawInfo","_context2","put","NotifyAction","List","t0","finish","_marked2","_context3","take","fork","_marked3","Status","installUserOrganization","setUpImplicitOrganization","setUpExplicitOrganization","fetchOrganization","fetchUserOrganizations","inviteUserToOrganization","invitationId","invitedUserEmail","revokeUserOrganizationInvitation","resendUserOrganizationInvitation","acceptInvitationToOrganization","promoteUserToOrganizationAdmin","demoteUserToOrganizationMember","removeUserFromOrganization","renameOrganization","newName","removeGuestFromOrganization","turnGuestIntoMember","guestId","SET_UP_EXPLICIT_ORGANIZATION","EXPLICIT_ORGANIZATION_SET_UP","EXPLICIT_ORGANIZATION_SET_UP_FAILED","INVITE_USER_TO_ORGANIZATION","USER_INVITED_TO_ORGANIZATION","REVOKE_USER_ORGANIZATION_INVITATION","RESEND_USER_ORGANIZATION_INVITATION","USER_ORGANIZATION_INVITATION_REVOKED","USER_ORGANIZATION_INVITATION_RESENT","ACCEPT_INVITATION_TO_ORGANIZATION","INVITATION_TO_ORGANIZATION_ACCEPTED","PROMOTE_USER_TO_ORGANIZATION_ADMIN","USER_PROMOTED_TO_ORGANIZATION_ADMIN","DEMOTE_USER_TO_ORGANIZATION_MEMBER","USER_DEMOTED_TO_ORGANIZATION_MEMBER","REMOVE_USER_FROM_ORGANIZATION","USER_REMOVED_FROM_ORGANIZATION","FETCH_ORGANIZATION","ORGANIZATION_FETCHED","FETCH_USER_ORGANIZATIONS","USER_ORGANIZATIONS_FETCHED","RENAME_ORGANIZATION","ORGANIZATION_RENAMED","REMOVE_GUEST_FROM_ORGANIZATION","GUEST_REMOVED_FROM_ORGANIZATION","TURN_GUEST_INTO_MEMBER","GUEST_TURNED_INTO_MEMBER","organizationFetched","organization","explicitOrganizationSetUp","explicitOrganizationSetUpFailed","userOrganizationsFetched","userOrganizations","userInvitedToOrganization","userOrganizationInvitationRevoked","invitation","userOrganizationInvitationResent","invitationToOrganizationAccepted","userPromotedToOrganizationAdmin","userDemotedToOrganizationMember","userRemovedFromOrganization","organizationRenamed","guestRemovedFromOrganization","guestTurnedIntoMember","defaultOrganizationInvitationProps","status","open","createOrganizationInvitation","OrganizationInvitation","createOrganizationInvitationFromServerData","defaultOrganizationProps","ownerId","explicit","memberQuota","boardQuota","members","admins","boards","guests","invitations","createOrganizationFromServerData","Organization","admin","self","get","adminId","memberId","newGuests","guest","newMembers","defaultUserOrganizationInfoProps","organizationName","ownOrganization","explicitOrganization","userIsAdmin","userIsGuest","createUserOrganizationInfoFromServerData","UserOrganizationInfo","addAggregate","ar","updateAggregate","removeAggregate","remove","upsertAggregates","arList","toArray","removeAllAggregates","initialState","inspectioOrganizationsReducer","combineReducers","event","implOrga","resetOrga","renamedOrga","handleDemoteUserToOrganizationMember","command","Api","select","makeOrganizationSelector","demoteToMember","demoteUserToOrganizationMember_marked","Type","demoteUserToOrganizationMember_marked2","fetchOrganizationFlow","onFetchOrganization","UserAction","Query","toConsumableArray","toJS","fetchOrganizationFlow_marked","handleFetchUserOrganizations","implicitOrgaSetup","query","installResponse","organizations","updatedCurrentUser","v4","UserModule","makeGetCurrentUser","count","first","fetchUserOrganizations_marked","fetchUserOrganizations_marked2","handleInviteUserToOrganization","inviteUser","inviteUserToOrganization_marked","inviteUserToOrganization_marked2","handlePromoteUserToOrganizationAdmin","promoteAdmin","promoteUserToOrganizationAdmin_marked","promoteUserToOrganizationAdmin_marked2","handleRemoveGuestFromOrganization","removeGuest","removeGuestFromOrganization_marked","removeGuestFromOrganization_marked2","handleRemoveUserFromOrganization","removeUser","removeUserFromOrganization_marked","removeUserFromOrganization_marked2","handleRenameOrganization","withNewName","renameOrganization_marked","renameOrganization_marked2","handleResendUserOrganizationInvitation","resendUserOrganizationInvitation_marked","resendUserOrganizationInvitation_marked2","handleRevokeUserOrganizationInvitation","revoked","revokeInvitation","revokeUserOrganizationInvitation_marked","revokeUserOrganizationInvitation_marked2","handleSetUpExplicitOrganization","setUpAsExplicit","setUpExplicitOrganization_marked","setUpExplicitOrganization_marked2","handleTurnGuestIntoMember","turnGuestIntoMember_marked","turnGuestIntoMember_marked2","MODULE","handleSwitchActiveOrganization","OrganizationModule","switchActiveOrganization_marked","switchActiveOrganization_marked2","getIioUserInfoById","makeGetIioUserInfoByIdSelector","iioUserListSelector","toIndexedSeq","makeIioUserListSelector","users","makeIioFilteredUserListSelector","userIdList","contains","onUserAuthenticated","UserSelector","currentUserSelector","SyncUsernameFlow_marked","SyncUsernameFlow_marked2","onUpdateProfile","onUpdatePassword","UpdateProfileFlow_marked","UpdateProfileFlow_marked2","pass","UpdateProfileFlow_marked3","_context4","_marked4","onUpsertUserSetting","UpsertUserSettingFlow_marked","requestChan","actionChannel","UpsertUserSettingFlow_marked2","getOrganizationById","getOrganizationList","toList","DB_VERSION","StandaloneIndexedDB","_this","initializationPromise","db","openRequest","indexedDB","onupgradeneeded","updateDatabaseToLatestVersion","oldVersion","onerror","onsuccess","objectStore","assertDBInitialized","transaction","_this2","_x3","_x4","_callee3","_this3","getAll","_x6","_x7","_callee5","_context5","_this4","add","_x10","_x11","_ref4","_callee7","_context7","_this5","_x14","_x15","_ref5","_callee9","_context9","_this6","_x18","_x19","createObjectStore","keyPath","standaloneStorageManager","StandaloneStorageManager","getBoards","bind","getBoard","updateBoard","addBoard","deleteBoard","setUserSetting","boardId","board","setting","makeGetCurrentBoardQuota","organizationListSelector","INITIAL_CROP","aspect","unit","x","y","width","height","UserAvatarUploadModal","_useState","useState","_useState2","crop","setCrop","_useState3","_useState4","imageScale","setImageScale","_useState5","_useState6","setFile","_useState7","_useState8","src","setSrc","closeModal","resetModal","Modal","closeIcon","Header","Content","image","react_dropzone_dist_es","onDrop","acceptedFiles","URL","createObjectURL","getRootProps","getInputProps","style","assign","padding","ReactCrop_min_default","maxWidth","maxHeight","imageStyle","onChange","newCrop","onImageLoaded","naturalWidth","Actions","Button","children","primary","onUpload","reduxForm","form","enableReinitialize","className","onSubmit","handleSubmit","immutable","component","placeholder","react_router_dom","to","showErrorMessage","Message_Message","header","content","withRouter","useDispatch","showAvatarActions","setShowAvatarActions","showAvatarUploadModal","setShowAvatarUploadModal","showPasswordErrorMessage","setShowPasswordErrorMessage","currentUser","useSelector","updateProfileWithNewAvatarUrl","merge","encodeURI","now","Container","Grid","stackable","Row","Column","mobile","tablet","computer","as","icon","textAlign","Dropdown","Menu","Item","text","finally","cursor","stopPropagation","user_name","Subheader","components_UserProfileEditForm","initialValues","cProps","history","Routes","submitForm","UserProfilePaswordForm","password1","password2","pws","reset","submitFormPassword","href","components_UserAvatarUploadModal","FormData","append","SAVE_BOARD","RENAME_BOARD","CHANGE_BOARD_ABBREVIATION","SET_BOARD_TAGS","CHANGE_RESPONSIBLE_TEAM","TOGGLE_CODY_SUGGEST_ENABLED","TOGGLE_EVENT_MODELING_ENABLED","IMPORT_NEW_BOARD","IMPORT_EXISTING_BOARD","ADD_BOARD","UPDATE_BOARDS","FORCE_UPDATE_BOARDS","SET_BOARD_TO_SNAPSHOT","SET_BOARD_DETAILS_FETCHED","CONFIRM_DELETE_BOARD","ABORT_BOARD_DELETION","DELETE_BOARD","SHARE_BOARD","RESEND_BOARD_INVITATION","REVOKE_BOARD_INVITATION","REVOKE_ACCESS_TO_BOARD","CHANGE_BOARD_PERMISSIONS","ADMIN_CHANGE_TEAM_BOARD_PERMISSIONS","TRIGGER_IMPORT_BOARD","TRIGGER_EXPORT_BOARD","TOGGLE_BOARD_HISTORY","TOGGLE_ELEMENT_DETAILS","TOGGLE_CODY_CONSOLE","TOGGLE_PLAYSHOT_MODAL","TOGGLE_TIMER_MODAL","TOGGLE_VIDEO_SESSION","APPEND_HISTORY_ENTRIES","PREPEND_HISTORY_ENTRIES","CLEAR_BOARD_HISTORY","LOAD_FIRST_BOARD_HISTORY_CHUNK","LOAD_NEXT_BOARD_HISTORY_CHUNK","SET_NO_MORE_HISTORY_AVAILABLE","SET_IS_LOADING_HISTORY","UPDATE_BOARD_ELEMENTS_TREE","CREATE_BOARD_CLIENT","REMOVE_BOARD_CLIENT","RESET_BOARD_CLIENT_SECRET","SET_STICKY_TEMPLATE","UPDATE_STICKY_ADVANCED_CONFIG","IMPORT_STICKY_TEMPLATES","SHARE_BOARD_WITH_ORGANIZATION_MEMBERS","SHARE_BOARD_WITH_ANYONE","OPEN_ELEMENTS_DETAILS","FILTER_BOARD_OVERVIEW","SORT_BOARD_OVERVIEW","FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM","HIDE_SHARED_BOARDS_ON_OVERVIEW","HIDE_OWN_BOARDS_ON_OVERVIEW","FILTER_ELEMENTS_TREE","MOVE_USER_BOARD_TO_ORGANIZATION","DISMISS_MAINTENANCE_MESSAGE","REMOTE_BOARD_CHANGED","LOCAL_BOARD_CHANGED","BOARD_IMPORT_STARTED","BOARD_IMPORTED","BOARD_EXPORTED","BOARD_INITIALIZED","LOCAL_BOARD_UPDATED_WITH_REMOTE_CHANGE","BOARD_INVITATION_SENT","BOARD_INVITATION_RESENT","BOARD_INVITATION_REVOKED","BOARD_ACCESS_REVOKED","BOARD_PERMISSIONS_CHANGED","TEAM_BOARD_PERMISSIONS_CHANGED","BOARD_PERMISSIONS_FOR_USERS_FETCHED","BOARD_PERMISSIONS_FOR_TEAMS_FETCHED","OPEN_BOARD_INVITATIONS_FETCHED","PLAYSHOT_SUMMARY_LIST_FETCHED","ACTIVE_GRAPH_ELEMENT_CHANGED","ACTIVE_GRAPH_ELEMENT_LABEL_CHANGED","ACTIVE_GRAPH_ELEMENT_METADATA_CHANGED","BOARD_GRAPH_ELEMENTS_FETCHED","BOARD_CLIENT_FETCHED","BOARD_CLIENT_NOT_CONFIGURED","BOARD_CLIENT_SECRET_FETCHED","BOARD_STICKY_TEMPLATES_FETCHED","STICKY_TEMPLATE_SET","STICKY_ADVANCED_CONFIG_UPDATED","STICKY_TEMPLATES_IMPORTED","USER_BOARD_MOVED_TO_ORGANIZATION","INITIAL_BOARD_LIST_LOADED","BOARD_SHARED_WITH_ORGANIZATION_MEMBERS","BOARD_SHARED_WITH_ANYONE","RUN_CODY_ON_CHANGED","START_FETCH_USER_BOARDS","FETCH_USER_BOARDS","FETCH_USER_BOARD","FETCH_BOARD_PERMISSIONS_FOR_USERS","FETCH_BOARD_PERMISSIONS_FOR_TEAMS","FETCH_OPEN_BOARD_INVITATIONS","FETCH_BOARD_GRAPH_ELEMENTS","FETCH_BOARD_CLIENT","FETCH_BOARD_CLIENT_SECRET","FETCH_BOARD_STICKY_TEMPLATES","FETCH_PLAYSHOT_SUMMARY_LIST","replacer","space","commentJsonStringify","json","reviver","removes_comments","commentJsonParse","cloneDeepJSON","NodeType","NextToPosition","defaultPlayshotProps","playshotId","savedAt","savedBy","playConfig","appName","defaultService","pages","views","commands","commandHandlers","events","eventReducers","queries","resolvers","eventPolicies","types","layout","theme","personas","definitions","playData","createPlayshotFromServerData","Playshot","toISOString","savePlayshot","playshot","storedPlayshots","loadLocalPlayshots","localStorage","setItem","apiSavePlayshot","deletePlayshot","_callee2","filteredPlayshots","apiDeletePlayshot","_x2","loadPlayshot","storedShots","shot","find","s","fetchPlayshot","playshotResult","_x5","shots","getItem","PlayServer","playUrl","playTab","sync","playCommandListener","connected","pendingMessages","_sendMessage","postMessage","_syncDeletedNodes","_syncNodes","_fullSync","_callee4","_x8","_postMessage","promise","reconnectIfNeeded","makeMessage","attachListener","_x9","_reconnectIfNeeded","_callee6","_context6","closed","playCmd","origin","parsedCmd","handleSavePlayshot","handshakeListener","ping","m","messageId","success","playshotSaved","codyResponse","listener","parsedRes","responseTo","installOrganizationBoard","boardName","boardAbbreviation","tags","responsibleTeam","codySuggestEnabled","eventModelingEnabled","renameBoard","toggleCodySuggest","toggleEventModeling","changeBoardAbbreviation","nameAbbreviation","setBoardTags","toJSON","changeResponsibleTeam","takeBoardSnapshot","boardVersion","version","shareBoard","permissions","invitedUser","boardPermissions","writeAccess","readAccess","adminAccess","resendBoardInvitation","revokeBoardInvitation","ackBoardInvitation","revokeAccessToBoard","changeBoardPermissions","adminChangeTeamBoardPermissions","teamId","fetchUserBoard","fetchUserBoards","fetchOlderPatches","fromBoardVersion","fetchNewerPatches","mode","fetchBoardPermissionsForUsers","fetchBoardPermissionsForTeams","fetchOpenBoardInvitations","fetchBoardOfInvitation","fetchBoardXmlFromLink","link","fetch","fetchPlayshotFromLink","validatePlayshot","uploadBoardImage","imageContent","mimeType","boardImageUploadApiPromise","replaceBoardImage","imageId","boardImageReplacementApiPromise","deleteBoardImage","imageUrl","boardImageDeletionApiPromise","fetchBoardGraphElements","fetchBoardClient","fetchBoardClientSecret","createBoardClient","removeBoardClient","resetBoardClientSecret","fetchBoardStickyTemplates","setStickyTemplate","cellType","template","updateStickyAdvancedConfig","templateType","templateSchema","moveUserBoardToOrganization","shareBoardWithOrganizationMembers","shareBoardWithAnyone","checkBoardAccess","fetchPlayshots","updateBoards","forceUpdateBoards","setBoardToSnapshot","snapshot","setBoardDetailsFetched","triggerImportBoard","triggerExportBoard","toggleBoardHistory","visible","toggleElementDetails","focusEditor","toggleCodyConsole","togglePlayshotModal","toggleTimerModal","toggleVideoSession","active","appendHistoryEntries","entries","prependHistoryEntries","clearBoardHistory","loadNextBoardHistoryChunk","loadFirstBoardHistoryChunk","setNoMoreHistoryAvailable","setIsLoadingHistory","loading","filterBoardOverview","sortBoardOverview","sort","filterBoardOverviewByResponsibleTeam","hideSharedBoardsOnOverview","hide","hideOwnBoardsOnOverview","filterElementsTree","focus","saveBoard","graph","importNewBoard","boardXml","importTemporary","importExistingBoard","toggleCodySuggestEnabled","toggleEventModelingEnabled","confirmDeleteBoard","abortBoardDeletion","updateBoardElementsTree","elements","disableNotification","importStickyTemplates","stickyTemplates","finishedCb","dismissMaintenanceMessage","remoteBoardChanged","boardChanged","localBoardChanged","boardImportStarted","boardImported","boardExported","boardInitialized","initialBoardListLoaded","localBoardUpdatedWithRemoteChange","boardInvitationSent","boardInvitation","boardInvitationResent","boardInvitationRevoked","boardAccessRevoked","boardPermissionsChanged","teamBoardPermissionsChanged","boardPermission","boardSharedWithOrganizationMembers","boardSharedWithAnyone","boardPermissionsForUsersFetched","boardPermissionsForTeamsFetched","openBoardInvitationsFetched","boardInvitations","playshotSummaryListFetched","summaries","activeGraphElementChanged","element","activeGraphElementLabelChanged","elementId","label","activeGraphElementMetadataChanged","boardGraphElementsFetched","boardClientFetched","client","boardClientNotConfigured","boardClientSecretFetched","clientSecret","boardStickyTemplatesFetched","stickyTemplateSet","stickyTemplate","stickyAdvancedConfigUpdated","stickyTemplatesImported","userBoardMovedToOrganization","runCodyOnChanged","runCodyOn","startFetchUserBoards","fetchPlayshotSummaryList","userOrganizationInfoListSelector","makeUserOrganizationInfoListSelector","UserOrganizationInfoList","makeActiveUserOrganizationInfoSelector","User","userOrganizationInfoList","orga","names","str","startCase","camelCase","propertyName","constantName","snakeCase","toUpperCase","fileName","kebabCase","DEFAULT_PERMISSIONS","defaultBoardPermissionProps","createBoardPermissionForUserFromServerData","permissionsId","BoardPermissionForUser","defaultBoardVersionProps","head","BoardVersion","defaultBoardProps","xml","createdAt","lastModified","inDeletion","shouldImport","shouldExport","shouldShowHistory","shouldShowElementDetails","shouldFocusMetadataEditor","shouldShowCodyConsole","shouldShowTimerModal","shouldShowPlayshotModal","videoSessionActive","shared","detailsFetched","sharedWith","assignedTeams","example","owner","creator","tempBoard","orgaMemberPermissions","anyonePermissions","deriveAbbreviationFromBoardName","words","split","abbr","firstWord","toLocaleUpperCase","slice","word","charAt","createUserBoard","Board","createTempBoard","changed","SCHEMA_TYPES","PRIMITIVE_SCHEMA_TYPES","isJsonSchema","schema","isValidType","$ref","$id","$title","isJsonSchemaArray","isJsonSchemaObject","isJsonSchemaPrimitive","isJsonSchemaRef","getVoMetadata","node","getParsedMetadata","Schema","querySchema","isListVo","getType","meta","isList","isStateVo","entity","getSchemaRefName","vo","voMeta","asPropertyRef","asFormRef","ns","voClassName","getTechnicalName","propRef","identifier","formRef","isShorthand","isPrimitive","isRef","isObject","$items","$type","isPropertyRef","ref","indexOf","splitPropertyRef","shorthand","jsonSchema","warn","schemaStr","toShorthandIfPossible","format","isString","parts","isJsonSchemaString","notSetValue","elementsTree","emptySchema","getFilteredElementsByType","doc","_splitPropertyRef","getRef","_splitPropertyRef2","refWithoutProp","items","prop","properties","propName","propSchema","required","toJsonSchema","otherSchema","isEqual","getCommandMetadata","getMetadata","aggregateCommand","newAggregate","getEventMetadata","public","getSingleSourceOfType","allowMultiple","includeChildren","sources","getSources","child","childSource","getSingleTargetOfType","targets","getTargets","childTarget","getSourcesOfType","getTargetsOfType","isDddActionEvent","isAggregateEvent","firstSource","aggregate","isEntityEvent","vos","findParentByType","getParent","detectService","service","feature","featureMeta","bc","boundedContext","bcMeta","fqcnWithDefaultService","forQuery","forViewModel","useLabel","fqcn","nodeName","getName","n","join","parseNodeMetadata","parseRawNodeMetadata","defaultTreeProps","createTreeFromGraph","createTreeFromElements","getRoot","ElementsTree","c","isValidNode","parseFilter","nodeIds","nodeTypes","nodeLabels","nodeTags","notNodeTags","part","trim","toLowerCase","strict","getTags","ispConst","TAG_ELEMENTS_TREE_HIDDEN","matchNode","getId","matchesAllLabelParts","labelFilter","filterChildren","filteredChildren","isFeatureFilter","isFeatureTypeFilter","isContextFilter","isContextTypeFilter","setChildren","filteredSubChildren","filterElements","filteredElements","ele","_getPrototypeOf2","args","cache","parsedFilter","cacheKey","initCache","getNamespacedName","getFilteredElementsByTypeAndLabel","se","nodeType","uniqueLabels","sortBy","namesList","f","matchedEles","size","getFQCN","lastWrapper","lastMxGraph","HistoryAction","HistoryCellTypeAddition","flattenNodeChildren","nodes","targetArr","deriveGraphFromMxgraph","mxgraph","editorUi","MxGraphWrapper","makeEmptyGraph","EmptyGraph","sortNodesByType","b","convertNodeToJs","removeCommentsFromMetadata","description","getDescription","getLink","layer","isLayer","defaultLayer","isDefaultLayer","parent","makeParentNodeRecord","childrenList","makeNodeRecord","sourcesList","makeConnectedNodeRecord","targetsList","geometry","GraphPointRecord","getGeometry","SizeRecord","getSize","enabled","isEnabled","makeNodeFromJs","immutableData","parsedMetadata","NodeRecord","defaultNodeRecordProps","MxGraphElement","mxcell","mxgraphModel","wrapper","deepLinkFactory","root","technicalName","technicalFQCN","parentCache","childrenCache","sourcesCache","targetsCache","metadataCache","parsedMetadataCache","geoCache","sizeCache","MXGRAPH_ROOT_UUIDS","inspectioUtils","getChildren","getNode","setPotentiallyStale","setDeepLinkFactory","getLabelText","$nodeName","copy","copyInternalProps","getLabelSecondaryText","$nodeType","getTypeInclEdge","misc","HistoryCellType","multiple","isVertex","edges","edge","source","target","isCellEnabled","orgLayerVisibility","cells","mxmodel","getModel","model","createId","getCurrentScale","getCurrentTranslate","onPanning","offPanning","translateMousePoint","onZoom","offZoom","actions","funct","triggerCody","cell","getCell","setSelectionCell","animateScroll","scrollCellsIntoView","isVisible","beginUpdate","execute","mxVisibleChange","isContainer","getAllEdges","endUpdate","hasOwnProperty","enableLazyTextPaint","beginUpdateWithoutChangeNotifications","setVisible","endUpdateWithoutChangeNotifications","disableLazyTextPaint","zoom","showAll","hasUserLevelVisibilityChanges","view","getState","getCellStyle","mxUtils","getValue","toString","locked","setCellStyles","removeSelectionCells","getDescendants","setContainerLocked","removeCells","addCell","mxCell","setDefaultParent","isActiveLayer","index","getIndex","getChildCount","getChildAt","getDefaultParent","addLayer","addVertex","addEdge","nodeId","newNode","existingNode","margin","center","addNode","moveNodeNextToAnother","cellSize","relativeGeo","getGeometryRelativeToElement","parentCell","moveCells","oldDesc","cellLabelChanged","joinLabelParts","oldName","doNotUpdateSimilarNodes","setAttributeForCell","cellState","getCellState","cellRenderer","redraw","triggerChangeActiveGraphElementIfIsActive","TAG_CONNECTED","getSimilarElements","sn","changeNodeMetadata","TAGS_ATTR","bounds","mxRectangle","positionChanged","dx","dy","vertexHandler","mxVertexHandler","moveChildren","destroy","resizeCell","toPosition","geo","expandIfNeeded","childGeometry","clone","translate","setGeometry","connectionLabel","edgePoints","invertCurve","insertEdge","sourceGeo","targetGeo","pointX","isEventModelingEnabled","mxPoint","sourceRightCorner","targetRightCorner","points","edgeState","resetValidationState","invalidate","isSelectionEmpty","getSelectionCells","selectNode","getFeatureTaskLink","setFeatureTaskLink","userLayerVisibility","layerVisibleForUser","mxCodec","createXmlDocument","encode","setAttribute","Math","round","isGridEnabled","gridSize","graphHandler","guidesEnabled","tooltipHandler","connectionHandler","connectionArrowsEnabled","foldingEnabled","pageVisible","pageScale","pageFormat","background","getXml","layerId","_this7","selectionModel","addListener","mxEvent","CHANGE","baseUrl","setCockpitBaseUrl","container","clearMoveVideoAvatarToPositionListener","onMoveVideoAvatarToPosition","setVideoAvatarEnabled","trackVideoAvatarPosition","cb","setCodyDownCb","setCodyLeftCb","setCodyRightCb","setCodyUpCb","runCody","sourceMeta","targetMeta","sourceSchema","getSchemaFromDescription","targetSchema","refName","setObjectProperty","deleteNode","nodeToDrop","existingCell","sidebar","createDragSource","createDropHandler","createDragPreview","_this$mxgraph$makeAct","makeActiveGraphElement","_this$mxgraph$makeAct2","activeCell","updateMetadata","updateSimilarElements","replaceTags","isEdge","edgeData","edgeLabel","isEventModel","swimlanes","_this8","attributes","cellValue","createCellXmlValue","getStylesheet","minWidth","parseInt","minHeight","pos","mxGeometry","setId","setVertex","execWithUnscaledView","updateCellState","preferredSize","getPreferredSizeForCell","initContainer","importCells","eleGeo","eleSize","xMargin","yMargin","centeredX","centeredY","left","right","above","below","aboveLeft","aboveRight","belowLeft","belowRight","desc","_this9","mostRight","mostBottom","graphNode","minSize","resizeNode","max","EmptyLayer","shortUUID","new","withoutParsedMetadata","referencingChild","fqcnCache","technicalFQCNCache","typeCache","technicalNameCache","parsed","GraphElementType","defaultHistoryEntryProps","edited","date","HistoryEntry","makeHistoryEntry","userInfo","cellLabel","toBoardVersion","recordedAt","defaultBoardChangedProps","changeSet","iData","BoardChanged","mapServerPatchToBoardChanged","serverPatch","patchId","patch","defaultBoardGraphElementProps","parentId","createBoardGraphElementFromServerData","BoardGraphElement","defaultBoardInvitationProps","invitingUser","resendAttempts","createBoardInvitationFromServerData","BoardInvitation","createBoardPermissionForTeamFromServerData","BoardPermissionForTeam","defaultBoardSnapshotProps","BoardSnapshot","addTeam","teamName","renameTeam","changeTeamDescription","newDescription","inviteUserToTeam","userEmail","resendTeamInvitation","revokeTeamInvitation","removeMemberFromTeam","deleteTeam","adminGrantTeamAccessToBoard","adminRevokeTeamAccessToBoard","fetchUserTeams","ackTeamInvitation","fetchTeamOfInvitation","fetchOpenTeamInvitations","moveTeamToOrganization","ADD_TEAM","RENAME_TEAM","CHANGE_TEAM_DESCRIPTION","INVITE_USER_TO_TEAM","RESEND_TEAM_INVITATION","REVOKE_TEAM_INVITATION","REMOVE_MEMBER_FROM_TEAM","FETCH_USER_TEAMS","UPDATE_TEAMS","ADMIN_GRANT_TEAM_ACCESS_TO_BOARD","ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD","DELETE_TEAM","TEAM_ADDED","TEAM_RENAMED","TEAM_DESCRIPTION_CHANGED","TEAMS_FETCHED","MEMBER_REMOVED_FROM_TEAM","TEAM_DELETED","TEAM_INVITATIONS_LOADED","TEAM_INVITATION_RESENT","TEAM_INVITATION_REVOKED","TEAM_ACCESS_TO_BOARD_GRANTED","TEAM_ACCESS_TO_BOARD_REVOKED","MOVE_TEAM_TO_ORGANIZATION","TEAM_MOVED_TO_ORGANIZATION","updateTeams","teams","teamIds","teamAdded","team","teamRenamed","teamDescriptionChanged","memberRemovedFromTeam","teamDeleted","teamInvitationsLoaded","teamInvitations","teamInvitationResent","teamInvitation","teamInvitationRevoked","teamsFetched","teamAccessToBoardGranted","teamAccessToBoardRevoked","teamMovedToOrganization","defaultTeamProps","deleted","isNew","createTeamFromServerData","Team","createNewTeam","member","defaultTeamInvitationProps","createTeamInvitationFromServerData","TeamInvitation","inspectioTeamsReducer","loadMembersOfAllTeams","loadUserTeams","memberIds","toSet","loadUserTeams_marked","newTeam","loadUserTeams_marked2","handleAddTeam","rename","addTeam_marked","addTeam_marked2","onAdminGrantTeamAccessToBoard","onAdminRevokeTeamAccessToBoard","plural","adminGrantTeamAccessToBoard_marked","adminGrantTeamAccessToBoard_marked2","adminGrantTeamAccessToBoard_marked3","handleChangeTeamDescription","orgTeam","changedTeam","makeTeamSelector","changeDescription","changeTeamDescription_marked","changeTeamDescription_marked2","handleDeleteTeam","deleteTeam_marked","deleteTeam_marked2","inviteUserToTeam_marked","handleRemoveMemberFromTeam","removeMember","removeMemberFromTeam_marked","removeMemberFromTeam_marked2","handleRenameTeam","renameTeam_marked","renameTeam_marked2","makeTeamInvitationSelector","getTeamInvitationById","handleResendTeamInvitation","resend","resendTeamInvitation_marked","resendTeamInvitation_marked2","handleRevokeTeamInvitation","revoke","revokeTeamInvitation_marked","revokeTeamInvitation_marked2","handleRefreshUserTeams","refreshUserTeams","refreshUserTeams_marked","refreshUserTeams_marked2","handleMoveTeamToOrganization","moveToOrganization","moveTeamToOrganization_marked","moveTeamToOrganization_marked2","SORT_OPTIONS","SORT_BY","getTeamById","teamListSelector","makeTeamListSelector","withAdminAccess","activeOrganizationSelector","isAdmin","keyBoardHidden","keyUpdateViewed","userSettingsSelector","makeUserSettingSelector","defaultVal","settings","makeUserSettingsSelector","toObject","makeUserSettingsLoadedSelector","convertSortValuesToSortOption","sortOrder","_convertSortOptionToS","option","NAME_ASC","NAME","NAME_DESC","CREATED_AT_ASC","CREATED_AT","CREATED_AT_DESC","LAST_MODIFIED_ASC","LAST_MODIFIED","LAST_MODIFIED_DESC","convertSortOptionToSortValues","makeGetBoardOverview","_convertSortOptionToS2","currentSortBy","currentSortOrder","setSort","options","selection","fluid","clickedEl","tagName","parentElement","blur","Icon","float","preventDefault","paddingRight","boardListSelector","boardLoadingSelector","initialBoardListLoadedSelector","boardOverviewSelector","makeGetAllBoards","activeUserOrganizationInfoSelector","makeGetBoards","returnHiddenBoards","boardOverview","allTagsMatch","filterRest","allSharedBoardsHidden","allOwnBoardsHidden","makeGetTeamBoards","makeIsLoadingBoards","isLoading","makeInitialBoardListLoaded","listLoaded","makeHasBoards","makeMapStateToPropsBoardOverview","getQuota","isLoadingBoards","userQuota","makeGetTags","showSettings","setShowSettings","existingTags","availableTags","useRef","teamOptions","setBoardName","boardNameInvalid","setBoardNameInvalid","setAbbr","_useState9","_useState10","abbrTouched","setAbbrTouched","_useState11","_useState12","abbrInvalid","setAbbrInvalid","_useState13","_useState14","setCodySuggestEnabled","_useState15","_useState16","setEventModelingEnabled","_useState17","_useState18","setTags","_useState19","_useState20","evt","Input","autoFocus","Divider","horizontal","Checkbox","toggle","checked","allowAdditions","current","onAddItem","tagVal","addTagOption","disabled","isAddingBoard","setIsAddingBoard","warning","components_AddBoardForm","BoardModel","AddBoardModal","AddBoard","setAddBoard","AddBoardButton_AddBoardModal","display","flexDirection","verticalAlign","justifyContent","alignItems","components_AddBoardModal","printIsoDateString","isoDateTime","toLocaleString","wordBreak","overflowWrap","Popup","trigger","color","fontSize","tagsInFilter","results","lastPart","pop","Search_Search","onSearchChange","onResultSelect","splice","filterWithoutLastPart","handleResultSelect","showNoResults","Filter","components_BoardOverviewSearch","HeaderBar","boardOverviewState","unshift","padded","GridRow","columns","GridColumn","BoardOverview_Sorting","BoardOverview_Filter","LoadingBoardCard","StandaloneExampleBoardCard","MaintenanceMessage","showMaintenanceMessage","onDismiss","hasBoards","settingsLoaded","showHint","popupOpen","setPopupOpen","BoardOverview_MaintenanceMessage","BoardOverview_HeaderBar","Card","Group","itemsPerRow","components_AddBoardCard","LoadingBoardCard_LoadingBoardCard","components_BoardCard","isCreator","Segment","Inline","rel","components_AddBoardButton","components_StandaloneExampleBoardCard","components_NewDomainModal","renderConfirm","componentProps","input","_componentProps$meta","touched","Form","values","confirmedName","pristine","valid","basic","onCancel","handleAbortClick","boardClientsSelector","confirmOpen","setConfirmOpen","Fragment","Confirm","onConfirm","resetConfirmOpen","setResetConfirmOpen","removeConfirmOpen","setRemoveConfirmOpen","resetLoading","setResetLoading","clientSecretCopied","setClientSecretCopied","closeResetConfirm","closeRemoveConfirm","Table","unstackable","Body","Cell","clientId","marginLeft","appendTo","inputElement","top","body","execCommand","parentNode","removeChild","copyToClipboard","paddingTop","paddingBottom","labelPosition","visibility","negative","floated","boardClients","HeaderSubheader_default","BoardClientConfiguration_BoardClientNotConfiguredMessage","BoardClientConfiguration_BoardClientTable","makeBoardPermissionForTeamSelector","boardPermissionForTeamListSelector","permission","boardPermissionForUserListSelector","makeBoardPermissionForTeamListSelector","hasReadAccess","hasWriteAccess","Or","TeamAction","changedBoard","BoardPermissionsForTeamsTable","EditBoard_BoardPermissionsForTeamsTableEntry","BoardPermissionTableEntry","isOwner","avatar","alt","Label","marginBottom","BoardPermissionTable","onwerId","BoardPermissionsTableEntry_BoardPermissionTableEntry","SecondaryButton","btnProps","UserAvatar","circular","Image","namePopup","makeBoardInvitationSelector","getBoardInvitationById","boardInvitationListSelector","setUserInfo","isResending","setIsResending","isRevoking","setIsRevoking","components_UserAvatar","paddingLeft","ButtonGroup","components_SecondaryButton","OpenBoardInvitationsTable","openInvitations","EditBoard_OpenBoardInvitationsTableEntry","setEmail","setWriteAccess","filteredUsers","toLocaleLowerCase","test","Notify","resultRenderer","selectedTeams","setSelectedTeams","teamBlacklist","ownTeamsOptions","dProps","CONNECT_SOCKET","DISCONNECT_SOCKET","SOCKET_CONNECTED","SOCKET_DISCONNECTED","SOCKET_CONNECTION_LOST","SEND_SOCKET_CMD","LISTEN_ON_SOCKET_CHANNEL","STOP_LISTENING_ON_SOCKET_CHANNEL","DEFAULT_SOCKET_CMD_TIMEOUT","connectSocket","disconnectSocket","socketConnected","socketDisconnected","socketConnectionLost","reason","sendSocketCmd","timeout","notifySocketCmdSent","socketCmd","ackSocketCmd","rejectSocketCmd","listenOnSocketChannel","channelName","emitActionType","stopListeningOnSocketChannel","emitChannelEvent","isAcknowledged","cmd","isNotAcknowledged","isError","STATUS_CONNECTED","STATUS_CONNECTING","STATUS_DISCONNECTED","STATUS_DISCONNECTING","STATUS_CONNECTION_LOST","disconnectedStatus","assertSocketStatus","AUTHENTICATE","USER_AUTHENTICATED","authenticate","auth","userAuthenticated","kc","tokenRefreshFlow","keycloakPromise","authErrors","profile","attr","verifyJwt","login","loadUserProfile","tokenParsed","sub","display_name","avatar_url","company_name","job_title","firstName","lastName","resourceAccess","updateToken","t1","t2","tokenRefreshFlow_marked","makeTokenSelector","manageSocketConnection","flow","runBackgroundTasks","onHandleIO","handleIO","Auth","socketFlow_marked","socket","disconnect","socketFlow_marked2","disconnectTask","reconnectTask","ioTask","listenDisconnectSaga","listenReconnectSaga","cancel","socketFlow_marked3","channelRegistry","Socket","StatusSelector","makeGetStatus","isConnected","sendCmd","stopListeningOnChannel","listenOnChannel","socketFlow_marked4","_marked5","registry","chan","eventChannel","emit","errorHandler","on","off","buffers","expanding","close","reconnectSocket","_context8","ack","AuthSelector","race","pushCmd","disconnected","statusSelector","StatusModel","getBoardById","boardSelector","params","makeBoardByIdSelector","makeGetBoard","makeMapStateToPropsAddBoard","getCurrentUser","makeMapStateToPropsEditBoard","makeMapStateToPropsMxGraphBoard","getSocketStatus","SocketSelector","getLiteModeSetting","socketStatus","liteMode","TableRow","TableCell","changedPermissions","BoardPermissionsForAnyoneTable","EditBoard_BoardPermissionsForOrganizationMembersTableEntry","EditBoard_BoardPermissionsForAnyoneTableEntry","readFile","organizationUserIds","organizationUsers","openBoardInvitations","usersPane","EditBoard_ShareBoardForm","BoardPermissionsTable_BoardPermissionTable","OpenBoardInvitationsTable_OpenBoardInvitationsTable","teamsPane","EditBoard_ShareBoardWithTeamForm","BoardPermissionsForTeamsTable_BoardPermissionsForTeamsTable","anyonePane","EditBoard_BoardPermissionsForAnyoneTable","panes","menuItem","render","Tab","menu","secondary","pointing","reader","FileReader","onload","readAsText","readFileArrayBuffer","readAsArrayBuffer","readFileBase64","readAsDataURL","defaultStickyTemplateProps","deriveStickTemplateId","createStickyTemplateFromServerData","StickyTemplate","createStickyTemplateFromDefault","OBJ_SCHEMA","DEFAULT_TEMPLATE","policy","hotSpot","externalSystem","ui","siwmlanes","freeText","makeStickyTemplateSelector","getStickyTemplateById","makeBoardStickyTemplateMapSelector","stickyTemplateMap","stickyMap","boardStickyTemplateMapSelector","resolveRef","JSONRepairError","_Error","wrapNativeSuper","codeSpace","codeNewline","codeTab","codeReturn","codeNonBreakingSpace","codeEnQuad","codeHairSpace","codeNarrowNoBreakSpace","codeMediumMathematicalSpace","codeIdeographicSpace","isHex","char","isDigit","isValidStringCharacter","isDelimiter","isFunctionNameCharStart","isFunctionNameChar","regexUrlStart","regexUrlChar","isUnquotedStringDelimiter","isStartOfValue","isQuote","regexStartOfValue","isControlCharacter","isWhitespace","charCodeAt","isWhitespaceExceptNewline","isSpecialWhitespace","isDoubleQuoteLike","isSingleQuoteLike","isDoubleQuote","isSingleQuote","stripLastOccurrence","textToStrip","stripRemainingText","lastIndexOf","substring","insertBeforeLastWhitespace","textToInsert","removeAtIndex","start","controlCharacters","\b","\f","\n","\r","\t","escapeCharacters","\"","\\","/","r","jsonrepair","forceObject","i","output","parseMarkdownCodeBlock","parseValue","throwUnexpectedEnd","processedComma","parseCharacter","parseWhitespaceAndKeepComments","endsWithCommaOrNewline","initial","processedValue","parseNewlineDelimitedJSON","throwUnexpectedCharacter","processed","skipCharacter","skipEllipsis","processedKey","parseString","parseUnquotedString","throwObjectKeyExpected","processedColon","truncatedText","throwColonExpected","parseObject","parseArray","atEndOfNumber","repairNumberEndingWithNumericSymbol","num","hasInvalidLeadingZero","parseNumber","parseKeyword","parseRegex","skipNewline","parseWhitespace","parseComment","_isWhiteSpace","whitespace","atEndOfBlockComment","stopAtDelimiter","stopAtIndex","skipEscapeChars","isEndQuote","iBefore","oBefore","iPrev","prevNonWhitespaceIndex","iQuote","oQuote","parseConcatenatedString","iPrevChar","prevChar","j","throwInvalidUnicodeCharacter","throwInvalidCharacter","parsedStr","isKey","symbol","chars","JexlFlavouredJSON","tokenPostfix","keywords","jsonKeywords","typeKeywords","operators","symbols","escapes","digits","octaldigits","binarydigits","hexdigits","regexpctl","regexpesc","tokenizer","include","json_obj","json_array","cases","@jsonKeywords","@default","json_val","json_val_string","common","@typeKeywords","@keywords","@operators","comment","jexl","jsdoc","string_double","string_val_double","string_single","string_backtick","bracketCounting","monaco","globalSchemaRegistry","globalRefSupport","globalLinkProviderRegistered","languages","setMonarchTokensProvider","currentGraph","isRefOpening","CodeEditor","editor","containerId","asDiffEditor","disposeOnChangeHandler","assertThisInitialized","internalData","createDiffEditor","getElementById","onOpenInformationReference","getContribution","openerService","repairJson","addKeyDownHandler","altKey","rawValue","repaired","currentPosition","getPosition","currentLineLength","getLineLength","lineNumber","setValue","newLineLength","newPosition","column","setPosition","dispose","fileId","disposeModel","onFocus","updateOptions","scrollBeyondLastLine","onBlur","original","modified","originalModel","prepareModel","modifiedModel","setModel","modelData","keybinding","handler","addCommand","onKeyDown","modelUri","Uri","supportRefLinks","createModel","language","tabSize","setModelLanguage","initializeOnChangeHandler","updateInternalData","onChangeDisposable","initializeJsonDiagnostics","willUnmount","newDisposable","onDidChangeContent","uri","fileMatch","jsonDefaults","setModeConfiguration","tokens","completionItems","diagnostics","documentFormattingEdits","documentRangeFormattingEdits","documentSymbols","foldingRanges","hovers","selectionRanges","setDiagnosticsOptions","enableSchemaRequest","allowComments","trailingCommas","schemas","linkProvider","provideLinks","matches","findMatches","links","range","startColumn","resolveLink","registerLinkProvider","setState","defineProperty","React","forwardRef","codeEditorRef","initializeModel","boardStickyTemplate","jsonSchemaMetaSchema","useImperativeHandle","retrievePayload","components_CodeEditor_CodeEditor","marginTop","folding","glyphMargin","lineNumbers","lineDecorationsWidth","minimap","formatOnPaste","setTemplateType","boardStickySchemaEditorRef","handleUpdateStickyAdvancedConfig","Select","BoardStickyConfiguration_BoardStickySchemaEditor","rawSchema","parsedSchema","newTemplate","convertJsonSchemaToEditorValue","editorValue","enum","onTemplateGenerated","Palette","stickyColors","projection","textCard","CellIcon","Color","fontFamily","encodeURIComponent","isFrame","isCard","isSpecialShape","isFirst","stickies","boardStickyTemplates","activeCellType","onSetActiveCellType","components_CellIcon","initializeModelWithValue","KeyMod","CtrlCmd","KeyCode","KEY_S","onSave","updateModelValue","setActiveCellType","advancedConfigActive","setAdvancedConfigActive","stickyTemplateEditorRef","uploadEl","isImporting","setIsImporting","handleUpdateTemplate","_unused","direction","click","templatesStr","tpl","jsonBlob","Blob","download","revokeObjectURL","largeScreen","widescreen","BoardStickyConfiguration_BoardStickySelection","borderLeft","BoardStickyConfiguration_BoardStickyTemplateEditor","BoardStickyConfiguration_BoardStickyAdvancedConfig","Dimmer","inverted","Loader","files","templates","_unused2","cellTypes","tplCellTypes","importableStickyTemplates","tplCellType","setTemplateSchema","EditableTextline","selectedOrganization","setSelectedOrganization","enterText","setEnterText","hasError","setHasError","errMsg","setErrMsg","textSuggestion","inputEl","handleChange","newVal","maxLength","handleBlur","refocus","onTextChanged","valueLength","charSize","fixedWidth","border","showInput","transparent","widthUnit","borderBottom","textStyle","components_EditableTextline","newAbbr","BoardTags","currentTagList","newTags","defaultHistoryStateData","oldestBoardVersion","olderPatchesAvailable","HistoryState","makeBoardHistoryByIdSelector","getBoardHistoryById","BoardSelector","abortDeletion","isPrivateWorkspace","validTargetOrganizations","components_EditBoardForm","components_ConfirmBoardDeletionForm","handleConfirmDeletion","EditBoard_CodySuggestEnabled","EditBoard_EventModelingEnabled","EditBoard_BoardTags","EditBoard_BoardStickyTemplates","TOGGLE_SIDEBAR_COLLAPSED","SET_SIDEBAR_WIDTH","SET_RIGHT_SIDEBAR_WIDTH","SET_SIDEBYSIDE_WIDTH","SET_SIDEBYSIDE_CELL","SET_CODY_CONSOLE_HEIGHT","TOGGLE_SIDEBAR_DIVIDER","TOGGLE_SIDEBAR_EDITOR","toggleSidebarCollapsed","collapsed","setSidebarWidth","setRightSidebarWidth","setSideBySideCell","toggleSidebarEditor","expanded","double","GraphRef","graphRef","selectionListeners","onSelectionChanged","createCellId","openLayersDialog","focusNode","setUserVisible","applyVisibilityGlobally","isLocked","setLocked","deleteLayer","setAsActiveLayer","setDefaultLayerAsActive","highlightLayer","addNodeNextToAnother","changeNodeName","changeNodeDescription","changeNodeLabel","changeNodeTags","moveNode","switchParent","connectNodes","highlightNodes","copySelectionToActiveLayer","changeFeatureStatus","exportXmlSnapshot","openCodyWizard","mergeIntoSchema","makeDraggable","makeActiveGraphElementIfPossible","useGraph","setGraph","currentMouseSync","MouseSyncRef","mouseSyncRef","cachedUserJoinedListeners","cachedUserLeftListeners","cachedBoardTimerStartedListeners","cachedBoardTimerPausedListeners","cachedBoardTimerStoppedListeners","mouseSync","l","onUserJoined","onUserLeft","onBoardTimerStarted","onBoardTimerPaused","onBoardTimerStopped","gestureChanged","emitUserGestureChanged","autoScrollEvent","emitUserIsAutoScrolling","move","mouseDelta","emitUserMouseMove","scroll","emitUserMouseScroll","hideObservingFrame","keepMousePositionsInPlaceOnPanning","observeUser","offUserJoined","offUserLeft","joined","startSync","stopMouseTrackingOfUser","stopObservingUser","stopSync","syncLastKnownAbsolutePointsAfterPanning","userName","trackMouseOfRemoteUser","timer","startBoardTimer","offBoardTimerPaused","offBoardTimerStarted","offBoardTimerStopped","pauseBoardTimer","stopBoardTimer","useMouseSync","setMouseSync","AxiosServer","validateStatus","cody","CodyResponseType","details","sendMessage","currentSession","syncRequiredCallback","newlyConnectedCodySyncIndex","NO_CODY_CONNECTION","printCodyResponse","codyName","_console","_console3","_console5","_console7","Info","_console2","_console4","Warning","Question","_console6","SyncRequired","_console8","printError","printWarning","addTargetsToSortedNodesList","originalNodes","sortedNodes","nestingLevel","orgN","targetInSortedNodes","sN","codyResponsePrinter","errorPrinter","warningPrinter","codyResponseListeners","currentNodeIndex","currentServerIndex","IIO","codyServers","syncPerformed","nodesWithoutSourceInNodeList","allSourcesNotInNodeList","nodeNoSource","sortNodes","context","ElementEdited","codyRes","StopSession","syncRequired","server","isSyncEnabled","Cody","connectedServers","codyServer","process","IioSaidHello","reply","_reply","UserReplied","talk","lastServer","ConfirmTest","runCommand","commandName","servers","onSyncRequired","syncNodes","_cody3","fullSync","Sync","Empty","enableSync","syncChangedNodes","_syncChangedNodes","_loop","performSync","chunk","currentChunk","delegateYield","syncDeletedNodes","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_loop2","_iterator3","_step3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","SyncDeleted","syncFinished","abortSession","ask","forHelp","print","setCodyResponsePrinter","printer","cName","setErrorPrinter","setWarningPrinter","attachCodyResponseListener","useIIO","onBoardChanged","prepareBoardHistoryFlow","boardChangedList","prependEntries","_ret","_args2","iioUserInfo","noMatchingInfo","infoLoaded","historyEntry","IioUserInfoSelector","v","loadedInfo","prepareBoardHistoryFlow_marked","latestBoardId","prepareBoardHistoryFlow_marked2","onLoadFirst","onLoadNext","loadBoardHistoryFlow","marshalBoardChanged","getBoardHistory","patches","loadBoardHistoryFlow_marked","loadBoardHistoryFlow_marked2","_action","loadBoardHistoryFlow_marked3","Gesture","RealtimeBoardSync","onHandledRemoteEvent","onPublished","localQueue","incomingQueue","lastProcessedVersion","lastRemoteVersion","reconnectListener","isFetchingLatestPatches","initialized","attempts","restartSync","loadAndProcessLatestPatchesFromServer","alert","processLocalQueue","handleBoardChanged","BoardSync","once","eventData","publishChanges","_loadAndProcessLatestPatchesFromServer","prevEvents","prevEvent","skipGapDetection","queue","defaultBoardTimerProps","deadline","duration","moderator","pausedTime","createBoardTimer","BoardTimer","colors","nextPointerColor","getPointerIconFromGesture","gesture","Moving","Typing","RemoteMouseSync","translateGraphPoint","userJoinedListeners","userLeftListeners","observedUser","observingFrame","lastMoveWasPanning","boardTimerStartedListeners","boardTimerPausedListeners","boardTimerStoppedListeners","activeBoardTimer","isBoardTimerPaused","disconnectListener","syncIntervalListener","evts","joinedEvt","point","vT","scale","pointerEl","setScale","panGraph","panningListeners","isPanning","absolutePoint","lastKnownAbsolutePoint","triggerZoomListeners","pointerIcon","boardTimer","syncWithServer","triggerJoinedListeners","isPaused","li","setInterval","clearInterval","borderColor","_this$registry$_userI","_makeNewPointer","pointerDiv","pointerP","pointer","Default","appendChild","labelP","innerHTML","makeNewPointer","_makeNewPointer2","pointerI","_this$registry$userId","frame","classList","innerText","backgroundColor","boardGraphElementsSelector","selectedBoard","setSelectedBoard","setSelectedEvent","setOpen","boardGraphElements","boardChoices","openHandle","openFromHandle","currentLink","selectBoard","clearable","marginRight","onLinkChosen","createCropCanvas","cropStartX","cropStartY","naturalHeight","newWidth","newHeight","canvas","getContext","drawImage","getCroppedImageBase64","toDataURL","getCroppedImageArrayBuffer","toBlob","blob","ACCEPTED_IMAGE_TYPES","CROP_IMAGE_TYPES","setImageId","setImage","uploading","setUploading","focusPasteInput","currentImageId","onFileSelected","upload","isCroppedImage","isVectorGraphic","imageWidth","imageHeight","imageDataURL","imageData","onFileUploaded","t3","t4","replaceImage","uploadNewImage","imageUploadErrorHandler","onPaste","clipboardData","getAsFile","accept","maxFiles","maxSize","newPercentCrop","setLink","setError","chooseLink","keyCode","tagger","nounInflector","presentVerbInflector","defaultSidebarStateProps","rightSidebarWidth","sideBySideWidth","sideBySideCell","codyConsoleHeight","dividers","editors","SidebarState","sidebarSelector","makeGetSidebarSelector","getAggregateMetadata","identifierCandidates","FormField","inline","onIdentifierChanged","getIdentifierCandidatesFromSchema","candidates","getListItemsSchema","getObjectProperties","schemaKey","getObjectPropertySchema","getConnectedEventIfPossible","getConnectedValueObjectSourceIfPossible","isVoStoredInDb","collection","isStateVoCandidate","getConnectedUiTargetIfPossible","makeElementsTreeByBoardIdSelector","getElementsTreeByBoardId","useElementsTree","selector","suggestDependenciesForNode","existingDependencies","includeEvents","deps","existingDeps","cloneDeep","dep","queryName","alias","serviceName","eventsDep","eventNameMatch","$eventName","eventFQCN","VERB_TAGS","NOUN_TAGS","ADJECTIVE_TAGS","verbutils","getConfiguredNounInflector","NounInflector","tagSentence","sentence","lexicon","Lexicon","ruleSet","RuleSet","BrillPOSTagger","getConfiguredTagger","taggedWords","isVerb","isNoun","isAdjective","ensureSingularNoun","singularize","testStemToGerund","verbStem","testSentence","isPresentTenseVerb","verb","singularizedVerb","PresentVerbInflector","pastTenseExceptions","are","eat","go","have","inherit","is","run","sit","visit","EditorState","makeEditorStateByNameSelector","getEditorStateByName","getRefVo","refSchema","ExpandButton","ctrlKey","onExpandChanged","opacity","makeShorthandSchemaValidationSchema","possibleRefs","ShorthandSchema","shorthand_both","oneOf","shorthand_string","anyOf","shorthand_object","patternProperties","^[a-zA-Z]{1,}[a-zA-Z0-9]{0,}[?]{0,1}$","^\\$title$","\\$ref$","\\$items","additionalProperties","unsavedSessions","editorHasFocus","setEditorHasFocus","invalidJson","setInvalidJson","editorState","isInvalidJson","sessionId","getPossibleRefs","autofocus","Editor_ExpandButton","expand","refVo","mouseWheelZoom","automaticLayout","scrollbar","alwaysConsumeMouseWheel","readOnly","readonly","fixedOverflowWidgets","changedSchemaStr","validJson","editorStr","silentError","onSchemaChanged","changedSchema","propagateChanges","noListSyntax","possibleRef","possibleRefAsList","JEXL_WIKI_MARKDOWN","makeJexlExpression","markdownDescription","suggestions","jexlExpr","default","pattern","withSuggestionPropMapping","possibleProps","fullMergeSuggestions","mappingSuggestions","makeRuleThenPropMapping","mergeSchema","rule_then_prop_mapping","^$merge$","^$not$","^[^$]+$","makeDefinitions","rule_definition","rule","if","else","if_not","rule_then","rest","rec","recKey","makeAssignVariable","fixedVariableName","rule_then_assign_variable","variable","const","minLength","makeCallService","possibleServices","rule_then_call_service","async","mapping","makeResolveFiltersDefinition","possibleProperties","expressionSuggests","makeFiltersDefinition","makeFindFiltersDefinition","withResolveFilterTypes","prefix","propertySchema","and","minItems","or","not","any","anyOfDocId","valueList","docId","eq","exists","gte","gt","inArray","like","lte","lt","makeFindInformation","possibleInformation","expSuggests","information","then_find_information","skip","limit","orderBy","then_find_one_information","findOne","then_find_information_by_id","findById","then_find_partial_information","findPartial","then_find_one_partial_information","findOnePartial","then_find_partial_information_by_id","findPartialById","then_lookup_user","lookup","makePartialSelectDefinition","find_partial_select","field","find_partial_select_lookup","using","optional","localKey","foreignKey","makeLogMessage","msgDesc","then_log_msg","makeThenThrowError","rule_then_throw_error","throw","makeBusinessRulesSchema","possibleEvents","BusinessRulesSchema","rule_then_record_event","record","rule_then_for_each","rule_then_execute_rules","rules","dependenciesKey","dependencies","getExprSuggests","commandSchema","changedRulesStr","onRulesChanged","changedRules","suggests","makeDependenciesSchema","messageSchema","depName","makeDependencySchema","dependenciesToString","changedDependenciesStr","onDependenciesChanged","changedDependenciesConfig","EditorDivider","divider","getDividerCollapsedByName","showContent","textDecoration","handleClick","toggleSidebarDivider","popupContent","section","hoverable","Editor_EditorDivider","isAggregate","messageType","CodySuggestButton","compact","hasSuggestions","onSuggest","lastAggregateId","ctx","getVersion","aggregateId","_useGraph","selectedAggregate","setSelectedAggregate","setMetadata","autoFocusBusinessRules","setAutoFocusBusinessRules","setDependencies","showDependencies","setShowDependencies","resetForm","commandDependencies","handleDependenciesConfigChanged","changedDependencies","cmdMeta","onCtxChanged","updateDependencies","cmdSchema","Divider_DependenciesEditorDivider","Editor_DependenciesEditor","Suggestion_CodySuggestButton","newDeps","Divider_BusinessRulesEditorDivider","Editor_BusinessRulesEditor","suggestEventRecordingRules","newRuleSet","commandHandler","onUpdateMetadata","removeOneNestingLevel","lines","modifiedLines","line","INVALID_LINE","isSchemaLine","isSubSchema","raw","SchemaFromNodeDescriptionParser","currentLine","parseNextLine","subSchemaLines","parseAllSubSchemaLines","subSchema","lineStr","getNextLine","trimLeft","_lineStr$split","_lineStr$split2","schemaType","getSchemaFromNodeDescription","streamId","changedStr","onStreamIdChanged","changedConfig","isQueryableItemVo","getPossibleStateRefs","getPossibleQueryableItemRefs","getPossibleListVOs","getPossibleQueryableVORefsWithoutQueryParams","getItemProperties","nodeSchema","listItemSchema","getPossiblePages","getPossibleCommands","getPossibleViews","getPossibleForms","makeCssSchemaDefinitions","mui-container","sx","spacing","rowSpacing","columnSpacing","xsOffset","smOffset","mdOffset","lgOffset","xlOffset","^&","sx_breakpoints","xs","sm","md","lg","xl","css","makeCssSchema","time","overflow","all","animationDirection","animationFillMode","animationPlayMode","backfaceVisibility","backgroundAttachment","backgroundClip","backgroundOrigin","backgroundRepeat","borderRadius","borderCollapse","borderImageRepeat","boxDecorationBreak","boxSizing","breakBefore","breakAfter","breakInside","captionSide","clear","clearAfter","columnFill","columnSpan","columnRuleStyle","emptyCells","flexWrap","alignSelf","alignContent","fontStretch","fontSynthesis","fontKerning","fontVariant","fontVariantCaps","fontStyle","fontWeight","hangingPunctuation","hyphens","imageResolution","lineBreak","listStylePosition","listStyleType","objectFit","outlineStyle","pageBreakAfter","pageBreakBefore","pageBreakInside","pointerEvents","resize","tableLayout","textAlignLast","textDecorationLine","textDecorationSkip","textDecorationPosition","textDecorationStyle","textEmphasisPosition","textJustify","textOrientation","transformStyle","textTransform","unicodeBidi","whiteSpace","wordWrap","writingWode","bottom","animationDelay","animationDuration","overflowX","overflowY","iconNameCache","iconsFetched","makeUiSchema","additions","possibleCommands","possiblePages","possibleListVOs","possibleForms","optionsAdditions","assignValue","ui:title","ui:hidden","ui:description","ui:disabled","ui:options","ui_schema","ui:widget","addItemCommand","makeCommandComponents","makeActionsUiSchema","connectTo","directSubmit","forceSchema","uiSchema","button","makeCommandButtonUiSchema","makeCommandFormUiSchema","pageLink","page","ui:button","variant","variant:expr","color:expr","style:expr","label:expr","disabled:expr","hidden","hidden:expr","iconNameEnum","icon:expr","endIcon","endIcon:expr","ui:form","successRedirect","successRedirect:expr","makeTableUiSchema","itemProperties","possibleListRefs","ui:table","headerName","flex","itemIdentifier","density","hideToolbar","checkboxSelection","pageSize","minimum","pageSizeOptions","makeSidebarSchema","possibleQueryableRefs","group","dynamic","getPropertiesUiSchema","formSchema","buttonSchema","tableSchema","propsSchema","propPropertiesUiSchema","showAdvancedSettings","onShowChanged","AggregateCommandToggle","onAggregateCommandChanged","deleteState","deleteHistory","onDeleteHistoryChanged","onDeleteStateChanged","onNewAggregateChanged","StreamLockingToggle","streamLocking","onStreamLockingChanged","getUiMetadata","uiMeta","makeInitializeRulesSchema","dataSchema","initializeRules","withProjectionOperations","rule_then_insert_projection","insert","rule_then_upsert_projection","upsert","rule_then_update_projection","update","loadDocIntoVariable","rule_then_replace_projection","rule_then_delete_projection","makeProjectionSchema","live","given","when","changedProjectionStr","onProjectionChanged","changedProjection","onSchemaRemoved","makeResolveSchema","where","resolve_where_rule_definition","resolve_filter_else","maxItems","getDocProperties","changedResolveConfigsStr","onResolveChanged","CollectionInput","INPUT_CHAR_SIZE","CHAR_SIZE_UNIT","ADDITIONAL_CHAR_PADDING","onCollectionChanged","isEntity","onIsEntityChanged","isProjection","isQueryable","onQueryableChanged","isStored","onStoredStateChanged","NamespaceInput","onNsChanged","lastVoId","autoFocusSchema","setAutoFocusSchema","voSchema","setVoSchema","setQuerySchema","setShowAdvancedSettings","setProjection","isEntityCollection","setIsEntityCollection","setIsQueryable","_useState21","_useState22","setIsProjection","checkIsEntityCollection","entityCollectionCheck","voId","stateMeta","shouldUpdateMetadata","suggestVoSchema","suggestQuery","getDefaultResolveConfigFromQuery","queryDependencies","suggestedUiSchema","suggestUiSchema","suggestVoNamespace","suggestCollection","handleSchemaChanged","newSchema","handleQuerySchemaChanged","newQuerySchema","handleQuerySchemaRemoved","handleUiSchemaChanged","newUiSchema","clonedMeta","handleProjectionChanged","newProjection","StateVO_NamespaceInput","newNs","StateVO_IdentifierSelect","newIdentifier","newMetadata","Divider_SchemaEditorDivider","Editor_SchemaEditor","Divider_UiSchemaEditorDivider","Editor_UiSchemaEditor","AnyVO_QueryableToggle","newIsQueryable","Editor_QuerySchemaEditor","Divider_ResolverEditorDivider","Editor_ResolveEditor","existingQuerySchema","newResolve","Divider_ProjectionEditorDivider","AnyVO_ProjectionToggle","newIsProjection","suggestProjection","Editor_ProjectionEditor","getPossibleEvents","Step_AdvancedButton","show","AnyVO_EntityVoToggle","AnyVO_StoredVoToggle","isStoredInDb","newMeta","AnyVO_CollectionInput","newCollection","Editor_InitializeRulesEditor","initialize","refVoMeta","qSchema","sourceVo","itemSchema","sourceRefName","evtMeta","toShorthand","descSchema","forCommand","uiForm","uiFormData","isDDDAction","commandMeta","uiViews","uiView","viewMeta","viewDataRef","route","firstVoList","firstVoListMeta","refProp","refVoSchema","refPropSchema","firstStringProp","oProp","oPropSchema","listVoMeta","_splitPropertyRef3","_splitPropertyRef4","uiColumns","col","fieldExists","uiCol","DEFAULT_DOC_NS","firstProp","isRequired","getIdentifier","caseEventList","eName","nameParts","eventName","idExpr","similarNodes","eventMap","lastCommandId","selectedCommand","setSelectedCommand","newCommand","setNewCommand","showStreamIdEditor","setShowStreamIdEditor","commandId","suggestCommandCreatesNewAggregate","newRules","handleStreamIdChanged","AggregateCommand_NewAggregateToggle","AggregateCommand_DeleteStateToggle","AggregateCommand_DeleteHistoryToggle","firstEvent","eventMeta","firstView","AggregateCommand_AggregateCommandToggle","AggregateCommand_StreamLockingToggle","Editor_StreamIdEditor","suggestAggregateCommandSchema","stateMetaAgain","suggestAggregateCommandUiSchema","suggestNewCommandName","eventNameTitle","w","baseForm","toBaseForm","ensurePresentTense","isAggregateCommand","makeEventApplyRulesSchema","eventSchema","informationSchema","applyRules","selectedEvent","setEventSchema","stateSchema","setStateSchema","updateMeta","suggestEventSchema","defaultApplyRule","getStateSchema","showApplyRules","Editor_EventApplyRulesEditor","cmdMetadata","stateMetadata","suggestAggregateEventName","verbs","verbStr","toPastTense","$merge","getPolicyMetadata","markAsConnected","changedTags","isIfConditionRule","isIfNotConditionRule","makePolicyRulesSchema","possibleExternalSystems","possibleStateRefs","possibleInformationRefs","PolicyRulesSchema","rule_then_trigger_command","rule_then_insert_information","rule_then_upsert_information","rule_then_update_information","rule_then_replace_information","rule_then_delete_information","makeThenChangeInformation","policyTargets","getNodeNameForNodeSelect","_props$nodeOptions$fi","selectedId","selected","existingNames","selectedNodeName","withNs","nodeOptions","uniqueName","o","selectedNode","handleSelectNode","selectedIds","namesOfSelectedNodes","selectedNodes","lastPolicyId","policyId","selectedPolicy","setSelectedPolicy","autoFocusPolicyRules","setAutoFocusPolicyRules","setPolicyTargets","policyDependencies","handleRulesChanged","targetOptions","getFilteredElementsByTypes","Divider_ProcessorEditorDivider","Node_MultipleNodeSelect","changedPolicyTargets","shouldRepositionFeature","updateTargetsOnGraph","changedCtx","policyContextFromNode","repositionedFeature","repositionFeature","updatePolicyTargets","suggestTriggerRules","Editor_PolicyRulesEditor","cmdFQCN","hasTriggerCommandRule","isThenTriggerCommand","isTriggerCommand","isForEach","existingTargets","existingTargetIds","changedTargetIds","targetsToDelete","targetsToAdd","anchorNode","last","DEFAULT_CONNECT_MARGIN","uiToApiMarign","sliceApiLabel","DEFAULT_CARD_HEIGHT","SLICE_LANE_MARGIN","newTarget","suggestPolicy","policyName","suggestPolicyName","similarElements","newPolicy","eventToUIMargin","SLICE_LANE_HEIGHT","API_TO_MODULE_MARGIN","repositionFeatureIfNeeded","fillFromSourceEvent","fillFromPolicy","fillFromTarget","fillFromFeature","isPolicyContext","isPartOfPolicyContext","policyMeta","eventModel","getEventModelFromNode","TAG_SLICE_API_LABEL","getFeatureFromNode","nextStep","determineNextStep","previousStep","determinePreviousStep","installCodyGraphSuggestions","installSuggestions","currentStep","prevStep","installLeftSuggestions","installRightSuggestions","newEvent","suggestPolicyEvent","featureName","suggestNewFeatureName","newFeature","currentContainerParent","allNodes","getAllNodesFromCtx","changeParent","suggestFeature","matchingNode","TAG_EVENT_MODEL","POSSIBLE_STATUS","onStatusChanged","validateUrl","TaskLinkInput","onLinkChanged","selectedFeature","setSelectedFeature","setStatus","taskLink","setTaskLink","getStatus","Feature_StatusSelect","newStatus","Feature_TaskLinkInput","newLink","mostLeft","mostTop","featureGeo","featureSize","abs","changeGeometry","changeSize","getAllNodesFromDDDActionCtx","getAllNodesFromPolicyCtx","parentUi","stateList","getDefaultUiTableSchema","selectedState","setSelectedState","setDataSchema","suggestStateSchema","makeCodySession","includedNode","session","ctxKey","of","_props$uiConfig","uiConfig","makePageContentSchema","changedUiConfigsStr","onUiConfigChanged","possibleViews","viewsSchema","type:expr","loadState","props:expr","makeUiConfigSchema","routeParams","title:expr","mainPage","tab","breadcrumb","config","notHandledUiConfig","getOptionValue","accessibleFrom","accessibleFromOptionValue","selectedUI","onAccessibleFromChanged","handleAccessibleFromChanged","prepareOptions","isNode","selectedUi","setSelectedUi","autoFocusUiConfig","setAutoFocusUiConfig","topLevel","setTopLevel","setParentUi","viewModels","setViewModels","updateParentUi","changedParentUi","linkToPageFromParentUIIfPossible","ctxPropsToUpdate","initialParentUi","isTopLevel","suggestTopLevel","handlePageConfigChanged","Ui_UiAccessibleFromSelect","changedAccessibleFrom","suggestPageConfig","Editor_UiConfigEditor","newPageConfig","Editor_PageContentEditor","currentPageConfig","onlyContent","onlyConfig","suggestedRouteParams","suggestRouteParams","suggestRoute","vName","vc","suggestUiRoutePart","param","suggestUiName","suffix","nodeNames","pluralize","ensurePluralNoun","firstViewModel","parentUI","parentUIMeta","stateRef","pageName","findStateListViewModel","_result","stateListVO","stateListVOMeta","table","hasPageLink","voMetaChanged","getPageNameFromPageLink","firstColumn","allCopiesOfParentUi","stateListViewModel","stateListViewModelMeta","vm","itemsSchema","markAsDisconnected","TAG_DISCONNECTED","isDisconnected","suggestDDDActionUi","uiName","tempUi","suggestViewModels","newUi","isAdded","existingViewModelIds","changedViewModelIds","viewModelsToDelete","viewModelsToAdd","lastExistingViewModel","newViewModel","updateViewModelsOnGraph","suggestCommand","aggregateToApiMargin","eventToApiMargin","suggestAggregate","aggregateName","suggestAggregateName","suggestEvent","suggestState","stateName","suggestNewEntityName","voNames","rawQuerySchema","suggestedSchema","similarStateElements","suggestStateList","tree","listVo","listMeta","createListFromState","dddActionFromNode","validTypes","fillFromUI","fillFromCommand","fillFromAggregate","fillFromEvent","eSaR","fillFromStateVoCandidate","installUpSuggestion","installDownSuggestion","fillFeatureFromNode","fillEventModelFromNode","isParentUi","childUi","commandMetadata","aggregateMeta","tMeta","featureContextFromNode","isFeatureContext","informationContextFromNode","isInformationContext","uiContextFromNode","getParentUi","getUiViews","getSliceApiLabelFromNode","isUiContext","isDddActionUi","isDddActionOrPolicyFeature","atLeastOneChildIsPartOfDDDActionOrPolicy","isValidEvent","stepHeader","step","isSelectContextStep","makeRunCodyOnSelector","codyEmoji","CodyEmoji","CodyMessage","showDetails","setShowDetails","msgColor","detailsColor","detailsFontWeight","defaultStyle","detailsStyle","showDetailsIcon","CodyConsole_CodyEmoji","applyMessageStyle","msgAndStyles","msgParts","styles","spans","nextStyle","firstPart","partI","firstCharIsWhitespace","lastCharIsWhitespace","parseStyleString","cssProps","propStrs","_propStr$split","_propStr$split2","camelize","nodeTypeFromStep","ActiveStepIcon","activeStep","CodyStepElement","Step","completed","linkable","onStepClicked","isGenerateNodeAction","iio","steps","setSteps","leftScroll","setLeftScroll","connectError","setConnectError","healthcheckError","setHealthcheckError","determineRunSteps","querySelector","scrollIntoView","behavior","execStep","executedStep","updatedSteps","updateStep","onBackToStepChanged","wizardStep","disableAllRemainingSteps","onCodyFinished","getNextStep","markAsActive","markAllAsLinkable","onScroll","scrollLeft","StepGroup","CodyMonitor_CodyStepElement","indeterminate","CodyConsole_CodyMessage","returnNext","updatedStep","codyServerName","clearTimeout","performHealthCheck","executable","urls","triesLeft","requests","failedResponse","allGood","defaultGenerateProps","lastAutoRun","_ref6","connectUrl","determineDDDActionRunSteps","determineInformationContextRunSteps","determinePolicyContextRunSteps","determineUiContextRunSteps","determineFeatureContextRunSteps","_x12","defaultProps","Step_ActiveStepIcon","skipTypes","pushLater","refreshedChild","determineAdditionalStepsIncludedInFeature","refreshedEvt","stepsNames","RunCodyOnSelect","onNextStep","lastActiveStep","forcedPreviousStep","onPreviousStep","currentFinishStepAction","EMPTY_CONTEXT","defaultCtx","setCtx","codySession","setCodySession","codyErrored","setCodyErrored","unsupportedNode","setUnsupportedNode","setActiveStep","setForcedPreviousStep","setReadonly","sidebarWidth","memoizeNode","setWizardStep","newCtx","contexts","shouldRunCody","isValid","currentCtx","closeWizard","saveCurrentStep","handleCtxChanged","changeStep","helpLink","stepWikiLink","closeOnEscape","CodyMonitor_RunCodyOnSelect","scrolling","Unsupported_UnsupportedNode","CodyMonitor_RunCody","Step_PreviousStep","Step_NextStep","determineWizardContextAndStep","resetCodySuggestCallbacks","WHEEL_LISTENER","stopImmediatePropagation","MxGraphBoard","mxGraph","divGraph","divDimmer","codec","boardSync","boardAgent","iioCody","lastFocusedCells","lastClicks","uploadOpenHandle","boardLinkHandle","taskLinkHandle","codyEngineWizardHandle","imageUploadedListener","boardLinkListener","taskLinkListener","setUsedGraph","setUsedMouseSync","activeGraphElement","mxGraphWrapper","syncChangesWithCody","changes","deletedCellIds","deletedEdges","change","deletedCell","deletedCells","deletedEdge","edgeNodes","transactionCellIds","effectedCells","effectedCellIds","_cellId","vertexChildren","vertexChild","getVerticesTree","LoadGraph","createRef","_useMouseSync","nextProps","nextState","initGraphBoard","setEnabled","setLiteMode","getGraphXml","updateXml","onBoardImported","onBoardImportStarted","onBoardExported","checkScrollToCells","activeUsers","components_MxGraphImageUpload","imageName","components_MxGraphBoardLink","components_MxGraphTaskLink","CodyEngineWizard_WizardModal","metadataToJSON","metadataJsonToString","mxFactory","onError","uuidPool","uuidT","mxGraphModel","prototype","fromUUID","editorUiInit","EditorUi","mxResources","loadDefaultBundle","bundle","getDefaultBundle","RESOURCE_BASE","mxLanguage","getSpecialBundle","STYLE_PATH","THEME","xhr","getText","themes","Graph","defaultThemeName","getDocumentElement","Editor","urlParams","chrome","copyApi","deeplinkFactory","notifyFunc","setHistory","enableCopyToClipboard","setDeeplinkFactory","enableNotifications","initializeGraphEditor","onInfo","attachImageUploadListener","attachLinkBoardListener","attachLinkTaskListener","attachCodyEngineWizardListener","attachImageReplaceListener","attachCodySuggestionsListener","attachChangeActiveGraphElementListener","attachSyncLabelChangedListener","attachLookupElementListener","attachShowElementDetailsListener","attachCellConnectedListener","attachCodyListener","initializeAutoSaveManager","graphDoc","parseXml","importGraphModel","documentElement","initContainerStyles","URLSearchParams","cellsFocused","checkPlayshotsModal","initBoardAgent","passive","onBoardInitialized","initCody","onInsertImage","processImageUrl","imgName","imgUrl","imgWidth","imgHeight","onLinkBoard","processBoardLink","boardLink","onLinkTask","processTaskLink","onCodyWizard","selectedCell","onReplaceImage","_this10","setUpdateCodySuggestionsCb","_determineWizardConte","ctxName","possibleCtx","possibleStep","initializeCodyGraphSuggestions","_this11","onChangeActiveGraphElement","onActiveGraphElementChanged","clearGraphElementCache","_this12","LABEL_CHANGED","sender","getProperty","onActiveGraphElementLabelChanged","mxValueChange","onActiveGraphElementMetadataChanged","onLookupElement","elementLabel","elementType","_this13","mxAutoSaveGraphModelChanged","mxAutoSaveManager","graphModelChanged","localAutoSave","autoSaveDelay","autoSaveThrottle","autoSaveThreshold","sortChanges","updateVersion","currentVersion","_this13$detectHistory","detectHistoryAttributesFromChanges","onLocalBoardChanged","enableLiteMode","disableLiteMode","_this14","onShowMetadata","focusMetadataEditor","_this15","CELL_CONNECTED","cellsToFocus","cellIds","setSelectionCells","_this16","_chunk","getAllVertexElementsOfActiveLayer","_this17","onTriggerCody","makeGraphElement","onMergeSchema","sourceCell","targetCell","_this18","syncInitialized","added","decode","syncActiveGraphElementWithRemoteChange","edit","mxUndoableEdit","fireEvent","mxEventObject","onLocalBoardUpdatedWithRemoteChange","onRemoteBoardChanged","attachCodySyncListener","_this19","topMenuHeight","topMenu","clientHeight","tr","addActiveUser","removeActiveUser","FIRE_MOUSE_EVENT","evtName","me","getGraphX","getGraphY","MOUSE_MOVE","panningHandler","isActive","physicsActive","EVT_USER_IS_PANNING","EVT_PANNING_PHYSICS_CLEARED","EVT_USER_IS_ZOOMING","EVT_USER_IS_TYPING","isTyping","EVT_USER_IS_MOVING","isMoving","EVT_USER_IS_AUTO_SCROLLING","_this20","topMenuUsers","backgroundSize","backgroundImage","toggleObserveUser","HTMLElement","unsetCurrentObservedUser","getUserIdFromLabelId","childNodes","firstChild","labelId","otherChanges","edgeChanged","mxGeometryChange","mxChildChange","filterOutMxStyleChange","previous","moved","detectHistoryCellTypeAndLabelFromChange","mxTerminalChange","allMoved","allDeleted","allAddedToContainer","deletedContainer","allMovedOutOfContainer","mxStyleChange","Component","MxGraphBoardContainer","Notification","pure","handleAdminChangeTeamBoardPermissions","changePermissions","adminChangeTeamBoardPermissions_marked","adminChangeTeamBoardPermissions_marked2","changeBoardAbbreviationFlow","changeBoardAbbreviationFlow_marked","changeBoardPermissionsFlow","onChangeBoardPermissions","changeBoardPermissionsFlow_marked","changeResponsibleTeamFlow","changeResponsibleTeamFlow_marked","boardKey","loadBoardList","boardsJson","deleteInspectioBoard","onErr","boardList","removeItem","deleteBoardFlow","localError","errorNotification","deleteBoardFlow_marked","deleteBoardFlow_marked2","fetchBoardClientFlow","onFetchBoardClient","onFetchBoardClientSecret","onCreateBoardClient","onRemoveBoardClient","onResetBoardClientSecret","fetchBoardClientFlow_marked","fetchBoardGraphElementsFlow","onFetchBoardGraphElements","fetchBoardGraphElementsFlow_marked","fetchBoardPermissionsFlow","onFetchBoardPermissionsForUsers","onFetchBoardPermissionsForTeams","fetchBoardPermissionsFlow_marked","handleFetchBoardStickyTemplates","fetchBoardStickyTemplates_marked","fetchBoardStickyTemplates_marked2","fetchOpenBoardInvitationsFlow","onFetchOpenBoardInvitations","fetchOpenBoardInvitationsFlow_marked","defaultPlayshotSummaryProps","createPlayshotSummaryFromServerData","PlayshotSummary","fetchPlayshotSummaryListFlow","onFetchPlayshotSummaryList","fetchPlayshotSummaryListFlow_marked","fetchUserBoardFlow","retryFetchUserBoard","onFetchUserBoard","fetchUserBoardResponse","accessCheck","accessCheckData","retryResponse","access","BoardVersioning","fetchUserBoardFlow_marked","createUserSettingsFromServerData","UserSettings","_ImmutableRecord","ImmutableRecord","loadUserSettings","LoadUserSettingsFlow_marked","updateUserData","loadUserBoards","onFetchUserBoards","fetchUserBoardsFlow","fetchUserBoardsFlow_marked","creatorId","fetchUserBoardsFlow_marked2","getUserReponse","fetchUserBoardsFlow_marked3","fetchUserBoardsFlow_marked4","fetchUserBoardsFlow_marked5","importExistingBoardFlow","oldBoard","importExistingBoardFlow_marked","importExistingBoardFlow_marked2","importNewBoardFlow","_useGraph2","emptyGraphWithXml","importNewBoardFlow_marked","importNewBoardFlow_marked2","handleImportStickyTemplates","tpls","importedTpls","importStickyTemplates_marked","importStickyTemplates_marked2","installUserBoardFlow","boardResponse","installUserBoardFlow_marked","handleMoveUserBoardToOrganization","OrgaModule","moveUserBoardToOrganization_marked","moveUserBoardToOrganization_marked2","renameBoardFlow","renameBoardFlow_marked","onResendBoardInvitation","resendBoardInvitationFlow","resendBoardInvitationFlow_marked","resendBoardInvitationFlow_marked2","onRevokeAccess","revokeAccessToBoardFlow","revokeAccessToBoardFlow_marked","revokeAccessToBoardFlow_marked2","onRevokeBoardInvitation","revokeBoardInvitationFlow","revokeBoardInvitationFlow_marked","revokeBoardInvitationFlow_marked2","onSaveBoard","saveBoardFlow","forceSnapshot","saveBoardFlow_marked","saveBoardFlow_marked2","setBoardTagsFlow","setBoardTagsFlow_marked","onShareBoard","shareBoardFlow","shareBoardFlow_marked","shareBoardFlow_marked2","handleShareBoardWithAnyone","shareBoardWithAnyoneFlow","shareBoardWithAnyoneFlow_marked","shareBoardWithAnyoneFlow_marked2","handleShareBoardWithOrganizationMembers","shareBoardWithOrganizationMembersFlow","shareBoardWithOrganizationMembersFlow_marked","shareBoardWithOrganizationMembersFlow_marked2","manager","BoardsIndexedDB","BoardsStorageManager","getOverviewSorting","setOverviewSorting","getOverviewResponsibleTeam","setOverviewResponsibleTeam","sorting","useBoardsStorageManager","handleSortBoardOverview","handleFilterByResponsbileTeam","storeOverviewSettingsFlow","storeOverviewSettingsFlow_marked","storeOverviewSettingsFlow_marked2","storeOverviewSettingsFlow_marked3","syncElementsTreeFlow","graphRoot","syncElementsTreeFlow_marked","sidebarCollapsed","latestGraph","SidebarAction","syncElementsTreeFlow_marked2","handleToggleCodySuggestEnabled","toggleCodySuggestEnabled_marked","toggleCodySuggestEnabled_marked2","handleToggleEventModelingEnabled","toggleEventModelingEnabled_marked","toggleEventModelingEnabled_marked2","handleSetStickyTemplate","updateStickyTemplate","_command$payload","setTemplate","updateStickyTemplate_marked","updateStickyTemplate_marked2","updateStickyTemplate_marked3","ActivePage","MaxLengthLabel","setActive","BoardHistoryEntry","setShowAll","Link","entry","clicks","components_MaxLengthLabel","Description","BoardHistoryGroup","isActiveByDefault","AccordionTitle","AccordionContent","loadHistory","getBoardByIdSelector","useMemo","getBoardHistoryByIdSelector","setClicks","feedEvents","moment","relativeMoments","startOfWeek","startOf","startOfMonth","startOfLastMonth","subtract","today","generateRelativeMomentsFromNow","groupedHistory","yesterday","twoDaysAgo","threeDaysAgo","fourDaysAgo","fiveDaysAgo","sixDaysAgo","lastWeek","twoWeeksAgo","threeWeeksAgo","fourWeeksAgo","lastMonth","older","entryDate","ISO_8601","entryComponent","components_BoardHistoryEntry","marshalFeedEvent","groupKey","isBefore","numOfWeeks","diff","numOfDays","convertToRelativeHistoryGroup","handleScroll","HTMLDivElement","scrollHeight","scrollTop","filteredHistory","foundFirstElementEntry","lastHistoryEntry","handleCloseHistory","boardHistoryGroups","components_BoardHistoryGroup","Transition","animation","zIndex","Accordion","doRedirect","setDoRedirect","redirectPath","setRedirectPath","handleAckResponse","ackResponse","react_router","userBoards","BoardModule","BoardListSelector","showDropdown","setShowDropdown","showRemoveBoardConfirm","setShowRemoveBoardConfirm","redirectToBoard","setRedirectToBoard","Route","onOpen","vertical","board_name","confirmButton","cancelButton","addTeamMode","onNameChanged","onCancelName","onCancelDescription","isRevoked","setIsRevoked","cachedInvitation","ListItem","OpenInvitationList","components_OpenInvitation","relaxed","divided","isValidEmail","loadingInvitations","setLoadingInvitations","setInvitations","failedToLoad","setFailedToLoad","hasInvitations","components_OpenInvitationList","avatarLoaded","setAvatarLoaded","showRemoveMemberConfirm","setShowRemoveMemberConfirm","canBeRemoved","handleMemberClick","adminClass","onLoad","showDeleteModal","setShowDeleteModal","showAddUserModal","setShowAddUserModal","showAddBoardToTeamModal","setShowAddBoardToTeamModal","memberList","mA","mB","components_MemberEntry","components_BoardEntry","blueprint","components_EditableTeamHeader","onTeamAdded","isMovable","components_MoveTeamMenu","targetOrganizations","components_InviteUserToTeamModal","components_AddBoardToTeamModal","team_name","showCard","setShowCard","checkExistingTeams","setCheckExistingTeams","existingTeams","existingTeam","components_TeamCard","activeOrganizationInfo","teamsAreMovable","orgaInfo","teamCards","joinedTeamCards","components_JoinedTeamCard","components_AddTeamCard","floating","DisplayMode","TeamOverview_TeamTab","translateKey","MenuItem","BoardTopMenu","components_TopmenuLiteMode","openOnTriggerClick","openOnTriggerFocus","openOnTriggerMouseEnter","NavLink","doubling","emailVal","onEmailChange","onPermissionsChange","setUserEmail","setPermissions","closeAddUserModal","components_InviteUserToBoardModal","TopmenuAvatar","activeClassName","logout","BoardLink","activeCrumb","Breadcrumb","Section","HomeLink","BoardOverviewCrumb","OrganizationOverviewCrumb","TeamOverviewCrumb","UpdatesCrumb","UserProfileCrumb","fixed","exact","BoardCrumb","ShareBoardButton","components_TopmenuAvatar","showModal","setShowModal","getUserQuota","components_BoardQuotaReachedModal","validateTeamExists","selectedTeam","setSelectedTeam","getTeamNameById","showAddTeamModal","setShowAddTeamModal","showRemoveTeamConfirm","setShowRemoveTeamConfirm","memberToRemove","teamToRemove","getUsernameByUserId","eyeIcon","components_AddTeamToBoardModal","ImportMode","BoardList","_ownVisibleBoards","isOrgaAdmin","ownVisibleBoards","ownHiddenBoards","ownBoard","boardListItems","Sidebar_BoardListItem","Sidebar_ShowMoreBoardsItem","badgeClasses","feedback","setFeedback","MessageContent","ERROR_MSG","Feedback","showFeedbackModal","setShowFeedbackModal","resetFeedbackModal","setResetFeedbackModal","components_FeedbackModal","feedbackText","lastSelectedType","syncTimer","currentHistoryEntry","readFileContent","handleFileContent","extractBoardName","setDisabled","showQuotaModal","setShowQuotaModal","askForImportMode","setAskForImportMode","currentFile","setCurrentFile","existingBoardName","setExistingBoardName","setBoardId","processFile","importMode","newBoard","newBoardId","existingBoardList","existingBoard","updatedBoard","replaceBoard","logoLoaded","setLogoLoaded","lastFilterVal","withoutSelectedType","searchVal","selectedType","withSelectedType","validFilterType","filterIsOpen","mapLowercaseTypeToNodeType","elementsTreeSelector","searchInput","showFilter","setShowFilter","setSelectedType","searchHasFocus","setSearchHasFocus","dispatchFilterChange","handleClear","filterColor","focusClass","DropdownMenu","DropdownItem","DropdownDivider","handleSelectType","borderTop","borderTopLeftRadius","borderBottomLeftRadius","onMouseDown","isFiltered","MxGraphBoardSearch","UpdateListEntry","viewed","UpdateList","MessageHeader","UpdatePage","updateIndex","components_UpdateListEntry","Sidebar_Logo","Sidebar_Upgrade","Sidebar_Search","Sidebar_ImportBoard","Sidebar_AddBoard","Sidebar_BoardOverview","Sidebar_BoardList","Sidebar_Updates","Sidebar_Feedback","LeafIcon","iconName","dblClickTimer","showChildren","setShowChildren","copyToLayerSuccess","nameEditMode","setNameEditMode","layerDeleteMode","setLayerDeleteMode","visibleIcon","lockIcon","showCopySuccess","leafOpen","onActiveLayerChanged","handleLeafIconClick","onContextMenu","components_LeafIcon","fitted","closeOnTriggerBlur","closeOnTriggerMouseLeave","hideOnScroll","willBeVisible","onLayerVisibilityChanged","handleVisibleClick","deletable","EDITABLE_LAYER_INPUT_CHAR_SIZE","EDITABLE_LAYER_CHAR_SIZE_UNIT","EDITABLE_LAYER_ADDITIONAL_CHAR_PADDING","newLayerName","deleteMode","setDeleteMode","labelRef","div","listItem","closest","itemIcon","canHaveChildren","validChildren","isValidLeaf","hiddenClass","onDragStart","TAG_SLICE","isMetadataVisible","handleSideBySideClick","BoardTreeView_BoardTree","leafs","expandLeafs","BoardTree","BoardTreeView_BoardTreeLeaf","refreshTimer","getElementsTreeSelector","layers","setLayers","visibilityChanges","setVisibilityChanges","activeLayerChanges","setActiveLayerChanges","showNewLayerInput","setShowNewLayerInput","copyIntoLayerPossible","setCopyIntoLayerPossible","showCopyToLayerSuccess","setShowCopyToLayerSuccess","hasSelection","requestAnimationFrame","getFilteredElementsAsTree","layerComponents","BoardTreeView_BoardLayer","defaultLayerSetAsActive","handleLayerVisibilityChanged","layerName","BoardTreeView","CollapseToggle","iconClass","newCollapsed","setTeamName","iconUp","setIconUp","setMemberToRemove","angleIcon","contentClass","react_router_hash_link_lib","el","bodyRect","getBoundingClientRect","offsetPosition","scrollTo","TeamList","teamList","Sidebar_TeamListItem","arrowClick","setArrowClick","handleOrganizationClick","activeOrgaName","hasImplicitOrganization","orgaName","components_SideMenuOrganizationSwitch","Copyright","Sidebar_Organization","board_count","Sidebar_AddTeam","Sidebar_TeamOverview","Sidebar_TeamList","getFullYear","isBoardWorkspace","collabsableLeft","setCollabsableLeft","isDragging","setIsDragging","isMobile","matchMedia","checkMobile","collapsible","touchOnlyPan","Sidebar_OverviewSidebar","Sidebar_WorkspaceSidebar","Sidebar_Copyright","cjs_default","axis","onDrag","deltaX","onStop","Sidebar_CollapseToggle","makeNodeFromActiveGraphElement","activeGraphElementsSelector","headerKey","showMore","setShowMore","showConnections","setShowConnections","numOfSources","numOfTargets","total","visibleSources","visibleTargets","handleConnectionClick","makeContextDescriptions","ctxType","handleContextSelected","Meta","extra","descriptions","cType","getNodeTypeForContext","getExtraDescriptionForContext","MetadataCodyWizard","force","Step_StateVO","Step_DddEvent","Step_PolicyEvent","Step_Aggregate","Step_DddCommand","Step_Ui","Step_Feature","Step_AnyVo","Step_Policy","Step_SelectContext","errorRegistry","activeTab","setActiveTab","infoModalOpen","setInfoModalOpen","isNodeWithMetadata","handleMetadataUpdate","disposable","firstSimilarElement","getElement","changeActiveTab","changedTab","onShowRunCody","activeNodeSources","activeNodeTargets","BoardElementDetails_ElementConnections","flexGrow","BoardElementDetails_MetadataCodyWizard","components_BoardHistory","components_CollaborationInfoModal","activeGraphElements","collabsableRight","setCollabsableRight","boardElementMetadataRef","showRunCody","setShowRunCody","availWidth","screen","min","activeElementId","similarElementsNodes","activeNode","activeNodeSourcesIds","activeNodeTargetsIds","_activeNodeSources","_activeNodeSourcesIds","_activeNodeTargets","_activeNodeTargetsIds","deduplicatedSources","deduplicatedTargets","activeSource","activeTarget","handleCloseElementDetails","BoardElementDetails_BoardElementMetadata","number","iioAvatar","InspectIoMessage","historyJson","loadCodyConsoleHistory","UserInput","lastCodyMsg","showConnectDefault","messageCount","defaultValue","onEnter","onEscape","UserMessage","RESERVED_NAMES","setMessages","setLastCodyMsg","collabsableBottom","setCollabsableBottom","consoleEl","bothSidebarsWidth","addMessage","scrollBy","CodyConsole_InspectIoMessage","handleCloseClick","CodyConsole_UserInput","CodyConsole_UserMessage","foundConnect","groups","foundDisconnect","deltaY","makeOrganizationInvitationSelector","getOrganizationInvitationById","hasEnoughQuota","Invitations_OpenOrganizationInvitation","currentUserIsOwner","isGuest","showNewOrga","setShowNewOrga","organizationData","mailFilter","setMailFilter","emailSearchOptions","g","components_OrganizationMemberEntry","guestList","newMailFilter","InviteUserToOrganisationModal","components_OrganisationManagement","setBoardXml","decodeURIComponent","playshotLoaded","setPlayshotLoaded","queryParams","shouldSave","withPlayshot","loadedBoardXml","playshotLink","convertToTimeNumber","emptyZeros","convertDurationToHms","d","floor","Number","h","convertHmsToDuration","calculateCurrentTime","hourglass","setHourglass","setCurrentTime","timeLeft","timerHours","timerMinutes","timerSeconds","leftPercentage","_convertDurationToHms","_convertDurationToHms2","intervalRef","minRef","hours","setHours","minutes","setMinutes","seconds","setSeconds","setDeadline","setDuration","setModerator","isPlaying","setIsPlaying","currentTime","setPausedTime","moderatorHasLeft","setModeratorHasLeft","_useState23","_useState24","gongPlayed","setGongPlayed","play","ignorePausedTime","hoursMillis","minutesMillis","secondsMillis","_pausedTime","calculatedDuration","newDeadline","triggerMouseSync","handleRemoteTimerStarted","_convertDurationToHms3","_convertDurationToHms4","remoteHours","remoteMinutes","remoteSeconds","handleRemoteTimerStopped","handleRemoteTimerPaused","handleRemoteUserJoined","handleRemoteUserLeft","_currentTime","currentHours","currentMinutes","currentSeconds","isTimeLeft","isModerator","canModerate","Audio","PublicSounds","hoursVal","minutesVal","secondsVal","pause","makePlayshotSummaryListSelector","getPlayshotSummariesByBoardId","ProophBoardDescriptionKeys","getNodeIdFromProophBoardDescription","_pbCardId","makeAsyncIterable","wrapAsyncGenerator","playFQCNFromDefinitionId","definitionId","registryIdToDataReference","registryId","convertJsonSchemaToShorthandIfPossible","converted","tryToConvert","convertObjToShorthand","convertArrayToShorthand","convertRefToShorthand","convertScalarToShorthand","shorthandProp","$default","shorthandStr","opt","convertPropertyRefToShorthand","shorthandObj","_jsonSchema$$ref$spli","_jsonSchema$$ref$spli2","getService","nodeData","getDefaultService","nodeLabel","removeDefaultService","playshotOrDefaultService","shift","getNextGeo","addedNodes","addedNodesList","lastNode","geoRight","SPACING","geoBelow","geoBelowRight","xSpacing","ySpacing","prepareDiffCommand","omit","factory","CommandAdded","operation","old","_apply","syncContext","getNodeByIdOrFQCN","nodeService","CommandMetadataChanged","newPlayshot","oldPlayshot","changedCommand","oldInfo","oldRules","CommandRenamed","oldCommand","makeApplyTask","runApplyTasks","tasks","lastResponseWasError","asyncIterator","_next","nextTask","CODY_APPLY_PAUSE","CommandRemoved","applyTasks","_func","_func2","_func3","_func4","prepareDiffEvent","EventAdded","EventMetadataChanged","changedEvent","oldEvent","EventRenamed","EventRemoved","CodyResponseException","playwithErrorCheck","prepareDiffInformation","queryInfo","qInfo","returnType","collectProjectionConfig","prjName","convertEventProjectionCaseToProjectionConfig","eventCase","thenRule","convertThenProjection","allowedOperations","InformationAdded","newInformation","InformationMetadataChanged","changedInformation","InformationRenamed","oldInformation","InformationRemoved","visitRulesThen","visitor","visitRuleThen","clonedRule","visitThen","isExecuteRules","getViewRuntimeInformation","viewName","applySlices","pageId","getAllPageCommands","makeAddCommandSliceTasks","makeAddPageTask","components","getCommandsFromUiSchema","viewInformation","commandSlice","makeAddCommandSliceFrameTask","makeAddCommandSlicePageTask","makeCommandSliceCommandTask","isRecordEvent","getEventsRecordedByCommand","eventContext","makeCommandSliceEventTask","policies","iri","makeInformationProjectionSliceTasks","viewKey","viewSlice","makeViewInformationSliceFrameTask","makeViewSliceInformationTask","makeViewSlicePageTask","infoId","preparedInfo","edgePoint","CONNECT_SPACING","addNodeBeforeSliceNode","pageNode","lastView","DEFAULT_CARD_WIDTH","commandNode","eventId","_callee8","mxGraphNode","sliceEle","PageAdded","newPage","PageMetadataChanged","changedPage","oldDefinition","PageRemoved","comparePlayshots","oldPages","newPages","oldPageNames","newPageNames","pagesToRemove","oldPageName","pagesToAdd","newPageName","changedPages","oldPage","pageNameToAdd","pageToAdd","pageLabel","pageNameToUpdate","pageToUpdate","pageNameToRemove","comparePages","oldCommands","newCommands","oldNames","newNames","commandsToRemove","commandsToAdd","changedCommands","cmdNameToAdd","cmdToAdd","cmdNameToUpdate","cmdToUpdate","cmdNameToRemove","compareCommands","oldEvents","newEvents","eventsToRemove","eventsToAdd","changedEvents","evtNameToAdd","evtToAdd","evtNameToChange","evtToChange","evtNameToRemove","evtToRemove","compareEvents","oldTypes","newTypes","informationToRemove","informationToAdd","oldPreparedInformation","newPreparedInformation","infoNameToAdd","infoToAdd","infoNameToUpdate","infoToUpdate","infoNameToRemove","infoToRemove","compareInformation","PlayshotDiffEditor","initializeDiffModel","renderSideBySide","useInlineViewWhenSpaceIsLimited","PlayshotChangedDiff","showDiff","setShowDiff","ListContent","MxGraphBoard_PlayshotDiffEditor","PlayshotTableRow","u","exporting","setExporting","loadingPlayshots","setLoadingPlayshots","deletingPlayshot","setDeletingPlayshot","onInitPlayshot","prevPlayshotPromise","playshotPromise","playshots","onComparePlayshots","playshotData","onDeletePlayshot","loadingPlayshotId","setLoadingPlayshotId","playshotComparision","setPlayshotComparision","syncError","setSyncError","playshotDeletedCount","setPlayshotDeletedCount","handleClose","initCodyPlay","handleInitPlayshot","handleDeletePlayshot","lastResponse","numOfChanges","getFilteredElementsByTag","syncChange","currentIteration","_value","nextIteration","finishSync","applied","switchPlayshot","side","playshotSummary","playshotOptions","pA","pB","PlayshotModal_SyncErrorMessage","MxGraphBoard_PlayshotChangedDiff","prevPlayshot","reverse","nextPlayshot","MxGraphBoard_PlayshotTableRow","streams","documents","SyncErrorMessage","calculateCollapsableRight","handleCloseSideBySide","Main","BoardOverview","EditBoard","UserProfile","TeamOverview","MxGraphBoardRedirect","OrganizationOverview","AcceptOrganizationInvitation","BoardImportFromLink","Root","Layout_TopMenu","Layout_Sidebar","App_Main","NotificationsContainer","CodyConsole","BoardHistory","SideBySideDetails","BoardElementDetails","PlayshotModal","components_Layout_TopMenu","AppStandalone_Main","App","store","baseName","es","react_redux_es","basename","AppStandalone_Root","authReducer","defaultBoardOverviewState","BoardOverviewState","filterDuplicates","filteredEntries","historyArr","skipNext","setPrevLabel","prevLabel","prevRecordedAt","prevAction","inspectioBoardsReducer","syncSummaryInfo","boardToUpdate","updateXmlFromSnapshot","boardToUpdateFetched","boardToResetFetched","boardToSave","updateXmlAndVersionFromBoard","setIn","removeIn","teamsAdd","teamsRevoke","boardPermissionsForUsers","valueSeq","permissionEntry","boardPermissionsForTeams","boardElementsState","_aBoardHistory$histor","_pBoardHistory$histor","aBoardHistory","aNewEntries","currentLastEntry","lastEntry","pBoardHistory","pNewEntries","firstEntry","pLastEntry","loadingHistoryState","loadingBoards","overview","oldElementsTree","mergeTree","oldFilteredTree","inspectioSidebarReducer","NotificationSystemReducer","idx","findIndex","lMsg","reducer","UserModel","inspectioUserReducer","BoardAction","settings_loaded","iioUsersInfo","rootReducer","notificationSystem","inspectioBoards","inspectioUsers","inspectioTeams","InspectioTeams","inspectioOrganizations","InspectioOrganizations","inspectioSidebar","formReducer","socketReducer","onDeleteBoard","standaloneDeleteBoardFlow","sagas_deleteBoardFlow_marked","sagas_deleteBoardFlow_marked2","standaloneEditBoardFlow","editBoardFlow_marked","editBoardFlow_marked2","standaloneFetchBoardStickyTemplatesFlow","boardData","stickyTemplateData","sagas_fetchBoardStickyTemplates_marked","sagas_fetchBoardStickyTemplates_marked2","standaloneFetchPlayshotSummaryListFlow","sagas_fetchPlayshotSummaryListFlow_marked","onLoadUserSettings","onSignIn","standaloneFetchUserBoardsFlow","sagas_fetchUserBoardsFlow_marked","sagas_fetchUserBoardsFlow_marked2","sagas_fetchUserBoardsFlow_marked3","sagas_fetchUserBoardsFlow_marked4","standaloneFetchUserBoardFlow","sagas_fetchUserBoardFlow_marked","onImportExistingBoard","standaloneImportExistingBoardFlow","sagas_importExistingBoardFlow_marked","sagas_importExistingBoardFlow_marked2","onImportNewBoard","standaloneImportNewBoardFlow","sagas_importNewBoardFlow_marked","sagas_importNewBoardFlow_marked2","sagas_importStickyTemplates_marked","sagas_importStickyTemplates_marked2","onInstallUserBoard","standaloneInstallUserBoardFlow","sagas_installUserBoardFlow_marked","installUserBoardFlow_marked2","standaloneLoadBoardHistoryFlow","sagas_loadBoardHistoryFlow_marked","sagas_loadBoardHistoryFlow_marked2","standaloneSaveBoardFlow","sagas_saveBoardFlow_marked","sagas_saveBoardFlow_marked2","standaloneUpdateStickyTemplateFlow","oldStickyTemplateData","sagas_updateStickyTemplate_marked","sagas_updateStickyTemplate_marked2","sagas_updateStickyTemplate_marked3","standaloneUpsertUserSetting","upsertUserSettingFlow_marked","upsertUserSettingFlow_marked2","StandaloneSaga","rootSaga","rootSagas","saga","spawn","saga_marked","configureStore","composeEnhancers","composeWithDevTools","sagaMiddleware","createSagaMiddleware","createStore","applyMiddleware","createBrowserHistory","__webpack_exports__","Keycloak","realm","ReactDOM","AppStandalone","de","translation","app","welcome","topmenu","save","confirm","yes","no","back","generateTemplate","showLess","learnMore","stickyTypes","insp","hint","learn_more","got_it","new_logo_header","new_logo_text","new_domain_header","new_domain_text","all_boards","add_board","last_modified","fetch_board_error","shared_board","empty_space","teamFilter","element_details","json_invalid_title","json_invalid_text","no_element_selected","disconnect_from_similar_elements_text","disconnect_from_similar_elements_link","connect_with_similar_elements_text","connect_with_similar_elements_link","no_boards_left_warning","boards_left_warning","boards_left_warning_upgrade","top_menu","activity","import_board","export_board","activate_lite_mode","lite_mode_is_active","lite_mode_is_active_details","cody_wizard","unsupported_node","run_cody","node_select","unique_name_error","default_placeholder","select_data_entity","select_aggregate_event","select_aggregate","select_command","select_ui","select_policy","select_feature","advanced_settings","button_label","schema_editor","invalid_json","copy_state_schema","copy_command_schema","query_schema_editor","ui_schema_editor","choose_icon","identifier_select","feature_status_select","step_header","step_state","new_data_entity","copy_command_ui_schema","step_any_vo","is_stored_in_db_label","is_entity_label","is_queryable_label","is_projection_label","step_aggregate_event","new_event","step_aggregate","new_aggregate","rules_label","manage_dependencies","dependencies_label","dependencies_placeholder","step_command","new_command","new_aggregate_select_label","new_aggregate_select_placeholder","delete_state_label","delete_history_label","delete_history_warning","copy_state_ui_schema","step_ui","new_ui","accessible_from_select_label","type_top_level","type_sub_level","view_models_label","select_view_models_placeholder","page_config_label","page_content_label","step_policy","new_policy","targets_placeholder","step_select_context","header_dddAction","meta_dddAction","desc_dddAction","header_policy","meta_policy","desc_policy","step_feature","new_feature","step_run_cody","action_connect","action_generate","action_healthcheck","message_install_cody_engine","message_restart_cody","message_perform_cody_restart","message_cody_still_failing","message_cody_failed_get_help","connections","help1","help2","help3","help4","help5","autocomplete","contextVariables","help1command","help1state","help1table","businessRules","resolver","projector","processor","collaboration_modal","header_team","header_history","import","import_existing_board","btn_replace_board","btn_import_as_new","edit_header","share","share_sub","delete_txt1","delete_link","delete_txt2","really_delete","tags_sub","cody_suggest_sub","event_modeling_sub","board_abbr","responsible_team","btn_add_save","btn_share","btn_send_invitation","btn_send","cody_suggest","event_modeling","invite_user","user_email","remove_user_confirm_title","remove_user_confirm_text","select_image","drag_and_drop_info","upload_failed_title","upload_failed_text","deletion_failed_title","deletion_failed_text","paste_failed","invalid_file_pasted","headline","select_board","select_event","tasklink","invitation_resend","invitation_revoke","sticky_templates","advanced_config","upload_info","uploaded_schema_invalid_title","uploaded_schema_invalid_text","moved_to_sidebar_header","moved_to_sidebar_details","moved_to_sidebar_wiki_text","delete_confirmation","add_layer","set_global_visibility","refresh_layers","folder_title","delete_layer","lock_layer","edit_name","insert_selection","move_to_organization_title","move_to_organization_sub_title","move_to_organization_desc","move_to_organization_select","move_to_organization_submit","modal_header","orgaMembers","anyone","organisation","switch_hint_header","switch_hint","switch_hint_ok","create_btn","not_explicit","no_member_quota","no_admin","remove_user_confirm_button","send_invitation","open_invitations","empty_invitations","promote_to_admin","demote_to_member","promote_to_member","overview_add","team_description","add_user","remove_board_confirm_title","remove_board_confirm_text","remove_board_confirm_button","add_to_board","grant_access","choose","choose_board","remove_from_board_confirm_title","remove_from_board_confirm_text","remove_team_confirm_title","remove_team_confirm_text","error_loading_invitations","no_teams","profile_headline","profile_subline","quota_reached","quota_reached_user","quota_reached_guest","team_quota_reached","labels","company","fields","avatar_upload","select_photo","change_password","passwords_not_matching_title","passwords_not_matching_text","delete_account","info_text","direct_msg","send","subscribe","betaModal","select_playshot","start_from_scratch","sync_playshot","sync_success","sync_error","empty","en","notConfigured","createClient","retrieveSecret","createConfirmTitle","createConfirmText","resetConfirmTitle","resetConfirmText","removeConfirmTitle","removeConfirmText","removeText"],"mappings":"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","file":"static/js/main.17d82279.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/cody.63c5836d.svg\";","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 1182;","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABBCAIAAAABlV4SAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABQElEQVRoge3ZMW7CMBTG8eeIQIYs7VZ3RCJzxTF6gKysrKh7VYZOSFwgB4DTMHOAMjK3qlSzdeiAnx23/hp9//mJvJ8SS1Ewzjn55xW5F0gQDRjRgBENGNGAEQ0YDcEw0gx9vR0/98/udPztbX5kbFO2L8V94xnTvLd+vD668ynRYmEZ20xWu+szqmcpF0BENDd/COeBBoxowIgGjGjAiAaMaMCIBoxowIgGjGjAiAaMhmBQfatMnrGzsl17P0Iqy3MfEgIklyEhQHI9S9+9Pz14Z6rN4foA+pkupnP/zB/sEV9Vl+3aOwVsqOrxsjO31juIaqjq8bJTHn1IQwhAEA2BAIEzhAMEyxAFECBDLECUBnNzF/HTAfUAiNJQLrbGzuIu4N9gOp+s9n3eoFT/sYMHcx56RANGNGBEA0Y0YHQBkZ0zQP+umloAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,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\"","import { default as jwt, JwtHeader, SigningKeyCallback, VerifyErrors } from 'jsonwebtoken';\nimport JwksClient, { CertSigningKey, RsaSigningKey, SigningKey } from 'jwks-rsa' ;\nimport { KeycloakTokenParsed } from 'keycloak-js';\n\nexport interface TokenParsed extends KeycloakTokenParsed {\n    iss: string;\n}\n\nlet jwksClient: JwksClient.JwksClient;\nlet getKey: any;\n\nexport const isRsaSigningKey = (s?: SigningKey): s is RsaSigningKey => {\n    if (s === undefined) {\n        return false;\n    }\n    return s.hasOwnProperty('rsaPublicKey');\n};\nexport const isCertSigningKey = (s?: SigningKey): s is CertSigningKey => {\n    if (s === undefined) {\n        return false;\n    }\n    return s.hasOwnProperty('publicKey');\n};\n\nexport const initJwtVerify = (token: string, unsecureToken: TokenParsed) => {\n    jwksClient = JwksClient({\n        cache: true,\n        strictSsl: process.env.REACT_APP_IG_KC_VERIFY_SSL_CERTIFICATE === 'true',\n        jwksUri: unsecureToken.iss + '/protocol/openid-connect/certs',\n        requestHeaders: {}, // Optional\n    });\n\n    getKey = (header: JwtHeader, callback: SigningKeyCallback) => {\n        // ensure integrity\n        if (header.alg !== 'RS256' || header.typ !== 'JWT') {\n            throw Error('Only RSA256 is supported for JWT');\n        }\n\n        jwksClient.getSigningKey(header.kid!, (err: Error | null, key: SigningKey) => {\n\n            if (isRsaSigningKey(key)) {\n                callback(err, key.rsaPublicKey);\n                return;\n            }\n            if (isCertSigningKey(key)) {\n                callback(err, key.publicKey);\n                return;\n            }\n\n            console.warn('Wrong signing key');\n            console.warn({err});\n            callback(err);\n        });\n    };\n\n};\n\nexport default (token: string) => {\n    return new Promise<object>(\n        (resolve, reject) => {\n            jwt.verify(\n                token,\n                getKey,\n                // {algorithms: ['RS256']},\n                (error: VerifyErrors, verifiedToken: object | string) => {\n                    if (error) {\n                        console.log({error});\n                        return reject(error);\n                    }\n\n                    return resolve({\n                        token,\n                        verifiedToken,\n                    });\n                },\n            );\n        },\n    );\n};\n","import axios from 'axios';\n\nexport const GRAPHQL_URL = '/graphql';\n\nconst configuredAxios = axios.create({\n  baseURL: '/board/api/v1/messagebox',\n});\n\nexport default configuredAxios;\n","import {io} from \"socket.io-client\";\nimport {isStandalone} from \"../standalone/util\";\n\nexport default io({\n    path: '/board/socket/',\n    autoConnect: false,\n    multiplex: true,\n    reconnection: true,\n    transportOptions: {\n        polling: {\n            extraHeaders: {}\n        }\n    }\n});\n\n\n","let token = '';\n\nexport const getToken = (): string => {\n    return token;\n}\n\nexport const setToken = (t: string) => {\n    token = t;\n}\n","import {AxiosError, AxiosPromise, AxiosResponse} from \"axios\";\nimport api from './ConfiguredAxios';\nimport configuredAxios from \"./ConfiguredAxios\";\nimport configuredSocket from \"./ConfiguredSocket\";\nimport {setToken} from \"../Auth/service/tokenCache\";\n\n\nexport interface ResponseType {\n    response?: AxiosResponse,\n    error?: AxiosResponse,\n}\n\nexport interface KeyCloakUserObject extends Object{\n    uid: string,\n    email: string,\n    display_name: string,\n    company_name: string,\n    job_title: string,\n    avatar_url: string,\n}\n\n/**\n * Provide axios and the socket connection with the new token and also update the token cookie\n *\n * @param token\n */\nexport const distributeNewToken = (token: string) => {\n    configuredAxios.defaults.headers.Authorization = 'Bearer ' + token;\n    // @ts-ignore\n    configuredSocket.io.opts.transportOptions!.polling.extraHeaders.Authorization = 'Bearer ' + token;\n    setToken(token);\n\n    const expiresDate = new Date();\n    expiresDate.setTime(expiresDate.getTime() + 10 * 60 * 1000);\n    document.cookie = 'token=' + token + ';path=/buckets/boards;expires=' + expiresDate.toUTCString();\n};\n\nexport const removeLoginToken = () => {\n    const loc = new URL(window.location.toString());\n    if(loc.searchParams.has('t')) {\n        loc.searchParams.delete('t');\n        window.history.replaceState('', '', loc.toString());\n    }\n}\n\nexport const retry = async (ctor: () => Promise<ResponseType>, maxRetries: number = 7, delay: number = 200) => {\n    let response: ResponseType;\n    let retries = 0;\n\n    do {\n        response = await ctor();\n\n        if (response.response) {\n            return response;\n        }\n        maxRetries--;\n\n        if (maxRetries === 0) {\n            return response;\n        }\n\n        retries++;\n        await new Promise(res => setTimeout(res, retries * delay));\n    } while (maxRetries > 0);\n\n    return response;\n}\n\nexport const axiosApiPromise = (messageName: string, payload: object): Promise<ResponseType> => {\n    switch (messageName) {\n        case 'InspectIO.BoardClient':\n            return api.post(messageName, payload)\n                .then((response: AxiosResponse) => ({response}))\n                .catch((error: AxiosError) => ({error: error.response}));\n        default:\n            return retry(\n                () => api.post(messageName, payload)\n                    .then((response: AxiosResponse) => ({response}))\n                    .catch((error: AxiosError) => ({error: error.response}))\n            );\n    }\n};\n\nexport const userManagementApiPromise = (messageName: string, payload: object): Promise<ResponseType> => {\n    return api.post(messageName, payload, { baseURL: '/board/api/v1/user-management' })\n        .then((response: AxiosResponse) => ({response}))\n        .catch((error: AxiosError) => ({error: error.response}));\n};\n\nexport const avatarUploadApiPromise = (messageName: string, payload: any): AxiosPromise<any> => {\n    return api.post(messageName, payload,{ baseURL: '/avatar/' });\n};\n\nexport const avatarDeletionApiPromise = (messageName: string): AxiosPromise<any> => {\n    return api.delete(messageName, { baseURL: '/avatar/' });\n};\n\nexport const boardImageUploadApiPromise = (boardId: string, payload: string|ArrayBuffer, mimeType: string): AxiosPromise<any> => {\n    return api.post(\n        boardId,\n        payload,\n        { baseURL: '/buckets/boards/', headers: { 'Content-Type': mimeType } }\n    );\n};\n\nexport const boardImageReplacementApiPromise = (boardId: string, imageId: string, payload: string|ArrayBuffer, mimeType: string): AxiosPromise<any> => {\n    return api.post(\n        `${boardId}/${imageId}`,\n        payload,\n        { baseURL: '/buckets/boards/',  headers: { 'Content-Type': mimeType } }\n    );\n};\n\nexport const boardImageDeletionApiPromise = (imageUrl: string): AxiosPromise<any> => {\n    return api.delete(imageUrl, { baseURL: `/` });\n};\n","import i18n from 'i18next';\nimport LngDetector from 'i18next-browser-languagedetector';\n\nconst resources = require('i18next-resource-store-loader!./i18n/index.js');\n\nconst detectionOptions = {\n    // order and from where user language should be detected\n    order: ['querystring', 'cookie', 'localStorage', 'navigator', 'htmlTag', 'path', 'subdomain'],\n\n    // cache user language on\n    caches: ['localStorage', 'cookie'],\n    excludeCacheFor: ['cimode'], // languages to not persist (cookie, localStorage)\n};\n\ni18n\n    // detect user language\n    // learn more: https://github.com/i18next/i18next-browser-languageDetector\n    .use(LngDetector)\n    // pass the i18n instance to the react-i18next components.\n    // Alternative use the I18nextProvider: https://react.i18next.com/components/i18nextprovider\n    // init i18next\n    // for all options read: https://www.i18next.com/overview/configuration-options\n    .init({\n        detection: detectionOptions,\n        fallbackLng: 'en',\n        debug: true,\n\n        resources,\n\n        // special options for react-i18next\n        // learn more: https://react.i18next.com/components/i18next-instance\n        react: {\n            wait: true,\n        },\n    });\n\nexport default i18n;","import React, { useEffect } from 'react';\n\nexport function useOnBodyClick(onClick: () => void): void {\n    useEffect(() => {\n        document.getElementsByTagName('body')[0].addEventListener('click', onClick);\n\n        return () => {\n            document.getElementsByTagName('body')[0].removeEventListener('click', onClick);\n        }\n    }, []);\n}","import { Record } from 'immutable';\nimport * as uuid from 'uuid';\n\nexport interface NotificationActionType {\n    label: string,\n    callback: () => void\n}\n\nexport interface MessageProps {\n    title?: string,\n    message: string,\n    tOpts?: object,\n    level?: 'success' | 'error' | 'warning' | 'info',\n    position?: 'tr' | 'tl' | 'tc' | 'br' | 'bl' | 'bc',\n    autoDismiss?: number,\n    dismissible?: boolean,\n    handled?: boolean,\n    uid?: string,\n    action?: NotificationActionType | null,\n    hideProgressBar?: boolean,\n}\n\nconst defaultMessageProps: MessageProps = {\n    title: '',\n    message: '',\n    level: 'info',\n    position: 'bl',\n    autoDismiss: 5,\n    dismissible: true,\n    handled: false,\n    uid: undefined,\n    action: null,\n    hideProgressBar: true,\n};\n\nexport class Message extends Record(defaultMessageProps) implements MessageProps {\n\n    public constructor(data: Partial<MessageProps>) {\n        if (data.uid === undefined) {\n            data.uid = uuid.v4();\n        }\n        super(data);\n    }\n\n    public markAsHandled(): Message {\n        return this.set('handled', true) as Message;\n    }\n\n    public hasAction(): boolean {\n        return null !== this.action;\n    }\n\n}\n","\nexport const NOTIFY = '@@NotificationSystem/Notify';\nexport const MESSAGE_HANDLED = '@@NotificationSystem/MessageHandled';","import { action } from 'typesafe-actions';\nimport {NotificationModel} from \"../model\";\nimport { NOTIFY } from \"./constants\";\n\nexport const notify = (message: NotificationModel.Message  ) => action(NOTIFY, message);\n\nexport const info =  (title: string, message: string, tOpts: object|undefined = undefined, autoDismiss = 5 ) => {\n    const msg = new NotificationModel.Message({\n            title,\n            message,\n            tOpts,\n            level: \"info\",\n            autoDismiss,\n        });\n\n    return action(NOTIFY, msg);\n};\n\nexport const error =  (title: string, message: string, tOpts: object|undefined = undefined ) => {\n    const msg = new NotificationModel.Message({\n            title,\n            message,\n            tOpts,\n            level: \"error\",\n            autoDismiss: 0,\n        });\n\n    return action(NOTIFY, msg);\n};\n","import { action } from 'typesafe-actions';\nimport {NotificationModel} from \"../model\";\nimport {MESSAGE_HANDLED} from \"./constants\";\n\nexport const publishMessageHandled = (message: NotificationModel.Message) => action(MESSAGE_HANDLED, message);","import { List } from 'immutable';\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from 'react-i18next';\nimport { toast, ToastContainer } from 'react-toastify';\nimport { Command, Event } from '../actions';\nimport { NotificationModel } from '../model';\n\nimport 'react-toastify/dist/ReactToastify.css';\n\n\n// Separate state props + dispatch props to their own interfaces.\ninterface PropsFromState {\n    messages: List<NotificationModel.Message>\n}\n\n// We can use `typeof` here to map our dispatch types to the props, like so.\ninterface PropsFromDispatch {\n    sendNotify: typeof Command.info,\n    onHandled: typeof Event.publishMessageHandled,\n}\n\ninterface OwnProps {\n    maxMessages?: number\n}\n\nexport interface NotificiationsProps extends PropsFromState, PropsFromDispatch, OwnProps, WithNamespaces {\n}\n\nconst options = {\n    // onOpen: (props:any) => console.log({props}),\n    // onClose: (props:any) => console.log({props}),\n    autoClose: 6000,\n    type: toast.TYPE.INFO,\n    hideProgressBar: true,\n    position: toast.POSITION.BOTTOM_LEFT,\n    pauseOnHover: true,\n    // progress: 0.2\n};\n\nexport const Notifications = (props: NotificiationsProps) =>\n    <ToastContainer position={toast.POSITION.BOTTOM_LEFT} />\n;\n","import {fromJS, List} from 'immutable';\nimport { createSelector } from 'reselect';\nimport { ApplicationState } from '../../reducer';\nimport { NotificationModel } from '../model';\n\nexport const notificationsSelector = (state: any, props: any) => state.getIn(['notificationSystem', 'messages'], fromJS([]));\n\nexport const makeGetNotifications = (): (state: ApplicationState, props: any) => List<NotificationModel.Message> => {\n    return createSelector(\n        [notificationsSelector] as any,\n        (messages: List<NotificationModel.Message>): List<NotificationModel.Message> => messages\n    )\n}\n\nexport const makeMapStateTopPropsNotifications = () => {\n    const getNotifications = makeGetNotifications();\n\n    return (state: ApplicationState, props: any) => {\n        const messages = getNotifications(state, props);\n\n        return {\n            messages,\n        }\n    }\n}\n","import {List} from \"immutable\";\nimport * as _ from 'lodash';\nimport React from \"react\";\nimport {withNamespaces} from \"react-i18next\";\nimport { connect } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport { compose, lifecycle } from 'recompose';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { Command, Event } from '../actions';\nimport { Notifications, NotificiationsProps } from '../components/Notifications';\nimport { NotificationModel } from '../model';\nimport { makeMapStateTopPropsNotifications } from \"../selectors/message\";\n\n// It's usually good practice to only include one context at a time in a connected component.\n// Although if necessary, you can always include multiple contexts. Just make sure to\n// separate them from each other to prevent prop conflicts.\nconst mapStateToProps = makeMapStateTopPropsNotifications();\n\n// mapDispatchToProps is especially useful for constraining our actions to the connected component.\n// You can access these via `this.props`.\nconst mapDispatchToProps = (dispatch: Dispatch) => bindActionCreators(\n    {\n        sendNotify: Command.info,\n        onHandled: Event.publishMessageHandled\n    },\n    dispatch,\n);\n\nlet currentlyVisible: string[] = [];\n\nconst showUnhandledMessages = (messages: List<NotificationModel.Message>, onHandled: (msg: NotificationModel.Message) => void, props: NotificiationsProps) => {\n    messages.filter((value?: NotificationModel.Message) => {\n        if (!value) {\n            return false;\n        }\n        return !value.handled;\n    })\n        .forEach((msg?: NotificationModel.Message) => {\n            if (!msg) {\n                return;\n            }\n\n            if(msg.uid && currentlyVisible.includes(msg.uid)) {\n                return;\n            }\n\n            let message: any = msg.message;\n\n            if(message instanceof Error) {\n                message = message.message;\n            }\n            if(msg.uid) {\n                currentlyVisible.push(msg.uid);\n            }\n\n            toast(\n                <div><p><strong>{ props.t(msg.title+'')}</strong></p>{props.t(message)}</div>,\n                {\n                    type: msg.level,\n                    autoClose: msg.level === 'error'? false : 2000,\n                    hideProgressBar: msg.hideProgressBar,\n                    onClose: () => {\n                        if(msg.uid) {\n                            currentlyVisible = currentlyVisible.filter(uid => uid !== msg.uid);\n                        }\n                        onHandled(msg.markAsHandled())\n                    }\n                });\n        });\n};\n\nexport default withNamespaces()(compose<NotificiationsProps, any>(\n    connect(mapStateToProps, mapDispatchToProps),\n    lifecycle({\n        componentDidMount() {\n            const { messages, onHandled } =\n                this.props as NotificiationsProps;\n\n            if (!messages) {\n                return;\n            }\n\n            showUnhandledMessages(messages, onHandled, this.props as NotificiationsProps);\n        },\n        componentDidUpdate() {\n            const { messages, onHandled } =\n                this.props as NotificiationsProps;\n\n            if (!messages) {\n                return;\n            }\n\n            showUnhandledMessages(messages, onHandled, this.props as NotificiationsProps);\n        }\n    }),\n)(Notifications));\n","export const root = '/';\nexport const overview = '/overview';\nexport const inspectio = '/inspectio';\nexport const userProfile = inspectio + '/user/profile';\nexport const inspectioBoardWorkspace = inspectio + '/board/:uid';\nexport const compileInspectioBoardWorkspace = (boardUid: string): string => inspectio + '/board/' + boardUid;\nexport const isInspectioBoardWorkspace = (pathname: string): boolean => pathname.search(inspectio + '/board/') === 0;\nexport const getBoardUidFromWorkspacePath = (pathname: string): string => pathname.replace(inspectio + '/board/', '');\nexport const getBoardUidFromWorkspaceUrl = (url: string): string => url.replace(getHostUrlPart() + inspectio + '/board/', '');\nexport const inspectioEditBoard = inspectio + '/boards/edit/:uid';\nexport const compileInspectioBoardEdit = (boardUid: string): string => inspectio + '/boards/edit/' + boardUid;\nexport const boardInvitation = inspectio + '/boards/invitation/:invitation';\nexport const boardImportLink = inspectio + '/boards/import/:link';\nexport const teamInvitation = inspectio + '/teams/invitation/:invitation';\nexport const organizationInvitation = inspectio + '/organizations/:organization/invitation/:invitation';\nexport const teamOverview = inspectio + '/teams';\nexport const organizationOverview = inspectio + '/organization';\nexport const Updates = inspectio + '/updates';\nexport const BoardRedirect = inspectio + '/boards/redirect';\nexport const PublicSounds = '/sound';\n\nexport type DeepLinkFactory = (cellId: string) => string;\n\nexport const makeWorkspaceDeeplinkFacory = (boardUid: string): DeepLinkFactory =>\n    (cellId) => getHostUrlPart() + compileInspectioBoardWorkspace(boardUid) + `?cells=${cellId}&clicks=1`;\n\nexport const compileWorkspacePlayshotDeeplink = (boardUid: string) =>\n  compileInspectioBoardWorkspace(boardUid) + `?playshots=1`;\n\nconst getHostUrlPart = (): string => {\n    return  window.location.protocol + '//' + window.location.host;\n}\n","export const SERVER_CONTEXT = 'InspectIO.';\n\nexport const SIGN_IN = '@@InspectioUsers/SignIn';\n\n// Queries\nexport const FETCH_USER = '@@InspectioBoards/User';\nexport const LOAD_IIO_USERS_INFO = '@@InspectioBoards/IioUsersInfo';\n\n// Events\nexport const IIO_USERS_INFO_LOADED = '@@InspectioBoards/IioUsersInfoLoaded';\nexport const USER_SETTINGS_LOADED = '@@InspectioBoard/UserSettingsLoaded';\nexport const USER_SETTING_UPSERTED = '@@InsecptioBoard/UserSettingUpserted';\n\n// User Update\nexport const UPDATE_PROFILE = '@@InspectioBoards/UserUpdate';\nexport const UPDATE_PASSWORD = '@@InspectioBoards/PasswordUpdate';\nexport const UPSERT_USER_SETTING = '@@InsecptioBoards/UpsertUserSetting';\n\n// Active Organization\nexport const SWITCH_ACTIVE_ORGANIZATION = '@@InspectioBoards/SwitchActiveOrganization';\nexport const ACTIVE_ORGANIZATION_SWITCHED = '@@InspectioBoards/ActiveOrganizationSwitched';\n","import { action } from 'typesafe-actions';\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {UserModel} from '../model';\nimport {UserSettingsValue} from \"../model/UserSettings\";\nimport {SIGN_IN, UPDATE_PASSWORD, UPDATE_PROFILE, UPSERT_USER_SETTING} from \"./constants\";\nimport {SWITCH_ACTIVE_ORGANIZATION} from \"./constants\";\n\nexport const signIn = (user: UserModel.UserInfo) => action(SIGN_IN, {user});\n\nexport const updateProfile = (user: UserModel.UserInfo, successCb: () => void) => action(UPDATE_PROFILE, {user, successCb});\n\nexport const updatePassword = (password: string) => action(UPDATE_PASSWORD, {password});\n\nexport const upsertUserSetting = (key: string, value: UserSettingsValue) => action(UPSERT_USER_SETTING, {key, value});\n\nexport const switchActiveOrganization = (organizationId: OrganizationId | null) => action(SWITCH_ACTIVE_ORGANIZATION, {organizationId});\n","import {AxiosPromise} from \"axios\";\nimport {\n    avatarDeletionApiPromise, avatarUploadApiPromise,\n    axiosApiPromise,\n    ResponseType,\n    userManagementApiPromise\n} from '../../api/util';\nimport { UserModel } from '../../User';\nimport {Email, UserId} from \"../model/UserInfo\";\nimport {UserSettingsValue} from \"../model/UserSettings\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {SERVER_CONTEXT} from \"./constants\";\n\nexport const getUser = (userId: string): Promise<ResponseType> => {\n    return axiosApiPromise('InspectIO.User', {userId});\n};\n\nexport const syncUsername = (\n    userId: string,\n    username: string,\n    email: string|null,\n    avatarUrl: string|null,\n    position: string|null\n): Promise<ResponseType> => {\n    email = email || null;\n    avatarUrl = avatarUrl || null;\n    position = position || null;\n\n    return  axiosApiPromise(\n        'InspectIO.SyncUserName',\n        {userId, name: username, email, avatarUrl, position}\n    );\n};\n\nexport const getInspectioUsersInfo = (userIds: UserId[]): Promise<ResponseType> => {\n    return axiosApiPromise('InspectIO.Users', {userIds});\n};\n\nexport const getInspectioUserInfoByEmail = (email: Email): Promise<ResponseType> => {\n    return axiosApiPromise('InspectIO.UserInfo', {email});\n};\n\nexport const getUserSettings = (): Promise<ResponseType> => {\n    return axiosApiPromise('InspectIO.UserSettings', {});\n};\n\nexport const upsertUserSetting = (key: string, value: UserSettingsValue): Promise<ResponseType> => {\n    return axiosApiPromise('InspectIO.UpsertUserSetting', {key, value: String(value)});\n};\n\nexport const updateProfile = (user: UserModel.UserInfo): Promise<ResponseType> => {\n    const data = {\n        userId: user.uid,\n        email: user.email,\n        username: user.name,\n        avatarUrl: user.avatarUrl,\n        displayName: user.displayName,\n        companyName: user.companyName,\n        jobTitle: user.jobTitle\n    };\n\n    return userManagementApiPromise('update-profile', data);\n};\n\nexport const updatePassword = (userId: string, password: string): Promise<ResponseType> => {\n    const data = {\n        userId,\n        temporary: false,\n        password\n    };\n\n    return userManagementApiPromise('reset-password', data);\n};\n\nexport const uploadAvatar = (userId: string, file: FormData): AxiosPromise<any> => {\n    return avatarUploadApiPromise(userId, file);\n};\n\nexport const deleteAvatar = (userId: string): AxiosPromise<any> => {\n    return avatarDeletionApiPromise(userId);\n};\n\nexport const switchActiveOrganization = (userId: UserId, organizationId: OrganizationId | null): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SwitchActiveOrganization', { userId, organizationId });\n}\n","import {List} from \"immutable\";\nimport {action} from \"typesafe-actions\";\nimport {IioUserInfo} from \"../model/IioUserInfo\";\nimport {\n    ACTIVE_ORGANIZATION_SWITCHED,\n    IIO_USERS_INFO_LOADED,\n    USER_SETTING_UPSERTED,\n    USER_SETTINGS_LOADED\n} from \"./constants\";\nimport {UserSettings, UserSettingsValue} from \"../model/UserSettings\";\nimport {UserInfo} from \"../model/UserInfo\";\n\nexport const iioUsersInfoLoaded = (usersInfo: List<IioUserInfo>) => action(IIO_USERS_INFO_LOADED, {usersInfo});\n\nexport const userSettingsLoaded = (userSettings: UserSettings) => action(USER_SETTINGS_LOADED, {userSettings});\n\nexport const userSettingUpserted = (key: string, value: UserSettingsValue) => action(USER_SETTING_UPSERTED, {key, value});\n\nexport const activeOrganizationSwitched = (user: UserInfo) => action(ACTIVE_ORGANIZATION_SWITCHED, user);\n","export const SEND_HTTP_REQUEST = '@@api/SEND_HTTP_REQUEST';\nexport const RESET_WEB_DATA = '@@api/RESET_WEB_DATA';\nexport const SEND_GRAPHQL_QUERY = '@@api/SEND_GRAPHQL_QUERY';\n\n","import { AxiosRequestConfig } from 'axios';\nimport { action } from 'typesafe-actions';\nimport {\n    RESET_WEB_DATA,\n    SEND_HTTP_REQUEST,\n} from './constants';\nimport {WebData} from \"./WebData\";\n\nexport const sendHttpRequest = <TMeta> (request: AxiosRequestConfig, responseActionType: string, metadata?: TMeta) => action(SEND_HTTP_REQUEST, {request, responseActionType, metadata});\n\nexport const responseAction = <D, TMeta> (responseActionType: string, webData: WebData<D>, metadata?: TMeta) => action(responseActionType, {webData, metadata});\n\nexport const resetWebData = (responseActionType: string) => action(RESET_WEB_DATA, {responseActionType});\n","\nexport const getMessageBoxRequestConfig = <P> (messageName: string, payload: P) => {\n    return {\n        url: messageName,\n        method: 'post',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        data: JSON.stringify(payload),\n        responseType: 'json'\n    }\n}\n","import {action} from \"typesafe-actions\";\nimport * as ApiAction from '../../api';\nimport {Email, UserId} from \"../model/UserInfo\";\nimport {FETCH_USER, LOAD_IIO_USERS_INFO, SERVER_CONTEXT} from './constants';\n\nexport const fetchUser = (userId: string) => {\n    return ApiAction.Action.sendHttpRequest<{}>(ApiAction.MessageBox.getMessageBoxRequestConfig(\n        SERVER_CONTEXT + 'User',\n        {userId},\n    ), FETCH_USER);\n};\n\nexport const loadUsersInfo = (userIds: UserId[]) => action(LOAD_IIO_USERS_INFO, {userIds});\n","import { Record } from 'immutable';\n\nexport const TYPE_FREE = 'free';\nexport const TYPE_BASIC = 'basic';\nexport const TYPE_PREMIUM = 'premium';\nexport const TYPE_CUSTOM = 'custom';\n\nexport type AccountType = 'free' | 'basic' | 'premium' | 'custom';\n\nexport interface AccountProps {\n    accountType: AccountType;\n}\n\nexport interface AccountMethods {\n    isEqualOrBetterThan(other: Account): boolean;\n    isFreeAccount(): boolean;\n    isBasicAccount(): boolean;\n    isPremiumAccount(): boolean;\n    isCustomAccount(): boolean;\n    equals(other: Account): boolean;\n}\n\nexport interface AccountRecord extends AccountProps, AccountMethods {\n}\n\nexport const defaultUserProps: AccountProps = {\n    accountType: TYPE_FREE,\n};\n\nexport const assertAccountType = (accountType: string): void => {\n    switch (accountType) {\n        case TYPE_FREE:\n        case TYPE_BASIC:\n        case TYPE_PREMIUM:\n        case TYPE_CUSTOM:\n            break;\n        default:\n            throw new Error('Invalid accountType type \"' + accountType + '\" provided');\n    }\n};\n\nexport const fromString = (accountType: AccountType) => new Account({accountType});\n\nexport const fromUserToken = (roles: string[]) => {\n    let accountType = freeAccount();\n    let otherAccount = freeAccount();\n\n    roles.forEach((value: string) => {\n        if (value.match(/-account/) !== null) {\n            otherAccount = new Account({accountType: value.replace(/-account/, '') as AccountType});\n\n            if (otherAccount.isEqualOrBetterThan(accountType)) {\n                accountType = otherAccount;\n            }\n        }\n    });\n    return accountType;\n};\n\nexport const freeAccount = (): Account => new Account({accountType: TYPE_FREE});\n\nexport class Account extends Record(defaultUserProps) implements AccountRecord {\n    public constructor(data: AccountProps) {\n        assertAccountType(data.accountType);\n        super(data);\n    }\n\n    public isFreeAccount(): boolean {\n        return this.accountType === TYPE_FREE;\n    }\n\n    public isBasicAccount(): boolean {\n        return this.accountType === TYPE_BASIC;\n    }\n\n    public isPremiumAccount(): boolean {\n        return this.accountType === TYPE_PREMIUM;\n    }\n\n    public isCustomAccount(): boolean {\n        return this.accountType === TYPE_CUSTOM;\n    }\n\n    public isEqualOrBetterThan(other: Account): boolean {\n        if (this.accountType === other.accountType) {\n            return true;\n        }\n\n        if (this.accountType === TYPE_FREE) {\n            return false;\n        }\n\n        if (other.accountType === TYPE_FREE) {\n            return true;\n        }\n\n        if (this.accountType === TYPE_CUSTOM) {\n            return true;\n        }\n\n        if (other.accountType === TYPE_CUSTOM) {\n            return false;\n        }\n\n        if (this.accountType === TYPE_PREMIUM) {\n            return true;\n        }\n\n        return false;\n    }\n\n    public equals(other: Account): boolean {\n        return this.accountType === other.accountType;\n    }\n}\n","/**\n * Code taken from: https://dev.to/polyov_dev/data-validation-in-typescript-using-the-either-pattern-4omk\n * But modified for better understanding (no need to know Haskell)\n */\n\nexport interface Failure<A> {\n    value: A;\n    tag: 'left'\n}\n\nexport interface Success<B> {\n    value: B;\n    tag: 'right'\n}\n\nexport type Either<A,B> = Failure<A> | Success<B>;\n\nexport function isFailure<A>(val: any): val is Failure<A> {\n    if ((val as Failure<A>).tag === 'left') {\n        return true;\n    }\n    return false;\n}\n\nexport function isSuccess<B>(val: any): val is Success<B> {\n    if ((val as Success<B>).tag === 'right') {\n        return true;\n    }\n\n    return false;\n}\n\nexport function Failure<A>(val: A) : Failure<A> {\n    return { value: val, tag: 'left' };\n}\n\nexport function Success<B>(val: B) : Success<B> {\n    return { value: val, tag: 'right' };\n}\n\nexport type Predicate<N> = (val: N) => boolean;\n\nexport type EitherFunction<A, B> = (val: B) => Either<A, B>;\n\nexport function predicateEither<A, B>(error: A, predicate: Predicate<B>) : (val: B) => Either<A, B> {\n    return (value: B) => {\n        if (!predicate(value)) {\n            return Failure(error);\n        }\n        return Success(value);\n    }\n}\n\n\nexport function validate<A, B>(val: B, ...predicates: Array<[Predicate<B>, A]>) : Either<A, B> {\n    for (const [p, error] of predicates) {\n        if (!p(val)) {\n            return Failure(error);\n        }\n    }\n    return Success(val);\n}\n\nexport function execValidate<A, B>(...predicates: Array<[Predicate<B>, A]>): (val: B) => Either<A, B> {\n    return (val: B) => {\n        return validate(val, ...predicates);\n    }\n}\n\nexport function validateEach<A, B>(list: B[], ...predicates: Array<[Predicate<B>, A]>) : Either<A, B[]> {\n    for(const item of list) {\n        const result = validate(item, ...predicates);\n\n        if(isFailure(result)) {\n            return result;\n        }\n    }\n\n    return Success(list);\n}\n\nexport function execValidateEach<A, B>(...predicates: Array<[Predicate<B>, A]>) : (list: B[]) => Either<A, B[]> {\n    return (list: B[]) => validateEach(list, ...predicates);\n}\n\nexport function exec<A, B>(func: EitherFunction<A, B>): (val: B) => Either<A, B> {\n    return (val: B) => func(val);\n}\n\nexport function execForEach<A, B, C>(func: EitherFunction<A, B>): (list: B[]) => Either<A, B[]> {\n    return (list: B[]) => {\n        const newList: B[] = [];\n\n        for(const item of list) {\n            const result = func(item);\n\n            if(isFailure(result)) {\n                return result;\n            }\n\n            newList.push(result.value);\n        }\n\n        return Success(newList);\n    }\n}\n\nexport function pipe<A, B>(val: B, ...funcs: Array<EitherFunction<A, B>>): Either<A, B> {\n    for (const eitherFunc of funcs) {\n        const result = eitherFunc(val);\n\n        if(isFailure(result)) {\n            return result;\n        }\n\n        val = result.value;\n    }\n\n    return Success(val);\n}\n\n","import * as _ from \"lodash\";\n\nexport const hasKey = <O>(key: string): (obj: O) => boolean => {\n    return (obj: O): boolean => {\n        if(!_.isObject(obj)) {\n            return false;\n        }\n\n        return _.has(obj, key);\n    }\n};\n\nexport const isArray = <O>(): (obj: O) => boolean => {\n    return (obj: O) => {\n        return _.isArray(obj);\n    }\n};\n\nexport const oneOf = <O>(key: string, choices: any[]): (obj: O) => boolean => {\n    return (obj: O) => {\n        const keyExists = (hasKey(key))(obj);\n\n        if(!keyExists) {\n            return false;\n        }\n\n        const val = _.get(obj, key);\n\n        return choices.includes(val);\n    }\n}\n\nexport const isJSON = <O>(key: string): (obj: O) => boolean => {\n    return (obj: O) => {\n        const keyExists = (hasKey(key))(obj);\n\n        if(!keyExists) {\n            return false;\n        }\n\n        const val = _.get(obj, key);\n\n        try {\n            JSON.parse(val);\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n}\n","import { Record } from 'immutable';\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {AvatarUrl, Email, JobTitle, UserId, Username} from \"./UserInfo\";\n\nexport const AGGREGATE_TYPE = 'IioUserInfo';\nexport type IioUserInfoError = string;\n\nexport interface IioUserInfoProps {\n    uid: UserId;\n    userId: UserId;\n    username: Username;\n    avatarUrl: AvatarUrl;\n    anonymous: boolean;\n    aggregateType: AggregateType;\n    position: JobTitle;\n    email: Email;\n}\n\nexport const defaultIioUserInfoProps: IioUserInfoProps = {\n    uid: '',\n    userId: '',\n    username: '',\n    avatarUrl: '',\n    anonymous: true,\n    aggregateType: AGGREGATE_TYPE,\n    position: '',\n    email: '',\n};\n\nexport function createIioUserInfoFromServerData(data: any): Either<IioUserInfoError, IioUserInfo> {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('userId'), \"userId missing\"],\n        [hasKey('username'), \"username missing in \"+data.userId],\n        [hasKey('avatarUrl'), \"avatarUrl missing in \"+data.userId],\n        [hasKey('position'), \"position missing in \"+data.userId],\n        [hasKey('email'), \"email missing in \"+data.userId],\n    );\n\n    if(isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new IioUserInfo({\n        ...defaultIioUserInfoProps,\n        ...data,\n        uid: data.userId,\n    }));\n}\n\nexport function createAnonymous(): IioUserInfo {\n    return new IioUserInfo(defaultIioUserInfoProps);\n}\n\nexport class IioUserInfo extends Record(defaultIioUserInfoProps) implements Aggregate, IioUserInfoProps {\n    public constructor(data: IioUserInfoProps) {\n        if(data.userId !== '') {\n            data.anonymous = false;\n        }\n\n        super(data);\n    }\n\n    public avatar(): AvatarUrl {\n        if(this.anonymous) {\n            return '';\n        }\n\n        if(this.avatarUrl === '') {\n            return this.generateDefaultAvatarUrl();\n        }\n\n        return this.avatarUrl;\n    }\n\n    private generateDefaultAvatarUrl(): AvatarUrl {\n        return `/avatar/${this.userId}?displayName=${this.username}`;\n    }\n}\n","import { Record } from 'immutable';\n\nexport const TYPE_ANONYMOUS = 'anonymous';\nexport const TYPE_USER = 'user';\nexport const TYPE_ADMIN = 'admin';\n\nexport type RoleType = 'anonymous' | 'user' | 'admin';\n\nexport interface RoleProps {\n    type: RoleType;\n}\n\nexport interface RoleMethods {\n    isAnonymous(): boolean;\n    isUser(): boolean;\n    isAdmin(): boolean;\n    equals(other: Role): boolean;\n}\n\nexport interface RoleRecord extends RoleProps, RoleMethods {}\n\nexport const defaultUserProps: RoleProps = {\n    type: TYPE_ANONYMOUS,\n};\n\nexport const fromtString = (role: RoleType): Role => new Role({type: role});\n\nexport const anonymousRole = (): Role => new Role({type: TYPE_ANONYMOUS});\n\nexport const assertRoleType = (type: string): void => {\n    switch (type) {\n        case TYPE_ANONYMOUS:\n        case TYPE_USER:\n        case TYPE_ADMIN:\n            break;\n        default:\n            throw new Error('Invalid role type \"' + type + '\" provided');\n    }\n};\n\nexport class Role extends Record(defaultUserProps) implements RoleRecord {\n    public constructor(data: RoleProps) {\n        assertRoleType(data.type);\n        super(data);\n    }\n\n    public isAnonymous(): boolean {\n        return this.type === TYPE_ANONYMOUS;\n    }\n\n    public isUser(): boolean {\n        return this.type === TYPE_USER;\n    }\n\n    public isAdmin(): boolean {\n        return this.type === TYPE_ADMIN;\n    }\n\n    public equals(other: Role): boolean {\n        return this.type === other.type;\n    }\n}\n","import { Map, Record } from 'immutable';\nimport { RoleModel } from './index';\n\nexport type RoleMapType = Map<RoleModel.RoleType, RoleModel.Role>;\n\nconst anonymous = () => Map<RoleModel.RoleType, RoleModel.Role>().set(RoleModel.TYPE_ANONYMOUS, RoleModel.anonymousRole());\n\nexport const withAnonymous = () => new RoleMap({roleMap: Map<RoleModel.RoleType, RoleModel.Role>().set(RoleModel.TYPE_ANONYMOUS, RoleModel.anonymousRole())});\n\nexport const fromToken = (roles: string[]): RoleMap => {\n    let map: RoleMapType = Map<RoleModel.RoleType, RoleModel.Role>();\n\n    roles.forEach((value: string) => {\n        if (null === value.match(/-account/)) {\n            const role = new RoleModel.Role({type: value as RoleModel.RoleType});\n            map = map.set(role.type, role);\n        }\n    });\n\n    return new RoleMap({roleMap: map});\n};\n\nexport interface RoleMapProps {\n    roleMap: RoleMapType;\n}\n\nexport interface RoleMapMethods {\n    isAnonymous(): boolean;\n    isUser(): boolean;\n    isAdmin(): boolean;\n    equals(other: RoleMap): boolean;\n}\n\nexport interface RoleMapRecord extends RoleMapProps, RoleMapMethods {}\n\nexport const defaultUserProps: RoleMapProps = {\n    roleMap: anonymous(),\n};\n\nexport class RoleMap extends Record(defaultUserProps) implements RoleMapRecord {\n    public constructor(data: RoleMapProps) {\n        if (data.roleMap.isEmpty()) {\n            data.roleMap = data.roleMap.set(RoleModel.TYPE_ANONYMOUS, RoleModel.anonymousRole());\n        }\n        super(data);\n    }\n\n    public isAnonymous(): boolean {\n        return this.roleMap.has(RoleModel.TYPE_ANONYMOUS);\n    }\n\n    public isUser(): boolean {\n        return this.roleMap.has(RoleModel.TYPE_USER);\n    }\n\n    public isAdmin(): boolean {\n        return this.roleMap.has(RoleModel.TYPE_ADMIN);\n    }\n\n    public equals(other: RoleMap): boolean {\n        return this.roleMap.equals(other);\n    }\n}\n","import {List, Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport { AccountModel, RoleMapModel } from './index';\nimport {OrganizationId} from \"../../Organization/model/Organization\";\n\nexport type UserId = string;\nexport type Username = string;\nexport type Email = string;\nexport type Account = AccountModel.AccountProps;\nexport type Roles = RoleMapModel.RoleMap;\nexport type GivenName = string;\nexport type FamilyName = string;\nexport type Quota = number;\nexport type TeamQuota = number;\nexport type DisplayName = string;\nexport type AvatarUrl = string;\nexport type CompanyName = string;\nexport type JobTitle = string;\n\nexport interface UserProps {\n    uid: UserId;\n    name: Username;\n    email: Email;\n    roles: Roles;\n    account: Account;\n    givenName: GivenName;\n    familyName: FamilyName;\n    quota: Quota;\n    teamQuota: TeamQuota,\n    displayName: DisplayName;\n    avatarUrl: AvatarUrl;\n    companyName: CompanyName;\n    jobTitle: JobTitle;\n    activeOrganization: OrganizationId | null;\n    signedIn?: boolean;\n}\n\nexport const defaultUserProps: UserProps = {\n    uid: '',\n    name: '',\n    email: '',\n    givenName: '',\n    familyName: '',\n    roles: RoleMapModel.withAnonymous(),\n    account: AccountModel.freeAccount(),\n    quota: 0,\n    teamQuota: 0,\n    displayName: '',\n    avatarUrl: '',\n    companyName: '',\n    jobTitle: '',\n    activeOrganization: null,\n    signedIn: false,\n};\n\nexport class UserInfo extends Record(defaultUserProps) implements UserProps {\n    public constructor(data: UserProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4();\n        }\n\n        super(data);\n    }\n\n    public generateDefaultAvatarUrl(): AvatarUrl {\n        return `/avatar/${this.uid}?displayName=${this.displayName}`;\n    }\n}\n\n\n","import {List} from \"immutable\";\nimport {call, fork, put, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {isFailure, isSuccess} from \"../../core/validation/either\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\nimport {LOAD_IIO_USERS_INFO} from \"../actions/constants\";\nimport {createIioUserInfoFromServerData, IioUserInfo} from \"../model/IioUserInfo\";\n\ntype LoadIioUsersInfo = ActionType<typeof Action.Query.loadUsersInfo>;\n\ntype FlowAction = LoadIioUsersInfo;\n\nfunction* onLoadUsersInfo(action: LoadIioUsersInfo) {\n    const response = yield call(Action.Api.getInspectioUsersInfo, action.payload.userIds);\n\n    yield call(onResponse, response);\n}\n\nfunction* onResponse({response, error}: ResponseType) {\n    if (error) {\n        // tslint:disable-next-line:no-console\n        console.error(\"Request Error\", \"Failed to laod user info\", error);\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load user info\"));\n    }\n\n    if (response) {\n        const rawUserInfoList: Array<{userId: string, username: string, avatarUrl: string}> = response.data;\n        let userInfoList = List<IioUserInfo>();\n\n        for (const rawInfo of rawUserInfoList) {\n            const result = createIioUserInfoFromServerData(rawInfo);\n\n            if(isFailure(result)) {\n                // tslint:disable-next-line:no-console\n                console.error(\"Failed to process IioUserInfo loaded from server\", result.value, rawInfo);\n                yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load user info\"));\n            }\n\n            if(isSuccess(result)) {\n                userInfoList = userInfoList.push(result.value);\n            }\n        }\n\n        yield put(Action.Event.iioUsersInfoLoaded(userInfoList));\n    }\n}\n\nexport function* lazyLoadInspectioUserInfo() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.LOAD_IIO_USERS_INFO,\n        ]);\n\n        switch (action.type) {\n            case LOAD_IIO_USERS_INFO:\n                yield fork(onLoadUsersInfo, action);\n                break;\n        }\n    }\n}","import {axiosApiPromise, ResponseType} from \"../../api/util\";\nimport {SERVER_CONTEXT} from \"../../User/actions/constants\";\nimport {Email, UserId} from \"../../User/model/UserInfo\";\nimport {OrganizationId, OrganizationName} from \"../model/Organization\";\nimport {OrganizationInvitationId} from \"../model/OrganizationInvitation\";\n\nexport const installUserOrganization = (organizationId: OrganizationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'InstallUserOrganization', { organizationId });\n};\n\nexport const setUpImplicitOrganization = (organizationId: OrganizationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SetUpImplicitOrganization', { organizationId });\n}\n\nexport const setUpExplicitOrganization = (organizationId: OrganizationId, name: OrganizationName): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SetUpExplicitOrganization', {organizationId, name});\n}\n\nexport const fetchOrganization = (organizationId: OrganizationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'Organization', { organizationId });\n}\n\nexport const fetchUserOrganizations = (): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'UserOrganizations', {});\n}\n\nexport const inviteUserToOrganization = (organizationId: OrganizationId, invitationId: OrganizationInvitationId, invitedUserEmail: Email): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'InviteUserToOrganization', {organizationId, invitationId, invitedUserEmail});\n}\n\nexport const revokeUserOrganizationInvitation = (organizationId: OrganizationId, invitedUserEmail: Email): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RevokeUserOrganizationInvitation', {organizationId, invitedUserEmail});\n}\n\nexport const resendUserOrganizationInvitation = (organizationId: OrganizationId, invitedUserEmail: Email): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ResendUserOrganizationInvitation', {organizationId, invitedUserEmail});\n}\n\nexport const acceptInvitationToOrganization = (organizationId: OrganizationId, invitationId: OrganizationInvitationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'AcceptInvitationToOrganization', {organizationId, invitationId});\n}\n\nexport const promoteUserToOrganizationAdmin = (organizationId: OrganizationId, userId: UserId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'PromoteUserToOrganizationAdmin', {organizationId, userId});\n}\n\nexport const demoteUserToOrganizationMember = (organizationId: OrganizationId, userId: UserId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'DemoteUserToOrganizationMember', {organizationId, userId});\n}\n\nexport const removeUserFromOrganization = (organizationId: OrganizationId, userId: UserId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RemoveUserFromOrganization', {organizationId, userId});\n}\n\nexport const renameOrganization = (organizationId: OrganizationId, newName: OrganizationName): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RenameOrganization', {organizationId, newName});\n}\n\nexport const removeGuestFromOrganization = (organizationId: OrganizationId, userId: UserId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RemoveGuestFromOrganization', {organizationId, userId});\n}\n\nexport const turnGuestIntoMember = (guestId: UserId, organizationId: OrganizationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'TurnGuestIntoMember', {guestId, organizationId});\n}\n","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {Email} from \"../../User/model/UserInfo\";\n\nexport const AGGREGATE_TYPE = 'OrganizationInvitation';\n\nexport type OrganizationInvitationId = string;\nexport type OrganizationInvitationError = string;\nexport enum Status {\n    open = 'open',\n    acknowledged = 'acknowledged',\n    revoked = 'revoked',\n}\n\nexport interface OrganizationInvitationProps {\n    uid: OrganizationInvitationId;\n    invitationId: OrganizationInvitationId;\n    invitedUserEmail: Email;\n    status: Status;\n    aggregateType: AggregateType;\n}\n\nexport const defaultOrganizationInvitationProps: OrganizationInvitationProps = {\n    uid: '',\n    invitationId: '',\n    invitedUserEmail: '',\n    status: Status.open,\n    aggregateType: AGGREGATE_TYPE,\n};\n\nexport const createOrganizationInvitation = (data: {invitationId: OrganizationInvitationId, invitedUserEmail: Email}) => {\n    return new OrganizationInvitation({\n        uid: data.invitationId,\n        invitationId: data.invitationId,\n        invitedUserEmail: data.invitedUserEmail,\n        status: Status.open,\n        aggregateType: AGGREGATE_TYPE\n    });\n}\n\nexport const createOrganizationInvitationFromServerData = (data: any): Either<OrganizationInvitationError, OrganizationInvitation> => {\n    const validatedData: Either<OrganizationInvitationError, any> = validate(data,\n        [hasKey('invitationId'), \"invitationId missing\"],\n        [hasKey('invitedUserEmail'), \"invitedUserEmail missing\"],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new OrganizationInvitation({\n        ...defaultOrganizationInvitationProps,\n        ...data,\n        uid: data.invitationId,\n    }));\n};\n\nexport class OrganizationInvitation extends Record(defaultOrganizationInvitationProps) implements OrganizationInvitationProps, Aggregate {\n    public constructor(data: OrganizationInvitationProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    // @TODO add use case methods to change state\n}\n","export const SET_UP_EXPLICIT_ORGANIZATION = '@@InspectioOrganizations/SetUpExplicitOrganization';\nexport const EXPLICIT_ORGANIZATION_SET_UP = '@@InspectioOrganizations/ExplicitOrganizationSetUp';\nexport const EXPLICIT_ORGANIZATION_SET_UP_FAILED = '@@InspectioOrganizations/ExplicitOrganizationSetUpFailed';\n\nexport const INVITE_USER_TO_ORGANIZATION = '@@InspectioOrganizations/InviteUserToOrganization';\nexport const USER_INVITED_TO_ORGANIZATION = '@@InspectioOrganizations/UserInvitedToOrganization';\nexport const REVOKE_USER_ORGANIZATION_INVITATION = '@@InspectioOrganizations/RevokeUserOrganizationInvitation';\nexport const RESEND_USER_ORGANIZATION_INVITATION = '@@InspectioOrganizations/ResendUserOrganizationInvitation';\nexport const USER_ORGANIZATION_INVITATION_REVOKED = '@@InspectioOrganizations/UserOrganizationInvitationRevoked';\nexport const USER_ORGANIZATION_INVITATION_RESENT = '@@InspectioOrganizations/UserOrganizationInvitationResent';\nexport const ACCEPT_INVITATION_TO_ORGANIZATION = '@@InspectioOrganizations/AcceptInvitationToOrganization';\nexport const INVITATION_TO_ORGANIZATION_ACCEPTED = '@@InspectioOrganizations/InvitationToOrganizationAccepted';\nexport const PROMOTE_USER_TO_ORGANIZATION_ADMIN = '@@InspectioOrganizations/PromoteUserToOrganizationAdmin';\nexport const USER_PROMOTED_TO_ORGANIZATION_ADMIN = '@@InspectioOrganizations/UserPromotedToOrganizationAdmin';\nexport const DEMOTE_USER_TO_ORGANIZATION_MEMBER = '@@InspectioOrganizations/DemoteUserToOrganizationMember';\nexport const USER_DEMOTED_TO_ORGANIZATION_MEMBER = '@@InspectioOrganizations/UserDemotedToOrganizationMember';\nexport const REMOVE_USER_FROM_ORGANIZATION = '@@InspectioOrganizations/RemoveUserFromOrganization';\nexport const USER_REMOVED_FROM_ORGANIZATION = '@@InspectioOrganizations/UserRemovedFromOrganization';\n\nexport const FETCH_ORGANIZATION = '@@InspectioOrganizations/FetchOrganization';\nexport const ORGANIZATION_FETCHED = '@@InspectioOrganizations/OrganizationFetched';\n\nexport const FETCH_USER_ORGANIZATIONS = '@@InspectioOrganizations/FetchUserOrganizations';\nexport const USER_ORGANIZATIONS_FETCHED = '@@InspectioOrganizations/UserOrganizationsFetched';\n\nexport const RENAME_ORGANIZATION = '@@InspectioOrganizations/RenameOrganization';\nexport const ORGANIZATION_RENAMED = '@@InspectioOrganizations/OrganizationRenamed';\n\nexport const REMOVE_GUEST_FROM_ORGANIZATION = '@@InspectioOrganizations/RemoveGuestFromOrganization';\nexport const GUEST_REMOVED_FROM_ORGANIZATION = '@@InspectioOrganizations/GuestRemovedFromOrganization';\n\nexport const TURN_GUEST_INTO_MEMBER = '@@InspectioOrganizations/TurnGuestIntoMember';\nexport const GUEST_TURNED_INTO_MEMBER = '@@InspectioOrganizations/GuestTurnedIntoMember';\n","import {action} from \"typesafe-actions\";\nimport {Email, UserId} from \"../../User/model/UserInfo\";\nimport {OrganizationId, OrganizationName} from \"../model/Organization\";\nimport {OrganizationInvitationId} from \"../model/OrganizationInvitation\";\nimport {\n    ACCEPT_INVITATION_TO_ORGANIZATION,\n    DEMOTE_USER_TO_ORGANIZATION_MEMBER,\n    INVITE_USER_TO_ORGANIZATION,\n    PROMOTE_USER_TO_ORGANIZATION_ADMIN, REMOVE_GUEST_FROM_ORGANIZATION,\n    REMOVE_USER_FROM_ORGANIZATION, RENAME_ORGANIZATION,\n    RESEND_USER_ORGANIZATION_INVITATION,\n    REVOKE_USER_ORGANIZATION_INVITATION,\n    SET_UP_EXPLICIT_ORGANIZATION, TURN_GUEST_INTO_MEMBER\n} from \"./constants\";\n\nexport const setUpExplicitOrganization = (organizationId: OrganizationId, name: OrganizationName) => action(SET_UP_EXPLICIT_ORGANIZATION, {organizationId, name});\n\nexport const inviteUserToOrganization = (organizationId: OrganizationId, invitedUserEmail: Email) => action(INVITE_USER_TO_ORGANIZATION, {organizationId, invitedUserEmail});\nexport const revokeUserOrganizationInvitation = (organizationId: OrganizationId, invitationId: OrganizationInvitationId, invitedUserEmail: Email) => action(REVOKE_USER_ORGANIZATION_INVITATION, {organizationId, invitationId, invitedUserEmail});\nexport const resendUserOrganizationInvitation = (organizationId: OrganizationId, invitationId: OrganizationInvitationId, invitedUserEmail: Email) => action(RESEND_USER_ORGANIZATION_INVITATION, {organizationId, invitationId, invitedUserEmail});\nexport const acceptInvitationToOrganization = (organizationId: OrganizationId, invitationId: OrganizationInvitationId) => action(ACCEPT_INVITATION_TO_ORGANIZATION, {organizationId, invitationId});\nexport const promoteUserToOrganizationAdmin = (organizationId: OrganizationId, userId: UserId) => action(PROMOTE_USER_TO_ORGANIZATION_ADMIN, {organizationId, userId});\nexport const demoteUserToOrganizationMember = (organizationId: OrganizationId, userId: UserId) => action(DEMOTE_USER_TO_ORGANIZATION_MEMBER, {organizationId, userId});\nexport const removeUserFromOrganization = (organizationId: OrganizationId, userId: UserId) => action(REMOVE_USER_FROM_ORGANIZATION, {organizationId, userId});\nexport const renameOrganization = (organizationId: OrganizationId, newName: OrganizationName) => action(RENAME_ORGANIZATION, {organizationId, newName});\nexport const removeGuestFromOrganization = (organizationId: OrganizationId, userId: UserId) => action(REMOVE_GUEST_FROM_ORGANIZATION, {organizationId, userId});\nexport const turnGuestIntoMember = (guestId: UserId, organizationId: OrganizationId) => action(TURN_GUEST_INTO_MEMBER, {guestId, organizationId});\n","import {List} from \"immutable\";\nimport {action} from \"typesafe-actions\";\nimport {Organization} from \"../model/Organization\";\nimport {OrganizationInvitation} from \"../model/OrganizationInvitation\";\nimport {UserOrganizationInfo} from \"../model/UserOrganizationInfo\";\nimport {\n    EXPLICIT_ORGANIZATION_SET_UP,\n    EXPLICIT_ORGANIZATION_SET_UP_FAILED,\n    GUEST_REMOVED_FROM_ORGANIZATION,\n    GUEST_TURNED_INTO_MEMBER,\n    INVITATION_TO_ORGANIZATION_ACCEPTED,\n    ORGANIZATION_FETCHED,\n    ORGANIZATION_RENAMED,\n    USER_DEMOTED_TO_ORGANIZATION_MEMBER,\n    USER_INVITED_TO_ORGANIZATION,\n    USER_ORGANIZATION_INVITATION_RESENT,\n    USER_ORGANIZATION_INVITATION_REVOKED,\n    USER_ORGANIZATIONS_FETCHED,\n    USER_PROMOTED_TO_ORGANIZATION_ADMIN,\n    USER_REMOVED_FROM_ORGANIZATION\n} from \"./constants\";\n\nexport const organizationFetched = (organization: Organization) => action(ORGANIZATION_FETCHED, organization);\nexport const explicitOrganizationSetUp = (organization: Organization) => action(EXPLICIT_ORGANIZATION_SET_UP, organization);\nexport const explicitOrganizationSetUpFailed = (organization: Organization) => action(EXPLICIT_ORGANIZATION_SET_UP_FAILED, organization);\nexport const userOrganizationsFetched = (userOrganizations: List<UserOrganizationInfo>) => action(USER_ORGANIZATIONS_FETCHED, userOrganizations);\nexport const userInvitedToOrganization = (organization: Organization) => action(USER_INVITED_TO_ORGANIZATION, organization);\nexport const userOrganizationInvitationRevoked = (invitation: OrganizationInvitation, organization: Organization) => action(USER_ORGANIZATION_INVITATION_REVOKED, {invitation, organization});\nexport const userOrganizationInvitationResent = (invitation: OrganizationInvitation, organization: Organization) => action(USER_ORGANIZATION_INVITATION_RESENT, {invitation, organization});\nexport const invitationToOrganizationAccepted = (organization: Organization) => action(INVITATION_TO_ORGANIZATION_ACCEPTED, organization);\nexport const userPromotedToOrganizationAdmin = (organization: Organization) => action(USER_PROMOTED_TO_ORGANIZATION_ADMIN, organization);\nexport const userDemotedToOrganizationMember = (organization: Organization) => action(USER_DEMOTED_TO_ORGANIZATION_MEMBER, organization);\nexport const userRemovedFromOrganization = (organization: Organization) => action(USER_REMOVED_FROM_ORGANIZATION, organization);\nexport const organizationRenamed = (organization: Organization) => action(ORGANIZATION_RENAMED, organization);\nexport const guestRemovedFromOrganization = (organization: Organization) => action(GUEST_REMOVED_FROM_ORGANIZATION, organization);\nexport const guestTurnedIntoMember = (organization: Organization) => action(GUEST_TURNED_INTO_MEMBER, organization);\n","import {action} from \"typesafe-actions\";\nimport {FETCH_ORGANIZATION, FETCH_USER_ORGANIZATIONS} from \"./constants\";\n\nexport const fetchOrganization = (organizationId: string) => action(FETCH_ORGANIZATION, { organizationId });\n\nexport const fetchUserOrganizations = () => action(FETCH_USER_ORGANIZATIONS, {});\n","import {List, Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, isSuccess, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {BoardId} from \"../../InspectioBoards/model/Board\";\nimport {Email, UserId} from \"../../User/model/UserInfo\";\nimport {\n    createOrganizationInvitation,\n    createOrganizationInvitationFromServerData,\n    OrganizationInvitation,\n    OrganizationInvitationId\n} from \"./OrganizationInvitation\";\n\nexport type OrganizationId = string;\nexport type OrganizationName = string;\nexport type OrganizationMemberQuota = number;\nexport type OrganizationBoardQuota = number;\nexport type OrganizationMembers = List<UserId>;\nexport type OrganizationAdmins = List<UserId>;\nexport type OrganizationGuests = List<UserId>;\nexport type OrganizationBoards = List<BoardId>;\nexport type OrganizationInvitations = List<OrganizationInvitation>;\n\nexport type OrganizationValidationError = string;\n\nexport const AGGREGATE_TYPE = 'Organization';\n\n\nexport interface OrganizationProps {\n    uid: OrganizationId;\n    ownerId: UserId;\n    name: OrganizationName;\n    explicit: boolean;\n    memberQuota: OrganizationMemberQuota;\n    boardQuota: OrganizationBoardQuota;\n    members: OrganizationMembers;\n    admins: OrganizationAdmins;\n    guests: OrganizationGuests;\n    boards: OrganizationBoards;\n    invitations: OrganizationInvitations;\n    aggregateType: AggregateType;\n}\n\nexport const defaultOrganizationProps: OrganizationProps = {\n    uid: '',\n    ownerId: '',\n    name: '',\n    explicit: false,\n    memberQuota: 0,\n    boardQuota: 0,\n    members: List(),\n    admins: List(),\n    boards: List(),\n    guests: List(),\n    invitations: List(),\n    aggregateType: AGGREGATE_TYPE,\n};\n\nexport const createOrganizationFromServerData = (data: any): Either<OrganizationValidationError, Organization> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('organizationId'), \"organizationId missing\"],\n        [hasKey('ownerId'), `ownerId missing in ${data.organizationId}`],\n        [hasKey('name'), `name missing in ${data.organizationId}`],\n        [hasKey('explicit'), `explicit missing in ${data.organizationId}`],\n        [hasKey('memberQuota'), `memberQuota missing in ${data.organizationId}`],\n        [hasKey('boardQuota'), `boardQuota missing in ${data.organizationId}`],\n        [hasKey('members'), `members missing in ${data.organizationId}`],\n        [hasKey('admins'), `admins missing in ${data.organizationId}`],\n        [hasKey('boards'), `boards missing in ${data.organizationId}`],\n        [hasKey('guests'), `guests missing in ${data.organizationId}`],\n        [hasKey('invitations'), `invitations missing in ${data.organizationId}`],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    const invitations = [];\n    let invitation: any;\n\n    for(invitation of data.invitations) {\n        const result = createOrganizationInvitationFromServerData(invitation);\n\n        if(isFailure(result)) {\n            return result;\n        }\n\n        if(isSuccess(result)) {\n            invitations.push(result.value)\n        }\n    }\n\n    return Success(new Organization({\n        uid: data.organizationId,\n        ownerId: data.ownerId,\n        name: data.name,\n        explicit: data.explicit,\n        memberQuota: data.memberQuota,\n        boardQuota: data.boardQuota,\n        members: List(data.members),\n        admins: List(data.admins),\n        guests: List(data.guests),\n        boards: List(data.boards),\n        invitations: List(invitations),\n        aggregateType: AGGREGATE_TYPE,\n    }));\n};\n\nexport class Organization extends Record(defaultOrganizationProps) implements OrganizationProps, Aggregate {\n    public constructor(data: OrganizationProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    public isAdmin(userId: UserId): boolean {\n        return this.ownerId === userId || this.admins.includes(userId);\n    }\n\n    public setUpAsExplicit(name: OrganizationName): Organization {\n        const orga = this.set('explicit', true);\n        return orga.set('name', name);\n    }\n\n    public inviteUser(invitationId: OrganizationInvitationId, email: Email): Organization {\n        return this.set('invitations', this.invitations.push(\n            createOrganizationInvitation({invitationId, invitedUserEmail: email})\n        ));\n    }\n\n    public promoteAdmin(userId: UserId): Organization {\n        return this.set('admins', this.admins.push(userId));\n    }\n\n    public demoteToMember(userId: UserId): Organization {\n        return this.set('admins', this.admins.filter(admin => admin !== userId));\n    }\n\n    public revokeInvitation(invitationId: OrganizationInvitationId): Organization {\n        return this.set('invitations', this.invitations.filter(invitation => invitation.invitationId !== invitationId));\n    }\n\n    public removeUser(userId: UserId): Organization {\n        let self = this;\n        self = self.set('admins', self.get('admins', List()).filter(adminId => adminId !== userId));\n        self = self.set('members', self.get('members', List()).filter(memberId => memberId !== userId));\n        self = self.set('memberQuota', self.get('memberQuota', 0) + 1);\n        return self;\n    }\n\n    public removeGuest(userId: UserId): Organization {\n        let self = this;\n        self = self.set('guests', self.get('guests', List()).filter(guestId => guestId !== userId));\n        self = self.set('memberQuota', self.get('memberQuota', 0) + 1);\n        return self;\n    }\n\n    public turnGuestIntoMember(guestId: UserId): Organization {\n        const newGuests = this.guests.filter(guest => guest !== guestId);\n        const newMembers = this.members.push(guestId);\n        return this.set('guests', newGuests).set('members', newMembers);\n    }\n\n    public withNewName(name: OrganizationName): Organization {\n        return this.set('name', name);\n    }\n}\n","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {OrganizationId} from \"./Organization\";\n\nexport const AGGREGATE_TYPE = 'UserOrganizationInfo';\n\nexport type UserOrganizationInfoError = string;\n\nexport interface UserOrganizationInfoProps {\n    uid: OrganizationId;\n    organizationId: OrganizationId;\n    userId: UserId;\n    organizationName: string;\n    ownOrganization: boolean;\n    explicitOrganization: boolean;\n    userIsAdmin: boolean;\n    userIsGuest: boolean;\n    aggregateType: AggregateType;\n}\n\nexport const defaultUserOrganizationInfoProps: UserOrganizationInfoProps = {\n    uid: '',\n    organizationId: '',\n    userId: '',\n    organizationName: '',\n    ownOrganization: false,\n    explicitOrganization: false,\n    userIsAdmin: false,\n    userIsGuest: true,\n    aggregateType: AGGREGATE_TYPE,\n};\n\nexport const createUserOrganizationInfoFromServerData = (data: any): Either<UserOrganizationInfoError, UserOrganizationInfo> => {\n    const validatedData: Either<UserOrganizationInfoError, any> = validate(data,\n        [hasKey('organizationId'), \"organizationId missing\"],\n        [hasKey('userId'), \"userId missing\"],\n        [hasKey('organizationName'), \"organizationName missing\"],\n        [hasKey('ownOrganization'), \"ownOrganization missing\"],\n        [hasKey('explicitOrganization'), \"explicitOrganization missing\"],\n        [hasKey('userIsAdmin'), \"userIsAdmin missing\"],\n        [hasKey('userIsGuest'), \"userIsGuest missing\"],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new UserOrganizationInfo({\n        ...defaultUserOrganizationInfoProps,\n        ...data,\n        uid: data.organizationId,\n    }));\n};\n\nexport class UserOrganizationInfo extends Record(defaultUserOrganizationInfoProps) implements UserOrganizationInfoProps, Aggregate {\n    public constructor(data: UserOrganizationInfoProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    // @TODO add use case methods to change state\n}\n","import {List, Map} from \"immutable\";\nimport {Aggregate, AggregateType} from \"../model/Aggregate\";\n\nexport interface AggregateMap<T> extends Map<string, Aggregate & T>{}\n\nexport function initialAggregateState<T>(): AggregateMap<T> {\n    return Map<string, Aggregate & T>();\n}\n\nexport function addAggregate<T>(state: AggregateMap<T>, ar: Aggregate & T): AggregateMap<T> {\n    return state.set(ar.uid, ar);\n}\n\nexport function updateAggregate<T>(state: AggregateMap<T>, ar: Aggregate & T): AggregateMap<T> {\n    return state.set(ar.uid, ar);\n}\n\nexport function removeAggregate<T>(state: AggregateMap<T>, ar: Aggregate & T): AggregateMap<T> {\n    return state.remove(ar.uid);\n}\n\nexport function upsertAggregates<T>(state: AggregateMap<T>, arList: List<Aggregate & T>): AggregateMap<T> {\n    for(const ar of arList.toArray()) {\n        state = updateAggregate(state, ar);\n    }\n    return state;\n}\n\nexport function removeAggregates<T>(state: AggregateMap<T>, arList: List<Aggregate & T>): AggregateMap<T> {\n    for(const ar of arList.toArray()) {\n        state = removeAggregate(state, ar);\n    }\n\n    return state;\n}\n\nexport function removeAllAggregates<T>(state: AggregateMap<T>): AggregateMap<T> {\n    return initialAggregateState();\n}\n\n\n\n\n\n\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {addAggregate, updateAggregate} from \"../../core/reducer/applyAggregateChanged\";\nimport {\n    EXPLICIT_ORGANIZATION_SET_UP,\n    EXPLICIT_ORGANIZATION_SET_UP_FAILED,\n    GUEST_REMOVED_FROM_ORGANIZATION,\n    GUEST_TURNED_INTO_MEMBER,\n    ORGANIZATION_FETCHED,\n    ORGANIZATION_RENAMED,\n    USER_DEMOTED_TO_ORGANIZATION_MEMBER,\n    USER_INVITED_TO_ORGANIZATION,\n    USER_ORGANIZATION_INVITATION_REVOKED,\n    USER_PROMOTED_TO_ORGANIZATION_ADMIN,\n    USER_REMOVED_FROM_ORGANIZATION\n} from \"../actions/constants\";\nimport {Organization} from '../model';\nimport {InspectioOrganizationEvent} from './index';\n\nexport interface OrganizationsState extends Map<string, Organization.Organization> {\n}\n\nexport const initialState: OrganizationsState = Map<string, Organization.Organization>();\n\nconst reducer: Reducer<OrganizationsState, InspectioOrganizationEvent> =\n    (state: OrganizationsState = initialState, event: InspectioOrganizationEvent): OrganizationsState => {\n    switch (event.type) {\n        case ORGANIZATION_FETCHED:\n            return addAggregate(state, event.payload);\n        case EXPLICIT_ORGANIZATION_SET_UP:\n        case EXPLICIT_ORGANIZATION_SET_UP_FAILED:\n        case USER_INVITED_TO_ORGANIZATION:\n        case USER_PROMOTED_TO_ORGANIZATION_ADMIN:\n        case USER_DEMOTED_TO_ORGANIZATION_MEMBER:\n        case USER_REMOVED_FROM_ORGANIZATION:\n        case GUEST_REMOVED_FROM_ORGANIZATION:\n        case ORGANIZATION_RENAMED:\n        case GUEST_TURNED_INTO_MEMBER:\n            return updateAggregate(state, event.payload);\n        case USER_ORGANIZATION_INVITATION_REVOKED:\n            return updateAggregate(state, event.payload.organization);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveOrganizationReducer };\n","import {List, Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport {upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {USER_ORGANIZATION_INVITATION_RESENT, USER_ORGANIZATION_INVITATION_REVOKED} from \"../actions/constants\";\nimport * as Events from \"../actions/events\";\nimport {OrganizationInvitation} from \"../model/OrganizationInvitation\";\n\ntype Event = ActionType<typeof Events>;\n\nexport interface OrganizationInvitationState extends Map<string, OrganizationInvitation> {\n}\n\nexport const initialState: OrganizationInvitationState = Map<string, OrganizationInvitation>();\n\nconst reducer: Reducer<OrganizationInvitationState, Event> = (state: OrganizationInvitationState = initialState, event: Event): OrganizationInvitationState => {\n    switch (event.type) {\n        case USER_ORGANIZATION_INVITATION_RESENT:\n        case USER_ORGANIZATION_INVITATION_REVOKED:\n            return upsertAggregates(state, List([event.payload.invitation]));\n        default:\n            return state;\n    }\n};\n\nexport {reducer as saveOrganizationInvitationReducer};\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport {updateAggregate, upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {\n    EXPLICIT_ORGANIZATION_SET_UP,\n    EXPLICIT_ORGANIZATION_SET_UP_FAILED,\n    ORGANIZATION_RENAMED,\n    USER_ORGANIZATIONS_FETCHED\n} from \"../actions/constants\";\nimport * as Events from \"../actions/events\";\nimport {UserOrganizationInfo} from \"../model/UserOrganizationInfo\";\n\ntype Event = ActionType<typeof Events>;\n\nexport interface UserOrganizationInfoState extends Map<string, UserOrganizationInfo> {\n}\n\nexport const initialState: UserOrganizationInfoState = Map<string, UserOrganizationInfo>();\n\nconst reducer: Reducer<UserOrganizationInfoState, Event> = (state: UserOrganizationInfoState = initialState, event: Event): UserOrganizationInfoState => {\n    switch (event.type) {\n        case USER_ORGANIZATIONS_FETCHED:\n            return upsertAggregates(state, event.payload);\n        case EXPLICIT_ORGANIZATION_SET_UP:\n            const implOrga = state.get(event.payload.uid);\n            if(implOrga) {\n                return updateAggregate(state, implOrga.set('organizationName', event.payload.name).set('explicitOrganization', true))\n            } else {\n                return state;\n            }\n        case EXPLICIT_ORGANIZATION_SET_UP_FAILED:\n            const resetOrga = state.get(event.payload.uid);\n            if(resetOrga) {\n                return updateAggregate(state, resetOrga.set('organizationName', event.payload.name).set('explicitOrganization', false))\n            } else {\n                return state;\n            }\n        case ORGANIZATION_RENAMED:\n            const renamedOrga = state.get(event.payload.uid);\n            if(renamedOrga) {\n                return updateAggregate(state, renamedOrga.set('organizationName', event.payload.name));\n            } else {\n                return state;\n            }\n        default:\n            return state;\n    }\n};\n\nexport {reducer as saveUserOrganizationInfoReducer};\n","import {fromJS} from \"immutable\";\nimport { combineReducers } from 'redux-immutable';\nimport {ActionType} from \"typesafe-actions\";\nimport * as Events from \"../actions/events\";\nimport {saveOrganizationReducer} from \"./applyOrganizationEvents\";\nimport {saveOrganizationInvitationReducer} from \"./applyOrganizationInvitationEvents\";\nimport {saveUserOrganizationInfoReducer} from \"./applyUserOrganizationInfoEvents\";\n\nexport type InspectioOrganizationEvent = ActionType<typeof Events>;\n\nexport interface InspectioOrganizationsState {\n}\n\nexport const inspectioOrganizationsReducer = combineReducers<InspectioOrganizationsState, InspectioOrganizationEvent>({\n    Organization: saveOrganizationReducer,\n    UserOrganizationInfo: saveUserOrganizationInfoReducer,\n    OrganizationInvitation: saveOrganizationInvitationReducer,\n}, () => fromJS({\n    Organization: undefined,\n    UserOrganizationInfo: undefined,\n    OrganizationInvitation: undefined,\n}));\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.demoteUserToOrganizationMember>\n\nfunction* handleDemoteUserToOrganizationMember(command: Command) {\n    const {response, error} = yield call(Action.Api.demoteUserToOrganizationMember, command.payload.organizationId, command.payload.userId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not demote user to organization member.'));\n    }\n\n    if(response) {\n        // @ts-ignore\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.userDemotedToOrganizationMember(organization.demoteToMember(command.payload.userId)));\n\n        yield put(NotifyAction.Command.info('User demoted', 'The user is no longer an admin of the organization.'));\n    }\n}\n\nexport function* demoteUserToOrganizationMember() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.DEMOTE_USER_TO_ORGANIZATION_MEMBER\n        ]);\n\n        yield fork(handleDemoteUserToOrganizationMember, command);\n    }\n}\n","import { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport {exec, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport { Action as UserAction } from '../../User';\nimport * as Action from '../actions';\nimport {createOrganizationFromServerData} from \"../model/Organization\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchOrganization>;\n\nconst onFetchOrganization = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchOrganization, action.payload.organizationId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not fetch organization'));\n    }\n\n    if (response) {\n        const result = pipe(\n            response.data,\n            exec((data: any) => createOrganizationFromServerData(data)),\n        );\n\n        if (isFailure(result)) {\n            console.error(\"Invalid organization response: \", result.value);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load organization'));\n        }\n\n        if (isSuccess(result)) {\n            yield put(Action.Event.organizationFetched(result.value));\n            yield put(UserAction.Query.loadUsersInfo([result.value.ownerId, ...result.value.members.toJS(), ...result.value.guests.toJS()]));\n        }\n    }\n};\n\nexport function* fetchOrganizationFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.FETCH_ORGANIZATION\n        ]);\n\n        yield fork(onFetchOrganization, action);\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport uuid from \"uuid\";\nimport {ResponseType} from \"../../api/util\";\nimport * as Auth from '../../Auth';\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as UserModule from \"../../User\";\nimport {Action} from \"../index\";\nimport {createUserOrganizationInfoFromServerData} from \"../model/UserOrganizationInfo\";\nimport v4 from \"uuid/v4\";\n\ntype Query = ActionType<typeof Action.Query.fetchUserOrganizations> | ActionType<typeof Auth.Action.Type.USER_AUTHENTICATED>;\n\nlet implicitOrgaSetup = false;\n\nfunction* handleFetchUserOrganizations(query: Query) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchUserOrganizations);\n\n    if (error) {\n        if(error.status === 404) {\n            const installResponse = yield call(Action.Api.setUpImplicitOrganization, v4());\n\n            if(installResponse.error) {\n                yield put(NotifyAction.Command.error('Request Error', 'Could not install user organization'));\n            }\n\n            if(installResponse.response) {\n                yield put(Action.Query.fetchUserOrganizations());\n            }\n        } else {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not fetch user organizations'));\n        }\n\n    }\n\n    if (response) {\n        const result = pipe(\n            response.data,\n            execValidate([isArray(), \"Response data is not of type Array\"]),\n            execForEach((data: any) => {\n                return createUserOrganizationInfoFromServerData(data);\n            }),\n        );\n\n        if (isFailure(result)) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load user organizations'));\n        }\n\n        if (isSuccess(result)) {\n            if(result.value.length) {\n                const organizations = List(result.value);\n\n                yield put(Action.Event.userOrganizationsFetched(organizations));\n\n                const currentUser = yield select(UserModule.UserSelector.makeGetCurrentUser());\n\n                // Automatically switch to personal workspace if only organization is own implicit one\n                // Can be the case: a) after migration; b) member removed from organization\n                if(currentUser.activeOrganization === null\n                    && organizations.count() === 1\n                    && !organizations.first({explicitOrganization: false}).explicitOrganization) {\n                    yield put(UserModule.Action.Command.switchActiveOrganization(organizations.first({organizationId: null}).organizationId));\n                }\n\n                const updatedCurrentUser = yield select(UserModule.UserSelector.makeGetCurrentUser());\n\n                if(updatedCurrentUser.activeOrganization) {\n                    yield put(Action.Query.fetchOrganization(updatedCurrentUser.activeOrganization));\n                }\n            } else if(!implicitOrgaSetup) {\n                implicitOrgaSetup = true;\n                const organizationId = uuid.v4();\n                const installUserOrganization: ResponseType = yield call(Action.Api.installUserOrganization, organizationId);\n\n                if (installUserOrganization.error) {\n                    yield put(NotifyAction.Command.error('Request Error', 'Could not initialize organization.'));\n                }\n\n                if (installUserOrganization.response) {\n                    yield put(Action.Query.fetchUserOrganizations());\n                }\n            }\n        }\n    }\n}\n\nexport function* fetchUserOrganizations() {\n    while (true) {\n        const query: Query = yield take([\n            Action.Type.FETCH_USER_ORGANIZATIONS\n        ]);\n\n        yield fork(handleFetchUserOrganizations, query);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport v4 from \"uuid/v4\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.inviteUserToOrganization>\n\nfunction* handleInviteUserToOrganization(command: Command) {\n    const invitationId = v4();\n    const {response, error} = yield call(Action.Api.inviteUserToOrganization, command.payload.organizationId, invitationId, command.payload.invitedUserEmail);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not invite user to organization.'));\n    }\n\n    if(response) {\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.userInvitedToOrganization(organization.inviteUser(invitationId, command.payload.invitedUserEmail)));\n\n        yield put(NotifyAction.Command.info('User invited', 'The user was invited to the organization.'));\n    }\n}\n\nexport function* inviteUserToOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.INVITE_USER_TO_ORGANIZATION\n        ]);\n\n        yield fork(handleInviteUserToOrganization, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.promoteUserToOrganizationAdmin>\n\nfunction* handlePromoteUserToOrganizationAdmin(command: Command) {\n    const {response, error} = yield call(Action.Api.promoteUserToOrganizationAdmin, command.payload.organizationId, command.payload.userId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not promote user to organization admin.'));\n    }\n\n    if(response) {\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.userPromotedToOrganizationAdmin(organization.promoteAdmin(command.payload.userId)));\n\n        yield put(NotifyAction.Command.info('User promoted', 'The user is now an admin of the organization.'));\n    }\n}\n\nexport function* promoteUserToOrganizationAdmin() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.PROMOTE_USER_TO_ORGANIZATION_ADMIN\n        ]);\n\n        yield fork(handlePromoteUserToOrganizationAdmin, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.removeGuestFromOrganization>\n\nfunction* handleRemoveGuestFromOrganization(command: Command) {\n    const {response, error} = yield call(Action.Api.removeGuestFromOrganization, command.payload.organizationId, command.payload.userId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not remove guest from organization.'));\n    }\n\n    if(response) {\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.guestRemovedFromOrganization(organization.removeGuest(command.payload.userId)));\n\n        yield put(NotifyAction.Command.info('Guest removed', 'The guest no longer has access to organization boards and teams.'));\n    }\n}\n\nexport function* removeGuestFromOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.REMOVE_GUEST_FROM_ORGANIZATION\n        ]);\n\n        yield fork(handleRemoveGuestFromOrganization, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.removeUserFromOrganization>\n\nfunction* handleRemoveUserFromOrganization(command: Command) {\n    const {response, error} = yield call(Action.Api.removeUserFromOrganization, command.payload.organizationId, command.payload.userId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not remove user from organization.'));\n    }\n\n    if(response) {\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.userRemovedFromOrganization(organization.removeUser(command.payload.userId)));\n\n        yield put(NotifyAction.Command.info('User removed', 'The user is no longer member of the organization.'));\n    }\n}\n\nexport function* removeUserFromOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.REMOVE_USER_FROM_ORGANIZATION\n        ]);\n\n        yield fork(handleRemoveUserFromOrganization, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.renameOrganization>\n\nfunction* handleRenameOrganization(command: Command) {\n    const {response, error} = yield call(Action.Api.renameOrganization, command.payload.organizationId, command.payload.newName);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not rename organization.'));\n    }\n\n    if(response) {\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.organizationRenamed(organization.withNewName(command.payload.newName)));\n\n        yield put(NotifyAction.Command.info('Organization renamed', 'Renaming organization was successful.'));\n    }\n}\n\nexport function* renameOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.RENAME_ORGANIZATION\n        ]);\n\n        yield fork(handleRenameOrganization, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {createOrganizationInvitation, Status} from \"../model/OrganizationInvitation\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.resendUserOrganizationInvitation>\n\nfunction* handleResendUserOrganizationInvitation(command: Command) {\n    const {response, error} = yield call(Action.Api.resendUserOrganizationInvitation, command.payload.organizationId, command.payload.invitedUserEmail);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not resend invitation.'));\n    }\n\n    if(response) {\n        const invitation = createOrganizationInvitation({\n            invitationId: command.payload.invitationId,\n            invitedUserEmail: command.payload.invitedUserEmail,\n        });\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.userOrganizationInvitationResent(\n            invitation,\n            organization\n        ));\n        yield put(NotifyAction.Command.info('User invited', 'Invitation was sent again.'));\n    }\n}\n\nexport function* resendUserOrganizationInvitation() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.RESEND_USER_ORGANIZATION_INVITATION\n        ]);\n\n        yield fork(handleResendUserOrganizationInvitation, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {createOrganizationInvitation, Status} from \"../model/OrganizationInvitation\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\n\ntype Command = ActionType<typeof Action.Command.revokeUserOrganizationInvitation>\n\nfunction* handleRevokeUserOrganizationInvitation(command: Command) {\n    const {response, error} = yield call(Action.Api.revokeUserOrganizationInvitation, command.payload.organizationId, command.payload.invitedUserEmail);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not revoke invitation.'));\n    }\n\n    if(response) {\n        const invitation = createOrganizationInvitation({\n            invitationId: command.payload.invitationId,\n            invitedUserEmail: command.payload.invitedUserEmail,\n        });\n        const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n        yield put(Action.Event.userOrganizationInvitationRevoked(\n            invitation.set('status', Status.revoked),\n            organization.revokeInvitation(invitation.invitationId)\n        ));\n    }\n}\n\nexport function* revokeUserOrganizationInvitation() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.REVOKE_USER_ORGANIZATION_INVITATION\n        ]);\n\n        yield fork(handleRevokeUserOrganizationInvitation, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype Command = ActionType<typeof Action.Command.setUpExplicitOrganization>\n\nfunction* handleSetUpExplicitOrganization(command: Command) {\n    const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n    if(organization) {\n        const explicitOrganization = organization.setUpAsExplicit(command.payload.name);\n\n        yield put(Action.Event.explicitOrganizationSetUp(explicitOrganization));\n\n        const {response, error}: ResponseType = yield call(Action.Api.setUpExplicitOrganization, command.payload.organizationId, command.payload.name);\n\n        if(error) {\n            yield put(Action.Event.explicitOrganizationSetUpFailed(organization));\n            yield put(NotifyAction.Command.error('Request Error', 'Could not create organization.'));\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info('Organization created', 'Organization created successfully'));\n        }\n    }\n}\n\nexport function* setUpExplicitOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.SET_UP_EXPLICIT_ORGANIZATION\n        ]);\n\n        yield fork(handleSetUpExplicitOrganization, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype Command = ActionType<typeof Action.Command.turnGuestIntoMember>\n\nfunction* handleTurnGuestIntoMember(command: Command) {\n    const organization = yield select(makeOrganizationSelector(command.payload.organizationId));\n\n    if(organization) {\n        const {response, error}: ResponseType = yield call(Action.Api.turnGuestIntoMember, command.payload.guestId, command.payload.organizationId);\n\n        if(error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not turn guest into member.'));\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info('Member added', 'Guest turned into member.'));\n            yield put(Action.Event.guestTurnedIntoMember(organization.turnGuestIntoMember(command.payload.guestId)));\n        }\n    }\n}\n\nexport function* turnGuestIntoMember() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.TURN_GUEST_INTO_MEMBER\n        ]);\n\n        yield fork(handleTurnGuestIntoMember, command);\n    }\n}\n","import * as Action from \"./actions\";\nimport * as Model from \"./model\";\nimport * as Reducer from \"./reducers\";\nimport * as Saga from \"./sagas\";\n\nconst MODULE = 'inspectioOrganizations';\n\nexport {\n    MODULE,\n    Action,\n    Model,\n    Reducer,\n    Saga,\n};\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as OrganizationModule from \"../../Organization\";\nimport * as Organization from \"../../Organization\";\nimport {Action} from \"../index\";\nimport {makeGetCurrentUser} from \"../selectors/currentUser\";\n\ntype Command = ActionType<typeof Action.Command.switchActiveOrganization>\n\nfunction* handleSwitchActiveOrganization(command: Command) {\n    let user = yield select(makeGetCurrentUser());\n    const {response, error}: ResponseType = yield call(Action.Api.switchActiveOrganization, user.uid, command.payload.organizationId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not switch active organization.'));\n    }\n    if (response) {\n        yield put(Organization.Action.Query.fetchUserOrganizations());\n\n        user = user.set('activeOrganization', command.payload.organizationId);\n        yield put(Action.Event.activeOrganizationSwitched(user));\n        if(command.payload.organizationId) {\n            yield put(OrganizationModule.Action.Query.fetchOrganization(command.payload.organizationId));\n        }\n    }\n}\n\nexport function* switchActiveOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.SWITCH_ACTIVE_ORGANIZATION\n        ]);\n\n        yield fork(handleSwitchActiveOrganization, command);\n    }\n}\n","import {List, Record} from 'immutable';\nimport { createSelector } from 'reselect';\nimport { ApplicationState } from '../../reducer';\nimport {IioUserInfo} from \"../model/IioUserInfo\";\nimport {UserId} from \"../model/UserInfo\";\n\nexport const getIioUserInfoById = (state: Record<ApplicationState>, userId: UserId): IioUserInfo|undefined => state.getIn(['inspectioUsers', 'iioUsersInfo', userId]);\n\nexport const makeGetIioUserInfoByIdSelector = (userId: UserId): (state: Record<ApplicationState>, props?: any) => IioUserInfo|undefined => (state: Record<ApplicationState>) => getIioUserInfoById(state, userId);\n\nexport const iioUserListSelector = (state: Record<ApplicationState>, props: any): List<IioUserInfo> =>\n    List(state.getIn(['inspectioUsers', 'iioUsersInfo']).toIndexedSeq().toArray()) || List();\n\nexport const makeIioUserListSelector = (): (state: Record<ApplicationState>, props?: any) => List<IioUserInfo> => {\n    return createSelector(\n        [iioUserListSelector],\n        (users): List<IioUserInfo> =>  {\n            return users;\n        }\n    )\n};\n\nexport const makeIioFilteredUserListSelector = (userIdList: List<UserId>): (state: Record<ApplicationState>, props?: any) => List<IioUserInfo> => {\n    return createSelector(\n        [iioUserListSelector],\n        (users): List<IioUserInfo> => {\n            return users.filter((info) => {\n                return userIdList.contains(info.userId);\n            })\n        }\n    )\n};\n","import { call, fork, select, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport * as Action from \"../actions\";\nimport {UserInfo} from \"../model/UserInfo\";\nimport {UserSelector} from \"../selectors\";\n\ntype FlowAction = ActionType<typeof Action.Command.signIn>;\n\nfunction* onUserAuthenticated(action: FlowAction) {\n    const user: UserInfo = yield select(UserSelector.currentUserSelector, undefined);\n\n    if(user.displayName) {\n         yield call(Action.Api.syncUsername, user.uid, user.displayName, user.email, user.avatarUrl, user.jobTitle);\n    }\n}\n\nexport function* syncUsername() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.SIGN_IN\n        ]);\n\n        yield fork(onUserAuthenticated, action)\n    }\n}","import { call, fork, put, select, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\nimport {UserInfo} from \"../model/UserInfo\";\nimport {UserSelector} from \"../selectors\";\n\ntype FlowAction = ActionType<typeof Action.Command.updateProfile>;\ntype UpdatePasswordFlowAction = ActionType<typeof Action.Command.updatePassword>;\n\nfunction* onUpdateProfile(action: FlowAction) {\n    const user: UserInfo = yield select(UserSelector.currentUserSelector, undefined);\n\n    if(user.name) {\n        const {response, error}: ResponseType = yield call(Action.Api.updateProfile, user);\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not update profile with new profile picture.'));\n        }\n\n        if(response) {\n            if(user.displayName) {\n                yield call(Action.Api.syncUsername, user.uid, user.displayName, user.email, user.avatarUrl, user.jobTitle);\n            }\n            yield put(NotifyAction.Command.info('Profile Saved', 'Your profile has been saved'));\n            action.payload.successCb();\n        }\n    }\n}\n\nexport function* updateProfile() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.UPDATE_PROFILE\n        ]);\n\n        yield fork(onUpdateProfile, action)\n    }\n}\n\nfunction* onUpdatePassword(action: UpdatePasswordFlowAction) {\n    const user: UserInfo = yield select(UserSelector.currentUserSelector, undefined);\n    const pass: string = action.payload.password;\n\n    if (user.uid) {\n        const {response, error}: ResponseType = yield call(Action.Api.updatePassword, user.uid, pass);\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not change password.'));\n        }\n        if (response) {\n            yield put(NotifyAction.Command.info('Password changed', 'Password was changed successfully.'));\n        }\n    }\n}\n\nexport function* updatePassword() {\n    while (true) {\n        const action: UpdatePasswordFlowAction = yield take([\n            Action.Type.UPDATE_PASSWORD\n        ]);\n\n        yield fork(onUpdatePassword, action)\n    }\n}","import { call, actionChannel, fork, put, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport * as Action from \"../actions\";\nimport {ResponseType} from \"../../api/util\";\n\ntype FlowAction = ActionType<typeof Action.Command.upsertUserSetting>;\n\nfunction* onUpsertUserSetting(action: FlowAction) {\n\n    // Trigger the event immediately since its not the end of the world if the request fails\n    yield put(Action.Event.userSettingUpserted(action.payload.key, action.payload.value));\n\n    const {response, error}: ResponseType = yield call(\n        Action.Api.upsertUserSetting,\n        action.payload.key,\n        action.payload.value\n    );\n\n    if (error) {\n        /* tslint:disable-next-line:no-console */\n        console.log(`Failed updating user setting for ${action.payload.key} and ${action.payload.value}`);\n    }\n}\n\nexport function* upsertUserSetting() {\n    // Execute user setting upserts one after another to prevent race conditions\n    const requestChan = yield actionChannel(Action.Type.UPSERT_USER_SETTING);\n\n    while (true) {\n        const action: FlowAction = yield take(requestChan);\n\n        yield call(onUpsertUserSetting, action)\n    }\n}\n","import {List, Map, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport * as User from \"../../User\";\nimport {MODULE} from \"../index\";\nimport {Organization, OrganizationId} from \"../model/Organization\";\n\nexport const getOrganizationById = (state: Record<ApplicationState>, uid: OrganizationId): Organization|undefined =>\n    state.getIn([MODULE, 'Organization', uid]);\n\nexport const makeOrganizationSelector = (organizationId: OrganizationId | null): (state: Record<ApplicationState>) => Organization|undefined =>\n    (state: Record<ApplicationState>) => organizationId ? getOrganizationById(state, organizationId) : undefined;\n\nexport const getOrganizationList = (state: Record<ApplicationState>): List<Organization> => state.getIn([MODULE, 'Organization']).toList();\n\nexport const makeOrganizationListSelector = (): (state: Record<ApplicationState>) => List<Organization> =>\n    (state: Record<ApplicationState>) => getOrganizationList(state);\n\nexport const makeActiveOrganizationSelector = (): (state: Record<ApplicationState>, props?: any) => Organization | undefined => {\n    return createSelector(\n        [getOrganizationList, User.UserSelector.currentUserSelector],\n        (organizations, currentUser): Organization | undefined => {\n            if(currentUser.activeOrganization === null) {\n                return;\n            }\n\n            return organizations.find(orga => orga.uid === currentUser.activeOrganization);\n        }\n    )\n}\n","/**\n * Specifies the current version of the insp_standalone IndexedDB. This should be incremented whenever the structure of\n * the DB has changed and a migration is required. Take a look at StandaloneIndexedDB::updateDatabaseToLatestVersion.\n * Note: This must be an integer!\n */\nconst DB_VERSION: number = 1\n\nexport const OBJECT_STORE_BOARDS = 'boards';\nexport const OBJECT_STORE_USER_SETTINGS = 'userSettings';\n\nclass StandaloneIndexedDB {\n    private initializationPromise: Promise<void>;\n    private db?: IDBDatabase;\n\n    constructor() {\n        this.initializationPromise = new Promise((resolve, reject) => {\n            const openRequest = indexedDB.open('insp_standalone', DB_VERSION);\n\n            openRequest.onupgradeneeded = (event: IDBVersionChangeEvent) => {\n                this.updateDatabaseToLatestVersion(openRequest.result, event.oldVersion);\n            }\n\n            openRequest.onerror = () => {\n                reject('IndexedDB could not be initialized');\n            }\n\n            openRequest.onsuccess = () => {\n                this.db = openRequest.result;\n                resolve();\n            };\n        });\n    }\n\n    public async get(objectStore: string, key: string): Promise<any> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readonly');\n            const request = await transaction.objectStore(objectStore).get(key);\n\n            request.onsuccess = () => resolve(request.result);\n            request.onerror = () => reject();\n        });\n    }\n\n    public async getAll(objectStore: string): Promise<any[]> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readonly');\n            const request = await transaction.objectStore(objectStore).getAll();\n\n            request.onsuccess = () => resolve(request.result);\n            request.onerror = () => reject();\n        });\n    }\n\n    public async add(objectStore: string, data: object): Promise<void> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readwrite');\n            const request = transaction.objectStore(objectStore).add(data);\n\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject();\n        });\n    }\n\n    public async put(objectStore: string, data: object): Promise<void> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readwrite');\n            const request = transaction.objectStore(objectStore).put(data);\n\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject();\n        });\n    }\n\n    public async delete(objectStore: string, key: string): Promise<void> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readwrite');\n            const request = transaction.objectStore(objectStore).delete(key);\n\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject();\n        });\n    }\n\n    public async assertDBInitialized(): Promise<void> {\n        await this.initializationPromise;\n\n        if (!this.db) {\n            throw new Error('IndexedDB is not initialized');\n        }\n    }\n\n    private updateDatabaseToLatestVersion(db: IDBDatabase, oldVersion: number): void {\n        // tslint:disable-next-line\n        console.log(`Starting upgrade for DB insp_standalone from version ${oldVersion} to ${DB_VERSION}`);\n\n        /**\n         * Specify what migrations need to be done for each version to the next one. Make sure to not use any \"break\"\n         * statements since fallthrough is actually what we want here in order to handle larger version jumps.\n         */\n        switch (oldVersion) {\n            case 0: // Initialization (migration from version 0 to 1)\n                db.createObjectStore(OBJECT_STORE_BOARDS, { keyPath: 'boardId' });\n                db.createObjectStore(OBJECT_STORE_USER_SETTINGS, { keyPath: 'key' });\n        }\n    }\n}\n\nexport default StandaloneIndexedDB;\n","import StandaloneStorageManager from \"./storage/StandaloneStorageManager\";\nimport StandaloneIndexedDB from \"./storage/StandaloneIndexedDB\";\n\nexport const isStandalone = () => process.env.REACT_APP_IS_STANDALONE === 'true';\n\nexport const standaloneStorageManager = new StandaloneStorageManager(new StandaloneIndexedDB());\n","import {StandaloneBoard, StandaloneUser, StandaloneUserSetting} from \"./types\";\nimport StandaloneIndexedDB, {OBJECT_STORE_BOARDS, OBJECT_STORE_USER_SETTINGS} from \"./StandaloneIndexedDB\";\n\nclass StandaloneStorageManager {\n    private db: StandaloneIndexedDB;\n\n    constructor(db: StandaloneIndexedDB) {\n        this.db = db;\n        this.getBoards = this.getBoards.bind(this);\n        this.getBoard = this.getBoard.bind(this);\n        this.updateBoard = this.updateBoard.bind(this);\n        this.addBoard = this.addBoard.bind(this);\n        this.deleteBoard = this.deleteBoard.bind(this);\n        this.getUserSettings = this.getUserSettings.bind(this);\n        this.setUserSetting = this.setUserSetting.bind(this);\n    }\n\n    public getUser(): StandaloneUser {\n        return {\n            userId: 'f1c1512d-e1b9-44c2-940c-3f7cade64a29',\n        }\n    }\n\n    public async getBoards(): Promise<StandaloneBoard[]> {\n        return await this.db.getAll(OBJECT_STORE_BOARDS);\n    }\n\n    public async getBoard(boardId: string): Promise<StandaloneBoard|null> {\n        return await this.db.get(OBJECT_STORE_BOARDS, boardId) || null;\n    }\n\n    public async updateBoard(board: StandaloneBoard): Promise<void> {\n        await this.db.put(OBJECT_STORE_BOARDS, board);\n    }\n\n    public async addBoard(board: StandaloneBoard): Promise<void> {\n        await this.db.add(OBJECT_STORE_BOARDS, board);\n    }\n\n    public async deleteBoard(boardId: string): Promise<void> {\n        await this.db.delete(OBJECT_STORE_BOARDS, boardId);\n    }\n\n    public async getUserSettings(): Promise<StandaloneUserSetting[]> {\n        return await this.db.getAll(OBJECT_STORE_USER_SETTINGS);\n    }\n\n    public async setUserSetting(setting: StandaloneUserSetting): Promise<void> {\n        if (await this.db.get(OBJECT_STORE_USER_SETTINGS, setting.key)) {\n            await this.db.put(OBJECT_STORE_USER_SETTINGS, setting);\n        } else {\n            await this.db.add(OBJECT_STORE_USER_SETTINGS, setting);\n        }\n    }\n}\n\nexport default StandaloneStorageManager;\n","import { Record } from 'immutable';\nimport { createSelector } from 'reselect';\nimport { ApplicationState } from '../../reducer';\nimport { UserModel } from '../model';\nimport {\n    makeActiveUserOrganizationInfoSelector,\n    userOrganizationInfoListSelector\n} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport {makeOrganizationListSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {Organization} from \"../../Organization/model/Organization\";\nimport {isStandalone} from \"../../standalone/util\";\n\nexport const currentUserSelector = (state: Record<ApplicationState>, props: any) => state.getIn(['inspectioUsers', 'users', 'currentUser']);\n\nexport const makeGetCurrentUser = (): (state: Record<ApplicationState>, props?: any) => UserModel.UserInfo => {\n    return createSelector(\n        [currentUserSelector],\n        (user: UserModel.UserInfo): UserModel.UserInfo => user,\n    );\n};\n\nexport const makeGetCurrentBoardQuota = (): (state: Record<ApplicationState>, props?: any) => number => {\n    const organizationListSelector = makeOrganizationListSelector();\n\n    return createSelector(\n        [currentUserSelector, organizationListSelector],\n        (user: UserModel.UserInfo, organizations): number => {\n            if(isStandalone()) {\n                return -1;\n            }\n\n            let activeOrganization: Organization | undefined;\n\n            organizations.forEach(organization => {\n                if(organization.uid === user.activeOrganization) {\n                    activeOrganization = organization;\n                }\n            });\n\n            if(!activeOrganization) {\n                return 0;\n            }\n\n            if(activeOrganization.guests.includes(user.uid)) {\n                return 0;\n            }\n\n            return activeOrganization.boardQuota;\n        },\n    );\n};\n\n","import * as React from \"react\";\nimport {useState} from \"react\";\nimport Dropzone from \"react-dropzone\";\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport {Button, Modal} from \"semantic-ui-react\";\n\nexport interface CropData {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n}\n\ninterface UserAvatarUploadModalProps {\n    t: any;\n    open: boolean;\n    onClose: () => void;\n    onUpload: (file: any, crop: CropData) => void;\n}\n\nconst INITIAL_CROP = { aspect: 1, unit: 'px' as 'px', x: 0, y: 0, width: 150, height: 150 };\n\nconst UserAvatarUploadModal = (props: UserAvatarUploadModalProps) => {\n    const [crop, setCrop] = useState(INITIAL_CROP);\n    const [imageScale, setImageScale] = useState<number>(1.0);\n    const [file, setFile] = useState<undefined|File>(undefined);\n    const [src, setSrc] = useState<undefined|string>(undefined);\n\n    const onFileSelected = (acceptedFiles: File[]) => {\n        setFile(acceptedFiles[0]);\n        setSrc(URL.createObjectURL(acceptedFiles[0]));\n    };\n\n    const closeModal = () => {\n        props.onClose();\n        resetModal();\n    };\n\n    const resetModal = () => {\n        setFile(undefined);\n        setSrc(undefined);\n        setCrop(INITIAL_CROP);\n    };\n\n    return (\n        <Modal open={props.open} onClose={closeModal} closeIcon={true}>\n            <Modal.Header>{props.t('insp.user.avatar_upload.select_photo')}</Modal.Header>\n            <Modal.Content image={true}>\n                <Dropzone onDrop={onFileSelected}>\n                    {({getRootProps, getInputProps}) => (\n                        <section style={{ height: '410px', width: '100%' }}>\n                            <div {...getRootProps()} style={{ width: '100%', height: '100%', padding: '1px' }}>\n                                {src ? (\n                                    <ReactCrop\n                                        style={{ maxWidth: \"100%\", maxHeight: \"400px\" }}\n                                        imageStyle={{ maxWidth: \"100%\", maxHeight: \"400px\" }}\n                                        src={src as any}\n                                        crop={crop}\n                                        onChange={(newCrop: any) => setCrop(newCrop)}\n                                        onImageLoaded={image => setImageScale(image.width / image.naturalWidth)}\n                                    />\n                                ) : (\n                                    <div>\n                                        <input {...getInputProps()} />\n                                        <p>{props.t('insp.user.avatar_upload.drag_and_drop_info')}</p>\n                                    </div>\n                                )}\n                            </div>\n                        </section>\n                    )}\n                </Dropzone>\n            </Modal.Content>\n            <Modal.Actions>\n                <Button\n                    children={props.t('app.form.cancel')}\n                    onClick={closeModal}\n                />\n                <Button\n                    primary={true}\n                    children={props.t('app.form.save')}\n                    onClick={() => {\n                        props.onUpload(file, {\n                            x: crop.x / imageScale,\n                            y: crop.y / imageScale,\n                            width: crop.width / imageScale,\n                            height: crop.height / imageScale\n                        });\n                        resetModal();\n                    }}\n                />\n            </Modal.Actions>\n        </Modal>\n    );\n};\n\nexport default UserAvatarUploadModal;\n","import {Map} from \"immutable\";\nimport React from 'react'\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Link} from \"react-router-dom\";\nimport {InjectedFormProps} from \"redux-form\";\nimport { Field, reduxForm } from 'redux-form/immutable';\nimport {Button} from \"semantic-ui-react\";\nimport {inspectio} from \"../../routes\";\n\ninterface FormData  {\n    uid: string;\n    displayName: string;\n    companyName: string;\n    email: string;\n    jobTitle: string;\n}\n\n// tslint:disable-next-line:interface-name\nexport interface IFormData extends Map<string, string> {\n    toJS(): FormData\n}\n\nexport interface OwnProps {\n}\n\nexport interface PropsFromDispatch { }\n\nexport type UserProfileEditFormProps = OwnProps & PropsFromDispatch & WithNamespaces & InjectedFormProps<IFormData, OwnProps & WithNamespaces>;\n\nconst UserProfileEditForm = (props: UserProfileEditFormProps) => (\n    <form className=\"ui form\" onSubmit={props.handleSubmit}>\n        <div className=\"field\">\n            <label>{props.t('insp.user.form.labels.email')}</label>\n            <Field name=\"email\" component=\"input\" type=\"text\" placeholder={props.t('insp.user.form.fields.email')} />\n        </div>\n\n        <div className=\"field\">\n            <label>{props.t('insp.user.form.labels.display_name')}</label>\n            <Field name=\"displayName\" component=\"input\" type=\"text\" placeholder={props.t('insp.user.form.fields.display_name')} />\n        </div>\n\n        <div className=\"field\">\n            <label>{props.t('insp.user.form.labels.company')}</label>\n            <Field name=\"companyName\" component=\"input\" type=\"text\" placeholder={props.t('insp.user.form.fields.company')} />\n        </div>\n\n        <div className=\"field\">\n            <label>{props.t('insp.user.form.labels.position')}</label>\n            <Field name=\"jobTitle\" component=\"input\" type=\"text\" placeholder={props.t('insp.user.form.fields.position')} />\n        </div>\n\n        <div className=\"field\">\n            <Button primary={true} type=\"submit\" className=\"bottom aligned\">{props.t('app.form.save')}</Button>\n            <Link to={inspectio} className=\"ui basic button noborder\">{props.t('app.form.cancel')}</Link>\n        </div>\n    </form>\n);\n\nexport default withNamespaces()(reduxForm<IFormData, OwnProps & WithNamespaces>({form: 'UserProfileEditForm', enableReinitialize: true})(UserProfileEditForm));\n\n","import {Map} from \"immutable\";\nimport React from 'react'\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {InjectedFormProps} from \"redux-form\";\nimport { Field, reduxForm } from 'redux-form/immutable';\nimport {Button, Message} from \"semantic-ui-react\";\n\ninterface FormData  {\n    uid: string;\n    passwordSet: {\n        password1: string,\n        password2: string,\n    }\n}\n\nexport interface ImFormData extends Map<string, string> {\n    toJS(): FormData\n}\n\nexport interface OwnProps {\n    showErrorMessage: boolean;\n}\n\nexport interface PropsFromDispatch { }\n\nexport type UserProfilePasswordFormProps = OwnProps & PropsFromDispatch & WithNamespaces & InjectedFormProps<ImFormData, OwnProps & WithNamespaces>;\n\nconst UserProfilePasswordForm = (props: UserProfilePasswordFormProps) => {\n\n    return (\n        <form className={'ui form' + (props.showErrorMessage ? ' error' : '')} onSubmit={props.handleSubmit}>\n            <div className={'field'}>\n                <label>{props.t('insp.user.form.labels.password1')}</label>\n                <Field name={'password1'} component={'input'} type={'password'}/>\n            </div>\n\n            <div className={'field'}>\n                <label>{props.t('insp.user.form.labels.password2')}</label>\n                <Field name={'password2'} component={'input'} type={'password'}/>\n            </div>\n\n            <Message\n                error={true}\n                header={props.t('insp.user.change_password.passwords_not_matching_title')}\n                content={props.t('insp.user.change_password.passwords_not_matching_text')}\n            />\n\n            <div className={'field'}>\n                <Button primary={true} type={'submit'} className={'bottom aligned'}>{props.t('app.form.change')}</Button>\n            </div>\n        </form>\n    );\n};\n\nexport default withNamespaces()(reduxForm<ImFormData, OwnProps & WithNamespaces>({form: 'UserProfilePasswordForm', enableReinitialize: false})(UserProfilePasswordForm));\n\n","import {fromJS} from \"immutable\";\nimport {SyntheticEvent, useState} from \"react\";\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {reset} from \"redux-form\";\nimport {Container, Dropdown, Grid, Header, Message} from 'semantic-ui-react';\nimport {useOnBodyClick} from \"../../core/hooks/useOnBodyClick\";\nimport {UserProfileMatchParams} from \"../../InspectioBoards/components/types\";\nimport { Action as NotifyAction } from '../../NotificationSystem/index';\nimport * as Routes from '../../routes';\nimport {updatePassword, updateProfile} from \"../actions/commands\";\nimport {Api} from \"../actions/index\";\nimport {makeGetCurrentUser} from \"../selectors/currentUser\";\nimport UserAvatarUploadModal, {CropData} from \"./UserAvatarUploadModal\";\nimport {default as UserProfileEditForm, IFormData} from './UserProfileEditForm';\nimport {default as UserProfilePasswordForm, ImFormData} from './UserProfilePaswordForm';\n\ninterface PasswordObject{\n    password1: string,\n    password2: string,\n}\n\ninterface OwnProps {\n}\n\n\nexport type UserProfileProps = OwnProps & WithNamespaces & RouteComponentProps<UserProfileMatchParams>;\n\n\nconst UserProfile = (props: UserProfileProps) => {\n\n    const dispatch = useDispatch();\n    const [showAvatarActions, setShowAvatarActions] = useState<boolean>(false);\n    const [showAvatarUploadModal, setShowAvatarUploadModal] = useState<boolean>(false);\n    const [showPasswordErrorMessage, setShowPasswordErrorMessage] = useState<boolean>(false);\n    const currentUser = useSelector(makeGetCurrentUser());\n\n    useOnBodyClick(() => {\n        setShowAvatarActions(false);\n    });\n\n    const submitForm = (data: IFormData, cProps: UserProfileProps): void => {\n        const user = currentUser!.merge(data.toJS());\n        dispatch(updateProfile(user, () => cProps.history.push(Routes.inspectio)));\n    };\n\n    const uploadAvatar = (file: any, crop: CropData) => {\n        const data = new FormData();\n        data.append('avatar_file', file);\n        data.append('crop', JSON.stringify(crop));\n\n        Api.uploadAvatar(currentUser.uid,data)\n            .then(() => {\n                updateProfileWithNewAvatarUrl();\n            })\n            .catch(() => {\n                dispatch(NotifyAction.Command.error(\n                    props.t('insp.user.avatar_upload.upload_failed_title'),\n                    props.t('insp.user.avatar_upload.upload_failed_text')\n                ));\n            })\n            .finally(() => {\n                setShowAvatarUploadModal(false);\n                setShowAvatarActions(false);\n            });\n    };\n\n    const deleteAvatar = () => {\n        Api.deleteAvatar(currentUser.uid)\n            .then(() => {\n                updateProfileWithNewAvatarUrl();\n            })\n            .catch(() => {\n                dispatch(NotifyAction.Command.error(\n                    props.t('insp.user.avatar_upload.deletion_failed_title'),\n                    props.t('insp.user.avatar_upload.deletion_failed_text')\n                ));\n            })\n            .finally(() => {\n                setShowAvatarActions(false);\n            })\n    };\n\n    /**\n     * Updates the profile avatar url by changing the timestamp to prevent caching issues\n     */\n    const updateProfileWithNewAvatarUrl = () => {\n        dispatch(updateProfile(\n            currentUser!.merge({\n                avatarUrl: '/avatar/' + currentUser.uid +\n                    '?displayName=' + encodeURI(currentUser.displayName) + '&timestamp=' + Date.now(),\n            }),\n            () => { return; }\n        ));\n    };\n\n    const submitFormPassword = (data: ImFormData): void => {\n        const defaultPwdSet = {\n            password1: \"\",\n            password2: \"\",\n        };\n\n        const pws = {...defaultPwdSet, ...data.toJS()};\n\n        if (pws.password1 === pws.password2) {\n            setShowPasswordErrorMessage(false);\n            dispatch(updatePassword(pws.password1));\n            dispatch(reset('UserProfilePasswordForm'));\n        } else {\n            setShowPasswordErrorMessage(true);\n        }\n    };\n\n    return <Container>\n        <Grid stackable={true}>\n            <Grid.Row>\n                <Grid.Column width=\"2\" className=\"tabletHidden\" />\n                <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"12\">\n                    <Header as=\"h1\" icon={true} textAlign='center'>\n                        <Dropdown open={showAvatarActions} icon={false}>\n                            <Dropdown.Menu>\n                                <Dropdown.Item\n                                    text={props.t('app.form.upload')}\n                                    onClick={() => setShowAvatarUploadModal(true)}\n                                />\n                                <Dropdown.Item\n                                    text={props.t('app.form.delete')}\n                                    onClick={deleteAvatar}\n                                />\n                            </Dropdown.Menu>\n                        </Dropdown>\n                        <img\n                            style={{ cursor: 'pointer' }}\n                            onClick={(e: SyntheticEvent) => {e.stopPropagation(); setShowAvatarActions(!showAvatarActions);}}\n                            className={\"ui circular image\"}\n                            src={currentUser.avatarUrl}\n                        />\n                        <Header.Content>\n                            {props.t('insp.user.profile_headline', {user_name: currentUser.displayName})}\n                            <Header.Subheader>{ props.t(\"insp.user.profile_subline\")}</Header.Subheader>\n                        </Header.Content>\n                    </Header>\n                </Grid.Column>\n            </Grid.Row>\n            <Grid.Row>\n                <Grid.Column width=\"2\" className=\"tabletHidden\" />\n                <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"12\">\n                    <div className=\"ui segments\">\n                        <div className=\"ui segment\">\n                            <UserProfileEditForm\n                                initialValues={fromJS(currentUser.toJS())}\n                                onSubmit={(data) => {submitForm(data, props)}}\n                            />\n                        </div>\n                    </div>\n                </Grid.Column>\n            </Grid.Row>\n        </Grid>\n\n        <Grid stackable={true}>\n            <Grid.Row>\n                <Grid.Column width=\"2\" className=\"tabletHidden\" />\n                <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"12\">\n                    <div className=\"ui segments\">\n                        <div className=\"ui segment\">\n                            <UserProfilePasswordForm\n                                initialValues={fromJS({password1: \"\",password2: \"\"})}\n                                onSubmit={(data) => {submitFormPassword(data)}}\n                                showErrorMessage={showPasswordErrorMessage}\n                            />\n                        </div>\n                    </div>\n                </Grid.Column>\n            </Grid.Row>\n        </Grid>\n\n        <Grid stackable={true}>\n            <Grid.Row>\n                <Grid.Column width=\"2\" className=\"tabletHidden\" />\n                <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"12\">\n                    <div className=\"ui segments\">\n                        <div className=\"ui segment\">\n                            <Message>\n                                <Message.Header>{props.t('insp.user.delete_account.headline')}</Message.Header>\n                                <Message.Content>\n                                    {props.t('insp.user.delete_account.message')}&nbsp;<a\n                                  href={\"mailto:support@prooph-board.com?subject=Please delete my account&body=Hi, can you please delete my account: \" + currentUser.uid + \". Thank you, \" + currentUser.displayName}>support@prooph-board.com</a>\n                                </Message.Content>\n                            </Message>\n                        </div>\n                    </div>\n                </Grid.Column>\n            </Grid.Row>\n        </Grid>\n       \n        <UserAvatarUploadModal\n            t={props.t}\n            open={showAvatarUploadModal}\n            onClose={() => {\n                setShowAvatarUploadModal(false);\n                setShowAvatarActions(false);\n            }}\n            onUpload={uploadAvatar}\n        />\n    </Container>\n};\n\nexport default withNamespaces()(withRouter(UserProfile));\n\n","export const SERVER_CONTEXT = 'InspectIO.';\n\nexport const SAVE_BOARD = '@@InspectioBoards/SaveBoard';\nexport const RENAME_BOARD = '@@InspectioBoards/RenameBoard';\nexport const CHANGE_BOARD_ABBREVIATION = '@@InspectioBoards/ChangeBoardAbbreviation';\nexport const SET_BOARD_TAGS = '@@InspectioBoards/SetBoardTags';\nexport const CHANGE_RESPONSIBLE_TEAM = '@@InspectioBoards/ChangeResponsibleTeam';\nexport const TOGGLE_CODY_SUGGEST_ENABLED = '@@InspectioBoards/ToggleCodySuggestEnabled';\nexport const TOGGLE_EVENT_MODELING_ENABLED = '@@InspectioBoards/ToggleEventModelingEnabled';\nexport const IMPORT_NEW_BOARD = '@@InspectioBoards/ImportNewBoard';\nexport const IMPORT_EXISTING_BOARD = '@@InspectioBoards/ImportExistingBoard';\nexport const ADD_BOARD = '@@InspectioBoards/AddBoard';\nexport const UPDATE_BOARDS = '@@InspectioBoards/AddBoards';\nexport const FORCE_UPDATE_BOARDS = '@@InspectioBoards/ForceUpdateBoards';\nexport const SET_BOARD_TO_SNAPSHOT = '@@InspectioBoards/SetBoardToSnapshot';\nexport const SET_BOARD_DETAILS_FETCHED = '@@InspectioBoards/SetBoardDetailsFetched';\nexport const CONFIRM_DELETE_BOARD = '@@InspectioBoards/ConfirmDeleteBoard';\nexport const ABORT_BOARD_DELETION = '@@InspectioBoards/AbortBoardDeletion';\nexport const DELETE_BOARD = '@@InspectioBoards/DeleteBoard';\nexport const SHARE_BOARD = '@@InspectioBoards/ShareBoard';\nexport const RESEND_BOARD_INVITATION = '@@InspectioBoards/ResendBoardInvitation';\nexport const REVOKE_BOARD_INVITATION = '@@InspectioBoards/RevokeBoardInvitation';\nexport const REVOKE_ACCESS_TO_BOARD = '@@InspectioBoards/RevokeAccessToBoard';\nexport const CHANGE_BOARD_PERMISSIONS = '@@InspectioBoards/ChangeBoardPermissions';\nexport const ADMIN_CHANGE_TEAM_BOARD_PERMISSIONS = '@@InspectioBoards/AdminChangeTeamBoardPermissions';\nexport const TRIGGER_IMPORT_BOARD = '@@InspectioBoards/TriggerImportBoard';\nexport const TRIGGER_EXPORT_BOARD = '@@InspectioBoards/TriggerExportBoard';\nexport const TOGGLE_BOARD_HISTORY = '@@IspectioBoards/ToggleBoardHistory';\nexport const TOGGLE_ELEMENT_DETAILS = '@@IspectioBoards/ToggleElementDetails';\nexport const TOGGLE_CODY_CONSOLE = '@@InspectioBoards/ToggleCodyConsole';\nexport const TOGGLE_PLAYSHOT_MODAL = '@@InspectioBoards/TogglePlayshotModal';\nexport const TOGGLE_TIMER_MODAL = '@@InspectioBoards/ToggleTimerModal';\nexport const TOGGLE_VIDEO_SESSION = '@@InspectioBoards/ToggleVideoSession';\nexport const APPEND_HISTORY_ENTRIES = '@@InspectioBoards/AppendHistoryEntries';\nexport const PREPEND_HISTORY_ENTRIES = '@@InspectioBoards/PrependHistoryEntries';\nexport const CLEAR_BOARD_HISTORY = '@@InspectioBoards/ClearBoardHistory';\nexport const LOAD_FIRST_BOARD_HISTORY_CHUNK = '@@InspectioBoards/LoadFirstBoardHistoryChunk';\nexport const LOAD_NEXT_BOARD_HISTORY_CHUNK = '@@InspectioBoards/LoadNextBoardHistoryChunk';\nexport const SET_NO_MORE_HISTORY_AVAILABLE = '@@InspectioBoards/SetNoMoreHistoryAvailable';\nexport const SET_IS_LOADING_HISTORY = '@@InspectioBoards/SetIsLoadingHistory';\nexport const UPDATE_BOARD_ELEMENTS_TREE = '@@InspectioBoards/UpdateBoardElementsTree';\nexport const CREATE_BOARD_CLIENT = '@@InspectioBoards/CreateBoardClient';\nexport const REMOVE_BOARD_CLIENT = '@@InspectioBoards/RemoveBoardClient';\nexport const RESET_BOARD_CLIENT_SECRET = '@@InspectioBoards/ResetBoardClientSecret';\nexport const SET_STICKY_TEMPLATE = '@@InspectioBoards/SetStickyTemplate';\nexport const UPDATE_STICKY_ADVANCED_CONFIG = '@@InspectioBoards/UpdateStickyAdvancedConfig';\nexport const IMPORT_STICKY_TEMPLATES = '@@InspectioBoards/ImportStickyTemplates';\nexport const SHARE_BOARD_WITH_ORGANIZATION_MEMBERS = '@@InspectioBoards/ShareBoardWithOrganizationMembers';\nexport const SHARE_BOARD_WITH_ANYONE = '@@InspectioBoards/ShareBoardWithAnyone';\n\nexport const OPEN_ELEMENTS_DETAILS = '@@InspectioBoards/OpenElementsDetails';\n\nexport const FILTER_BOARD_OVERVIEW = '@@InspectioBoards/FilterBoardOverview';\nexport const SORT_BOARD_OVERVIEW = '@@InspectioBoards/SortBoardOverview';\nexport const FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM = '@@InspectioBoards/FilterBoardOverviewByResponsibleTeam';\nexport const HIDE_SHARED_BOARDS_ON_OVERVIEW = '@@InspectioBoards/HideSharedBoardsOnOverview';\nexport const HIDE_OWN_BOARDS_ON_OVERVIEW = '@@InspectioBoards/HideOwnBoardsOnOverview';\nexport const FILTER_ELEMENTS_TREE = '@@InspectioBoards/FilterElementsTree';\n\nexport const MOVE_USER_BOARD_TO_ORGANIZATION = '@@InspectioBoards/MoveUserBoardToOrganization';\n\nexport const DISMISS_MAINTENANCE_MESSAGE = '@@InspectioBoards/DismissMaintenanceMessage';\n\n\n// Board Sync\nexport const REMOTE_BOARD_CHANGED = '@@InspectioBoards/RemoteBoardChanged';\nexport const LOCAL_BOARD_CHANGED = '@@InspectioBoards/LocalBoardChanged';\nexport const BOARD_IMPORT_STARTED = '@@InspectioBoards/BoardImportStarted';\nexport const BOARD_IMPORTED = '@@InspectioBoards/BoardImported';\nexport const BOARD_EXPORTED = '@@InspectioBoards/BoardExported';\nexport const BOARD_INITIALIZED = '@@InspectioBoards/BoardInitialized';\nexport const LOCAL_BOARD_UPDATED_WITH_REMOTE_CHANGE = '@@InspectioBoards/LocalBoardUpdatedWithRemoteChange';\n\n// Events\nexport const BOARD_INVITATION_SENT = '@@InspectioBoards/BoardInvitationSent';\nexport const BOARD_INVITATION_RESENT = '@@InspectioBoards/BoardInvitationResent';\nexport const BOARD_INVITATION_REVOKED = '@@InspectioBoards/BoardInvitationRevoked';\nexport const BOARD_ACCESS_REVOKED = '@InspectioBoards/BoardAccessRevoked';\nexport const BOARD_PERMISSIONS_CHANGED = '@@InspectioBoards/BoardPermissionsChanged';\nexport const TEAM_BOARD_PERMISSIONS_CHANGED = '@@InspectioBoards/TeamBoardPermissionsChanged';\nexport const BOARD_PERMISSIONS_FOR_USERS_FETCHED = '@@InspectioBoards/BoardPermissionsForUsersFetched';\nexport const BOARD_PERMISSIONS_FOR_TEAMS_FETCHED = '@@InspectioBoards/BoardPermissionsForTeamsFetched';\nexport const OPEN_BOARD_INVITATIONS_FETCHED = '@@InspectioBoards/OpenBoardInvitationsFetched';\nexport const PLAYSHOT_SUMMARY_LIST_FETCHED = '@@InspectioBoards/PlayshotSummaryListFetched';\nexport const ACTIVE_GRAPH_ELEMENT_CHANGED = '@@InspectioBoards/ActiveGraphElementChanged';\nexport const ACTIVE_GRAPH_ELEMENT_LABEL_CHANGED = '@@InspectioBoards/ActiveGraphElementLabelChanged';\nexport const ACTIVE_GRAPH_ELEMENT_METADATA_CHANGED = '@@InspectioBoards/ActiveGraphElementMetadataChanged';\nexport const BOARD_GRAPH_ELEMENTS_FETCHED = '@@InspectioBoards/BoardGraphElementsFetched';\nexport const BOARD_CLIENT_FETCHED = '@@InspectioBoards/BoardClientFetched';\nexport const BOARD_CLIENT_NOT_CONFIGURED = '@@InspectioBoards/BoardClientNotConfigured';\nexport const BOARD_CLIENT_SECRET_FETCHED = '@@InspectioBoards/BoardClientSecretFetched';\nexport const BOARD_STICKY_TEMPLATES_FETCHED = '@@InspectioBoards/BoardStickyTemplatesFetched';\nexport const STICKY_TEMPLATE_SET = '@@InspectioBoards/StickyTemplateSet';\nexport const STICKY_ADVANCED_CONFIG_UPDATED = '@@InspectioBoards/StickyAdvancedConfigUpdated';\nexport const STICKY_TEMPLATES_IMPORTED = '@@InspectioBoards/StickyTemplatesImported';\nexport const USER_BOARD_MOVED_TO_ORGANIZATION = '@@InspectioBoards/UserBoardMovedToOrganization';\nexport const INITIAL_BOARD_LIST_LOADED = '@@InspectioBoards/InitialBoardListLoaded';\nexport const BOARD_SHARED_WITH_ORGANIZATION_MEMBERS = '@@InspectioBoards/BoardSharedWithOrganizationMembers';\nexport const BOARD_SHARED_WITH_ANYONE = '@@InspectioBoards/BoardSharedWithAnyone';\nexport const RUN_CODY_ON_CHANGED = '@@InspectioBoards/RunCodyOnChanged';\n\n// Queries\nexport const START_FETCH_USER_BOARDS = '@@InspectioBoards/StartFetchUserBoards';\nexport const FETCH_USER_BOARDS = '@@InspectioBoards/FetchUserBoards';\nexport const FETCH_USER_BOARD = '@@InspectioBoards/FetchUserBoard';\nexport const FETCH_BOARD_PERMISSIONS_FOR_USERS = '@@InspectioBoards/BoardPermissionsForUsers';\nexport const FETCH_BOARD_PERMISSIONS_FOR_TEAMS = '@@InspectioBoards/BoardPermissionsForTeams';\nexport const FETCH_OPEN_BOARD_INVITATIONS = '@@InspectioBoards/FetchOpenBoardInvitations';\nexport const FETCH_BOARD_GRAPH_ELEMENTS = '@@InspectioBoards/BoardGraphElements';\nexport const FETCH_BOARD_CLIENT = '@@InspectioBoards/FetchBoardClient';\nexport const FETCH_BOARD_CLIENT_SECRET = '@@InspectioBoards/FetchBoardClientSecret';\nexport const FETCH_BOARD_STICKY_TEMPLATES = '@@InspectioBoards/FetchBoardStickyTemplates';\nexport const FETCH_PLAYSHOT_SUMMARY_LIST = '@@InspectioBoards/FetchPlayshotSummaryList';\n","import {CommentJSONValue, parse as commentJsonParse, Reviver, stringify as commentJsonStringify} from \"comment-json\";\n\nexport function stringify(value: any, replacer?: ((key: string, value: any) => any) | Array<number | string> | null, space?: string | number): string {\n  return commentJsonStringify(value, replacer, space);\n}\n\nexport function parse(json: string, reviver?: Reviver, removes_comments?: boolean): CommentJSONValue {\n  return commentJsonParse(json, reviver, removes_comments);\n}\n\nexport function cloneDeepJSON<T>(value: T): T {\n  return parse(stringify(value, null, 2)) as T;\n}\n","import {Record} from 'immutable';\nimport {JSONSchema7} from \"json-schema\";\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey, isJSON} from \"../../core/validation/predicates\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {parse} from \"../service/json/json-comment-wrapper\";\nimport {PlayCommandHandlerRegistry, PlayCommandRegistry} from \"../service/playshot/diff/commands/command-definitions\";\nimport {PlayApplyRulesRegistry, PlayEventRegistry} from \"../service/playshot/diff/events/event-definitions\";\nimport {\n  PlayInformationRegistry,\n  PlayQueryRegistry,\n  PlayResolverRegistry,\n  PlayViewRegistry\n} from \"../service/playshot/diff/information/information-definitions\";\nimport {PlayPageRegistry} from \"../service/playshot/diff/pages/page-definitions\";\nimport {Persona} from \"../service/playshot/persona-types\";\nimport {PlayEventPolicyRegistry} from \"../service/playshot/diff/policies/policy-definitions\";\n\nexport const AGGREGATE_TYPE = 'Playshot';\n\nexport type PlayshotId = string;\nexport type PlayshotError = string;\n\nexport interface CodyPlayConfig {\n  appName: string,\n  defaultService: string,\n  layout: 'prototype' | 'task-based-ui',\n  theme: object,\n  personas: Persona[],\n  pages: PlayPageRegistry,\n  views: PlayViewRegistry,\n  commands: PlayCommandRegistry,\n  commandHandlers: PlayCommandHandlerRegistry,\n  events: PlayEventRegistry,\n  eventReducers: PlayApplyRulesRegistry,\n  queries: PlayQueryRegistry,\n  resolvers: PlayResolverRegistry,\n  types: PlayInformationRegistry,\n  eventPolicies: PlayEventPolicyRegistry,\n  /*\n  aggregates: PlayAggregateRegistry,\n\n   */\n  definitions: { [definitionId: string]: JSONSchema7 };\n}\n\nexport interface PlayshotProps {\n  uid: PlayshotId;\n  aggregateType: AggregateType;\n  playshotId: string;\n  boardId: string;\n  name: string;\n  savedAt: string;\n  savedBy: UserId;\n  playConfig: CodyPlayConfig;\n  playData: object;\n}\n\nexport const defaultPlayshotProps: PlayshotProps = {\n  uid: '',\n  aggregateType: AGGREGATE_TYPE,\n  playshotId: '',\n  boardId: '',\n  name: '',\n  savedAt: '',\n  savedBy: '',\n  playConfig: {\n    appName: 'Cody Play',\n    defaultService: 'App',\n    pages: {},\n    views: {},\n    commands: {},\n    commandHandlers: {},\n    events: {},\n    eventReducers: {},\n    queries: {},\n    resolvers: {},\n    eventPolicies: {},\n    types: {},\n    layout: \"prototype\",\n    theme: {},\n    personas: [],\n    definitions: {}\n  },\n  playData: {},\n};\n\nexport const createPlayshotFromServerData = (data: any): Either<PlayshotError, Playshot> => {\n  const validatedData: Either<PlayshotError, any> = validate(data,\n    [hasKey('playshotId'), \"playshotId missing\"],\n    [hasKey('name'), \"boardId missing\"],\n    [hasKey('savedAt'), \"boardId missing\"],\n    [hasKey('savedBy'), \"boardId missing\"],\n    [hasKey('playConfig'), \"playConfig missing\"],\n    [isJSON('playConfig'), \"playConfig is not a valid JSON string\"],\n    [isJSON('playData'), \"playData is not a valdi JSON string\"],\n  );\n\n  if (isFailure(validatedData)) {\n    return validatedData;\n  }\n\n  return Success(new Playshot({\n    ...defaultPlayshotProps,\n    ...data,\n    uid: data.playshotId,\n    playConfig: parse(data.playConfig),\n    playData: JSON.parse(data.playData),\n  }));\n};\n\nexport class Playshot extends Record(defaultPlayshotProps) implements PlayshotProps, Aggregate {\n  public constructor(data: Partial<PlayshotProps>) {\n    if(data.playshotId !== '') {\n      data.uid = data.playshotId;\n    }\n\n    if (data.uid === '' && data.playshotId === '') {\n      data.uid = uuid.v4()\n      data.playshotId = data.uid;\n    }\n\n\n\n    if(data.savedAt === '') {\n      data.savedAt = (new Date()).toISOString();\n    }\n\n    super(data);\n  }\n\n  // @TODO add use case methods to change state\n}\n","import {List, Map, Record} from \"immutable\";\nimport shortUUID from \"short-uuid\";\nimport {DeepLinkFactory} from \"../../routes\";\nimport {ActiveGraphElement} from \"../reducers/applyActiveGraphElementActions\";\nimport {CommandMetadata, getCommandMetadata} from \"../service/cody-wizard/command/get-command-metadata\";\nimport {\n    EventMetadata,\n    getEventMetadata\n} from \"../service/cody-wizard/event/get-event-metadata\";\nimport {fqcn} from \"../service/cody-wizard/node/fqcn\";\nimport {parseNodeMetadata, parseRawNodeMetadata} from \"../service/cody-wizard/node/metadata\";\nimport {names} from \"../service/cody-wizard/node/names\";\nimport {Schema} from \"../service/cody-wizard/schema/schema\";\nimport {getSchemaRefName} from \"../service/cody-wizard/vo/get-schema-ref-name\";\nimport {getVoMetadata, ValueObjectMetadata} from \"../service/cody-wizard/vo/get-vo-metadata\";\nimport {parse, stringify} from \"../service/json/json-comment-wrapper\";\nimport {createTreeFromElements, createTreeFromGraph, ElementsTree} from \"./ElementsTree\";\nimport {HistoryCellType} from \"./HistoryEntry\";\n\nexport type NodeId = string;\nexport type NodeName = string;\nexport type NodeDescription = string;\nexport type NodeTag = string;\nexport type NodeLink = string;\nexport type NodeMetadata = string;\nexport type NodeLabel = string; // Name + Description\nexport interface NodeSize {width: number; height: number}\nexport enum NodeType {\n    event = 'event',\n    command = 'command',\n    role = 'role',\n    projection = 'projection',\n    aggregate = 'aggregate',\n    document = 'document',\n    policy = 'policy',\n    hotSpot = 'hotSpot',\n    externalSystem = 'externalSystem',\n    ui = 'ui',\n    feature = 'feature',\n    slice = 'slice',\n    swimlanes = 'siwmlanes',\n    boundedContext = 'boundedContext',\n    freeText = 'freeText',\n    textCard = 'textCard',\n    edge = 'edge',\n    misc = 'misc',\n    icon = 'icon',\n    image = 'image',\n    layer = 'layer'\n}\n\nexport interface GraphPoint {\n    x: number;\n    y: number;\n}\n\nexport interface Size {\n    width: number;\n    height: number;\n}\n\nexport enum NextToPosition {\n    left = 'left',\n    right = 'right',\n    above = 'above',\n    below = 'below',\n    aboveLeft = 'aboveLeft',\n    aboveRight = 'aboveRight',\n    belowLeft = 'belowLeft',\n    belowRight = 'belowRight',\n}\n\nexport type PanningListener = (translate: GraphPoint) => void;\nexport type ZoomListener = (scale: number, translate: GraphPoint) => void;\nexport type MoveVideoToPositionListener = (position: {x: number, y: number}) => void;\nexport type CodyCallback = () => void;\n\nexport interface Node {\n    getId: () => NodeId;\n    getName: () => NodeName;\n    getTechnicalName: () => NodeName;\n    getFQCN: (defaultService: string) => NodeName;\n    getTechnicalFQCN: (defaultService: string) => NodeName;\n    changeName: (name: NodeName) => Node;\n    getDescription: () => NodeDescription;\n    getType: () => NodeType;\n    getLink: () => NodeLink | null;\n    getTags: () => List<NodeTag>;\n    isLayer: () => boolean;\n    isDefaultLayer: () => boolean;\n    getParent: () => Node | null;\n    changeParent: (parent: Node | null) => Node;\n    children: () => List<Node>;\n    setChildren: (children: List<Node>) => Node;\n    getGeometry: () => GraphPoint;\n    changeGeometry: (geometry: GraphPoint) => Node;\n    getSources: () => List<Node>;\n    getTargets: () => List<Node>;\n    getMetadata: () => string | null;\n    getParsedMetadata: () => {[metaKey: string]: any};\n    changeMetadata: (metadata: string) => Node;\n    isEnabled: () => boolean;\n    getSize: () => Size;\n    changeSize: (size: Size) => Node;\n    getVersion: () => number;\n}\n\nexport interface Graph {\n    createCellId: () => string;\n    getCurrentScale: () => number;\n    getCurrentTranslate: () => GraphPoint;\n    onPanning: (listener: PanningListener) => void;\n    offPanning: (listener: PanningListener) => void;\n    translateMousePoint: (x: number, y: number) => GraphPoint;\n    onZoom: (listener: ZoomListener) => void;\n    offZoom: (listener: ZoomListener) => void;\n    getRoot: () => Node;\n    openLayersDialog: () => void;\n    triggerCody: () => void;\n    selectNode: (node: Node) => boolean;\n    focusNode: (node: Node, animateScroll?: boolean) => void;\n    hasUserLevelVisibilityChanges: () => boolean;\n    isVisible: (node: Node) => boolean;\n    setUserVisible: (node: Node, visible: boolean) => void;\n    applyVisibilityGlobally: () => void;\n    isLocked: (node: Node) => boolean;\n    setLocked: (node: Node, locked: boolean) => void;\n    deleteNode: (node: Node) => void;\n    addLayer: (name: string) => void;\n    deleteLayer: (node: Node) => void;\n    isActiveLayer: (node: Node) => boolean;\n    setAsActiveLayer: (node: Node) => void;\n    setDefaultLayerAsActive: () => void;\n    highlightLayer: (node: Node) => void;\n    addNode: (node: Node) => void;\n    getNode: (nodeId: string) => Node | null;\n    addNodeNextToAnother: (newNode: Node, existingNode: Node, position: NextToPosition, margin: number| {x: number, y: number}, center?: boolean) => void;\n    moveNodeNextToAnother: (node: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean) => void;\n    changeNodeName: (node: Node, newName: string) => void;\n    changeNodeDescription: (node: Node, description: NodeDescription) => void;\n    changeNodeLabel: (node: Node, label: NodeLabel) => void;\n    changeNodeMetadata: (node: Node, metadata: NodeMetadata) => void;\n    changeNodeTags: (node: Node, tags: List<NodeTag>) => void;\n    resizeNode: (node: Node, size: Size) => void;\n    moveNode: (node: Node, toPosition: GraphPoint) => void;\n    switchParent: (node: Node, parent: Node | null, geo?: GraphPoint, expandIfNeeded?: boolean) => void;\n    connectNodes: (source: Node, target: Node, connectionLabel?: string, edgePoints?: GraphPoint[], invertCurve?: boolean) => void;\n    highlightNodes: (nodes: Node[]) => void;\n    copySelectionToActiveLayer: () => boolean;\n    changeFeatureStatus: (feature: Node, status: 'important' | 'planned' | 'ready' | 'deployed') => void;\n    getFeatureTaskLink: (feature: Node) => string | null;\n    setFeatureTaskLink: (feature: Node, link: string | null) => void;\n    exportXmlSnapshot: () => string;\n    onSelectionChanged: (listener: (hasSelection: boolean) => void) => void;\n    setCockpitBaseUrl: (baseUrl: string) => void;\n    focus: () => void;\n    setVideoAvatarEnabled: (enabled: boolean) => void;\n    onMoveVideoAvatarToPosition: (listener: MoveVideoToPositionListener) => void;\n    clearMoveVideoAvatarToPositionListener: () => void;\n    trackVideoAvatarPosition: (x: number, y: number) => void;\n    setCodyUpCb: (cb: null | CodyCallback) => void;\n    setCodyDownCb: (cb: null | CodyCallback) => void;\n    setCodyLeftCb: (cb: null | CodyCallback) => void;\n    setCodyRightCb: (cb: null | CodyCallback) => void;\n    openCodyWizard: (runCody?: boolean) => void;\n    mergeIntoSchema: (source: Node, target: Node) => void;\n    isEventModelingEnabled: () => boolean;\n    makeDraggable: (ele: HTMLElement, nodeToDrop: Node) => void;\n    makeActiveGraphElementIfPossible: (node: Node) => ActiveGraphElement | null;\n}\n\nexport const flattenNodeChildren = (nodes: Node[], targetArr?: Node[]): Node[] => {\n    if(!targetArr) {\n        targetArr = [];\n    }\n\n    nodes.forEach(node => {\n        targetArr!.push(node);\n        if(node.children().count() > 0) {\n            flattenNodeChildren(node.children().toJS(), targetArr);\n        }\n    })\n\n    return targetArr;\n}\n\nlet lastWrapper: MxGraphWrapper;\nlet lastMxGraph: any;\nexport const deriveGraphFromMxgraph = (mxgraph: any, editorUi: any): MxGraphWrapper => {\n    if(mxgraph !== lastMxGraph) {\n        lastWrapper = new MxGraphWrapper(mxgraph, editorUi);\n        lastMxGraph = mxgraph;\n    }\n\n    return lastWrapper;\n};\n\nexport const makeEmptyGraph = (boardXml?: string): Graph => {\n    return new EmptyGraph(boardXml);\n};\n\nexport const sortNodesByGraphPosition = (a: Node, b: Node): number => {\n    if(a.getGeometry().y < b.getGeometry().y - 40) {\n        return -1;\n    }\n\n    if(a.getGeometry().x < b.getGeometry().x - 40 && a.getGeometry().y < b.getGeometry().y) {\n        return -1;\n    }\n\n    if(a.getGeometry().x > b.getGeometry().x) {\n        return 1;\n    }\n\n    if(a.getGeometry().y > b.getGeometry().y) {\n        return 1;\n    }\n\n    return 0;\n};\n\nexport const sortNodesByType = (a: Node, b: Node): number => {\n    if(a.getType() === NodeType.boundedContext && b.getType() !== NodeType.boundedContext) {\n        return -1;\n    }\n\n    if(b.getType() === NodeType.boundedContext && a.getType() !== NodeType.boundedContext) {\n        return 1;\n    }\n\n    if(a.getType() === NodeType.feature && b.getType() !== NodeType.feature) {\n        return -1;\n    }\n\n    if(b.getType() === NodeType.feature && a.getType() !== NodeType.feature) {\n        return 1;\n    }\n\n    if(a.getName() < b.getName()) {\n        return -1;\n    }\n\n    if(b.getName() < a.getName()) {\n        return 1;\n    }\n\n    return 0;\n}\n\nexport const convertNodeToJs = (node: Node, removeCommentsFromMetadata?: boolean): RawNodeRecordProps => {\n    let metadata = node.getMetadata();\n\n    if(removeCommentsFromMetadata && metadata) {\n        try {\n            // It removes comments from JSON\n            metadata = stringify(parse(metadata, undefined, true));\n        } catch (e) {\n            metadata = null;\n        }\n    }\n\n    return {\n        id: node.getId(),\n        name: node.getName(),\n        description: node.getDescription(),\n        type: node.getType(),\n        link: node.getLink(),\n        tags: node.getTags().toJS(),\n        layer: node.isLayer(),\n        defaultLayer: node.isDefaultLayer(),\n        parent: node.getParent()? makeParentNodeRecord(node.getParent() as Node, node, true, removeCommentsFromMetadata) : null,\n        // toJSON => shallow copy is important here to keep Node classes intact, with toJS() they would be converted to plain objects, which is not what we want!\n        childrenList: node.children().map(c => makeNodeRecord(c, true, removeCommentsFromMetadata)).toJSON(),\n        sourcesList: node.getSources().map(s => makeConnectedNodeRecord(s, true, removeCommentsFromMetadata)).toJSON(),\n        targetsList: node.getTargets().map(t => makeConnectedNodeRecord(t, true, removeCommentsFromMetadata)).toJSON(),\n        geometry: new GraphPointRecord(node.getGeometry()),\n        metadata,\n        size: new SizeRecord(node.getSize()),\n        enabled: node.isEnabled()\n    };\n}\n\nexport const makeNodeFromJs = (data: Partial<RawNodeRecordProps>): Node => {\n    const immutableData: Partial<NodeRecordProps> = {};\n\n    if(data.id) {\n        immutableData.id = data.id;\n    }\n\n    if(data.name) {\n        immutableData.name = data.name;\n    }\n\n    if(data.description) {\n        immutableData.description = data.description;\n    }\n\n    if(data.type) {\n        immutableData.type = data.type;\n    }\n\n    if(data.link) {\n        immutableData.link = data.link;\n    }\n\n    if(data.tags) {\n        immutableData.tags = List(data.tags);\n    }\n\n    immutableData.layer = data.layer || false;\n    immutableData.defaultLayer = data.defaultLayer || false;\n\n    if(data.parent) {\n        immutableData.parent = data.parent;\n    }\n\n    if(data.childrenList) {\n        immutableData.childrenList = List(data.childrenList);\n    }\n\n    if(data.sourcesList) {\n        immutableData.sourcesList = List(data.sourcesList);\n    }\n\n    if(data.targetsList) {\n        immutableData.targetsList = List(data.targetsList);\n    }\n\n    if(data.geometry) {\n        immutableData.geometry = new GraphPointRecord({x: data.geometry.x, y: data.geometry.y});\n    }\n\n    if(data.metadata) {\n        immutableData.metadata = data.metadata;\n        immutableData.parsedMetadata = Map(parseRawNodeMetadata(data.metadata));\n    }\n\n    if(data.size) {\n        immutableData.size = new SizeRecord({width: data.size.width, height: data.size.height});\n    }\n\n    if(typeof data.enabled !== 'undefined') {\n        immutableData.enabled = !!data.enabled;\n    }\n\n\n    return new NodeRecord({...defaultNodeRecordProps, ...immutableData});\n}\n\n// tslint:disable-next-line:max-classes-per-file\nclass GraphPointRecord extends Record({x: 0, y: 0}) implements GraphPoint {};\n\n// tslint:disable-next-line:max-classes-per-file\nclass SizeRecord extends Record({width: 0, height: 0}) implements Size {};\n\n// tslint:disable-next-line:max-classes-per-file\nexport class MxGraphElement implements Node {\n    private mxcell: any;\n    private mxgraphModel: any;\n    private mxgraph: any;\n    private wrapper: MxGraphWrapper;\n\n    private id: NodeId | null = null;\n    private root: boolean | null = null;\n    private name: NodeName | null = null;\n    private technicalName: NodeName | null = null;\n    private fqcn: NodeName | null = null;\n    private technicalFQCN: NodeName | null = null;\n    private description: NodeDescription | null = null;\n    private type: NodeType | null = null;\n    private tags: List<NodeTag> | null = null;\n    private layer: boolean = false;\n    private parentCache: Node | null | undefined = undefined;\n    private childrenCache: List<Node> | null = null;\n    private sourcesCache: List<Node> | null = null;\n    private targetsCache: List<Node> | null = null;\n    private metadataCache: string | null | undefined = undefined;\n    private parsedMetadataCache: {[metaKey: string]: any} | undefined = undefined;\n    private geoCache: GraphPoint | undefined = undefined;\n    private sizeCache: Size | undefined = undefined;\n    private deepLinkFactory: DeepLinkFactory | undefined = undefined;\n    private version: number;\n\n    constructor (mxcell: any, mxgraphModel: any, mxgraph: any, wrapper: MxGraphWrapper, layer: boolean = false, deepLinkFactory?: DeepLinkFactory | undefined) {\n        this.mxcell = mxcell;\n        this.mxgraphModel = mxgraphModel;\n        this.mxgraph = mxgraph;\n        this.wrapper = wrapper;\n        this.layer = layer;\n        this.root = mxcell.getId() === MXGRAPH_ROOT_UUIDS[1];\n        this.deepLinkFactory = deepLinkFactory;\n        this.version = 1;\n    }\n\n    public setPotentiallyStale(): void {\n        this.name = null;\n        this.technicalName = null;\n        this.fqcn = null;\n        this.technicalFQCN = null;\n        this.description = null;\n        this.type = null;\n        this.tags = null;\n        this.geoCache = undefined;\n        this.sizeCache = undefined;\n        this.parentCache = undefined;\n        this.sourcesCache = null;\n        this.targetsCache = null;\n        this.version++;\n\n        if(typeof this.metadataCache !== 'undefined') {\n            if(this.metadataCache !== inspectioUtils.getMetadata(this.mxcell)) {\n                this.parsedMetadataCache = undefined;\n                const meta = inspectioUtils.getMetadata(this.mxcell);\n                this.metadataCache = meta? meta : null;\n            }\n        } else {\n            this.parsedMetadataCache = undefined;\n        }\n\n\n        // Also mark all children as potentially stale as this is triggered from the root and should ripple through the entire tree\n        if(this.childrenCache) {\n            let children: any[] | null = this.mxgraphModel.getChildren(this.mxcell);\n\n            if(!children) {\n                children = [];\n            }\n\n            this.childrenCache = List(children.map(child => {\n                child = this.wrapper.getNode(child.getId()) as MxGraphElement;\n                child.setPotentiallyStale();\n                if(this.deepLinkFactory) {\n                    child.setDeepLinkFactory(this.deepLinkFactory);\n                }\n                return child;\n            }));\n        }\n    }\n\n    public setDeepLinkFactory(deepLinkFactory: DeepLinkFactory): void {\n        this.deepLinkFactory = deepLinkFactory;\n    }\n\n    public getId(): NodeId {\n        if(null === this.id) {\n            this.id = this.mxcell.getId();\n        }\n        return this.id as NodeId;\n    }\n\n    public getName(): NodeName {\n        if(null === this.name) {\n            this.name = inspectioUtils.getLabelText(this.mxcell);\n\n            if(this.isDefaultLayer() && this.name === '') {\n                this.name = 'Board'\n            }\n        }\n        return this.name as NodeName;\n    }\n\n    public getTechnicalName(): NodeName {\n        if(null === this.technicalName) {\n            const meta = this.getParsedMetadata();\n\n            this.technicalName = meta.$nodeName || this.getName();\n        }\n\n        return this.technicalName as NodeName;\n    }\n\n    public getFQCN(defaultService: string): NodeName {\n        if(null === this.fqcn) {\n            this.fqcn = fqcn(this, false, false, true, defaultService);\n        }\n\n        return this.fqcn;\n    }\n\n    public getTechnicalFQCN(defaultService: string): NodeName {\n        if(null === this.technicalFQCN) {\n            this.technicalFQCN = fqcn(this, false, false, false, defaultService);\n        }\n\n        return this.technicalFQCN;\n    }\n\n    public changeName(name: NodeName): MxGraphElement {\n        const copy = new MxGraphElement(this.mxcell, this.mxgraphModel, this.mxgraph, this.wrapper, this.layer, this.deepLinkFactory);\n        this.copyInternalProps(copy);\n        copy.name = name;\n        return copy;\n    }\n\n    public getDescription(): NodeDescription {\n        if(null === this.description) {\n            this.description = inspectioUtils.getLabelSecondaryText(this.mxcell);\n        }\n\n        return this.description as NodeDescription;\n    }\n\n    public getType(): NodeType {\n        if(null !== this.type) {\n            return this.type;\n        }\n\n        const meta = this.getParsedMetadata() as {$nodeType?: NodeType};\n\n        if(meta.$nodeType) {\n            this.type = meta.$nodeType;\n            return this.type as NodeType;\n        }\n\n        let type = inspectioUtils.getTypeInclEdge(this.mxcell);\n\n        if(!type) {\n            type = NodeType.misc;\n        }\n\n        if(type === HistoryCellType.multiple) {\n            type = NodeType.misc;\n        }\n\n        if(this.isLayer()) {\n            type = NodeType.layer;\n        }\n\n        this.type = type;\n\n        return this.type;\n    }\n\n    public getLink(): NodeLink | null {\n        if(this.isLayer()) {\n            return null;\n        }\n\n        if(this.root) {\n            return null;\n        }\n\n        if(!this.deepLinkFactory) {\n            return null;\n        }\n\n        return this.deepLinkFactory(this.getId());\n    }\n\n    public getTags(): List<NodeTag> {\n        if(null !== this.tags) {\n            return this.tags;\n        }\n\n        return List(inspectioUtils.getTags(this.mxcell));\n    }\n\n    public getParent(): Node | null {\n        if(typeof this.parentCache === 'undefined') {\n            this.parentCache = this.isLayer() || this.mxcell.getParent() === null? null : this.wrapper.getNode(this.mxcell.getParent().getId()) as MxGraphElement;\n            if(this.deepLinkFactory && this.parentCache && this.parentCache instanceof MxGraphElement) {\n                this.parentCache.setDeepLinkFactory(this.deepLinkFactory);\n            }\n        }\n\n        return this.parentCache;\n    }\n\n    public changeParent(parent: Node | null): Node {\n        const copy = new MxGraphElement(this.mxcell, this.mxgraphModel, this.mxgraph, this.wrapper, this.layer, this.deepLinkFactory);\n        this.copyInternalProps(copy);\n        copy.parentCache = parent;\n        return copy;\n    }\n\n    public children(): List<Node> {\n        if(null !== this.childrenCache) {\n            return this.childrenCache;\n        }\n\n        let children: any[] | null = this.mxgraphModel.getChildren(this.mxcell);\n\n        if(!children) {\n            children = [];\n        }\n\n        const childrenList = List(children);\n\n        this.childrenCache = childrenList.map(child => {\n            child = this.wrapper.getNode(child.getId()) as MxGraphElement;\n\n            if(this.deepLinkFactory) {\n                child.setDeepLinkFactory(this.deepLinkFactory);\n            }\n\n            return child;\n        });\n\n        return this.childrenCache;\n    }\n\n    public setChildren(children: List<Node>): Node {\n        const copy = new MxGraphElement(this.mxcell, this.mxgraphModel, this.mxgraph, this.wrapper, this.layer, this.deepLinkFactory);\n        this.copyInternalProps(copy);\n        copy.childrenCache = children;\n        return copy;\n    }\n\n    public getSources(): List<Node> {\n        if(null !== this.sourcesCache) {\n            return this.sourcesCache;\n        }\n\n        let sources = List();\n\n        if(!this.mxcell.isVertex() || !this.mxcell.edges) {\n            return sources;\n        }\n\n        this.mxcell.edges.forEach((edge: any) => {\n            if(edge && edge.source && edge.source.getId() !== this.mxcell.getId()) {\n                const source = this.wrapper.getNode(edge.source.getId()) as MxGraphElement;\n                if(this.deepLinkFactory) {\n                    source.setDeepLinkFactory(this.deepLinkFactory);\n                }\n                sources = sources.filter(s => s.getId() !== edge.source.getId())\n                  .push(source);\n            }\n        });\n\n        this.sourcesCache = sources;\n\n        return sources;\n    }\n\n    public getTargets(): List<Node> {\n        if(null !== this.targetsCache) {\n            return this.targetsCache;\n        }\n\n        let targets = List();\n\n        if(!this.mxcell.isVertex() || !this.mxcell.edges) {\n            return targets;\n        }\n\n        this.mxcell.edges.forEach((edge: any) => {\n            if(edge && edge.target && edge.target.getId() !== this.mxcell.getId()) {\n                const target = this.wrapper.getNode(edge.target.getId()) as MxGraphElement;\n                if(this.deepLinkFactory) {\n                    target.setDeepLinkFactory(this.deepLinkFactory);\n                }\n                targets = targets.filter(t => t.getId() !== edge.target.getId())\n                  .push(target);\n            }\n        });\n\n        this.targetsCache = targets;\n        return targets;\n    }\n\n    public isLayer(): boolean {\n        return this.layer;\n    }\n\n    public isDefaultLayer(): boolean {\n        return this.isLayer() && this.mxcell.getId() === MXGRAPH_ROOT_UUIDS[0];\n    }\n\n    public getGeometry(): GraphPoint {\n        // Only use cache if it was explicitly set with changeGeometry\n        if(this.geoCache) {\n            return this.geoCache;\n        }\n\n        if(!this.mxcell.geometry) {\n            return {x:0, y:0};\n        }\n\n        return new GraphPointRecord({x: this.mxcell.geometry.x, y: this.mxcell.geometry.y});\n    }\n\n    public getSize(): Size {\n        // Only use cache if it was explicitly set with changeSize\n        if(this.sizeCache) {\n            return this.sizeCache;\n        }\n\n        if(!this.mxcell.geometry) {\n            return {width: 0, height: 0};\n        }\n\n        return new SizeRecord({width: this.mxcell.geometry.width, height: this.mxcell.geometry.height});\n    }\n\n    public changeGeometry(geometry: GraphPoint): Node {\n        const copy = new MxGraphElement(this.mxcell, this.mxgraphModel, this.mxgraph, this.wrapper, this.layer, this.deepLinkFactory);\n        this.copyInternalProps(copy);\n        copy.geoCache = geometry;\n        return copy;\n    }\n\n    public changeSize(size: Size): Node {\n        const copy = new MxGraphElement(this.mxcell, this.mxgraphModel, this.mxgraph, this.wrapper, this.layer, this.deepLinkFactory);\n        this.copyInternalProps(copy);\n        copy.sizeCache = size;\n        return copy;\n    }\n\n    public getMetadata(): string | null {\n        if(typeof this.metadataCache === 'undefined') {\n            const meta = inspectioUtils.getMetadata(this.mxcell);\n            this.metadataCache = meta? meta : null;\n        }\n\n        return this.metadataCache;\n    }\n\n    public getParsedMetadata(): {[metaKey: string]: any} {\n        if(typeof this.parsedMetadataCache === 'undefined') {\n            this.parsedMetadataCache = parseNodeMetadata(this);\n        }\n\n        return this.parsedMetadataCache;\n    }\n\n    public getVersion(): number {\n        return this.version;\n    }\n\n\n    public changeMetadata(metadata: string): MxGraphElement {\n        const copy = new MxGraphElement(this.mxcell, this.mxgraphModel, this.mxgraph, this.wrapper, this.layer, this.deepLinkFactory);\n        this.copyInternalProps(copy);\n        copy.metadataCache = metadata;\n        copy.parsedMetadataCache = undefined;\n        return copy;\n    }\n\n    public isEnabled(): boolean {\n        return this.mxgraph.isCellEnabled(this.mxcell);\n    }\n\n    private copyInternalProps (target: MxGraphElement) {\n        target.id = this.id;\n        target.root = this.root;\n        target.name = this.name;\n        target.description = this.description;\n        target.type = this.type;\n        target.tags = this.tags;\n        target.layer = this.layer;\n        target.parentCache = this.parentCache;\n        target.childrenCache = this.childrenCache;\n        target.targetsCache = this.targetsCache;\n        target.metadataCache = this.metadataCache;\n        target.parsedMetadataCache = this.parsedMetadataCache;\n        target.geoCache = this.geoCache;\n        target.sizeCache = this.sizeCache;\n        target.deepLinkFactory = this.deepLinkFactory;\n        target.version = this.version;\n    }\n}\n\n// tslint:disable-next-line:max-classes-per-file\nclass MxGraphWrapper implements Graph {\n    private mxgraph: any;\n    private editorUi: any;\n    private orgLayerVisibility: {[nodeId: string]: boolean} = {};\n    private root: MxGraphElement;\n    private cells: {[cellId: string]: MxGraphElement} = {};\n\n    constructor(mxgraph: any, editorUi: any) {\n        this.mxgraph = mxgraph;\n        this.editorUi = editorUi;\n        const mxmodel = this.mxgraph.getModel();\n        this.root = new MxGraphElement(mxmodel.getRoot(), mxmodel, this.mxgraph, this)\n    }\n\n    public createCellId(): string {\n        return this.mxgraph.model.createId();\n    }\n\n    public getCurrentScale(): number {\n        return this.mxgraph.getCurrentScale();\n    }\n\n    public getCurrentTranslate(): GraphPoint {\n        return this.mxgraph.getCurrentTranslate();\n    }\n\n    public onPanning(listener: PanningListener): void {\n        this.mxgraph.onPanning(listener);\n    }\n\n    public offPanning(listener: PanningListener): void {\n        this.mxgraph.offPanning(listener);\n    }\n\n    public translateMousePoint(x: number, y: number): GraphPoint {\n        return this.mxgraph.translateMousePoint(x, y);\n    }\n\n    public onZoom(listener: ZoomListener): void {\n        this.mxgraph.onZoom(listener);\n    }\n\n    public offZoom(listener: ZoomListener): void {\n        this.mxgraph.offZoom(listener);\n    }\n\n    public getRoot(): Node {\n        return this.root;\n    }\n\n    public openLayersDialog(): void {\n        this.editorUi.actions.get('layers').funct();\n    }\n\n    public triggerCody(): void {\n        this.mxgraph.triggerCody();\n    }\n\n    public selectNode(node: Node): boolean {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(!cell) {\n            return false;\n        }\n\n        this.mxgraph.setSelectionCell(cell);\n        return true;\n    }\n\n    public focusNode(node: Node, animateScroll?: boolean): void {\n        const cell = this.mxgraph.getModel().getCell(node.getId());\n\n        this.mxgraph.scrollCellsIntoView([cell], true, true, animateScroll);\n    }\n\n    public hasUserLevelVisibilityChanges(): boolean {\n        return Object.keys(this.orgLayerVisibility).length > 0;\n    }\n\n    public isVisible(node: Node): boolean {\n        const cell = this.mxgraph.getModel().getCell(node.getId());\n\n        return cell && this.mxgraph.getModel().isVisible(cell);\n    }\n\n    public setUserVisible(node: Node, visible: boolean): void {\n        const cell = this.mxgraph.getModel().getCell(node.getId());\n\n        // User visibility feature is deactivated\n        // It allows users to play around with visibility without effecting others, but on the other hand\n        // it makes the handling way more complicated and would also require a userElementLock functionality\n        // We keep the feature in the code, if too many users complain about the behavior\n        // Sync button above elements tree is also hidden at the moment\n        if(cell) {\n            this.mxgraph.model.beginUpdate();\n\n            try {\n                this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, cell, visible));\n                if(!inspectioUtils.isContainer(cell) && !node.isLayer()) {\n                    const edges: any[] = this.mxgraph.getAllEdges([cell]);\n\n                    edges.forEach(edge => {\n                        if(visible) {\n                            if(edge.source && edge.source !== cell && this.mxgraph.getModel().isVisible(edge.source)) {\n                                this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, edge, visible));\n                            }\n\n                            if(edge.target && edge.target !== cell && this.mxgraph.getModel().isVisible(edge.target)) {\n                                this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, edge, visible));\n                            }\n                        } else {\n                            this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, edge, visible));\n                        }\n                    })\n                }\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n\n            return;\n\n            window.setTimeout(() => {\n                if(visible) {\n                    if(node.isLayer()) {\n                        this.mxgraph.zoom(0.2, true);\n                        this.mxgraph.showAll(cell);\n                        this.mxgraph.scrollCellsIntoView(this.mxgraph.model.getChildren(cell));\n                    } else {\n                        this.mxgraph.scrollCellsIntoView([cell]);\n                    }\n                }\n            }, 200);\n        }\n\n        if(!this.orgLayerVisibility.hasOwnProperty(cell.getId())) {\n            this.orgLayerVisibility[cell.getId()] = this.isVisible(node);\n        }\n\n        if(cell) {\n            this.mxgraph.enableLazyTextPaint();\n            this.mxgraph.model.beginUpdateWithoutChangeNotifications();\n\n            try {\n                this.mxgraph.getModel().setVisible(cell, visible);\n            } finally {\n                this.mxgraph.model.endUpdateWithoutChangeNotifications();\n            }\n\n            this.mxgraph.disableLazyTextPaint();\n        }\n\n        window.setTimeout(() => {\n            if(visible) {\n                if(node.isLayer()) {\n                    this.mxgraph.zoom(0.2, true);\n                    this.mxgraph.showAll(cell);\n                    this.mxgraph.scrollCellsIntoView(this.mxgraph.model.getChildren(cell));\n                } else {\n                    this.mxgraph.scrollCellsIntoView([cell]);\n                }\n            }\n        }, 200);\n    }\n\n    public applyVisibilityGlobally(): void {\n        if(this.hasUserLevelVisibilityChanges()) {\n            this.mxgraph.model.beginUpdate();\n\n            try {\n                for (const cellId in this.orgLayerVisibility) {\n                    if(this.orgLayerVisibility.hasOwnProperty(cellId)) {\n                        const cell = this.mxgraph.model.getCell(cellId);\n\n                        if(cell) {\n                            this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, cell, this.mxgraph.model.isVisible(cell)));\n                        }\n                    }\n                }\n\n                this.orgLayerVisibility = {};\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n        }\n    }\n\n    public isLocked(node: Node): boolean {\n        const cell = this.mxgraph.getModel().getCell(node.getId());\n\n        if(!cell) {\n            return false;\n        }\n\n        const state = this.mxgraph.view.getState(cell);\n        const style = (state != null) ? state.style : this.mxgraph.getCellStyle(cell);\n        return  mxUtils.getValue(style, 'locked', '0').toString() === '1';\n    }\n\n    public setLocked(node: Node, locked: boolean): void {\n        const cell = this.mxgraph.getModel().getCell(node.getId());\n\n        if(!cell) {\n            return;\n        }\n\n        if(node.getType() === NodeType.feature || node.getType() === NodeType.boundedContext) {\n            this.mxgraph.setContainerLocked(cell, locked);\n            return;\n        }\n\n        const state = this.mxgraph.view.getState(cell);\n        const style = (state != null) ? state.style : this.mxgraph.getCellStyle(cell);\n\n        this.mxgraph.getModel().beginUpdate();\n        try {\n            this.mxgraph.setCellStyles('locked', locked? '1' : null, [cell]);\n        } finally {\n            this.mxgraph.getModel().endUpdate();\n        }\n\n        if (locked)\n        {\n            this.mxgraph.removeSelectionCells(this.mxgraph.getModel().getDescendants(cell));\n        }\n    }\n\n    public deleteNode(node: Node): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            this.mxgraph.removeCells([cell], true);\n        }\n    }\n\n    public addLayer(name: string): void {\n        if (this.mxgraph.isEnabled())\n        {\n            this.mxgraph.model.beginUpdate();\n\n            try\n            {\n                const cell = this.mxgraph.addCell(new mxCell(name), this.mxgraph.model.root);\n                this.mxgraph.setDefaultParent(cell);\n            }\n            finally\n            {\n                this.mxgraph.model.endUpdate();\n            }\n        }\n    }\n\n    public deleteLayer(node: Node): void {\n        if(node.isDefaultLayer()) {\n            throw Error(\"The default layer cannot be deleted!\");\n        }\n\n        const cell = this.mxgraph.model.getCell(node.getId());\n        const isActiveLayer = this.isActiveLayer(node);\n\n        this.mxgraph.model.beginUpdate();\n        try\n        {\n            const index = this.mxgraph.model.root.getIndex(cell);\n            this.mxgraph.removeCells([cell], false);\n\n            if(isActiveLayer) {\n                if (index > 0 && index <= this.mxgraph.model.getChildCount(this.mxgraph.model.root))\n                {\n                    this.mxgraph.setDefaultParent(this.mxgraph.model.getChildAt(this.mxgraph.model.root, index - 1));\n                }\n                else\n                {\n                    this.mxgraph.setDefaultParent(null);\n                }\n            }\n        }\n        finally\n        {\n            this.mxgraph.model.endUpdate();\n        }\n    }\n\n    public isActiveLayer(node: Node): boolean {\n        return this.mxgraph.getDefaultParent().getId() === node.getId();\n    }\n\n    public setAsActiveLayer(node: Node): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            this.mxgraph.model.beginUpdate();\n\n            try {\n                this.mxgraph.setDefaultParent(cell);\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n        }\n    }\n\n    public setDefaultLayerAsActive(): void {\n        this.mxgraph.setDefaultParent(null);\n    }\n\n    public highlightLayer(node: Node): void {\n        const cell = this.mxgraph.getModel().getCell(node.getId());\n\n        if(cell && this.mxgraph.model.getChildren(cell)) {\n            this.mxgraph.scrollCellsIntoView(this.mxgraph.model.getChildren(cell));\n        }\n    }\n\n    public addNode(node: Node): void {\n        if(node.isLayer()) {\n            this.addLayer(node.getName());\n            return;\n        }\n\n        if(node.getType() === HistoryCellType.edge) {\n            this.addEdge(node);\n            return;\n        }\n\n        this.addVertex(node);\n    }\n\n    public getNode(nodeId: string): Node | null {\n        if(this.cells[nodeId]) {\n            return this.cells[nodeId];\n        }\n\n        const cell = this.mxgraph.model.getCell(nodeId);\n\n        if(!cell) {\n            return null;\n        }\n\n        this.cells[nodeId] = new MxGraphElement(cell, this.mxgraph.model, this.mxgraph, this, this.mxgraph.model.isLayer(cell));\n\n        return this.cells[nodeId];\n    }\n\n    public addNodeNextToAnother(newNode: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean): void {\n        this.addNode(newNode);\n        this.moveNodeNextToAnother(newNode, existingNode, position, margin, center);\n    }\n\n    public moveNodeNextToAnother(node: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(!cell) {\n            console.error(\"[MxGraphWrapper] Tried to move node next to another, but the corresponding cell is not returned by mxgraph. Something seems to be wrong\", convertNodeToJs(node));\n            return;\n        }\n\n        const cellSize = {width: cell.getGeometry().width, height: cell.getGeometry().height};\n\n        const relativeGeo = this.getGeometryRelativeToElement(existingNode, position, cellSize, margin, center);\n\n        if (existingNode.getParent() && cell.getParent().getId() !== existingNode.getParent()!.getId()) {\n            const parentCell = this.mxgraph.model.getCell(existingNode.getParent()!.getId());\n\n            if(parentCell) {\n                this.mxgraph.model.add(parentCell, cell);\n            }\n        }\n\n        // First, make sure that cell is at point 0,0 because move works with relative coordinates\n        if(node.getGeometry().x > 0 || node.getGeometry().y > 0) {\n            this.mxgraph.moveCells([cell], -1 * node.getGeometry().x, -1 * node.getGeometry().y, false);\n        }\n\n        this.mxgraph.moveCells([cell], relativeGeo.x, relativeGeo.y, false);\n    }\n\n    public changeNodeName(node: Node, newName: string): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            const oldDesc = inspectioUtils.getLabelSecondaryText(cell);\n\n            this.mxgraph.cellLabelChanged(cell, inspectioUtils.joinLabelParts(newName, oldDesc));\n        }\n    }\n\n    public changeNodeDescription(node: Node, description: NodeDescription): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            const oldName = inspectioUtils.getLabelText(cell);\n\n            this.mxgraph.cellLabelChanged(cell, inspectioUtils.joinLabelParts(oldName, description));\n        }\n    }\n\n    public changeNodeLabel(node: Node, label: NodeLabel): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            this.mxgraph.cellLabelChanged(cell, label);\n        }\n    }\n\n    public changeNodeMetadata(node: Node, metadata: NodeMetadata, doNotUpdateSimilarNodes?: boolean): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            this.mxgraph.model.beginUpdate();\n            try {\n                this.mxgraph.setAttributeForCell(cell, 'metadata', metadata);\n                const cellState = this.mxgraph.getCellState(cell);\n                this.mxgraph.cellRenderer.redraw(cellState, false, true);\n            } catch (e) {\n                console.error(e);\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n\n            this.mxgraph.triggerChangeActiveGraphElementIfIsActive(cell);\n\n            if(doNotUpdateSimilarNodes) {\n                return;\n            }\n\n            if(node.getTags().contains(ispConst.TAG_CONNECTED)) {\n                const elementsTree = createTreeFromElements(this.root.children());\n\n                const similarNodes = elementsTree.getSimilarElements(node)\n                  .filter(ele => ele.getTags().contains(ispConst.TAG_CONNECTED));\n\n                similarNodes.forEach(sn => this.changeNodeMetadata(sn, metadata, true));\n            }\n        }\n    }\n\n    public changeNodeTags(node: Node, tags: List<NodeTag>): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            this.mxgraph.model.beginUpdate();\n            try {\n                this.mxgraph.setAttributeForCell(cell, ispConst.TAGS_ATTR, tags.join(\",\"));\n                const cellState = this.mxgraph.getCellState(cell);\n                this.mxgraph.cellRenderer.redraw(cellState, false, true);\n            } catch (e) {\n                console.error(e);\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n        }\n    }\n\n    public resizeNode(node: Node, size: Size): void {\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell && cell.getGeometry()) {\n            const bounds = new mxRectangle(\n              node.getGeometry().x,\n              node.getGeometry().y,\n              size.width,\n              size.height\n            )\n\n            const positionChanged = cell.getGeometry().x !== bounds.x || cell.getGeometry().y !== bounds.y;\n\n            try {\n                this.mxgraph.model.beginUpdate();\n\n                if(positionChanged) {\n                    const dx = cell.getGeometry().x - bounds.x;\n                    const dy = cell.getGeometry().y - bounds.y;\n\n                    const vertexHandler = new mxVertexHandler(this.mxgraph.view.getState(cell));\n                    vertexHandler.moveChildren(cell, dx, dy);\n                    vertexHandler.destroy();\n                }\n\n                this.mxgraph.resizeCell(cell, bounds, false);\n            } catch (e) {\n                console.error(e);\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n        }\n    }\n\n    public moveNode(node: Node, toPosition: GraphPoint): void {\n        const dx = node.getGeometry().x - toPosition.x;\n        const dy = node.getGeometry().y - toPosition.y;\n\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            this.mxgraph.moveCells([cell], dx, dy, false);\n        }\n    }\n\n    public switchParent(node: Node, parent: Node | null, geo?: GraphPoint, expandIfNeeded?: boolean): void {\n        const parentCell = parent ? this.mxgraph.model.getCell(parent.getId()) : null;\n        const cell = this.mxgraph.model.getCell(node.getId());\n\n        if(cell) {\n            const childGeometry = mxUtils.clone(cell.getGeometry());\n\n            if(cell.parent && cell.parent.getGeometry() && (!parentCell.parent || parentCell.parent.getId() !== cell.parent.getId())) {\n                childGeometry.translate(cell.parent.getGeometry().x, cell.parent.getGeometry().y);\n            }\n\n            if(parentCell) {\n                childGeometry.translate(parentCell.getGeometry().x * -1, parentCell.getGeometry().y * -1);\n            }\n\n            try {\n                this.mxgraph.model.beginUpdate();\n\n                this.mxgraph.model.add(parentCell, cell);\n\n\n                if(geo) {\n                    childGeometry.x = geo.x;\n                    childGeometry.y = geo.y;\n                }\n\n                this.mxgraph.model.setGeometry(cell, childGeometry);\n\n                if(node instanceof MxGraphElement) {\n                    node.setPotentiallyStale();\n                }\n\n                if(parent instanceof MxGraphElement) {\n                    parent.setPotentiallyStale();\n                }\n\n                if(parent && expandIfNeeded) {\n                    this.expandIfNeeded(parent);\n                }\n            } catch (e) {\n                console.error(e);\n            } finally {\n                this.mxgraph.model.endUpdate();\n            }\n        }\n    }\n\n    public connectNodes(source: Node, target: Node, connectionLabel?: string, edgePoints?: GraphPoint[], invertCurve?: boolean): void {\n        // @TODO: handle connectionLabel\n\n        const parent = source.getParent() === null || target.getParent() === null || source.getParent() !== target.getParent()\n            ? this.mxgraph.getDefaultParent()\n            : this.mxgraph.model.getCell(source.getParent()!.getId());\n\n        const edge = this.mxgraph.insertEdge(parent, null, '', this.mxgraph.model.getCell(source.getId()), this.mxgraph.model.getCell(target.getId()));\n\n        if(!edgePoints) {\n            const sourceGeo = this.mxgraph.getModel().getGeometry(this.mxgraph.model.getCell(source.getId()));\n            const targetGeo = this.mxgraph.getModel().getGeometry(this.mxgraph.model.getCell(target.getId()));\n\n\n            if(sourceGeo.x !== targetGeo.x && sourceGeo.y !== targetGeo.y) {\n                let pointX = 0;\n\n                edgePoints = [];\n\n                if(!this.isEventModelingEnabled()) {\n                    if(targetGeo.x > sourceGeo.x) {\n                        const sourceRightCorner = sourceGeo.x + sourceGeo.width;\n                        pointX = sourceRightCorner + ((targetGeo.x - sourceRightCorner) / 2);\n                    } else {\n                        const targetRightCorner = targetGeo.x + targetGeo.width;\n                        pointX = targetRightCorner + ((sourceGeo.x - targetRightCorner) / 2);\n                    }\n\n                    edgePoints.push(new mxPoint(pointX, (sourceGeo.y + sourceGeo.height / 2)));\n                    edgePoints.push(new mxPoint(pointX, (targetGeo.y + targetGeo.height / 2)));\n                } else {\n                    if(invertCurve) {\n                        pointX = sourceGeo.x + (sourceGeo.width / 2);\n\n                        edgePoints.push(new mxPoint(pointX, (targetGeo.y + targetGeo.height / 2)));\n                    } else {\n                        pointX = targetGeo.x + (targetGeo.width / 2);\n\n                        edgePoints.push(new mxPoint(pointX, (sourceGeo.y + sourceGeo.height / 2)));\n                    }\n                }\n            }\n        }\n\n        if(edgePoints && edgePoints.length) {\n            const geo = this.mxgraph.getModel().getGeometry(edge) || {points: []};\n            geo.points = edgePoints;\n            this.mxgraph.getModel().setGeometry(edge, geo);\n            const edgeState = this.mxgraph.getCellState(edge);\n            this.mxgraph.view.resetValidationState();\n            this.mxgraph.view.invalidate(edge);\n            this.mxgraph.cellRenderer.redraw(edgeState, false, true);\n        }\n    }\n\n    public highlightNodes(nodes: Node[]): void {\n        // Do nothing\n    }\n\n    public copySelectionToActiveLayer(): boolean {\n        if (this.mxgraph.isEnabled() && !this.mxgraph.isSelectionEmpty())\n        {\n            this.mxgraph.moveCells(this.mxgraph.getSelectionCells(), 0, 0, false, this.mxgraph.getDefaultParent());\n            return true;\n        }\n\n        return false;\n    }\n\n    public changeFeatureStatus(feature: Node, status: \"important\" | \"planned\" | \"ready\" | \"deployed\"): void {\n        if(feature.getType() !== NodeType.feature) {\n            return;\n        }\n\n        this.selectNode(feature);\n\n        const action = this.mxgraph.editorUi.actions.get(`tag${names(status).className}`);\n\n        if(action) {\n            action.funct();\n        }\n    }\n\n    public getFeatureTaskLink(feature: Node): string | null {\n        if(feature.getType() !== NodeType.feature) {\n            return null;\n        }\n\n        const cell = this.mxgraph.model.getCell(feature.getId());\n\n        return this.mxgraph.getFeatureTaskLink(cell);\n    }\n\n    public setFeatureTaskLink(feature: Node, link: string | null): void {\n        if(feature.getType() !== NodeType.feature) {\n            return;\n        }\n\n        const cell = this.mxgraph.model.getCell(feature.getId());\n\n        if(!cell) {\n            return;\n        }\n\n        this.mxgraph.setFeatureTaskLink(cell, link);\n    }\n\n    public exportXmlSnapshot(): string {\n        // 1. check if we need to reset layer visibility to not override global settings\n        const userLayerVisibility: {[nodeId: string]: boolean} = {};\n\n        if(this.hasUserLevelVisibilityChanges()) {\n            this.mxgraph.model.beginUpdateWithoutChangeNotifications();\n\n            try {\n                for (const cellId in this.orgLayerVisibility) {\n                    if(this.orgLayerVisibility.hasOwnProperty(cellId)) {\n                        const cell = this.mxgraph.model.getCell(cellId);\n\n                        if(cell) {\n                            const layerVisibleForUser = this.mxgraph.model.isVisible(cell);\n\n                            if(layerVisibleForUser !== this.orgLayerVisibility[cellId]) {\n                                userLayerVisibility[cellId] = layerVisibleForUser;\n                                this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, cell, this.orgLayerVisibility[cellId]));\n                            }\n                        }\n                    }\n                }\n            } finally {\n                this.mxgraph.model.endUpdateWithoutChangeNotifications();\n            }\n        }\n\n        // 2. Export Graph Xml\n\n        const enc = new mxCodec(mxUtils.createXmlDocument());\n        const node = enc.encode(this.mxgraph.getModel());\n\n        if (this.mxgraph.view.translate.x !== 0 || this.mxgraph.view.translate.y !== 0)\n        {\n            node.setAttribute('dx', Math.round(this.mxgraph.view.translate.x * 100) / 100);\n            node.setAttribute('dy', Math.round(this.mxgraph.view.translate.y * 100) / 100);\n        }\n\n        node.setAttribute('grid', (this.mxgraph.isGridEnabled()) ? '1' : '0');\n        node.setAttribute('gridSize', this.mxgraph.gridSize);\n        node.setAttribute('guides', (this.mxgraph.graphHandler.guidesEnabled) ? '1' : '0');\n        node.setAttribute('tooltips', (this.mxgraph.tooltipHandler.isEnabled()) ? '1' : '0');\n        node.setAttribute('connect', (this.mxgraph.connectionHandler.isEnabled()) ? '1' : '0');\n        node.setAttribute('arrows', (this.mxgraph.connectionArrowsEnabled) ? '1' : '0');\n        node.setAttribute('fold', (this.mxgraph.foldingEnabled) ? '1' : '0');\n        node.setAttribute('page', (this.mxgraph.pageVisible) ? '1' : '0');\n        node.setAttribute('pageScale', this.mxgraph.pageScale);\n        node.setAttribute('pageWidth', this.mxgraph.pageFormat.width);\n        node.setAttribute('pageHeight', this.mxgraph.pageFormat.height);\n\n        if (this.mxgraph.background != null)\n        {\n            node.setAttribute('background', this.mxgraph.background);\n        }\n\n        const xml = mxUtils.getXml(node);\n\n        // 3. Now set layer visibility back to what user currently sees\n        this.mxgraph.model.beginUpdateWithoutChangeNotifications();\n\n        try {\n            for (const layerId in this.orgLayerVisibility) {\n                if(this.orgLayerVisibility.hasOwnProperty(layerId)) {\n                    const layer = this.mxgraph.model.getCell(layerId);\n\n                    if(layer) {\n                        this.mxgraph.model.execute(new mxVisibleChange(this.mxgraph.model, layer, userLayerVisibility[layerId]));\n                    }\n                }\n            }\n        } finally {\n            this.mxgraph.model.endUpdateWithoutChangeNotifications();\n        }\n\n        return xml;\n    }\n\n    public onSelectionChanged(listener: (hasSelection: boolean) => void): void {\n        this.mxgraph.selectionModel.addListener(mxEvent.CHANGE, () => {\n            if(this.mxgraph.isSelectionEmpty()) {\n                listener(false);\n            } else {\n                listener(true);\n            }\n        });\n    }\n\n    public setCockpitBaseUrl(baseUrl: string): void {\n        this.mxgraph.setCockpitBaseUrl(baseUrl);\n    }\n\n    public focus(): void {\n        this.mxgraph.container.focus();\n    }\n\n    public clearMoveVideoAvatarToPositionListener(): void {\n        this.mxgraph.clearMoveVideoAvatarToPositionListener();\n    }\n\n    public onMoveVideoAvatarToPosition(listener: MoveVideoToPositionListener): void {\n        this.mxgraph.onMoveVideoAvatarToPosition(listener);\n    }\n\n    public setVideoAvatarEnabled(enabled: boolean): void {\n        this.mxgraph.setVideoAvatarEnabled(enabled);\n    }\n\n    public trackVideoAvatarPosition(x: number, y: number): void {\n        this.mxgraph.trackVideoAvatarPosition(x,y);\n    }\n\n    public setCodyDownCb(cb: CodyCallback | null): void {\n        this.mxgraph.setCodyDownCb(cb);\n    }\n\n    public setCodyLeftCb(cb: CodyCallback | null): void {\n        this.mxgraph.setCodyLeftCb(cb);\n    }\n\n    public setCodyRightCb(cb: CodyCallback | null): void {\n        this.mxgraph.setCodyRightCb(cb);\n    }\n\n    public setCodyUpCb(cb: CodyCallback | null): void {\n        this.mxgraph.setCodyUpCb(cb);\n    }\n\n    public openCodyWizard(runCody?: boolean): void {\n        const action = 'codywizard' + (runCody ? '_run' : '');\n        this.editorUi.actions.get(action).funct();\n    }\n\n    public mergeIntoSchema(source: Node, target: Node): void {\n        if(source.getType() !== NodeType.document) {\n            return;\n        }\n\n        const sourceMeta = getVoMetadata(source);\n\n        let targetMeta: ValueObjectMetadata | CommandMetadata | EventMetadata | null = null;\n\n        switch (target.getType()) {\n            case NodeType.document:\n                targetMeta = getVoMetadata(target);\n                break;\n            case NodeType.event:\n                targetMeta = getEventMetadata(target);\n                break;\n            case NodeType.command:\n                targetMeta = getCommandMetadata(target);\n                break;\n        }\n\n        if(!targetMeta) {\n            return;\n        }\n\n        let sourceSchema = sourceMeta.schema;\n\n        if(!sourceSchema || sourceSchema.isEmpty()) {\n            sourceSchema = this.getSchemaFromDescription(source);\n        }\n\n        const targetSchema = targetMeta.schema || Schema.fromString('{}');\n\n        if(!targetSchema.isObject()) {\n            return;\n        }\n\n        if(sourceSchema.isObject()) {\n            const elementsTree = createTreeFromElements(this.root.children());\n\n            if(elementsTree.getSimilarElements(source).count() > 0) {\n                const refName = getSchemaRefName(source, sourceMeta, true);\n                sourceSchema = Schema.fromString(refName);\n            }\n        }\n\n        let propName = source.getName();\n        let required = true;\n\n        if(propName[propName.length - 1] === '?') {\n            required = false;\n            propName = propName.slice(0, propName.length - 1);\n        }\n\n        targetSchema.setObjectProperty(names(propName).propertyName, sourceSchema, required);\n        targetMeta.schema = targetSchema;\n\n        this.changeNodeMetadata(target, stringify(targetMeta, null, 2));\n        this.deleteNode(source);\n    }\n\n    public isEventModelingEnabled(): boolean {\n        return !!this.mxgraph.eventModelingEnabled;\n    }\n\n    public makeDraggable(ele: HTMLElement, nodeToDrop: Node): void {\n        const existingCell = this.mxgraph.getModel().getCell(nodeToDrop.getId());\n\n        if(this.editorUi.sidebar) {\n            const sidebar = this.editorUi.sidebar;\n            const bounds = {\n                x: 0,\n                y: 0,\n                width: nodeToDrop.getSize().width,\n                height: nodeToDrop.getSize().height,\n            }\n\n            sidebar.createDragSource(\n              ele,\n              sidebar.createDropHandler([existingCell], false, true, bounds, undefined, undefined, true),\n              sidebar.createDragPreview(bounds.width, bounds.height, nodeToDrop.getType()),\n              [existingCell],\n              bounds\n            );\n        }\n    }\n\n    public makeActiveGraphElementIfPossible(node: Node): ActiveGraphElement | null {\n        const existingCell = this.mxgraph.getModel().getCell(node.getId());\n\n        if(!existingCell) {\n            return null;\n        }\n\n        const [\n          activeCell,\n          updateMetadata,\n          updateSimilarElements,\n          replaceTags\n        ] = this.mxgraph.makeActiveGraphElement(existingCell);\n\n        if(!activeCell) {\n            return null;\n        }\n\n        if(activeCell.isEdge()) {\n            let edgeLabel = 'Edge';\n            let edgeData;\n\n            if(activeCell.source && activeCell.target) {\n                edgeLabel = inspectioUtils.getLabelText(activeCell.source) + ' -> ' + inspectioUtils.getLabelText(activeCell.target);\n                edgeData = {\n                    source: activeCell.source.getId(),\n                    target: activeCell.target.getId(),\n                };\n            }\n\n            return {\n                id: activeCell.getId(),\n                type: NodeType.edge,\n                label: edgeLabel,\n                metadata: inspectioUtils.getMetadata(activeCell),\n                edgeData,\n                updateMetadata,\n                updateSimilarElements,\n                replaceTags,\n                locked: !this.mxgraph.isCellEnabled(activeCell)\n            }\n        }\n\n        if(activeCell.isVertex()) {\n            return {\n                id: activeCell.getId(),\n                type: inspectioUtils.isEventModel(activeCell)? HistoryCellType.swimlanes : inspectioUtils.getTypeInclEdge(activeCell) as NodeType,\n                label: inspectioUtils.getLabelText(activeCell),\n                metadata: inspectioUtils.getMetadata(activeCell),\n                tags: inspectioUtils.getTags(activeCell),\n                updateMetadata,\n                updateSimilarElements,\n                replaceTags,\n                locked: !this.mxgraph.isCellEnabled(activeCell)\n            }\n        }\n\n        return null;\n    }\n\n    private addVertex(node: Node): void\n    {\n        const existingCell = this.mxgraph.getModel().getCell(node.getId());\n\n        if(existingCell) {\n            console.warn(\"[BoardAgent] Skipping element. A cell with same id is already on the board!\", convertNodeToJs(node));\n            return;\n        }\n\n        const attributes: {[name: string]: string} = {};\n\n        if(node.getTags().count()) {\n            attributes[ispConst.TAGS_ATTR] = node.getTags().join(\",\");\n        }\n\n\n        const cellValue = inspectioUtils.createCellXmlValue(\n            node.getType(),\n            node.getName(),\n            node.getDescription(),\n            node.getMetadata(),\n            attributes\n        )\n\n        const stylesheet = this.mxgraph.getStylesheet();\n\n        const style = stylesheet.getCellStyle(node.getType());\n\n        let size = {width: node.getSize().width, height: node.getSize().height};\n\n        if(size.width === 0) {\n            if(style.minWidth) {\n                size.width = parseInt(style.minWidth.toString(), undefined);\n                size.height = parseInt(style.minHeight.toString(), undefined);\n            } else {\n                size = {width: 160, height: 100};\n            }\n        }\n\n        const pos = node.getGeometry();\n\n        // @TODO: check that geo is relative if parent is given\n\n        const cell = new mxCell(cellValue, new mxGeometry(pos.x, pos.y, size.width, size.height), node.getType());\n\n        cell.setId(node.getId());\n        cell.setVertex(true);\n\n        // Ensure that cell has state\n        this.mxgraph.execWithUnscaledView(() => {\n            const state = this.mxgraph.view.getState(cell, true);\n            this.mxgraph.view.updateCellState(state);\n        })\n\n        const preferredSize = this.mxgraph.getPreferredSizeForCell(cell);\n\n        if(size.height !== preferredSize.height) {\n            cell.setGeometry(new mxGeometry(pos.x, pos.y, preferredSize.width, preferredSize.height));\n        }\n\n\n        const parent = node.getParent() ? this.mxgraph.getModel().getCell(node.getParent()!.getId()) : null;\n\n        if(inspectioUtils.isContainer(cell)) {\n            inspectioUtils.initContainer(cell, this.mxgraph, true);\n        }\n\n        this.mxgraph.importCells([cell], 0, 0, parent);\n    }\n\n    private addEdge(node: Node): void\n    {\n        // @TODO: add edge, cell.setEdge(true);\n    }\n\n    private getGeometryRelativeToElement(element: Node, pos: NextToPosition, size: NodeSize, margin: number | {x: number, y: number}, center?: boolean): GraphPoint {\n        const eleGeo = element.getGeometry();\n\n        const eleSize = element.getSize();\n\n        const xMargin = typeof margin === \"object\" ? margin.x : margin;\n        const yMargin = typeof margin === \"object\" ? margin.y : margin;\n\n        if(typeof center === 'undefined') {\n            center = true;\n        }\n\n        const centeredX = eleSize.width === 0 || size.width === 0\n            ? eleGeo.x\n            : eleGeo.x + (eleSize.width / 2 ) - (size.width / 2);\n\n        const centeredY = eleSize.height === 0 || size.height === 0\n            ? eleGeo.y\n            : eleGeo.y + (eleSize.height / 2) - (size.height / 2);\n\n        switch (pos) {\n            case NextToPosition.left:\n                return {\n                    x: eleGeo.x - xMargin - size.width,\n                    y: center? centeredY : eleGeo.y\n                }\n            case NextToPosition.right:\n                return {\n                    x: eleGeo.x + eleSize.width + xMargin,\n                    y: center? centeredY : eleGeo.y\n                }\n            case NextToPosition.above:\n                return {\n                    x: center? centeredX : eleGeo.x,\n                    y: eleGeo.y - yMargin - size.height,\n                }\n            case NextToPosition.below:\n                return {\n                    x: center? centeredX : eleGeo.x,\n                    y: eleGeo.y + eleSize.height + yMargin,\n                }\n            case NextToPosition.aboveLeft:\n                return {\n                    x: eleGeo.x - xMargin - size.width,\n                    y: eleGeo.y - yMargin - size.height,\n                }\n            case NextToPosition.aboveRight:\n                return {\n                    x: eleGeo.x + eleSize.width + xMargin,\n                    y: eleGeo.y - yMargin - size.height,\n                }\n            case NextToPosition.belowLeft:\n                return {\n                    x: eleGeo.x - xMargin - size.width,\n                    y: eleGeo.y + eleSize.height + yMargin,\n                }\n            case NextToPosition.belowRight:\n                return {\n                    x: eleGeo.x + eleSize.width + xMargin,\n                    y: eleGeo.y + eleSize.height + yMargin,\n                }\n        }\n\n        return {x: 0, y: 0};\n    }\n\n    private getSchemaFromDescription(element: Node): Schema {\n        const desc = element.getDescription();\n\n        const schema = Schema.fromString(desc);\n\n        if(schema.isEmpty()) {\n            return Schema.fromString('string')\n        }\n\n        return schema;\n    }\n\n    private expandIfNeeded(element: Node): void {\n        // tslint:disable-next-line:one-variable-per-declaration\n        let mostRight: number = 0, mostBottom: number = 0;\n\n        element.children().forEach(node => {\n            const graphNode = this.getNode(node.getId());\n\n            if(graphNode) {\n                node = graphNode;\n            }\n\n            const geo = node.getGeometry();\n\n            const size = node.getSize();\n\n\n            if(geo.x + size.width > mostRight || typeof mostRight === 'undefined') {\n                mostRight = geo.x + size.width;\n            }\n\n            if(geo.y + size.height > mostBottom || typeof mostBottom === 'undefined') {\n                mostBottom = geo.y + size.height;\n            }\n        })\n\n        const padding = 160;\n\n        if(mostRight === 0 && mostBottom === 0) {\n            return;\n        }\n\n        const minSize: NodeSize = {width: mostRight! + padding, height: mostBottom! + padding};\n\n        const eleSize = element.getSize();\n\n        if(minSize.width > eleSize.width || minSize.height > eleSize.height) {\n            this.resizeNode(element, {\n                width: Math.max(minSize.width, eleSize.width),\n                height: Math.max(minSize.height, eleSize.height)\n            });\n        }\n    }\n}\n\n// tslint:disable-next-line:max-classes-per-file\nexport class EmptyLayer implements Node {\n    public getId(): NodeId {\n        return '__EMPTY_LAYER__';\n    }\n\n    public getName(): NodeName {\n        return 'Empty Layer';\n    }\n\n    public getTechnicalName(): NodeName {\n        return this.getName();\n    }\n\n    public getFQCN(defaultService: string): NodeName {\n        return fqcn(this, false, false, true, defaultService);\n    }\n\n    public getTechnicalFQCN(defaultService: string): NodeName {\n        return fqcn(this, false, false, true, defaultService);\n    }\n\n    public getDescription(): NodeDescription {\n        return '';\n    }\n\n    public getType(): NodeType {\n        return NodeType.misc;\n    }\n\n    public getLink(): NodeLink | null {\n        return null;\n    }\n\n    public getTags(): List<NodeTag> {\n        return List();\n    }\n\n    public isLayer(): boolean {\n        return true;\n    }\n\n    public isDefaultLayer(): boolean {\n        return false;\n    }\n\n    public getParent(): Node | null {\n        return null;\n    }\n\n    public changeParent(parent: Node | null): Node {\n        // do nothing\n        return this;\n    }\n\n\n\n    public children(): List<Node> {\n        return List();\n    }\n\n    public getSources(): List<Node> {\n        return List();\n    }\n\n    public getTargets(): List<Node> {\n        return List();\n    }\n\n    public getMetadata(): string | null {\n        return null;\n    }\n\n    public getParsedMetadata(): {[metaKey: string]: any} {\n        return {};\n    }\n\n    public setChildren(children: List<Node>): Node {\n        return this;\n    }\n\n    public getGeometry(): GraphPoint {\n        return {x: 0, y: 0};\n    }\n\n    public getSize(): Size {\n        return {width: 0, height: 0};\n    }\n\n    public changeName(name: NodeName): EmptyLayer {\n        // do nothing\n        return this;\n    }\n\n    public changeMetadata(metadata: string): EmptyLayer {\n        // do nothing\n        return this;\n    }\n\n    public isEnabled(): boolean {\n        return true;\n    }\n\n    public changeGeometry(geometry: GraphPoint): Node {\n        // do nothing\n        return this;\n    }\n\n    public changeSize(size: Size): Node {\n        // do nothing\n        return this;\n    }\n\n    public getVersion(): number {\n        return 1;\n    }\n}\n\n// tslint:disable-next-line:max-classes-per-file\nclass EmptyGraph implements Graph {\n    private boardXml: string;\n\n    constructor(boardXml?: string) {\n        if(!boardXml) {\n            boardXml = '';\n        }\n\n        this.boardXml = boardXml;\n    }\n\n    public createCellId(): string {\n        return shortUUID().new();\n    }\n\n    public getCurrentScale(): number {\n        return 1.0;\n    }\n\n    public getCurrentTranslate(): GraphPoint {\n        return {x: 0, y: 0};\n    }\n\n    public onPanning(listener: PanningListener): void {\n        // no op\n    }\n\n    public offPanning(listener: PanningListener): void {\n        // no op\n    }\n\n    public translateMousePoint(x: number, y: number): GraphPoint {\n        return {x,y};\n    }\n\n    public onZoom(listener: ZoomListener): void {\n        // no op\n    }\n\n    public offZoom(listener: ZoomListener): void {\n        // no op\n    }\n\n    public getRoot(): Node {\n        return new EmptyLayer();\n    }\n\n    public openLayersDialog(): void {\n        // do nothing\n    }\n\n    public triggerCody(): void {\n        // do nothing\n    }\n\n    public selectNode(node: Node): boolean {\n        return false;\n    }\n\n    public focusNode(node: Node, animateScroll?: boolean): void {\n        // do nothing\n    }\n\n    public hasUserLevelVisibilityChanges(): boolean {\n        return false;\n    }\n\n    public isVisible(node: Node): boolean {\n        return false;\n    }\n\n    public setUserVisible(node: Node, visible: boolean): void {\n        // Do nothing\n    }\n\n    public applyVisibilityGlobally(): void {\n        // Do nothing\n    }\n\n    public isLocked(node: Node): boolean {\n        return false;\n    }\n\n    public setLocked(node: Node, locked: boolean): void {\n        // Do nothing\n    }\n\n    public addLayer(name: string): void {\n        // Do nothing\n    }\n\n    public deleteLayer(node: Node): void {\n        // Do nothing\n    }\n\n    public isActiveLayer(node: Node): boolean {\n        return false;\n    }\n\n    public setAsActiveLayer(node: Node): void {\n        // Do nothing\n    }\n\n    public setDefaultLayerAsActive(): void {\n        // Do nothing\n    }\n\n    public highlightLayer(node: Node): void {\n        // Do nothing\n    }\n\n    public addNode(node: Node): void {\n        // Do nothing\n    }\n\n    public getNode(nodeId: string): Node | null {\n        return null;\n    }\n\n    public addNodeNextToAnother(newNode: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean): void {\n        // Do nothing\n    }\n\n    public moveNodeNextToAnother(node: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean): void {\n        // Do nothing\n    }\n\n    public deleteNode(node: Node): void {\n        // Do nothing\n    }\n\n    public changeNodeName(node: Node, newName: string): void {\n        // Do nothing\n    }\n\n    public changeNodeDescription(node: Node, description: NodeDescription): void {\n        // Do nothing\n    }\n\n    public changeNodeLabel(node: Node, label: NodeLabel): void {\n        // Do nothing\n    }\n\n    public changeNodeMetadata(node: Node, metadata: NodeMetadata): void {\n        // Do nothing\n    }\n\n    public changeNodeTags(node: Node, tags: List<NodeTag>): void {\n        // Do nothing\n    }\n\n    public resizeNode(node: Node, size: Size): void {\n        // Do nothing\n    }\n\n    public moveNode(node: Node, toPosition: GraphPoint): void {\n        // Do nothing\n    }\n\n    public switchParent(node: Node, parent: Node | null, geo?: GraphPoint, expandIfNeeded?: boolean): void {\n        // Do nothing\n    }\n\n    public connectNodes(source: Node, target: Node, connectionLabel?: string, edgePoints?: GraphPoint[], invertCurve?: boolean): void {\n        // Do nothing\n    }\n\n    public highlightNodes(nodes: Node[]): void {\n        // Do nothing\n    }\n\n    public copySelectionToActiveLayer(): boolean {\n        return false;\n    }\n\n    public changeFeatureStatus(feature: Node, status: \"important\" | \"planned\" | \"ready\" | \"deployed\"): void {\n        // Do nothing\n    }\n\n    public getFeatureTaskLink(feature: Node): string | null {\n        return null;\n    }\n\n    public setFeatureTaskLink(feature: Node, link: string | null): void {\n        // Do nothing\n    }\n\n    public exportXmlSnapshot(): string {\n        return this.boardXml;\n    }\n\n    public onSelectionChanged(listener: (hasSelection: boolean) => void): void {\n        // Do nothing\n    }\n\n    public setCockpitBaseUrl(baseUrl: string): void {\n        // Do nothing\n    }\n\n    public focus(): void {\n        // Do nothing\n    }\n\n    public clearMoveVideoAvatarToPositionListener(): void {\n        // Do nothing\n    }\n\n    public onMoveVideoAvatarToPosition(listener: MoveVideoToPositionListener): void {\n        // Do nothing\n    }\n\n    public setVideoAvatarEnabled(enabled: boolean): void {\n        // Do nothing\n    }\n\n    public trackVideoAvatarPosition(x: number, y: number): void {\n        // Do nothing\n    }\n\n    public setCodyDownCb(cb: CodyCallback | null): void {\n        // Do nothing\n    }\n\n    public setCodyLeftCb(cb: CodyCallback | null): void {\n        // Do nothing\n    }\n\n    public setCodyRightCb(cb: CodyCallback | null): void {\n        // Do nothing\n    }\n\n    public setCodyUpCb(cb: CodyCallback | null): void {\n        // Do nothing\n    }\n\n    public openCodyWizard(runCody?: boolean): void {\n        // Do nothing\n    }\n\n    public mergeIntoSchema(source: Node, target: Node): void {\n        // Do nothing\n    }\n\n    public isEventModelingEnabled(): boolean {\n        return true;\n    }\n\n    public makeDraggable(ele: HTMLElement, nodeToDrop: Node): void {\n        // Do nothing\n    }\n\n    public makeActiveGraphElementIfPossible(node: Node): ActiveGraphElement | null {\n        return null;\n    }\n}\n\ninterface NodeRecordProps {\n    id: NodeId;\n    name: NodeName;\n    description: NodeDescription;\n    type: NodeType;\n    link: NodeLink | null;\n    tags: List<NodeTag>;\n    layer: boolean;\n    defaultLayer: boolean;\n    parent: Node | null;\n    childrenList: List<Node>;\n    sourcesList: List<Node>;\n    targetsList: List<Node>;\n    geometry: GraphPoint;\n    size: Size;\n    metadata: string | null;\n    parsedMetadata?: {[metaKey: string]: any};\n    enabled: boolean;\n    version?: number;\n}\n\ninterface RawNodeRecordProps {\n    id: NodeId;\n    name: NodeName;\n    description: NodeDescription;\n    type: NodeType;\n    link: NodeLink | null;\n    tags: string[];\n    layer: boolean;\n    defaultLayer: boolean;\n    parent: Node | null;\n    childrenList: Node[];\n    sourcesList: Node[];\n    targetsList: Node[];\n    geometry: {x: number, y: number};\n    size: {width: number, height: number};\n    metadata: string | null;\n    enabled: boolean;\n}\n\nconst defaultNodeRecordProps: NodeRecordProps = {\n    id: '',\n    name: '',\n    description: '',\n    type: NodeType.misc,\n    link: null,\n    tags: List(),\n    layer: false,\n    defaultLayer: false,\n    parent: null,\n    childrenList: List(),\n    sourcesList: List(),\n    targetsList: List(),\n    geometry: {x:0, y:0},\n    size: {width: 0, height: 0},\n    metadata: null,\n    enabled: true,\n    version: 1,\n};\n\nexport const makeNodeRecord = (node: Node, withoutParsedMetadata?: boolean, removeCommentsFromMetadata?: boolean): NodeRecord => {\n    let metadata = node.getMetadata();\n\n    if(removeCommentsFromMetadata && metadata) {\n        try {\n            // It removes comments from JSON\n            metadata = stringify(parse(metadata, undefined, true));\n        } catch (e) {\n            metadata = null;\n        }\n    }\n\n    return new NodeRecord({\n        id: node.getId(),\n        name: node.getName(),\n        description: node.getDescription(),\n        type: node.getType(),\n        link: node.getLink(),\n        tags: node.getTags(),\n        layer: node.isLayer(),\n        defaultLayer: node.isDefaultLayer(),\n        parent: node.getParent()? makeParentNodeRecord(node.getParent() as Node, node, withoutParsedMetadata, removeCommentsFromMetadata) : null,\n        childrenList: node.children().map(child => makeNodeRecord(child, withoutParsedMetadata, removeCommentsFromMetadata)),\n        sourcesList: node.getSources().map(s => makeConnectedNodeRecord(s, withoutParsedMetadata, removeCommentsFromMetadata)),\n        targetsList: node.getTargets().map(t => makeConnectedNodeRecord(t, withoutParsedMetadata, removeCommentsFromMetadata)),\n        geometry: new GraphPointRecord(node.getGeometry()),\n        size: new SizeRecord(node.getSize()),\n        metadata,\n        parsedMetadata: withoutParsedMetadata ? undefined : node.getParsedMetadata(),\n        enabled: node.isEnabled(),\n    });\n};\n\nconst makeConnectedNodeRecord = (node: Node, withoutParsedMetadata?: boolean, removeCommentsFromMetadata?: boolean): NodeRecord => {\n    let metadata = node.getMetadata();\n\n    if(removeCommentsFromMetadata && metadata) {\n        try {\n            // It removes comments from JSON\n            metadata = stringify(parse(metadata, undefined, true));\n        } catch (e) {\n            metadata = null;\n        }\n    }\n\n    return new NodeRecord({\n        id: node.getId(),\n        name: node.getName(),\n        description: node.getDescription(),\n        type: node.getType(),\n        link: node.getLink(),\n        tags: node.getTags(),\n        layer: node.isLayer(),\n        defaultLayer: node.isDefaultLayer(),\n        parent: node.getParent()? makeParentNodeRecord(node.getParent() as Node, node, withoutParsedMetadata, removeCommentsFromMetadata) : null,\n        childrenList: node.children().map(c => makeNodeRecord(c, withoutParsedMetadata, removeCommentsFromMetadata)),\n        sourcesList: List(),\n        targetsList: List(),\n        geometry: new GraphPointRecord(node.getGeometry()),\n        size: new SizeRecord(node.getSize()),\n        metadata,\n        parsedMetadata: withoutParsedMetadata ? undefined : node.getParsedMetadata(),\n        enabled: node.isEnabled(),\n    });\n};\n\nconst makeParentNodeRecord = (parent: Node, referencingChild: Node, withoutParsedMetadata?: boolean, removeCommentsFromMetadata?: boolean): NodeRecord => {\n    let metadata = parent.getMetadata();\n\n    if(removeCommentsFromMetadata && metadata) {\n        try {\n            // It removes comments from JSON\n            metadata = stringify(parse(metadata, undefined, true));\n        } catch (e) {\n            metadata = null;\n        }\n    }\n\n    return new NodeRecord({\n        id: parent.getId(),\n        name: parent.getName(),\n        description: parent.getDescription(),\n        type: parent.getType(),\n        link: parent.getLink(),\n        tags: parent.getTags(),\n        layer: parent.isLayer(),\n        defaultLayer: parent.isDefaultLayer(),\n        parent: parent.getParent()? makeParentNodeRecord(parent.getParent() as Node, parent, withoutParsedMetadata, removeCommentsFromMetadata) : null,\n        childrenList: List(),\n        sourcesList: List(),\n        targetsList: List(),\n        geometry: new GraphPointRecord(parent.getGeometry()),\n        size: new SizeRecord(parent.getSize()),\n        metadata,\n        parsedMetadata: withoutParsedMetadata ? undefined : parent.getParsedMetadata(),\n        enabled: parent.isEnabled()\n    });\n}\n\n// tslint:disable-next-line:max-classes-per-file\nclass NodeRecord extends Record(defaultNodeRecordProps) implements Node {\n\n    private parsedMetadataCache: {[metaKey: string]: any} | undefined = undefined;\n    private fqcnCache: NodeName | undefined = undefined;\n    private technicalFQCNCache: NodeName | undefined = undefined;\n    private typeCache: NodeType | undefined = undefined;\n    private technicalNameCache: NodeName | undefined = undefined;\n\n    public getId(): NodeId {\n        return this.id;\n    }\n\n    public getName(): NodeName {\n        return this.name;\n    }\n\n    public getTechnicalName(): NodeName {\n        if(!this.technicalNameCache) {\n            this.technicalNameCache = this.getParsedMetadata().$nodeName || this.getName();\n        }\n\n        return this.technicalNameCache as NodeName;\n    }\n\n    public getFQCN(defaultService: string): NodeName {\n        if(!this.fqcnCache) {\n            this.fqcnCache = fqcn(this, false, false, true, defaultService);\n        }\n        return this.fqcnCache;\n    }\n\n    public getTechnicalFQCN(defaultService: string): NodeName {\n        if(!this.technicalFQCNCache) {\n            this.technicalFQCNCache = fqcn(this, false, false, false, defaultService);\n        }\n        return this.technicalFQCNCache;\n    }\n\n    public changeName(name: NodeName): NodeRecord {\n        return this.set('name', name);\n    }\n\n    public getDescription(): NodeDescription {\n        return this.description;\n    }\n\n    public getType(): NodeType {\n        if(!this.typeCache) {\n            this.typeCache = this.getParsedMetadata().$nodeType || this.type;\n        }\n\n        return this.typeCache as NodeType;\n    }\n\n    public getLink(): NodeLink | null {\n        return this.link;\n    }\n\n    public getTags(): List<NodeTag> {\n        return this.tags;\n    }\n\n    public isLayer(): boolean {\n        return this.layer;\n    }\n\n    public isDefaultLayer(): boolean {\n        return this.defaultLayer;\n    }\n\n    public getParent(): Node | null {\n        return this.parent;\n    }\n\n    public changeParent(parent: Node | null): Node {\n        return this.set('parent', parent);\n    }\n\n    public children(): List<Node> {\n        return this.childrenList;\n    }\n\n    public getSources(): List<Node> {\n        return this.sourcesList;\n    }\n\n    public getTargets(): List<Node> {\n        return this.targetsList;\n    }\n\n    public getGeometry(): GraphPoint {\n        return this.geometry;\n    }\n\n    public getSize(): Size {\n        return this.size;\n    }\n\n    public getMetadata(): string | null {\n        return this.metadata;\n    }\n\n    public getParsedMetadata(): {[metaKey: string]: any} {\n        const parsed = this.get('parsedMetadata');\n\n        if(!parsed) {\n            if(!this.parsedMetadataCache) {\n                this.parsedMetadataCache = parseNodeMetadata(this);\n            }\n\n            return this.parsedMetadataCache;\n        }\n\n        return parsed;\n    }\n\n\n    public setChildren(children: List<Node>): Node {\n        return this.set('childrenList', children);\n    }\n\n    public changeMetadata(metadata: string): NodeRecord {\n        const copy = this.set('metadata', metadata);\n        return copy.set('parsedMetadata', Map(parseNodeMetadata(copy)));\n    }\n\n    public isEnabled(): boolean {\n        return this.get('enabled');\n    }\n\n    public changeGeometry(geometry: GraphPoint): Node {\n        return this.set('geometry', geometry);\n    }\n\n    public changeSize(size: Size): Node {\n        return this.set('size', size);\n    }\n\n    public getVersion(): number {\n        return this.get('version', 1) as number;\n    }\n}\n","import {isFailure} from \"../../core/validation/either\";\nimport {isStandalone, standaloneStorageManager} from \"../../standalone/util\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {deletePlayshot as apiDeletePlayshot, fetchPlayshot, savePlayshot as apiSavePlayshot} from \"../actions/api\";\nimport {BoardId} from \"../model/Board\";\nimport {createPlayshotFromServerData, Playshot, PlayshotId} from \"../model/Playshot\";\nimport {Playshot as PlayServerPlayshot} from \"./Cody/PlayServer\";\nimport {parse, stringify} from \"./json/json-comment-wrapper\";\n\nconst STORAGE_KEY = 'cody_playshots_';\n\ntype LocalPlayshot = PlayServerPlayshot & {savedAt: string, savedBy: UserId};\n\nexport const savePlayshot = async (playshot: PlayServerPlayshot): Promise<boolean> => {\n  if(isStandalone()) {\n    const storedPlayshots = loadLocalPlayshots(playshot.boardId);\n\n\n\n    storedPlayshots.push({...playshot, savedAt: (new Date()).toISOString(), savedBy: standaloneStorageManager.getUser().userId});\n\n    localStorage.setItem(STORAGE_KEY + playshot.boardId, stringify(storedPlayshots));\n    return true;\n  } else {\n    return apiSavePlayshot(playshot).then(res => !res.error);\n  }\n}\n\nexport const deletePlayshot = async (playshotId: PlayshotId, boardId: BoardId): Promise<boolean> => {\n  if(isStandalone()) {\n    const storedPlayshots = loadLocalPlayshots(boardId);\n\n    const filteredPlayshots = storedPlayshots.filter(p => p.playshotId !== playshotId);\n\n    localStorage.setItem(STORAGE_KEY + boardId, stringify(filteredPlayshots));\n\n    return true;\n  } else {\n    return apiDeletePlayshot(playshotId, boardId).then(res => !res.error);\n  }\n}\n\nexport const loadPlayshot = async (boardId: BoardId, playshotId: PlayshotId): Promise<Playshot> => {\n  if(isStandalone()) {\n    const storedShots = loadLocalPlayshots(boardId);\n\n    const shot = storedShots.find(s => s.playshotId === playshotId);\n\n    if(!shot) {\n      throw new Error(`Playshot with id ${playshotId} not found in local storage`);\n    }\n\n    return new Playshot(shot);\n  } else {\n    return fetchPlayshot(playshotId).then(res => {\n      if(res.error) {\n        console.error(res.error);\n        throw new Error(`Playshot with id ${playshotId} could not be loaded`);\n      }\n\n      const playshotResult = createPlayshotFromServerData(res.response!.data);\n\n      if(isFailure(playshotResult)) {\n        throw new Error(`Failed to parse playshot response: ${playshotResult.value}`);\n      }\n\n      return playshotResult.value;\n    })\n  }\n}\n\nexport const loadLocalPlayshots = (boardId: BoardId): LocalPlayshot[] => {\n  const key = STORAGE_KEY + boardId;\n\n  const shots = localStorage.getItem(key);\n\n  if(shots) {\n    try {\n      return parse(shots);\n    } catch (e) {\n      console.error('Failed to parse playshots from local storage: ', e);\n    }\n  }\n\n  return [];\n}\n\n\n","import v4 from \"uuid/v4\";\nimport {BoardId} from \"../../model/Board\";\nimport {CodyResponse} from \"../Cody\";\nimport {savePlayshot} from \"../playshot-storage\";\nimport {CodyServer} from \"./CodyServer\";\nimport {Either, execValidate, pipe} from \"../../../core/validation/either\";\nimport {hasKey} from \"../../../core/validation/predicates\";\nimport {parse, stringify} from \"../json/json-comment-wrapper\";\n\ninterface Message {\n  messageId: string;\n  messageName: string;\n  payload: any;\n}\n\ninterface Response {\n  responseTo: string;\n  codyResponse: CodyResponse;\n}\n\ninterface PlayCommand {\n  command: 'SavePlayshot';\n  payload: any;\n}\n\nexport interface Playshot {\n  playshotId: string;\n  boardId: string;\n  name: string;\n  playConfig: object;\n  playData: {\n    streams: object;\n    documents: object;\n  }\n}\n\nexport const validatePlayshot = (playshot: Playshot): Either<string, Playshot> => {\n  return pipe(\n    playshot,\n    execValidate([hasKey('playshotId'), \"playshotId is missing in playshot\"]),\n    execValidate([hasKey('boardId'), \"boardId is missing in playshot\"]),\n    execValidate([hasKey('name'), \"name is missing in playshot\"]),\n    execValidate([hasKey('playConfig'), \"playConfig is missing in playshot\"]),\n    execValidate([hasKey('playData'), \"playData is missing in playshot\"]),\n  )\n}\n\ntype PlayCommandListener = (msg: MessageEvent) => void;\n\nexport class PlayServer implements CodyServer {\n  public readonly name: string;\n  private playTab: typeof window | undefined;\n  private sync: boolean = false;\n  private playUrl: string;\n  private boardId: BoardId;\n  private playCommandListener: PlayCommandListener | undefined;\n  private connected = false;\n  private pendingMessages: Message[] = [];\n\n  public constructor(name: string, playUrl: string, boardId: BoardId) {\n    this.name = name;\n    this.playUrl = playUrl;\n    this.boardId = boardId;\n  }\n\n  public isSyncEnabled(): boolean {\n    return this.sync;\n  }\n\n  public enableSync(): void {\n    this.sync = true;\n  }\n\n  public async sendMessage(messageName: string, payload: any): Promise<CodyResponse> {\n    return this.postMessage(messageName, payload);\n  }\n\n  public async syncDeletedNodes(messageName: string, payload: any): Promise<CodyResponse> {\n    return this.postMessage(messageName, payload);\n  }\n\n  public async syncNodes(messageName: string, payload: any): Promise<CodyResponse> {\n    return this.postMessage(messageName, payload);\n  }\n\n  public async fullSync(messageName: string, payload: any): Promise<CodyResponse> {\n    return this.postMessage('FullSync', payload);\n  }\n\n  private async postMessage(messageName: string, payload: any): Promise<CodyResponse> {\n    await this.reconnectIfNeeded();\n\n    const message = this.makeMessage(messageName, payload);\n\n    const promise = this.attachListener(message);\n\n    if(this.playTab && this.connected) {\n      this.playTab.postMessage(stringify(message), this.playUrl);\n    } else {\n      console.log(\"[CodyPlayServer] server not ready. Going to queue message: \", message);\n      this.pendingMessages.push(message);\n    }\n\n    return promise;\n  }\n\n  private async reconnectIfNeeded(): Promise<void> {\n    if(this.playTab && !this.playTab.closed) {\n      return;\n    }\n\n    this.connected = false;\n\n    if(this.playCommandListener) {\n      window.removeEventListener('message', this.playCommandListener);\n    } else {\n      this.playCommandListener = (playCmd: MessageEvent) => {\n        if(playCmd.origin !== this.playUrl) {\n          // Ignore unknown\n          return;\n        }\n\n        try {\n          const parsedCmd: PlayCommand = parse(playCmd.data);\n\n          if(parsedCmd.command && parsedCmd.command === \"SavePlayshot\") {\n            this.handleSavePlayshot(parsedCmd.payload);\n          }\n        } catch (e) {\n          console.error(`[CodyPlayServer] Failed to parse Cody Play command`, e);\n        }\n      }\n    }\n\n    const playTab = window.open(this.playUrl + `?board=${this.boardId}`, 'CodyPlay');\n\n    if(!playTab) {\n      throw new Error(`Failed to open Cody Play tab. Probably blocked by browser. Please check your browser settings and plugins like AdBlock.`);\n    }\n\n    this.playTab = playTab;\n\n    return new Promise(resolve => {\n      const handshakeListener = (msg: MessageEvent) => {\n        if(msg.origin === this.playUrl) {\n          try {\n            const ping = JSON.parse(msg.data);\n\n            if(!ping.ping) {\n              return;\n            }\n\n            if(ping.ping !== '[CodyMessageServer]') {\n              return;\n            }\n          } catch (e) {\n            // ignore\n            return;\n          }\n\n          console.log(\"[CodyPlayServer] connected\");\n          this.connected = true;\n\n          const pendingMessages = this.pendingMessages;\n          this.pendingMessages = [];\n          pendingMessages.forEach(m => {\n            console.log(\"[CodyPlayServer] Sending queued message: \", m);\n            this.playTab!.postMessage(stringify(m), this.playUrl)\n          })\n\n          window.removeEventListener('message', handshakeListener);\n\n          if(this.playCommandListener) {\n            window.addEventListener('message', this.playCommandListener);\n          }\n\n          resolve();\n        }\n      }\n\n      window.addEventListener('message', handshakeListener);\n    })\n  }\n\n  private makeMessage(messageName: string, payload: any): Message {\n    return {\n      messageId: v4(),\n      messageName,\n      payload,\n    }\n  }\n\n  private handleSavePlayshot(playshot: Playshot): void {\n    console.log(\"[CodyPlayServer] Received a playshot: \", playshot);\n\n    savePlayshot(playshot).then(success => {\n      const playshotSaved = {\n        playshotId: playshot.playshotId,\n        success,\n      }\n\n      this.postMessage('PlayshotSaved', playshotSaved)\n        .then(codyResponse => console.log(codyResponse))\n        .catch(e => {console.error(e)});\n    })\n      .catch(e => {console.error(e)});\n  }\n\n  private attachListener(message: Message): Promise<CodyResponse> {\n    return new Promise<CodyResponse>(resolve => {\n      const listener = (res: MessageEvent) => {\n        if(res.origin !== this.playUrl) {\n          // Ignore unknown\n          return;\n        }\n\n        const parsedRes: Response = parse(res.data);\n\n        if(parsedRes.responseTo && parsedRes.responseTo === message.messageId) {\n          window.removeEventListener('message', listener);\n          resolve(parsedRes.codyResponse);\n        }\n      }\n\n      window.addEventListener('message', listener);\n    });\n  }\n}\n","import {AxiosPromise} from \"axios\";\nimport {\n    axiosApiPromise, boardImageDeletionApiPromise, boardImageReplacementApiPromise,\n    boardImageUploadApiPromise,\n    ResponseType\n} from '../../api/util';\nimport * as TeamModel from \"../../InspectioTeams/model/Team\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {UserModel} from \"../../User\";\nimport { BoardModel, BoardVersioning } from '../model';\nimport {BoardId, BoardXml} from \"../model/Board\";\nimport {GraphElementType} from \"../model/BoardGraphElement\";\nimport {BoardInvitationId} from \"../model/BoardInvitation\";\nimport {Permissions} from \"../model/BoardPermissionForUser\";\nimport {NodeType} from \"../model/Graph\";\nimport {TemplateSchema, TemplateType} from \"../model/StickyTemplate\";\nimport { SERVER_CONTEXT } from './constants';\nimport {List} from \"immutable\";\nimport {Playshot, validatePlayshot} from \"../service/Cody/PlayServer\";\nimport {PlayshotId} from \"../model/PlayshotSummary\";\nimport {isFailure} from \"../../core/validation/either\";\nimport {stringify} from \"../service/json/json-comment-wrapper\";\n\nexport const installOrganizationBoard = (\n    organizationId: OrganizationId,\n    boardId: BoardModel.BoardId,\n    boardName: BoardModel.BoardName,\n    boardAbbreviation: string,\n    tags: string[],\n    responsibleTeam?: TeamId,\n    codySuggestEnabled = true,\n    eventModelingEnabled = true\n): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'InstallOrganizationBoard', {organizationId, boardId, boardName, boardAbbreviation, tags, responsibleTeam, codySuggestEnabled, eventModelingEnabled});\n}\n\nexport const renameBoard = (boardId: BoardModel.BoardId, name: BoardModel.BoardName): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RenameBoard', {boardId, name});\n};\n\nexport const toggleCodySuggest = (boardId: BoardModel.BoardId, codySuggestEnabled: boolean): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ToggleCodySuggest', {boardId, codySuggestEnabled});\n}\n\nexport const toggleEventModeling = (boardId: BoardModel.BoardId, eventModelingEnabled: boolean): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ToggleEventModeling', {boardId, eventModelingEnabled});\n}\n\nexport const changeBoardAbbreviation = (boardId: BoardModel.BoardId, nameAbbreviation: string): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ChangeBoardAbbreviation', {boardId, nameAbbreviation});\n};\n\nexport const setBoardTags = (boardId: BoardModel.BoardId, tags: List<string>): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SetBoardTags', {boardId, tags: tags.toJSON()});\n};\n\nexport const changeResponsibleTeam = (boardId: BoardModel.BoardId, responsibleTeam?: TeamId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ChangeResponsibleTeam', {boardId, responsibleTeam: responsibleTeam || null});\n};\n\nexport const deleteBoard = (boardId: BoardModel.BoardId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'DeleteBoard', {boardId});\n};\n\nexport const takeBoardSnapshot = (boardId: BoardModel.BoardId, boardVersion: BoardVersioning.BoardVersion, content: BoardModel.BoardXml) => {\n    return axiosApiPromise(\n        SERVER_CONTEXT + 'TakeBoardSnapshot',\n        {boardId, boardVersion: {userId: boardVersion.userId, version: boardVersion.version}, content});\n};\n\nexport const shareBoard = (boardId: BoardModel.BoardId, email: UserModel.Email, permissions?: Permissions): Promise<ResponseType> => {\n    return axiosApiPromise(\n        SERVER_CONTEXT + 'ShareBoardWithUser',\n        {boardId, invitedUser: email, boardPermissions: (permissions || {writeAccess: true, readAccess: true, adminAccess: false})}\n    )\n};\n\nexport const resendBoardInvitation = (invitationId: BoardInvitationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ResendBoardInvitation', { invitationId });\n};\n\nexport const revokeBoardInvitation = (invitationId: BoardInvitationId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RevokeBoardInvitation', { invitationId });\n};\n\nexport const ackBoardInvitation = (invitationId: BoardInvitationId): Promise<ResponseType> => {\n    return axiosApiPromise(\n        SERVER_CONTEXT + 'AcknowledgeInvitation',\n        {invitationId}\n    )\n};\n\nexport const revokeAccessToBoard = (boardId: BoardModel.BoardId, userId: UserModel.UserId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RevokeAccessToBoard', {boardId, userId});\n};\n\nexport const changeBoardPermissions = (boardId: BoardModel.BoardId, userId: UserModel.UserId, permissions: Permissions): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ChangeBoardPermissions', {boardId, userId, boardPermissions: permissions});\n};\n\nexport const adminChangeTeamBoardPermissions = (boardId: BoardModel.BoardId, teamId: TeamModel.TeamId, permissions: Permissions): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'AdminChangeTeamBoardPermissions', {boardId, teamId, boardPermissions: permissions});\n}\n\nexport const fetchUserBoard = (boardId: BoardModel.BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'UserBoard', {boardId});\n};\n\nexport const fetchUserBoards = () => {\n    return axiosApiPromise(SERVER_CONTEXT + 'UserBoards', {});\n};\n\nexport const fetchOlderPatches = (boardId: BoardModel.BoardId, boardVersion: BoardVersioning.BoardVersion) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardHistory', {boardId, fromBoardVersion: boardVersion.toJSON()});\n};\n\nexport const fetchNewerPatches = (boardId: BoardModel.BoardId, boardVersion: BoardVersioning.BoardVersion) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardHistory', {boardId, fromBoardVersion: boardVersion.toJSON(), mode: \"newer\"});\n};\n\nexport const fetchBoardPermissionsForUsers = (boardId: BoardModel.BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardPermissionsForUsers', { boardId });\n};\n\nexport const fetchBoardPermissionsForTeams = (boardId: BoardModel.BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardPermissionsForTeams', { boardId });\n};\n\nexport const fetchOpenBoardInvitations = (boardId: BoardModel.BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'OpenBoardInvitations', { boardId });\n};\n\nexport const fetchBoardOfInvitation = (invitationId: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'InvitationBoard', {invitationId});\n};\n\nexport const fetchBoardXmlFromLink = (link: string): Promise<BoardXml> => {\n    return fetch(link).then(response => response.text());\n}\n\nexport const fetchPlayshotFromLink = (link: string): Promise<Playshot> => {\n    return fetch(link).then(response => response.json()).then((playshot: Playshot) => {\n        return new Promise<Playshot>((resolve, reject) => {\n            const result = validatePlayshot(playshot);\n\n            if(isFailure(result)) {\n                reject(result.value)\n            } else {\n                resolve(result.value);\n            }\n        })\n    });\n}\n\nexport const uploadBoardImage = (boardId: BoardId, imageContent: string|ArrayBuffer, mimeType: string): AxiosPromise<{imageId: string}> => {\n    return boardImageUploadApiPromise(boardId, imageContent, mimeType);\n};\n\nexport const replaceBoardImage = (boardId: BoardId, imageId: string, imageContent: string|ArrayBuffer, mimeType: string): AxiosPromise<{imageId: string}> => {\n    return boardImageReplacementApiPromise(boardId, imageId, imageContent, mimeType);\n};\n\nexport const deleteBoardImage = (imageUrl: string): AxiosPromise<any> => {\n    return boardImageDeletionApiPromise(imageUrl);\n};\n\nexport const fetchBoardGraphElements = (boardId: BoardId, type: GraphElementType) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardGraphElements', { boardId, type });\n};\n\nexport const fetchBoardClient = (boardId: BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardClient', { boardId });\n};\n\nexport const fetchBoardClientSecret = (boardId: BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'BoardClientSecret', { boardId });\n};\n\nexport const createBoardClient = (boardId: BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'CreateBoardClient', { boardId });\n};\n\nexport const removeBoardClient = (boardId: BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RemoveBoardClient', { boardId });\n};\n\nexport const resetBoardClientSecret = (boardId: BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ResetBoardClientSecret', { boardId });\n};\n\nexport const fetchBoardStickyTemplates = (boardId: BoardModel.BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'StickyTemplates', { boardId });\n};\n\nexport const setStickyTemplate = (boardId: BoardModel.BoardId, cellType: NodeType, template: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SetStickyTemplate', {boardId, cellType, template});\n}\n\nexport const updateStickyAdvancedConfig = (boardId: BoardModel.BoardId, cellType: NodeType, templateType: TemplateType, templateSchema?: TemplateSchema) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'UpdateStickyAdvancedConfig', {boardId, cellType, templateType, ...(templateSchema ? {templateSchema} : {})});\n}\n\nexport const moveUserBoardToOrganization = (organizationId: OrganizationId, boardId: BoardId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'MoveUserBoardToOrganization', {organizationId, boardId});\n}\n\nexport const shareBoardWithOrganizationMembers = (boardId: BoardModel.BoardId, permissions: Permissions): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ShareBoardWithOrganizationMembers', {boardId, permissions});\n}\n\nexport const shareBoardWithAnyone = (boardId: BoardModel.BoardId, permissions: Permissions): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ShareBoardWithAnyone', {boardId, permissions});\n}\n\nexport const checkBoardAccess = (boardId: BoardModel.BoardId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'CheckBoardAccess', {boardId});\n}\n\nexport const savePlayshot = (playshot: Playshot) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SavePlayshot', {\n        playshotId: playshot.playshotId,\n        boardId: playshot.boardId,\n        name: playshot.name,\n        playConfig: stringify(playshot.playConfig),\n        playData: JSON.stringify(playshot.playData),\n    })\n}\n\nexport const deletePlayshot = (playshotId: PlayshotId, boardId: BoardId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'DeletePlayshot', {\n        playshotId,\n        boardId,\n    })\n}\n\nexport const fetchPlayshots = (boardId: BoardId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'PlayshotSummaryList', {boardId});\n}\n\nexport const fetchPlayshot = (playshotId: PlayshotId): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'Playshot', {playshotId});\n}\n","import {History} from \"history\";\nimport {List} from \"immutable\";\nimport { action } from 'typesafe-actions';\nimport {Model as TeamModel} from \"../../InspectioTeams\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {UserModel} from '../../User';\nimport { BoardModel, BoardSnapshot } from '../model';\nimport {BoardId} from \"../model/Board\";\nimport {BoardInvitationId} from \"../model/BoardInvitation\";\nimport {Permissions} from \"../model/BoardPermissionForUser\";\nimport {BoardVersion} from \"../model/BoardVersion\";\nimport {Graph, Node, NodeType} from \"../model/Graph\";\nimport {BoardHistory} from \"../model/HistoryEntry\";\nimport {StickyTemplate, TemplateSchema, TemplateType} from \"../model/StickyTemplate\";\nimport {\n    ABORT_BOARD_DELETION,\n    ADD_BOARD,\n    ADMIN_CHANGE_TEAM_BOARD_PERMISSIONS,\n    APPEND_HISTORY_ENTRIES,\n    CHANGE_BOARD_ABBREVIATION,\n    CHANGE_BOARD_PERMISSIONS,\n    CHANGE_RESPONSIBLE_TEAM,\n    CLEAR_BOARD_HISTORY,\n    CONFIRM_DELETE_BOARD,\n    CREATE_BOARD_CLIENT,\n    DELETE_BOARD,\n    DISMISS_MAINTENANCE_MESSAGE,\n    FILTER_BOARD_OVERVIEW,\n    FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM,\n    FILTER_ELEMENTS_TREE,\n    FORCE_UPDATE_BOARDS,\n    HIDE_OWN_BOARDS_ON_OVERVIEW,\n    HIDE_SHARED_BOARDS_ON_OVERVIEW,\n    IMPORT_EXISTING_BOARD,\n    IMPORT_NEW_BOARD,\n    IMPORT_STICKY_TEMPLATES,\n    LOAD_FIRST_BOARD_HISTORY_CHUNK,\n    LOAD_NEXT_BOARD_HISTORY_CHUNK,\n    MOVE_USER_BOARD_TO_ORGANIZATION,\n    PREPEND_HISTORY_ENTRIES,\n    REMOVE_BOARD_CLIENT,\n    RENAME_BOARD,\n    RESEND_BOARD_INVITATION,\n    RESET_BOARD_CLIENT_SECRET,\n    REVOKE_ACCESS_TO_BOARD,\n    REVOKE_BOARD_INVITATION,\n    SAVE_BOARD,\n    SET_BOARD_DETAILS_FETCHED,\n    SET_BOARD_TAGS,\n    SET_BOARD_TO_SNAPSHOT,\n    SET_IS_LOADING_HISTORY,\n    SET_NO_MORE_HISTORY_AVAILABLE,\n    SET_STICKY_TEMPLATE,\n    SHARE_BOARD,\n    SHARE_BOARD_WITH_ANYONE,\n    SHARE_BOARD_WITH_ORGANIZATION_MEMBERS,\n    SORT_BOARD_OVERVIEW,\n    TOGGLE_BOARD_HISTORY,\n    TOGGLE_CODY_CONSOLE,\n    TOGGLE_CODY_SUGGEST_ENABLED,\n    TOGGLE_ELEMENT_DETAILS,\n    TOGGLE_EVENT_MODELING_ENABLED,\n    TOGGLE_PLAYSHOT_MODAL,\n    TOGGLE_TIMER_MODAL,\n    TOGGLE_VIDEO_SESSION,\n    TRIGGER_EXPORT_BOARD,\n    TRIGGER_IMPORT_BOARD,\n    UPDATE_BOARD_ELEMENTS_TREE,\n    UPDATE_BOARDS,\n    UPDATE_STICKY_ADVANCED_CONFIG\n} from './constants';\nimport {SORT_OPTIONS} from \"../components/BoardOverview/Sorting\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\n\nexport const addBoard = (board: BoardModel.Board, history: History<any>) => action(ADD_BOARD, {board, history});\nexport const updateBoards = (boards: BoardModel.Board[]) => action(UPDATE_BOARDS, boards);\nexport const forceUpdateBoards = (boards: BoardModel.Board[]) => action(FORCE_UPDATE_BOARDS, boards);\nexport const setBoardToSnapshot = (snapshot: BoardSnapshot.BoardSnapshot) => action(SET_BOARD_TO_SNAPSHOT, {snapshot});\nexport const setBoardDetailsFetched = (boardId: BoardModel.BoardId, writeAccess: boolean) => action(SET_BOARD_DETAILS_FETCHED, {boardId, writeAccess});\n\nexport const triggerImportBoard = (boardId: BoardModel.BoardId) => action(TRIGGER_IMPORT_BOARD, {boardId});\nexport const triggerExportBoard = (boardId: BoardModel.BoardId) => action(TRIGGER_EXPORT_BOARD, {boardId});\nexport const toggleBoardHistory = (boardId: BoardModel.BoardId, visible: boolean) => action(TOGGLE_BOARD_HISTORY, {boardId, visible});\nexport const toggleElementDetails = (boardId: BoardModel.BoardId, visible: boolean, focusEditor: boolean) => action(TOGGLE_ELEMENT_DETAILS, {boardId, visible, focusEditor});\nexport const toggleCodyConsole = (boardId: BoardModel.BoardId, visible: boolean) => action(TOGGLE_CODY_CONSOLE, {boardId, visible});\nexport const togglePlayshotModal = (boardId: BoardModel.BoardId, visible: boolean) => action(TOGGLE_PLAYSHOT_MODAL, {boardId, visible});\nexport const toggleTimerModal = (boardId: BoardModel.BoardId, visible: boolean) => action(TOGGLE_TIMER_MODAL, {boardId, visible});\nexport const toggleVideoSession = (boardId: BoardModel.BoardId, active: boolean) => action(TOGGLE_VIDEO_SESSION, {boardId, active});\nexport const appendHistoryEntries = (boardId: BoardModel.BoardId, entries: BoardHistory) => action(APPEND_HISTORY_ENTRIES, {boardId, entries});\nexport const prependHistoryEntries = (boardId: BoardModel.BoardId, entries: BoardHistory) => action(PREPEND_HISTORY_ENTRIES, {boardId, entries});\nexport const clearBoardHistory = (boardId: BoardModel.BoardId) => action(CLEAR_BOARD_HISTORY, {boardId});\nexport const loadNextBoardHistoryChunk = (boardId: BoardModel.BoardId, boardVersion: BoardVersion) => action(LOAD_NEXT_BOARD_HISTORY_CHUNK, {boardId, boardVersion});\nexport const loadFirstBoardHistoryChunk = (boardId: BoardModel.BoardId) => action(LOAD_FIRST_BOARD_HISTORY_CHUNK, {boardId});\nexport const setNoMoreHistoryAvailable = (boardId: BoardModel.BoardId) => action(SET_NO_MORE_HISTORY_AVAILABLE, {boardId});\nexport const setIsLoadingHistory = (boardId: BoardModel.BoardId, loading: boolean) => action(SET_IS_LOADING_HISTORY, {boardId, loading});\n\n\nexport const filterBoardOverview = (filter: string) => action(FILTER_BOARD_OVERVIEW, {filter});\nexport const sortBoardOverview = (sort: SORT_OPTIONS) => action(SORT_BOARD_OVERVIEW, {sort});\nexport const filterBoardOverviewByResponsibleTeam = (teamId: TeamId | undefined) => action(FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM, {teamId});\nexport const hideSharedBoardsOnOverview = (hide: boolean) => action(HIDE_SHARED_BOARDS_ON_OVERVIEW, {hide});\nexport const hideOwnBoardsOnOverview = (hide: boolean) => action(HIDE_OWN_BOARDS_ON_OVERVIEW, {hide});\nexport const filterElementsTree = (boardId: BoardId, filter: string, focus?: boolean) => action(FILTER_ELEMENTS_TREE, {boardId, filter, focus});\n\nexport const saveBoard = (board: BoardModel.Board, graph: Graph) => action(SAVE_BOARD, {board, graph});\nexport const renameBoard = (board: BoardModel.Board) => action(RENAME_BOARD, {board});\nexport const changeBoardAbbreviation = (board: BoardModel.Board) => action(CHANGE_BOARD_ABBREVIATION, {board});\nexport const setBoardTags = (board: BoardModel.Board) => action(SET_BOARD_TAGS, {board});\nexport const changeResponsibleTeam = (board: BoardModel.Board) => action(CHANGE_RESPONSIBLE_TEAM, {board});\nexport const importNewBoard = (boardName: string, boardXml: string, boardId?: BoardId, importTemporary?: boolean) => action(IMPORT_NEW_BOARD, {boardName, boardXml, boardId, importTemporary});\nexport const importExistingBoard = (board: BoardModel.Board) => action(IMPORT_EXISTING_BOARD, {board});\nexport const toggleCodySuggestEnabled = (board: BoardModel.Board) => action(TOGGLE_CODY_SUGGEST_ENABLED, {board});\n\nexport const toggleEventModelingEnabled = (board: BoardModel.Board) => action(TOGGLE_EVENT_MODELING_ENABLED, {board});\n\nexport const confirmDeleteBoard = (boardId: string) => action(CONFIRM_DELETE_BOARD, {boardId});\n\nexport const abortBoardDeletion = (boardId: string) => action(ABORT_BOARD_DELETION, {boardId});\n\nexport const deleteBoard = (boardId: BoardModel.BoardId) => action(DELETE_BOARD, {boardId});\n\nexport const shareBoard = (boardId: BoardModel.BoardId, email: UserModel.Email, permissions?: Permissions) => action(SHARE_BOARD, {boardId, email, permissions});\nexport const resendBoardInvitation = (invitationId: BoardInvitationId) => action(RESEND_BOARD_INVITATION,{invitationId});\nexport const revokeBoardInvitation = (invitationId: BoardInvitationId) => action(REVOKE_BOARD_INVITATION, {invitationId});\nexport const revokeAccessToBoard = (boardId: BoardModel.BoardId, userId: UserModel.UserId) => action(REVOKE_ACCESS_TO_BOARD, {boardId, userId});\nexport const changeBoardPermissions = (boardId: BoardModel.BoardId, userId: UserModel.UserId, permissions: Permissions) => action(CHANGE_BOARD_PERMISSIONS, {boardId, userId, permissions});\nexport const adminChangeTeamBoardPermissions = (boardId: BoardModel.BoardId, teamId: TeamModel.Team.TeamId, permissions: Permissions) => action(ADMIN_CHANGE_TEAM_BOARD_PERMISSIONS, {boardId, teamId, permissions});\nexport const shareBoardWithOrganizationMembers = (boardId: BoardId, permissions: Permissions) => action(SHARE_BOARD_WITH_ORGANIZATION_MEMBERS, {boardId, permissions});\nexport const shareBoardWithAnyone = (boardId: BoardId, permissions: Permissions) => action(SHARE_BOARD_WITH_ANYONE, {boardId, permissions});\n\nexport const updateBoardElementsTree = (boardId: BoardModel.BoardId, elements: List<Node>) => action(UPDATE_BOARD_ELEMENTS_TREE, {boardId, elements});\n\nexport const createBoardClient = (boardId: BoardModel.BoardId) => action(CREATE_BOARD_CLIENT, {boardId});\nexport const removeBoardClient = (boardId: BoardModel.BoardId) => action(REMOVE_BOARD_CLIENT, {boardId});\nexport const resetBoardClientSecret = (boardId: BoardModel.BoardId) => action(RESET_BOARD_CLIENT_SECRET, {boardId});\n\nexport const setStickyTemplate = (boardId: BoardModel.BoardId, cellType: NodeType, template: string, disableNotification?: boolean) => action(SET_STICKY_TEMPLATE, {boardId, cellType, template, disableNotification});\nexport const updateStickyAdvancedConfig = (boardId: BoardModel.BoardId, cellType: NodeType, templateType: TemplateType, templateSchema?: TemplateSchema, disableNotification?: boolean) => action(UPDATE_STICKY_ADVANCED_CONFIG, {boardId, cellType, templateType, templateSchema, disableNotification});\nexport const importStickyTemplates = (boardId: BoardModel.BoardId, stickyTemplates: List<StickyTemplate>, finishedCb: () => void) => action(IMPORT_STICKY_TEMPLATES, {boardId, stickyTemplates, finishedCb});\n\nexport const moveUserBoardToOrganization = (organizationId: OrganizationId, boardId: BoardId) => action(MOVE_USER_BOARD_TO_ORGANIZATION, {organizationId, boardId});\n\nexport const dismissMaintenanceMessage = () => action(DISMISS_MAINTENANCE_MESSAGE, {});\n","import {List} from \"immutable\";\nimport { action } from 'typesafe-actions';\nimport * as Socket from '../../Socket';\nimport {UserModel} from \"../../User/model\";\nimport {BoardGraphElement, BoardInvitation, BoardPermissionForTeam, BoardPermissionForUser} from \"../model\";\nimport { BoardSync } from '../model';\nimport {Board, BoardId} from \"../model/Board\";\nimport {BoardClient} from \"../model/BoardClient\";\nimport {Permissions} from \"../model/BoardPermissionForUser\";\nimport {Graph} from \"../model/Graph\";\nimport {StickyTemplate} from \"../model/StickyTemplate\";\nimport {ActiveGraphElement} from \"../reducers/applyActiveGraphElementActions\";\nimport {\n    ACTIVE_GRAPH_ELEMENT_CHANGED,\n    ACTIVE_GRAPH_ELEMENT_LABEL_CHANGED,\n    ACTIVE_GRAPH_ELEMENT_METADATA_CHANGED,\n    BOARD_ACCESS_REVOKED,\n    BOARD_CLIENT_FETCHED,\n    BOARD_CLIENT_NOT_CONFIGURED,\n    BOARD_CLIENT_SECRET_FETCHED,\n    BOARD_EXPORTED,\n    BOARD_GRAPH_ELEMENTS_FETCHED,\n    BOARD_IMPORT_STARTED,\n    BOARD_IMPORTED,\n    BOARD_INITIALIZED,\n    BOARD_INVITATION_RESENT,\n    BOARD_INVITATION_REVOKED,\n    BOARD_INVITATION_SENT,\n    BOARD_PERMISSIONS_CHANGED,\n    BOARD_PERMISSIONS_FOR_TEAMS_FETCHED,\n    BOARD_PERMISSIONS_FOR_USERS_FETCHED, BOARD_SHARED_WITH_ANYONE,\n    BOARD_SHARED_WITH_ORGANIZATION_MEMBERS,\n    BOARD_STICKY_TEMPLATES_FETCHED,\n    INITIAL_BOARD_LIST_LOADED,\n    LOCAL_BOARD_CHANGED,\n    LOCAL_BOARD_UPDATED_WITH_REMOTE_CHANGE,\n    OPEN_BOARD_INVITATIONS_FETCHED, PLAYSHOT_SUMMARY_LIST_FETCHED,\n    REMOTE_BOARD_CHANGED, RUN_CODY_ON_CHANGED,\n    STICKY_ADVANCED_CONFIG_UPDATED,\n    STICKY_TEMPLATE_SET,\n    STICKY_TEMPLATES_IMPORTED,\n    TEAM_BOARD_PERMISSIONS_CHANGED,\n    USER_BOARD_MOVED_TO_ORGANIZATION\n} from './constants';\nimport {RunCodyOption} from \"../reducers/RunCodyOn\";\nimport {PlayshotSummary} from \"../model/PlayshotSummary\";\n\nexport const remoteBoardChanged = (boardChanged: BoardSync.BoardChanged) => action(REMOTE_BOARD_CHANGED, {boardChanged});\n\nexport const localBoardChanged = (boardChanged: BoardSync.BoardChanged) => action(LOCAL_BOARD_CHANGED, {boardChanged});\n\nexport const boardImportStarted = (boardId: BoardId) => action(BOARD_IMPORT_STARTED, {boardId});\nexport const boardImported = (boardId: BoardId, board: Board, graph: Graph) => action(BOARD_IMPORTED, {boardId, board, graph});\nexport const boardExported = (boardId: BoardId) => action(BOARD_EXPORTED, {boardId});\nexport const boardInitialized = (board: Board, graph: Graph) => action(BOARD_INITIALIZED, {board, graph});\n\nexport const initialBoardListLoaded = () => action(INITIAL_BOARD_LIST_LOADED);\n\nexport const localBoardUpdatedWithRemoteChange = (boardId: BoardId, board: Board, graph: Graph) => action(LOCAL_BOARD_UPDATED_WITH_REMOTE_CHANGE, {boardId, board, graph});\n\nexport const boardInvitationSent = (boardInvitation: BoardInvitation.BoardInvitation) => action(BOARD_INVITATION_SENT, {boardInvitation});\nexport const boardInvitationResent = (boardInvitation: BoardInvitation.BoardInvitation) => action(BOARD_INVITATION_RESENT, {boardInvitation});\nexport const boardInvitationRevoked = (boardInvitation: BoardInvitation.BoardInvitation) => action(BOARD_INVITATION_REVOKED, {boardInvitation});\nexport const boardAccessRevoked = (boardId: BoardId, userId: UserModel.UserId) => action(BOARD_ACCESS_REVOKED, {boardId, userId});\nexport const boardPermissionsChanged = (boardId: BoardId, userId: UserModel.UserId, permissions: Permissions) => action(BOARD_PERMISSIONS_CHANGED, {boardId, userId, permissions});\nexport const teamBoardPermissionsChanged = (boardPermission: BoardPermissionForTeam.BoardPermissionForTeam) => action(TEAM_BOARD_PERMISSIONS_CHANGED, boardPermission);\nexport const boardSharedWithOrganizationMembers = (boardId: BoardId, permissions: Permissions) => action(BOARD_SHARED_WITH_ORGANIZATION_MEMBERS, {boardId, permissions});\nexport const boardSharedWithAnyone = (boardId: BoardId, permissions: Permissions) => action(BOARD_SHARED_WITH_ANYONE, {boardId, permissions});\n\nexport const boardPermissionsForUsersFetched = (boardPermissions: List<BoardPermissionForUser.BoardPermissionForUser>) =>\n    action(BOARD_PERMISSIONS_FOR_USERS_FETCHED, {boardPermissions});\n\nexport const boardPermissionsForTeamsFetched = (boardPermissions: List<BoardPermissionForTeam.BoardPermissionForTeam>) =>\n    action(BOARD_PERMISSIONS_FOR_TEAMS_FETCHED, {boardPermissions});\n\nexport const openBoardInvitationsFetched = (boardInvitations: List<BoardInvitation.BoardInvitation>) => action(OPEN_BOARD_INVITATIONS_FETCHED, {boardInvitations});\n\nexport const playshotSummaryListFetched = (summaries: List<PlayshotSummary>) => action(PLAYSHOT_SUMMARY_LIST_FETCHED, {summaries});\n\nexport const activeGraphElementChanged = (boardId: BoardId, element: ActiveGraphElement | undefined) => action(ACTIVE_GRAPH_ELEMENT_CHANGED, {boardId, element});\nexport const activeGraphElementLabelChanged = (boardId: BoardId, elementId: string, label: string) => action(ACTIVE_GRAPH_ELEMENT_LABEL_CHANGED, {boardId, elementId, label});\nexport const activeGraphElementMetadataChanged = (boardId: BoardId, elementId: string, metadata: string | undefined) => action(ACTIVE_GRAPH_ELEMENT_METADATA_CHANGED, {boardId, elementId, metadata});\nexport const boardGraphElementsFetched = (boardId: BoardId, elements: List<BoardGraphElement.BoardGraphElement>) => action(BOARD_GRAPH_ELEMENTS_FETCHED, { boardId, elements });\nexport const boardClientFetched = (boardId: BoardId, client: BoardClient) => action(BOARD_CLIENT_FETCHED, { boardId, client });\nexport const boardClientNotConfigured = (boardId: BoardId) => action(BOARD_CLIENT_NOT_CONFIGURED, { boardId });\nexport const boardClientSecretFetched = (boardId: BoardId, clientSecret: string) => action(BOARD_CLIENT_SECRET_FETCHED, { boardId, clientSecret });\n\nexport const boardStickyTemplatesFetched = (stickyTemplates: List<StickyTemplate>) => action(BOARD_STICKY_TEMPLATES_FETCHED, {stickyTemplates});\nexport const stickyTemplateSet = (stickyTemplate: StickyTemplate) => action(STICKY_TEMPLATE_SET, {stickyTemplate});\nexport const stickyAdvancedConfigUpdated = (stickyTemplate: StickyTemplate) => action(STICKY_ADVANCED_CONFIG_UPDATED, {stickyTemplate});\nexport const stickyTemplatesImported = (stickyTemplates: List<StickyTemplate>) => action(STICKY_TEMPLATES_IMPORTED, {stickyTemplates});\nexport const userBoardMovedToOrganization = (board: Board) => action(USER_BOARD_MOVED_TO_ORGANIZATION, board);\n\nexport const runCodyOnChanged = (runCodyOn: RunCodyOption) => action(RUN_CODY_ON_CHANGED, {runCodyOn});\n","import {action} from \"typesafe-actions\";\nimport {BoardModel} from '../model';\nimport {GraphElementType} from \"../model/BoardGraphElement\";\nimport {\n    FETCH_BOARD_CLIENT,\n    FETCH_BOARD_CLIENT_SECRET,\n    FETCH_BOARD_GRAPH_ELEMENTS,\n    FETCH_BOARD_PERMISSIONS_FOR_TEAMS,\n    FETCH_BOARD_PERMISSIONS_FOR_USERS,\n    FETCH_BOARD_STICKY_TEMPLATES,\n    FETCH_OPEN_BOARD_INVITATIONS,\n    FETCH_PLAYSHOT_SUMMARY_LIST,\n    FETCH_USER_BOARD,\n    FETCH_USER_BOARDS,\n    START_FETCH_USER_BOARDS\n} from './constants';\n\nexport const startFetchUserBoards = () => action(START_FETCH_USER_BOARDS);\n\nexport const fetchUserBoards = () => action(FETCH_USER_BOARDS);\n\nexport const fetchUserBoard = (boardId: BoardModel.BoardId) => action(FETCH_USER_BOARD, {boardId});\n\nexport const fetchBoardPermissionsForUsers = (boardId: BoardModel.BoardId) => action(FETCH_BOARD_PERMISSIONS_FOR_USERS, {boardId});\n\nexport const fetchBoardPermissionsForTeams = (boardId: BoardModel.BoardId) => action(FETCH_BOARD_PERMISSIONS_FOR_TEAMS, {boardId});\n\nexport const fetchOpenBoardInvitations = (boardId: BoardModel.BoardId) => action(FETCH_OPEN_BOARD_INVITATIONS, {boardId});\n\nexport const fetchBoardGraphElements = (boardId: BoardModel.BoardId, type: GraphElementType) => action(FETCH_BOARD_GRAPH_ELEMENTS, {boardId, type});\n\nexport const fetchBoardClient = (boardId: BoardModel.BoardId) => action(FETCH_BOARD_CLIENT, {boardId});\n\nexport const fetchBoardClientSecret = (boardId: BoardModel.BoardId) => action(FETCH_BOARD_CLIENT_SECRET, {boardId});\n\nexport const fetchBoardStickyTemplates = (boardId: BoardModel.BoardId) => action(FETCH_BOARD_STICKY_TEMPLATES, {boardId});\n\nexport const fetchPlayshotSummaryList = (boardId: BoardModel.BoardId) => action(FETCH_PLAYSHOT_SUMMARY_LIST, {boardId});\n","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport * as User from \"../../User\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {MODULE} from \"../index\";\nimport {OrganizationId} from \"../model/Organization\";\nimport {UserOrganizationInfo} from \"../model/UserOrganizationInfo\";\n\nexport const getUserOrganizationInfoById = (state: Record<ApplicationState>, uid: OrganizationId): UserOrganizationInfo | undefined => state.getIn([MODULE, 'UserOrganizationInfo', uid]);\n\nexport const makeUserOrganizationInfoSelector = (uid: OrganizationId): (state: Record<ApplicationState>) => UserOrganizationInfo | undefined => (state: Record<ApplicationState>) => getUserOrganizationInfoById(state, uid);\n\nexport const userOrganizationInfoListSelector = (state: Record<ApplicationState>, props: any): List<UserOrganizationInfo> =>\n    List(state.getIn([MODULE, 'UserOrganizationInfo']).toIndexedSeq().toArray()) || List();\n\nexport const makeUserOrganizationInfoListSelector = (userId: UserId): (state: Record<ApplicationState>, props?: any) => List<UserOrganizationInfo> => {\n    return createSelector(\n        [userOrganizationInfoListSelector],\n        (UserOrganizationInfoList): List<UserOrganizationInfo> => {\n            return UserOrganizationInfoList.filter(info => info.userId === userId);\n        }\n    )\n};\n\nexport const makeActiveUserOrganizationInfoSelector = (): (state: Record<ApplicationState>, props?: any) => UserOrganizationInfo | undefined => {\n    return createSelector(\n        [userOrganizationInfoListSelector, User.UserSelector.currentUserSelector],\n        (userOrganizationInfoList, currentUser): UserOrganizationInfo | undefined => {\n            if(currentUser.activeOrganization === null) {\n                return;\n            }\n\n            return userOrganizationInfoList.find(orga => orga.uid === currentUser.activeOrganization);\n        }\n    )\n}\n","import {camelCase, kebabCase, snakeCase, startCase} from 'lodash';\n\nexport const names = (str: string): {name: string, className: string, propertyName: string, constantName: string, fileName: string, title: string} => {\n  return {\n    name: str,\n    className: startCase(camelCase(str)).replace(/ /g, ''),\n    propertyName: camelCase(str),\n    constantName: snakeCase(str).toUpperCase(),\n    fileName: kebabCase(str),\n    title: startCase(str),\n  }\n}\n","import {Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {BoardId} from \"./Board\";\n\nexport type PermissionsId = string;\nexport interface Permissions {adminAccess: boolean; readAccess: boolean; writeAccess: boolean}\n\nexport const DEFAULT_PERMISSIONS = {adminAccess: false, readAccess: false, writeAccess: false}\n\nexport type BoardPermissionValidationError = string;\n\nexport const AGGREGATE_TYPE = 'BoardPermissionForUser';\n\nexport interface BoardPermissionForUserProps {\n    uid: PermissionsId;\n    aggregateType: AggregateType;\n    permissions: Permissions;\n    userId: UserId;\n    boardId: BoardId;\n}\n\nexport const defaultBoardPermissionProps: BoardPermissionForUserProps = {\n    uid: '',\n    aggregateType: AGGREGATE_TYPE,\n    permissions: DEFAULT_PERMISSIONS,\n    userId: '',\n    boardId: '',\n};\n\nexport const createBoardPermissionForUserFromServerData = (data: any): Either<BoardPermissionValidationError, BoardPermissionForUser> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('permissionsId'), \"permissionsId missing\"],\n        [hasKey('permissions'), \"permissions missing in \" + data.permissionsId],\n        [hasKey('userId'), \"userId missing in \" + data.permissionsId],\n        [hasKey('boardId'), \"boardId missing in \" + data.permissionsId],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new BoardPermissionForUser({\n        uid: data.permissionsId,\n        aggregateType: AGGREGATE_TYPE,\n        permissions: data.permissions,\n        userId: data.userId,\n        boardId: data.boardId\n    }));\n};\n\nexport class BoardPermissionForUser extends Record(defaultBoardPermissionProps) implements BoardPermissionForUserProps, Aggregate {\n    public constructor(data: BoardPermissionForUserProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n}\n","import {Record} from 'immutable';\nimport {UserModel} from '../../User';\n\nexport interface BoardVersionProps {\n    userId: UserModel.UserId;\n    version: number;\n    head?: boolean;\n}\n\nexport const defaultBoardVersionProps: BoardVersionProps = {\n    userId: '',\n    version: 0,\n    head: false,\n}\n\nexport class BoardVersion extends Record(defaultBoardVersionProps) implements BoardVersionProps {\n    public constructor(data: BoardVersionProps) {\n        if(data.head === undefined || data.head === null) {\n            data.head = false;\n        }\n\n        super(data);\n    }\n\n    public isHead(): boolean {\n        return this.head || false;\n    }\n\n    public asHead(): BoardVersion {\n        return this.set('head', true);\n    }\n\n    public equals(other: BoardVersion): boolean {\n        return this.userId === other.userId && this.version === other.version;\n    }\n\n    public isNewerThan(other: BoardVersion): boolean {\n        if(this.userId !== other.userId) {\n            return true;\n        }\n\n        return this.version > other.version;\n    }\n}\n","import {List, Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {UserModel} from \"../../User\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {names} from \"../service/cody-wizard/node/names\";\nimport {DEFAULT_PERMISSIONS, Permissions} from \"./BoardPermissionForUser\";\nimport {BoardSnapshot} from \"./BoardSnapshot\";\nimport {BoardVersion, defaultBoardVersionProps} from \"./BoardVersion\";\n\nexport type BoardId = string;\nexport type BoardName = string;\nexport type ServiceName = string;\nexport type BoardXml = string;\n\nexport interface BoardProps {\n    uid: BoardId;\n    name: string;\n    nameAbbreviation: string;\n    tags: List<string>,\n    version: BoardVersion;\n    createdAt: string;\n    xml?: BoardXml | null;\n    lastModified?: string;\n    inDeletion?: boolean;\n    shouldImport?: boolean;\n    shouldExport?: boolean;\n    shouldShowHistory?: boolean;\n    shouldShowElementDetails?: boolean;\n    shouldFocusMetadataEditor?: boolean;\n    shouldShowCodyConsole?: boolean;\n    shouldShowTimerModal?: boolean;\n    shouldShowPlayshotModal?: boolean;\n    videoSessionActive?: boolean;\n    detailsFetched?: boolean;\n    shared: boolean;\n    sharedWith: List<UserId>;\n    assignedTeams: List<TeamId>;\n    responsibleTeam?: TeamId;\n    writeAccess?: boolean;\n    example?: boolean;\n    owner: UserId | null;\n    creator: UserId | null;\n    organization: OrganizationId | null;\n    tempBoard: boolean;\n    orgaMemberPermissions: Permissions;\n    anyonePermissions: Permissions;\n    codySuggestEnabled: boolean;\n    eventModelingEnabled: boolean;\n}\n\nexport const defaultBoardProps: BoardProps = {\n    uid: '',\n    name: '',\n    nameAbbreviation: '',\n    tags: List(),\n    version: new BoardVersion(defaultBoardVersionProps),\n    xml: null,\n    createdAt: (() => new Date())().toISOString(),\n    lastModified: (() => new Date())().toISOString(),\n    inDeletion: false,\n    shouldImport: false,\n    shouldExport: false,\n    shouldShowHistory: false,\n    shouldShowElementDetails: false,\n    shouldFocusMetadataEditor: false,\n    shouldShowCodyConsole: false,\n    shouldShowTimerModal: false,\n    shouldShowPlayshotModal: false,\n    videoSessionActive: false,\n    shared: false,\n    detailsFetched: false,\n    sharedWith: List<UserId>(),\n    assignedTeams: List<TeamId>(),\n    responsibleTeam: undefined,\n    writeAccess: false,\n    example: false,\n    owner: null,\n    creator: null,\n    organization: null,\n    tempBoard: false,\n    orgaMemberPermissions: DEFAULT_PERMISSIONS,\n    anyonePermissions: DEFAULT_PERMISSIONS,\n    codySuggestEnabled: true,\n    eventModelingEnabled: true,\n};\n\nexport const deriveAbbreviationFromBoardName = (name: BoardName): string => {\n    const words = name.split(\" \");\n\n    let abbr = '';\n\n    if(words.length === 1) {\n        const firstWord = words[0];\n\n        if(firstWord.length <= 3) {\n            return firstWord.toLocaleUpperCase();\n        }\n\n        return firstWord.slice(0, 3).toLocaleUpperCase();\n    }\n\n    if(words.length > 1) {\n        words.forEach(word => abbr+= word.charAt(0));\n    }\n\n    return abbr.slice(0, 3).toLocaleUpperCase();\n}\n\nexport const createUserBoard = (userId: UserModel.UserId, name: BoardName, abbr?: string, tags?: string[], responsibleTeam?: TeamId, codySuggestEnabled = true, eventModelingEnabled = true): Board => {\n    console.log(\"create user board\", responsibleTeam);\n\n    return new Board({\n        uid: '',\n        name,\n        nameAbbreviation: abbr || deriveAbbreviationFromBoardName(name),\n        tags: tags? List(tags) : List(),\n        version: new BoardVersion({userId, version: 1}),\n        xml: null,\n        createdAt: (() => new Date())().toISOString(),\n        lastModified: undefined,\n        inDeletion: false,\n        shared: false,\n        detailsFetched: true,\n        sharedWith: List<UserId>(),\n        assignedTeams: List<TeamId>(),\n        responsibleTeam,\n        writeAccess: true,\n        example: false,\n        owner: null,\n        creator: userId,\n        organization: null,\n        tempBoard: false,\n        orgaMemberPermissions: DEFAULT_PERMISSIONS,\n        anyonePermissions: DEFAULT_PERMISSIONS,\n        codySuggestEnabled,\n        eventModelingEnabled,\n    });\n};\n\nexport const createTempBoard = (userId: UserModel.UserId, name: BoardName): Board => {\n    return new Board({\n        uid: '',\n        name,\n        nameAbbreviation: deriveAbbreviationFromBoardName(name),\n        tags: List(),\n        version: new BoardVersion({userId, version: 1}),\n        xml: null,\n        createdAt: (() => new Date())().toISOString(),\n        lastModified: undefined,\n        inDeletion: false,\n        shared: false,\n        detailsFetched: true,\n        sharedWith: List<UserId>(),\n        assignedTeams: List<TeamId>(),\n        writeAccess: true,\n        example: false,\n        owner: null,\n        creator: userId,\n        organization: null,\n        tempBoard: true,\n        orgaMemberPermissions: DEFAULT_PERMISSIONS,\n        anyonePermissions: DEFAULT_PERMISSIONS,\n        codySuggestEnabled: true,\n        eventModelingEnabled: true,\n    });\n};\n\nexport class Board extends Record(defaultBoardProps) implements BoardProps {\n    public constructor(data: BoardProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        if(data.xml === undefined) {\n            data.xml = null;\n        }\n\n        if(data.lastModified === undefined) {\n            data.lastModified = (() => new Date())().toISOString();\n        }\n\n        super(data);\n    }\n\n    public updateXmlAndVersionFromBoard(board: Board): Board\n    {\n        let changed = this.set('xml', board.xml);\n        changed = changed.set('version', board.version);\n        changed = changed.set('lastModified', board.lastModified);\n        return changed;\n    }\n\n    public updateXmlFromSnapshot(snapshot: BoardSnapshot): Board\n    {\n        let changed = this.set('xml', snapshot.xml);\n        changed = changed.set('version', snapshot.boardVersion);\n        return changed;\n    }\n\n    public updateXml(xml: string, userId: UserModel.UserId): Board\n    {\n        let changed = this.set('xml', xml);\n        changed = changed.set('lastModified', (() => new Date())().toISOString());\n        // Note: we set a new version that is not the HEAD version, even if current version is marked as head\n        // The local change needs to be acknowledged first\n        changed = changed.set('version', new BoardVersion({userId, version: this.version.version + 1}));\n        return changed;\n    }\n\n    public updateVersion(version: BoardVersion): Board\n    {\n        return this.set('version', version);\n    }\n\n    public syncSummaryInfo(other: Board): Board\n    {\n        let changed = this.set('sharedWith', other.sharedWith);\n        changed = changed.set('assignedTeams', other.assignedTeams);\n        changed = changed.set('owner', other.owner);\n        return changed.set('example', other.example);\n    }\n\n    public isCreator(userId: UserId): boolean\n    {\n        return this.get('creator') === userId;\n    }\n\n    public moveToOrganization(organizationId: OrganizationId): Board\n    {\n        let changed = this.set('creator', this.get('owner'));\n        changed = changed.set('owner', null);\n        return changed.set('organization', organizationId);\n    }\n\n    public codyEngineServiceName(): ServiceName\n    {\n        return names(this.get('name')).className;\n    }\n}\n","import {JSONSchema7, JSONSchema7TypeName} from \"json-schema\";\n\nexport const SCHEMA_TYPES: JSONSchema7TypeName[] = [\"object\", \"array\", \"string\", \"integer\", \"number\", \"boolean\", \"null\"];\nexport const PRIMITIVE_SCHEMA_TYPES: JSONSchema7TypeName[] = [\"string\", \"integer\", \"number\", \"boolean\", \"null\"];\n\nexport const isJsonSchema = (schema: any): schema is JSONSchema7 => {\n  if(typeof schema !== \"object\") {\n    return false;\n  }\n\n  if(schema.type && !isValidType(schema.type)) {\n    return false;\n  }\n\n  if(schema.$ref || schema.$id || schema.$title) {\n    return true;\n  }\n\n  return !Object.keys(schema).length;\n}\n\nconst isValidType = (type: JSONSchema7TypeName | JSONSchema7TypeName[]): boolean => {\n  if(Array.isArray(type)) {\n    for (const typeElement of type) {\n      if(!isValidType(typeElement)) {\n        return false;\n      }\n    }\n  }\n\n  if(typeof type !== \"string\") {\n    return false;\n  }\n\n  return SCHEMA_TYPES.includes(type);\n}\n","import {JSONSchema7} from \"json-schema\";\n\nexport const isJsonSchemaArray = (schema: Record<string, any>): schema is JSONSchema7 => {\n  if(typeof schema !== \"object\") {\n    return false;\n  }\n\n  return schema.type && schema.type === \"array\";\n}\n","import {JSONSchema7} from \"json-schema\";\n\nexport const isJsonSchemaObject = (schema: any): schema is JSONSchema7 => {\n  if(typeof schema !== \"object\") {\n    return false;\n  }\n\n  return schema.type && schema.type === \"object\";\n}\n","import {JSONSchema7, JSONSchema7TypeName} from \"json-schema\";\nimport {PRIMITIVE_SCHEMA_TYPES} from \"./is-json-schema\";\n\nexport const isJsonSchemaPrimitive = (schema: JSONSchema7): boolean => {\n  return !!schema.type && typeof schema.type === \"string\" && PRIMITIVE_SCHEMA_TYPES.includes(schema.type as JSONSchema7TypeName);\n}\n","import {JSONSchema7, JSONSchema7TypeName} from \"json-schema\";\n\nexport const isJsonSchemaRef = (schema: JSONSchema7): boolean => {\n  return !!schema.$ref;\n}\n","import {Node} from \"../../../model/Graph\";\nimport {\n  AlwaysRule,\n  ConditionRule,\n  Rule, ThenDeleteProjection,\n  ThenInsertProjection, ThenReplaceProjection,\n  ThenType, ThenUpdateProjection,\n  ThenUpsertProjection\n} from \"../rule-engine/configuration\";\nimport { RulesDependenciesMetadata } from \"../rule-engine/types\";\nimport {Schema} from \"../schema/schema\";\nimport {UiSchema} from \"../ui/ui-schema\";\nimport {AnyRule} from \"../../playshot/rule-definitions\";\n\nexport type Sort = 'asc' | 'desc';\n\nexport interface SortOrderItem {\n  prop: string;\n  sort: Sort;\n}\nexport type SortOrder = SortOrderItem[];\n\nexport interface ResolveConfig {\n  where?: AlwaysRule | ConditionRule,\n  orderBy?: SortOrderItem | SortOrder\n}\n\nexport interface ProjectionConfig {\n  name?: string,\n  live?: boolean,\n  cases: ProjectionConfigCase[]\n}\n\nexport interface ProjectionConfigCase {\n  given?: AnyRule[],\n  when: string,\n  then: ThenInsertProjection | ThenUpsertProjection | ThenUpdateProjection | ThenReplaceProjection | ThenDeleteProjection,\n}\n\nexport interface RefTableColumn {\n  data: string;\n  value: Rule[] | string;\n}\n\nexport interface PageLinkTableColumn {\n  page: string;\n  mapping: Record<string, string>;\n}\n\nexport interface TableColumnUiSchema {\n  field: string;\n  headerName?: string;\n  flex?: string | number;\n  width?: string | number;\n  value?: Rule[] | string;\n  pageLink?: string | PageLinkTableColumn;\n  ref?: {data: string; value: string};\n  link?: string | Rule[];\n}\n\nexport type TableGridDensity = 'compact' | 'standard' | 'comfortable';\n\ninterface TableUiConfig {\n  columns?: TableColumnUiSchema[],\n  pageSize?: number,\n  pageSizeOptions?: number[],\n  density?: TableGridDensity,\n  // @TODO: show/hide specific grid toolbar options or hide entire grid toolbar\n  // @TODO: support endless scroll, pagination, ... ?\n}\n\nexport interface TableUiSchema {\n  'ui:table'?: TableUiConfig;\n  table?: TableUiConfig;\n}\n\n\nexport interface ValueObjectMetadata {\n  identifier?: string;\n  shorthand?: boolean;\n  schema?: Schema;\n  querySchema?: Schema;\n  queryDependencies?: RulesDependenciesMetadata;\n  resolve?: ResolveConfig;\n  ns?: string;\n  collection?: string | false;\n  initialize?: Rule[];\n  uiSchema?: UiSchema & TableUiSchema;\n  projection?: ProjectionConfig;\n  entity?: boolean;\n}\n\nexport const getVoMetadata = (node: Node): ValueObjectMetadata => {\n  const metadata = node.getParsedMetadata() as Record<string, any>;\n\n  if(metadata.schema) {\n    metadata.schema = new Schema(metadata.schema);\n  }\n\n  if(metadata.querySchema) {\n    metadata.querySchema = new Schema(metadata.querySchema);\n  }\n\n  return metadata;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {isJsonSchemaArray} from \"../json-schema/is-json-schema-array\";\nimport {isList} from \"../schema/shorthand\";\nimport {getVoMetadata} from \"./get-vo-metadata\";\n\nexport const isListVo = (node: Node): boolean => {\n  if(node.getType() !== NodeType.document) {\n    return false;\n  }\n\n  const meta = getVoMetadata(node);\n\n  if(!meta.schema) {\n    return false;\n  }\n\n  return meta.schema.isList();\n}\n\nexport const isListForUICandidate = (node: Node): boolean => {\n  if(!isListVo(node)) {\n    return false;\n  }\n\n  const targets = node.getTargets();\n\n  if(targets.count() === 0) {\n    return true;\n  }\n\n  if(targets.count() > 1) {\n    return false;\n  }\n\n  const target = targets.toArray()[0];\n\n  return target && target.getType() === NodeType.ui;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {getVoMetadata} from \"./get-vo-metadata\";\nimport {isListVo} from \"./is-list-vo\";\n\nexport const isStateVo = (node: Node): boolean => {\n  if(node.getType() !== NodeType.document) {\n    return false;\n  }\n\n  if(isListVo(node)) {\n    return false;\n  }\n\n  const meta = getVoMetadata(node);\n\n  return !!meta.entity;\n}\n","import {Node} from \"../../../model/Graph\";\nimport {names} from \"../node/names\";\nimport {getVoMetadata, ValueObjectMetadata} from \"./get-vo-metadata\";\nimport {isStateVo} from \"./is-state-vo\";\nimport {isListVo} from \"./is-list-vo\";\n\nexport const getSchemaRefName = (vo: Node, voMeta: ValueObjectMetadata, asPropertyRef?: boolean, asFormRef?: boolean): string => {\n  const ns = voMeta.ns || '/';\n  const voClassName = names(vo.getTechnicalName()).className;\n\n  const propRef = isStateVo(vo) && asPropertyRef ? ':' + voMeta.identifier : '';\n\n  const formRef = asFormRef ? '/Form' : '';\n\n  return ns + (ns[ns.length - 1] === \"/\" ? voClassName : '/' + voClassName) + formRef + propRef;\n}\n","import {PRIMITIVE_SCHEMA_TYPES} from \"../json-schema/is-json-schema\";\nimport {JSONSchema7TypeName} from \"json-schema\";\n\nexport interface ShorthandObject {\n  [prop: string]: string | ShorthandObject;\n}\n\nexport type Shorthand = string | ShorthandObject;\n\nexport const isShorthand = (schema: any): schema is Shorthand => {\n  if(typeof schema === \"string\") {\n    return isPrimitive(schema) || isRef(schema);\n  }\n\n  if(typeof schema === \"object\") {\n    return isObject(schema) || isList(schema) || isPrimitive(schema);\n  }\n\n  return false;\n}\n\nexport const isObject = (schema: string | ShorthandObject): schema is ShorthandObject => {\n  return typeof schema !== \"string\" && !isList(schema) && !isPrimitive(schema);\n}\n\nexport const isList = (schema: Shorthand): boolean => {\n  if(!schema) {\n    return false;\n  }\n\n  if(typeof schema === \"string\") {\n    return false;\n  }\n\n  return typeof schema.$items !== \"undefined\";\n}\n\nexport const isPrimitive = (schema: string | ShorthandObject): boolean => {\n  if(!schema) {\n    return false;\n  }\n\n  let type = '';\n  if(typeof schema === \"string\") {\n    const parts = schema.split(\"|\");\n\n    type = parts[0];\n  } else if(typeof schema.$type === 'string') {\n    type = schema.$type;\n  }\n\n\n  return PRIMITIVE_SCHEMA_TYPES.includes(type as JSONSchema7TypeName);\n}\n\nexport const isString = (schema: string | ShorthandObject, format?: string): boolean => {\n  if(typeof schema === \"object\") {\n    if(!schema.$type) {\n      return false;\n    }\n\n    return isString(schema.$type);\n  }\n\n  const parts = schema.split(\"|\");\n\n  if(parts[0] !== \"string\") {\n    return false;\n  }\n\n  if(!format) {\n    return true;\n  }\n\n  // Normalize format\n  format = format.replace('format:', '');\n  format = 'format:'+format;\n\n  for (const part of parts) {\n    if(part === format) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport const isRef = (schema: string | ShorthandObject): boolean => {\n  if(typeof schema === \"string\") {\n    return schema[0] === '/';\n  }\n\n  return typeof schema.$ref === \"string\";\n}\n\nexport const isPropertyRef = (ref: string): boolean => {\n  return ref.indexOf(':') !== -1;\n}\n\nexport const splitPropertyRef = (ref: string): [string, string] => {\n  const split = ref.split(':');\n\n  if(split.length === 1) {\n    split.push('');\n  }\n  return split as [string, string];\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {eq, isEqual} from \"lodash\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {NodeType} from \"../../../model/Graph\";\nimport {parse, stringify} from \"../../json/json-comment-wrapper\";\nimport {isJsonSchema} from \"../json-schema/is-json-schema\";\nimport {isJsonSchemaArray} from \"../json-schema/is-json-schema-array\";\nimport {isJsonSchemaObject} from \"../json-schema/is-json-schema-object\";\nimport {isJsonSchemaPrimitive} from \"../json-schema/is-json-schema-primitive\";\nimport {isJsonSchemaRef} from \"../json-schema/is-json-schema-ref\";\nimport {isJsonSchemaString} from \"../json-schema/is-json-schema-string\";\nimport {getSchemaDefinitionId} from \"../vo/get-schema-definition-id\";\nimport {getSchemaRefName} from \"../vo/get-schema-ref-name\";\nimport {getVoMetadata} from \"../vo/get-vo-metadata\";\nimport {\n  isList,\n  isObject,\n  isPrimitive,\n  isRef,\n  isShorthand,\n  isString,\n  Shorthand,\n  ShorthandObject,\n  splitPropertyRef\n} from \"./shorthand\";\n\n\nexport class Schema {\n\n  public static fromString(schemaStr: string): Schema {\n    if (isShorthand(schemaStr)) {\n      return new Schema(schemaStr);\n    }\n\n    try {\n      const parsedSchema = parse(schemaStr);\n      return new Schema(parsedSchema);\n    } catch (e) {\n      console.warn(\"[CodyWizard] Schema.fromString was not able to parse JSON string\", schemaStr, e);\n      return new Schema({});\n\n    }\n  }\n\n  private shorthand: Shorthand | null = null;\n  private jsonSchema: JSONSchema7 | null = null;\n\n  constructor(schema: Shorthand | JSONSchema7 | Schema) {\n    if(schema instanceof Schema) {\n      schema = schema.toJSON();\n    }\n\n    if(isShorthand(schema)) {\n      this.shorthand = schema;\n      return;\n    }\n\n    if(isJsonSchema(schema)) {\n      this.jsonSchema = schema;\n      return;\n    }\n\n    console.warn(\"[CodyWizard] Schema received invalid schema. It's neither Shorthand nor JSONSchema7 and therefor ignored!\", schema);\n  }\n\n  public toShorthand(): Shorthand {\n    if(this.shorthand) {\n      return this.shorthand;\n    }\n\n    console.warn(\"[CodyWizard] Schema conversion from JSON Schema to shorthand is not implemented yet\", this.jsonSchema);\n\n    return {};\n  }\n\n  public isShorthand(): boolean {\n    return isShorthand(this.toShorthandIfPossible());\n  }\n\n  public isEmpty(): boolean {\n    const s = this.toShorthandIfPossible();\n\n    if(typeof s === \"string\") {\n      return s === '';\n    }\n\n    return Object.keys(s).length === 0;\n  }\n\n  public toShorthandIfPossible(): Shorthand | JSONSchema7 {\n    if(this.shorthand) {\n      return this.shorthand;\n    }\n\n    if(this.jsonSchema) {\n      console.warn(\"[CodyWizard] Schema conversion from JSON Schema to shorthand is not implemented yet\", this.jsonSchema);\n      return this.jsonSchema;\n    }\n\n    return {};\n  }\n\n  public isString(format?: string): boolean {\n    if(this.shorthand) {\n      return isString(this.shorthand, format);\n    }\n\n    if(this.jsonSchema) {\n      return isJsonSchemaString(this.jsonSchema, format);\n    }\n\n    return false;\n  }\n\n  public isRef(): boolean {\n    if(this.shorthand) {\n      return isRef(this.shorthand);\n    }\n\n    if(this.jsonSchema) {\n      return isJsonSchemaRef(this.jsonSchema);\n    }\n\n    return false;\n  }\n\n  public getRef<NSV>(notSetValue?: NSV): string | NSV;\n  public getRef<NSV>(notSetValue: NSV): string | NSV {\n    if(!this.isRef()) {\n      return notSetValue;\n    }\n\n    if(this.shorthand) {\n      return typeof this.shorthand === \"string\" ? this.shorthand : this.shorthand.$ref as string;\n    }\n\n    if(this.jsonSchema) {\n      return this.jsonSchema.$ref as string;\n    }\n\n    return notSetValue;\n  }\n\n  public resolveRef(elementsTree: ElementsTree): Schema {\n    const emptySchema = new Schema({});\n\n    if(!this.isRef()) {\n      return emptySchema;\n    }\n\n    let ref = emptySchema;\n\n    if(this.isShorthand()) {\n      elementsTree.getFilteredElementsByType(NodeType.document).forEach(doc => {\n        const voMeta = getVoMetadata(doc);\n        const [refWithoutProp, prop] = splitPropertyRef(this.getRef());\n        if(getSchemaRefName(doc, voMeta) === refWithoutProp) {\n          ref = voMeta.schema || emptySchema;\n        }\n      })\n\n      return ref;\n    }\n\n    if(!this.jsonSchema) {\n      elementsTree.getFilteredElementsByType(NodeType.document).forEach(doc => {\n        const voMeta = getVoMetadata(doc);\n        if(getSchemaDefinitionId(doc, voMeta) === this.getRef()) {\n          ref = voMeta.schema || emptySchema;\n        }\n      })\n\n      return ref;\n    }\n\n    return emptySchema;\n  }\n\n  public isPrimitive(): boolean {\n    if(this.shorthand) {\n      return isPrimitive(this.shorthand);\n    }\n\n    if(this.jsonSchema) {\n      return isJsonSchemaPrimitive(this.jsonSchema);\n    }\n\n    return false;\n  }\n\n  public isList(): boolean {\n    if(this.shorthand) {\n      return isList(this.shorthand);\n    }\n\n    if(this.jsonSchema) {\n      return isJsonSchemaArray(this.jsonSchema);\n    }\n\n    return false;\n  }\n\n  public getListItemsSchema<NSV>(notSetValue?: NSV): Schema | NSV;\n  public getListItemsSchema<NSV>(notSetValue: NSV): Schema | NSV {\n    if(this.shorthand && isList(this.shorthand)) {\n      return new Schema((this.shorthand as ShorthandObject).$items);\n    }\n\n    if(this.jsonSchema && isJsonSchemaArray(this.jsonSchema)) {\n      return new Schema(this.jsonSchema.items as JSONSchema7);\n    }\n\n    return notSetValue;\n  }\n\n  public isObject(): boolean {\n    if(this.shorthand) {\n      return isObject(this.shorthand);\n    }\n\n    if(this.jsonSchema) {\n      return isJsonSchemaObject(this.jsonSchema);\n    }\n\n    return false;\n  }\n\n  public getObjectProperties(): string[] {\n    if(!this.isObject()) {\n      return [];\n    }\n\n    if(this.shorthand && isObject(this.shorthand)) {\n      return Object.keys(this.shorthand).map(prop => prop.replace('?', ''));\n    }\n\n    if(this.jsonSchema && isJsonSchemaObject(this.jsonSchema)) {\n      return Object.keys(this.jsonSchema.properties || {});\n    }\n\n    return [];\n  }\n\n  public getObjectPropertySchema<NSV>(propName: string, notSetValue?: NSV): Schema | NSV;\n  public getObjectPropertySchema<NSV>(propName: string, notSetValue: NSV): Schema | NSV {\n    if(!this.isObject()) {\n      return notSetValue;\n    }\n\n    if(this.shorthand && isObject(this.shorthand) && this.shorthand[propName]) {\n      return new Schema(this.shorthand[propName]);\n    }\n\n    if(this.shorthand && isObject(this.shorthand) && this.shorthand[propName + '?']) {\n      return new Schema(this.shorthand[propName + '?']);\n    }\n\n    if(this.jsonSchema && isJsonSchemaObject(this.jsonSchema)) {\n      const props = this.jsonSchema.properties || {};\n\n      if(props[propName]) {\n        return new Schema(props[propName] as JSONSchema7);\n      }\n    }\n\n    return notSetValue;\n  }\n\n  public setObjectProperty(propName: string, propSchema: Schema, required = true): void {\n    if(!this.isObject()) {\n      return;\n    }\n\n    if(this.shorthand) {\n      if(!required) {\n        propName += '?';\n      }\n\n      // @ts-ignore\n      this.shorthand[propName] = propSchema.toShorthandIfPossible();\n    }\n\n    if(this.jsonSchema) {\n      // @ts-ignore\n      this.jsonSchema.properties[propName] = propSchema.toJsonSchema();\n\n      if(!required) {\n        return;\n      }\n\n      if(this.jsonSchema.required) {\n        this.jsonSchema.required.push(propName);\n      } else {\n        this.jsonSchema.required = [propName];\n      }\n    }\n  }\n\n  public isRequired(propName: string): boolean {\n    if(this.isEmpty() || !this.isObject()) {\n      return false;\n    }\n\n    if(this.shorthand) {\n      if(isObject(this.shorthand) && this.shorthand[propName]) {\n        return true;\n      }\n\n      // propName + ? || propName not set\n      return false;\n    }\n\n    if(this.jsonSchema) {\n      if(isJsonSchemaObject(this.jsonSchema) && this.jsonSchema.required && this.jsonSchema.required.includes(propName)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  public toJsonSchema(): JSONSchema7 {\n    if(this.jsonSchema) {\n      return this.jsonSchema;\n    }\n\n    console.warn(\"[CodyWizard] Schema conversion from shorthand to JSONSchema is not implemented yet\", this.shorthand);\n\n    return {};\n  }\n\n  public toString(): string {\n    return stringify(this.toShorthandIfPossible(), null, 2);\n  }\n\n  public toJSON(): Shorthand | JSONSchema7 {\n    return this.toShorthandIfPossible();\n  }\n\n  public equals(otherSchema: Schema): boolean {\n    return isEqual(this.toJSON(), otherSchema.toJSON());\n  }\n}\n","import {JSONSchema7} from \"json-schema\";\n\nexport const isJsonSchemaString = (schema: JSONSchema7, format?: string): boolean => {\n  if(schema.type && schema.type === \"string\") {\n    if(format) {\n      return !!schema.format && schema.format === format;\n    }\n\n    return true;\n  }\n\n  return false;\n}\n","import {Node} from \"../../../model/Graph\";\nimport {ValueObjectMetadata} from \"./get-vo-metadata\";\n\nexport const getSchemaDefinitionId = (vo: Node, voMeta: ValueObjectMetadata): string => {\n  // @TODO implement function\n  return '';\n}\n","import {Node} from \"../../../model/Graph\";\nimport {Rule} from \"../rule-engine/configuration\";\nimport {RulesDependenciesMetadata} from \"../rule-engine/types\";\nimport {Schema} from \"../schema/schema\";\nimport {UiSchema} from \"../ui/ui-schema\";\n\nexport interface CommandMetadata {\n  aggregateCommand: boolean;\n  newAggregate?: boolean;\n  shorthand?: boolean;\n  schema?: Schema;\n  uiSchema?: UiSchema;\n  dependencies?: RulesDependenciesMetadata;\n  rules?: Rule[];\n  deleteState?: boolean;\n  deleteHistory?: boolean;\n  streamId?: string;\n}\n\nexport const getCommandMetadata = (command: Node): CommandMetadata => {\n  const metadata = command.getParsedMetadata();\n\n  if(!command.getMetadata()) {\n    // New commands are non-aggregate commands by default\n    metadata.aggregateCommand = false;\n  }\n\n  if(metadata.schema) {\n    metadata.schema = new Schema(metadata.schema);\n  }\n\n  // Existing commands without flag, are aggregate commands by default to keep BC\n  if(typeof metadata.aggregateCommand === \"undefined\") {\n    metadata.aggregateCommand = true;\n  }\n\n  if(typeof metadata.newAggregate === \"undefined\") {\n    metadata.newAggregate = metadata.aggregateCommand;\n  }\n\n  return metadata as CommandMetadata;\n}\n","import {Node} from \"../../../model/Graph\";\nimport {Rule, ThenAssignVariable} from \"../rule-engine/configuration\";\nimport {Schema} from \"../schema/schema\";\n\nexport interface ApplyEventRule extends Rule {\n  then: ThenAssignVariable\n}\n\nexport interface EventMetadata {\n  public?: boolean;\n  shorthand?: boolean;\n  schema?: Schema;\n  applyRules?: ApplyEventRule[];\n}\n\nexport const getEventMetadata = (node: Node): EventMetadata => {\n  const metadata = node.getParsedMetadata() as Record<string, any>;\n\n  if(typeof metadata.public === \"undefined\") {\n    metadata.public = false;\n  }\n\n  if(metadata.schema) {\n    metadata.schema = new Schema(metadata.schema);\n  }\n\n  // @TODO: validate rules\n\n  return metadata;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {List} from \"immutable\";\n\nexport const getSingleSourceOfType = (node: Node, type: NodeType, allowMultiple?: boolean, includeChildren?: boolean): Node | null => {\n  let sources = node.getSources().filter(s => s.getType() === type);\n\n  if(includeChildren) {\n    node.children().forEach(child => {\n      const childSource = getSingleSourceOfType(child, type, allowMultiple, true);\n      if(childSource) {\n        sources = sources.push(childSource);\n      }\n    })\n  }\n\n  if(sources.count() === 0) {\n    return null;\n  }\n\n  if(sources.count() === 1 || allowMultiple) {\n    return sources.toArray()[0];\n  }\n\n  return null;\n}\n\nexport const getSingleTargetOfType = (node: Node, type: NodeType, allowMultiple?: boolean, includeChildren?: boolean): Node | null => {\n  let targets = node.getTargets().filter(t => t.getType() === type);\n\n  if(includeChildren) {\n    node.children().forEach(child => {\n      const childTarget = getSingleTargetOfType(child, type, allowMultiple, true);\n      if(childTarget) {\n        targets = targets.push(childTarget)\n      }\n    })\n  }\n\n  if(targets.count() === 0) {\n    return null;\n  }\n\n  if(targets.count() === 1 || allowMultiple) {\n    return targets.toArray()[0];\n  }\n\n  return null;\n}\n\nexport const getSourcesOfType = (node: Node, type: NodeType, includeChildren?: boolean): Node[] => {\n  let sources = List<Node>();\n\n  if(includeChildren) {\n    node.children().forEach(child => sources = sources.merge(getSourcesOfType(child, type, includeChildren)));\n  }\n\n\n  return sources.merge(node.getSources().filter(s => s.getType() === type)).toArray();\n}\n\nexport const getTargetsOfType = (node: Node, type: NodeType, includeChildren?: boolean): Node[] => {\n  let targets = List<Node>();\n\n  if(includeChildren) {\n    node.children().forEach(child => targets = targets.merge(getTargetsOfType(child, type, includeChildren)));\n  }\n\n  return targets.merge(node.getTargets().filter(t => t.getType() === type)).toArray();\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {getCommandMetadata} from \"../command/get-command-metadata\";\nimport {getTargetsOfType} from \"../node/get-single-node-of-type\";\nimport {isStateVo} from \"../vo/is-state-vo\";\n\nexport const isDddActionEvent = (node: Node): boolean => {\n  if(node.getType() !== NodeType.event) {\n    return false;\n  }\n\n  if(isAggregateEvent(node)) {\n    return true;\n  }\n\n  const sources = node.getSources();\n\n  if(sources.count() > 0) {\n    const firstSource = sources.filter(s => s.getType() === NodeType.command).first(undefined);\n\n    if(firstSource && firstSource.getType() === NodeType.command) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport const isAggregateEvent = (node: Node): boolean => {\n  if(node.getType() !== NodeType.event) {\n    return false;\n  }\n\n  const sources = node.getSources();\n\n  if(sources.count() === 1) {\n    const type = sources.toArray()[0].getType();\n\n    if(type === NodeType.aggregate) {\n      return true\n    }\n\n    if(type === NodeType.command) {\n      const cmdMeta = getCommandMetadata(sources.first());\n\n      return cmdMeta.aggregateCommand;\n    }\n  }\n\n  return false;\n}\n\nexport const isEntityEvent = (node: Node): boolean => {\n  if(node.getType() !== NodeType.event) {\n    return false;\n  }\n\n  const vos = getTargetsOfType(node, NodeType.document);\n\n  for (const vo of vos) {\n    if(isStateVo(vo)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport const isAggregateEventCandidate = (node: Node): boolean => {\n  if(isAggregateEvent(node)) {\n    return true;\n  }\n\n  if(node.getType() !== NodeType.event) {\n    return false;\n  }\n\n  return node.getSources().count() === 0;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\n\nexport const findParentByType = (node: Node | null, type: NodeType): Node | null => {\n  if(node && node.getType() === type) {\n    return node;\n  }\n\n  if(!node) {\n    return null;\n  }\n\n  return findParentByType(node.getParent(), type);\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {findParentByType} from \"./find-parent-by-type\";\nimport {names} from \"./names\";\n\nexport const detectService = (node: Node): string | null => {\n  const meta = node.getParsedMetadata() as Record<string, any>;\n\n  if(meta.service && typeof meta.service === 'string') {\n    return names(meta.service).className;\n  }\n\n  const feature = findParentByType(node, NodeType.feature);\n\n  if(feature) {\n    const featureMeta = feature.getParsedMetadata() as Record<string, any>;\n\n    if(featureMeta.service) {\n      return names(featureMeta.service).className;\n    }\n  }\n\n  const bc = findParentByType(node, NodeType.boundedContext);\n\n  if(bc) {\n    const bcMeta = bc.getParsedMetadata() as Record<string, any>;\n    if(bcMeta.service) {\n      return names(bcMeta.service).className;\n    }\n  }\n\n  return null;\n}\n","import {ServiceName} from \"../../../model/Board\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {isAggregateEvent} from \"../event/is-aggregate-event\";\nimport {getVoMetadata} from \"../vo/get-vo-metadata\";\nimport {detectService} from \"./detect-service\";\nimport {names} from \"./names\";\n\nexport const fqcnWithDefaultService = (node: Node, defaultService: string, forQuery?: boolean, forViewModel?: boolean, useLabel?: boolean) => {\n  return fqcn(node, forQuery, forViewModel, useLabel, defaultService);\n}\n\nexport const fqcn = (node: Node, forQuery?: boolean, forViewModel?: boolean, useLabel?: boolean, defaultService?: string) => {\n  let service = detectService(node);\n\n  const nodeName = useLabel ? node.getName() : node.getTechnicalName();\n\n  if (service) {\n    service += '.';\n  } else if (defaultService) {\n    service = `${defaultService}.`;\n  } else {\n    service = '';\n  }\n\n  if(node.getType() === NodeType.document) {\n    if(forQuery) {\n      return `${service}Get${names(nodeName).className}`;\n    }\n\n    if(forViewModel) {\n      return `${service}${names(nodeName).className}`;\n    }\n\n    const voMeta = getVoMetadata(node);\n\n    if(voMeta.ns) {\n      const ns = voMeta.ns.charAt(0) === \"/\" ? voMeta.ns.slice(1) : voMeta.ns;\n      return `${service}${ns.split(\"/\").map(n => names(n).className).join(\".\")}.${names(nodeName).className}`;\n    }\n  }\n\n  if(node.getType() === NodeType.event) {\n    if(isAggregateEvent(node)) {\n      const aggregate = node.getSources().first(undefined);\n\n      if(aggregate && aggregate.getType() === NodeType.aggregate) {\n        return `${service}${names(aggregate.getTechnicalName()).className}.${names(nodeName).className}`;\n      }\n    }\n  }\n\n  return `${service}${names(nodeName).className}`;\n}\n","import {Node} from \"../../../model/Graph\";\nimport {parse} from \"../../json/json-comment-wrapper\";\n\nexport const parseNodeMetadata = (node: Node): Record<string, any> => {\n  return parseRawNodeMetadata(node.getMetadata());\n}\n\nexport const parseRawNodeMetadata = (meta: string | null): Record<any, any> => {\n\n  if(!meta) {\n    return  {};\n  }\n\n  try {\n    return parse(meta);\n  } catch (e) {\n    console.error(\"Failed to parse metadata of node: \",  meta);\n    return {};\n  }\n}\n","import {List, Record} from 'immutable';\nimport {detectService} from \"../service/cody-wizard/node/detect-service\";\nimport {names} from \"../service/cody-wizard/node/names\";\nimport {Graph, MxGraphElement, Node, NodeId, NodeType} from \"./Graph\";\n\ninterface ParsedFilter {\n    nodeIds: string[];\n    nodeTypes: string[];\n    nodeLabels: string[];\n    nodeTags: string[];\n    notNodeTags: string[];\n    strict: boolean;\n    service?: string;\n}\n\nexport interface TreeProps {\n    elements: List<Node>;\n    filter: string;\n    focus: boolean;\n}\n\nexport const defaultTreeProps: TreeProps = {\n    elements: List(),\n    filter: '',\n    focus: false,\n};\n\nexport const createTreeFromGraph = (graph: Graph): ElementsTree => {\n    return createTreeFromElements(graph.getRoot().children());\n};\n\nexport const createTreeFromElements = (elements: List<Node>): ElementsTree => {\n    return new ElementsTree({elements: elements.filter(c => isValidNode(c))});\n}\n\nexport const parseFilter = (filter: string): ParsedFilter => {\n    const parts = filter.split(';');\n\n    const nodeIds: string[] = [];\n    const nodeTypes: string[] = [];\n    const nodeLabels: string[] = [];\n    const nodeTags: string[] = [];\n    const notNodeTags: string[] = [];\n\n    parts.forEach(part => {\n        if(part.search('id:') !== -1) {\n            nodeIds.push(part.replace('id:', '').trim());\n        }else if(part.search('type:') !== -1) {\n            nodeTypes.push(part.replace('type:', '').trim().toLowerCase());\n        } else if(part.search('!tag:') !== -1) {\n            notNodeTags.push(part.replace('!tag:', '').trim().toLowerCase());\n        } else if(part.trim().search(/^!#/) !== -1) {\n            notNodeTags.push(part.replace('!#', '').trim().toLowerCase());\n        } else if(part.search('tag:') !== -1) {\n            nodeTags.push(part.replace('tag:', '').trim().toLowerCase());\n        } else if(part.trim().search(/^#/) !== -1) {\n            nodeTags.push(part.replace('#', '').trim().toLowerCase());\n        } else {\n            nodeLabels.push(part.trim());\n        }\n    })\n\n    return {nodeIds, nodeTypes, nodeLabels, nodeTags, notNodeTags, strict: false};\n}\n\nexport const isFeatureTypeFilter = (filter: ParsedFilter): boolean => {\n    return filter.nodeTypes.length === 1 && filter.nodeTypes[0] === NodeType.feature;\n}\n\nexport const isContextTypeFilter = (filter: ParsedFilter): boolean => {\n    return filter.nodeTypes.length === 1 && filter.nodeTypes[0] === NodeType.boundedContext.toLowerCase();\n}\n\nconst isValidNode = (node: Node): boolean => {\n    return !node.getTags().contains(ispConst.TAG_ELEMENTS_TREE_HIDDEN)\n}\n\nconst matchNode = (node: Node, filter: ParsedFilter): boolean => {\n    if(!isValidNode(node)) {\n        return false;\n    }\n\n    if(filter.nodeTypes.length && !filter.nodeTypes.includes(node.getType().toLowerCase())) {\n        return false;\n    }\n\n    if(filter.nodeIds.length && !filter.nodeIds.includes(node.getId())) {\n        return false;\n    }\n\n    if(filter.service) {\n        const nodeService = detectService(node);\n        if(nodeService !== filter.service) {\n            return false;\n        }\n    }\n\n    if(filter.nodeTags.length) {\n        for (const tag of filter.nodeTags) {\n            if(!node.getTags().contains(tag)) {\n                // @TODO: Remove fallback after a while, fixed spelling 2019-11-26\n                if(tag === 'planned') {\n                    if(!node.getTags().contains('planed')) {\n                        return false;\n                    }\n                } else {\n                    return false;\n                }\n            }\n        }\n    }\n\n    if(filter.notNodeTags.length) {\n        for (const tag of filter.notNodeTags) {\n            if(node.getTags().contains(tag)) {\n                return false;\n            }\n        }\n    }\n\n    let matchesAllLabelParts = true;\n\n    filter.nodeLabels.forEach(labelFilter => {\n        if(filter.strict) {\n            if(node.getName() !== labelFilter) {\n                matchesAllLabelParts = false;\n            }\n        } else {\n            if(node.getName().toLowerCase().search(labelFilter.toLowerCase()) === -1) {\n                matchesAllLabelParts = false;\n            }\n        }\n    });\n\n    return matchesAllLabelParts;\n};\n\nconst filterChildren = (children: List<Node>, filter: ParsedFilter): List<Node> => {\n    const filteredChildren: Node[] = [];\n    const isFeatureFilter = isFeatureTypeFilter(filter);\n    const isContextFilter = isContextTypeFilter(filter);\n\n    children.forEach(child => {\n        if(isFeatureFilter && child.getType() === NodeType.feature) {\n            if(matchNode(child, filter)) {\n                filteredChildren.push(child.setChildren(child.children().filter(c => isValidNode(c))));\n            }\n\n            return;\n        }\n\n        if(isContextFilter && child.getType() === NodeType.boundedContext) {\n            if(matchNode(child, filter)) {\n                filteredChildren.push(child.setChildren(child.children().filter(c => isValidNode(c))));\n            }\n            return;\n        }\n\n        const filteredSubChildren = filterChildren(child.children(), filter);\n\n        if(filteredSubChildren.count() > 0) {\n            filteredChildren.push(child.setChildren(filteredSubChildren));\n            return;\n        }\n\n        if(matchNode(child, filter)) {\n            filteredChildren.push(child.setChildren(filteredSubChildren))\n        }\n    });\n\n    return List(filteredChildren);\n};\n\nconst filterElements = (elements: List<Node>, filter: ParsedFilter): List<Node> => {\n    const filteredElements: Node[] = [];\n\n    elements.forEach(ele => {\n\n       const filteredSubChildren = filterElements(ele.children(), filter);\n\n       if(filteredSubChildren.count() > 0) {\n           filteredElements.push(...filteredSubChildren.toArray());\n       }\n\n       if(matchNode(ele, filter)) {\n           filteredElements.push(ele);\n       }\n    });\n\n    return List(filteredElements);\n}\n\nexport class ElementsTree extends Record(defaultTreeProps) implements TreeProps {\n\n    private cache: {[filter: string]: any} = {};\n\n    public mergeTree(other: ElementsTree): ElementsTree {\n        // @TODO Implement diffing strategy to only add/remove/update changed elements\n        return other.set('filter', this.filter);\n    }\n\n    public getFilteredElementsAsTree(): List<Node> {\n        const parsedFilter = parseFilter(this.filter);\n        const cacheKey = JSON.stringify(parsedFilter);\n\n        this.initCache();\n\n        if(!this.cache[cacheKey]) {\n            this.cache[cacheKey] = filterChildren(this.elements, parsedFilter);\n        }\n\n        return this.cache[cacheKey];\n    }\n\n    public isFiltered(): boolean {\n        return this.filter !== '';\n    }\n\n    public getSimilarElements(node: Node): List<Node> {\n        const cacheKey = `getSimilarElements_${node.getId()}`;\n\n        this.initCache();\n\n        if(!this.cache[cacheKey]) {\n            const nodeName = this.getNamespacedName(node);\n\n            if(nodeName === '') {\n                return List([]);\n            }\n\n            this.cache[cacheKey] = this.getFilteredElementsByTypeAndLabel(node.getType(), node.getName()).filter(se => {\n                return se.getId() !== node.getId()\n                    && this.getNamespacedName(se) === nodeName\n            });\n        }\n\n        return this.cache[cacheKey];\n    }\n\n    public getFilteredElementsByTag(tag: string): List<Node> {\n        return filterElements(this.elements, {\n            nodeIds: [],\n            nodeLabels: [],\n            strict: true,\n            nodeTags: [tag.replace('#', '').toLowerCase()],\n            notNodeTags: [],\n            nodeTypes: [],\n        })\n    }\n\n    public getFilteredElementsByTypeAndLabel(nodeType: string, label: string, service?: string): List<Node> {\n        return filterElements(this.elements, {\n            nodeIds: [],\n            nodeLabels: [label],\n            strict: true,\n            nodeTags: [],\n            notNodeTags: [],\n            nodeTypes: [nodeType.toLowerCase()],\n            service\n        })\n    }\n\n    public getFilteredElementsByType(nodeType: string, uniqueLabels?: boolean): List<Node> {\n        const filteredElements = filterElements(this.elements, {\n            nodeIds: [],\n            nodeLabels: [],\n            strict: true,\n            nodeTags: [],\n            notNodeTags: [],\n            nodeTypes: [nodeType.toLowerCase()]\n        }).sortBy(ele => ele.getName());\n\n        if(!uniqueLabels) {\n            return filteredElements;\n        }\n\n        const namesList: string[] = [];\n\n        return filteredElements.filter(ele => {\n            if(namesList.includes(ele.getName())) {\n                return false;\n            }\n\n            namesList.push(ele.getName());\n\n            return true;\n        })\n    }\n\n    public getFilteredElementsByTypes(nodeTypes: NodeType[], uniqueLabels?: boolean): List<Node> {\n        const filteredElements = filterElements(this.elements, {\n            nodeIds: [],\n            nodeLabels: [],\n            strict: true,\n            nodeTags: [],\n            notNodeTags: [],\n            nodeTypes: nodeTypes.map(f => f.toLowerCase())\n        }).sortBy(ele => ele.getName());\n\n        if(!uniqueLabels) {\n            return filteredElements;\n        }\n\n        const namesList: string[] = [];\n\n        return filteredElements.filter(ele => {\n            if(namesList.includes(ele.getName())) {\n                return false;\n            }\n\n            namesList.push(ele.getName());\n\n            return true;\n        })\n    }\n\n    public getElement(elementId: NodeId): Node | undefined {\n        const cacheKey = `getElement_${elementId}`;\n\n        this.initCache();\n\n        if(!this.cache[cacheKey]) {\n            const matchedEles = filterElements(this.elements, {\n                nodeIds: [elementId],\n                nodeLabels: [],\n                nodeTags: [],\n                notNodeTags: [],\n                nodeTypes: [],\n                strict: true\n            });\n\n            if (matchedEles.size > 0) {\n                this.cache[cacheKey] = matchedEles.first();\n\n            }\n\n            return undefined;\n        }\n\n        return this.cache[cacheKey];\n    }\n\n    private getNamespacedName(node: Node): string {\n        if(node.getType() === NodeType.event) {\n            let service = detectService(node);\n            if(service) {\n                service += '.';\n            } else {\n                service = '';\n            }\n            // FQCN of event might include aggregate name, but for similar nodes that's not what we want to compare\n            return `${service}` + names(node.getName()).className;\n        }\n\n        // @TODO: Inject default service from board settings\n        return node.getFQCN('');\n    }\n\n    private initCache() {\n        if(!this.cache) {\n            this.cache = {};\n        }\n    }\n}\n","import {List, Record} from 'immutable';\nimport moment from \"moment\";\nimport {UserModel} from \"../../User\";\nimport {IioUserInfo} from \"../../User\";\nimport {BoardId} from \"./Board\";\nimport {BoardChanged} from \"./BoardChanged\";\nimport {BoardVersion, defaultBoardVersionProps} from \"./BoardVersion\";\nimport {NodeType} from \"./Graph\";\n\nexport interface BoardHistory extends List<HistoryEntry>{\n\n}\n\nexport enum HistoryAction {\n    added = 'added',\n    edited = 'edited',\n    deleted = 'deleted',\n    moved = 'moved',\n}\n\nenum HistoryCellTypeAddition {multiple = 'multiple'}\n\nexport const HistoryCellType = {...NodeType, ...HistoryCellTypeAddition}\nexport type HistoryCellType = NodeType | HistoryCellTypeAddition;\n\nexport interface HistoryEntryProps {\n    userId: UserModel.UserId;\n    username: UserModel.Username;\n    boardId: BoardId;\n    boardVersion: BoardVersion;\n    action: HistoryAction;\n    cellType: HistoryCellType;\n    label: string;\n    date: string;\n    cellId?: string;\n}\n\nexport const defaultHistoryEntryProps: HistoryEntryProps = {\n    userId: '',\n    username: '',\n    boardId: '',\n    boardVersion: new BoardVersion(defaultBoardVersionProps),\n    action: HistoryAction.edited,\n    cellType: HistoryCellType.misc,\n    label: '',\n    date: '',\n    cellId: undefined,\n};\n\nexport class HistoryEntry extends Record(defaultHistoryEntryProps) implements HistoryEntryProps {}\n\nexport const makeHistoryEntry = (boardChanged: BoardChanged, userInfo: IioUserInfo.IioUserInfo): HistoryEntry => {\n    return new HistoryEntry({\n        action: boardChanged.action!,\n        cellType: boardChanged.cellType!,\n        label: boardChanged.cellLabel!,\n        userId: userInfo.userId,\n        username: userInfo.username,\n        boardId: boardChanged.board,\n        boardVersion: boardChanged.toBoardVersion(),\n        date: boardChanged.recordedAt,\n        cellId: boardChanged.cellId,\n    });\n};\n\n","import {Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\n\nexport type GraphElementId = string;\nexport type GraphElementName = string;\nexport type GraphElementParentId = string|null;\nexport type GraphElementChildren = string[];\nexport type GraphElementSources = string[];\nexport type GraphElementTargets = string[];\n\nexport enum GraphElementType {\n    event = 'event'\n}\n\nexport type BoardGraphElementValidationError = string;\n\nexport const AGGREGATE_TYPE = 'BoardGraphElement';\n\nexport interface BoardGraphElementProps {\n    uid: GraphElementId;\n    aggregateType: AggregateType;\n    name: GraphElementName\n    parentId: GraphElementParentId;\n    type: GraphElementType;\n    children: GraphElementChildren|undefined;\n    sources: GraphElementSources|undefined;\n    targets: GraphElementTargets|undefined;\n}\n\nexport const defaultBoardGraphElementProps: BoardGraphElementProps = {\n    uid: '',\n    aggregateType: AGGREGATE_TYPE,\n    name: '',\n    parentId: null,\n    type: GraphElementType.event,\n    children: undefined,\n    sources: undefined,\n    targets: undefined,\n};\n\nexport const createBoardGraphElementFromServerData = (data: any): Either<BoardGraphElementValidationError, BoardGraphElement> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('id'), \"id missing\"],\n        [hasKey('name'), \"name missing in \" + data.id],\n        [hasKey('parentId'), \"parentId missing in \" + data.id],\n        [hasKey('type'), \"type missing in \" + data.id]\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new BoardGraphElement({\n        uid: data.id,\n        aggregateType: AGGREGATE_TYPE,\n        name: data.name,\n        parentId: data.parentId,\n        type: data.type,\n        sources: data.sources || undefined,\n        targets: data.targets || undefined,\n        children: data.children || undefined\n    }));\n};\n\nexport class BoardGraphElement extends Record(defaultBoardGraphElementProps) implements BoardGraphElementProps, Aggregate {\n    public constructor(data: BoardGraphElementProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n}\n","import {List, Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {UserModel} from \"../../User\";\nimport {BoardId} from \"./Board\";\nimport {BoardVersion} from \"./BoardVersion\";\nimport {HistoryAction, HistoryCellType} from \"./HistoryEntry\";\n\nexport interface BoardQueue extends List<BoardChanged>{\n\n}\n\n\nexport interface RawBoardChangedProps {\n    uid: string;\n    name: string;\n    board: BoardId;\n    changeSet: string[];\n    version: number;\n    recordedAt: string;\n    userId: UserModel.UserId;\n    action?: HistoryAction;\n    cellType?: HistoryCellType;\n    cellLabel?: string;\n    cellId?: string;\n}\n\nexport interface BoardChangedProps {\n    uid: string;\n    name: string;\n    board: BoardId;\n    changeSet: List<string>;\n    version: number;\n    recordedAt: string;\n    userId: UserModel.UserId;\n    action?: HistoryAction;\n    cellType?: HistoryCellType;\n    cellLabel?: string;\n    cellId?: string;\n}\n\nexport const defaultBoardChangedProps: BoardChangedProps = {\n    uid: '',\n    name: 'BoardChanged',\n    board: '',\n    changeSet: List(),\n    version: 0,\n    recordedAt: '',\n    userId: '',\n    action: HistoryAction.edited,\n    cellType: HistoryCellType.misc,\n    cellLabel: '',\n    cellId: undefined,\n}\n\nexport const remoteBoardChanged = (data: RawBoardChangedProps): BoardChanged => {\n    const iData = {...data, changeSet: List(data.changeSet)}\n    return new BoardChanged(iData);\n}\n\nexport const localBoardChanged = (\n    board: string,\n    changeSet: List<string>,\n    version: number,\n    userId: string,\n    action: HistoryAction,\n    cellType: HistoryCellType,\n    cellLabel: string,\n    cellId?: string\n): BoardChanged => {\n    return new BoardChanged({\n        uid: '',\n        name: defaultBoardChangedProps.name,\n        board,\n        changeSet,\n        version,\n        recordedAt: '',\n        userId,\n        action,\n        cellType,\n        cellLabel,\n        cellId\n    })\n}\n\nexport const mapServerPatchToBoardChanged = (serverPatch: any): BoardChanged => {\n    return remoteBoardChanged({\n        uid: serverPatch.patchId,\n        board: serverPatch.boardId,\n        name: defaultBoardChangedProps.name,\n        changeSet: serverPatch.patch,\n        version: serverPatch.boardVersion.version,\n        userId: serverPatch.boardVersion.userId,\n        recordedAt: serverPatch.recordedAt,\n        action: serverPatch.action,\n        cellId: serverPatch.cellId !== null? serverPatch.cellId : undefined,\n        cellType: serverPatch.cellType,\n        cellLabel: serverPatch.cellLabel,\n    });\n}\n\nexport class BoardChanged extends Record(defaultBoardChangedProps) implements BoardChangedProps {\n    public constructor(data: BoardChangedProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4();\n        }\n\n        if(data.recordedAt === '') {\n            data.recordedAt = (() => new Date())().toISOString();\n        }\n\n        super(data);\n    }\n\n    public toBoardVersion (): BoardVersion {\n        return new BoardVersion({\n            userId: this.userId,\n            version: this.version\n        })\n    }\n}\n","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {Email, UserId} from \"../../User/model/UserInfo\";\nimport {TeamId} from \"./Team\";\n\nexport const AGGREGATE_TYPE = 'TeamInvitation';\n\nexport type TeamInvitationId = string;\nexport type TeamInvitationError = string;\n\nexport enum Status {\n    open = 'open',\n    acknowledged = 'acknowledged',\n    revoked = 'revoked',\n}\n\nexport interface TeamInvitationProps {\n    uid: TeamInvitationId;\n    teamId: TeamId;\n    admin: UserId;\n    invitedUser: Email;\n    status: Status;\n    resendAttempts: number;\n    aggregateType: AggregateType;\n}\n\nexport const defaultTeamInvitationProps: TeamInvitationProps = {\n    uid: '',\n    teamId: '',\n    admin: '',\n    invitedUser: 'unknown@acme.com',\n    status: Status.open,\n    resendAttempts: 0,\n    aggregateType: AGGREGATE_TYPE,\n};\n\nexport const createTeamInvitationFromServerData = (data: any): Either<TeamInvitationError, TeamInvitation> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('invitationId'), \"invitationId missing\"],\n        [hasKey('teamId'), \"teamId missing in \"+data.invitationId],\n        [hasKey('admin'), \"admin missing in \"+data.invitationId],\n        [hasKey('invitedUser'), \"invitedUser missing in \"+data.invitationId],\n        [hasKey('status'), \"status missing in \"+data.invitationId],\n    );\n\n    if(isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new TeamInvitation({\n        ...data,\n        uid: data.invitationId,\n        aggregateType: AGGREGATE_TYPE,\n    }));\n};\n\nexport class TeamInvitation extends Record(defaultTeamInvitationProps) implements TeamInvitationProps, Aggregate {\n    public constructor(data: TeamInvitationProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    public resend(): TeamInvitation\n    {\n        return this.set(\"resendAttempts\", this.resendAttempts + 1);\n    }\n\n    public revoke(): TeamInvitation\n    {\n        return this.set(\"status\", Status.revoked);\n    }\n}","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {Email, UserId} from \"../../User/model/UserInfo\";\nimport {BoardId} from \"./Board\";\nimport {Permissions} from \"./BoardPermissionForUser\";\n\nexport const AGGREGATE_TYPE = 'BoardInvitation';\n\nexport type BoardInvitationId = string;\nexport type BoardInvitationError = string;\nexport type BoardInvitationStatus = 'pending'|'acknowledged'|'deactivated'|'revoked';\n\nexport interface BoardInvitationProps {\n    uid: BoardInvitationId;\n    aggregateType: AggregateType;\n    boardId: BoardId;\n    invitedUserEmail: Email;\n    invitingUser: UserId;\n    permissions: Permissions;\n    status: BoardInvitationStatus;\n    resendAttempts: number;\n}\n\nexport const defaultBoardInvitationProps: BoardInvitationProps = {\n    uid: '',\n    aggregateType: AGGREGATE_TYPE,\n    boardId: '',\n    invitedUserEmail: '',\n    invitingUser: '',\n    permissions: {adminAccess: false, readAccess: false, writeAccess: false},\n    status: 'pending',\n    resendAttempts: 0,\n};\n\nexport const createBoardInvitationFromServerData = (data: any): Either<BoardInvitationError, BoardInvitation> => {\n    const validatedData: Either<BoardInvitationError, any> = validate(data,\n        [hasKey('invitationId'), \"invitationId missing\"],\n        [hasKey('boardId'), \"boardId missing in \" + data.permissionsId],\n        [hasKey('invitedUserEmail'), \"invitedUserEmail missing in \" + data.permissionsId],\n        [hasKey('invitingUser'), \"invitingUser missing in \" + data.permissionsId],\n        [hasKey('permissions'), \"permissions missing in \" + data.permissionsId],\n        [hasKey('status'), \"status missing in \" + data.permissionsId],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new BoardInvitation({\n        ...defaultBoardInvitationProps,\n        ...data,\n        uid: data.invitationId,\n    }));\n};\n\nexport class BoardInvitation extends Record(defaultBoardInvitationProps) implements BoardInvitationProps, Aggregate {\n    public constructor(data: BoardInvitationProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    public resend(): BoardInvitation\n    {\n        return this.set('resendAttempts', this.resendAttempts + 1);\n    }\n\n    public revoke(): BoardInvitation\n    {\n        return this.set('status', 'revoked');\n    }\n}\n","import {Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {BoardId} from \"./Board\";\n\nexport type PermissionsId = string;\nexport interface Permissions {adminAccess: boolean; readAccess: boolean; writeAccess: boolean}\n\nexport type BoardPermissionValidationError = string;\n\nexport const AGGREGATE_TYPE = 'BoardPermission';\n\nexport interface BoardPermissionForTeamProps {\n    uid: PermissionsId;\n    aggregateType: AggregateType;\n    permissions: Permissions;\n    teamId: TeamId;\n    boardId: BoardId;\n}\n\nexport const defaultBoardPermissionProps: BoardPermissionForTeamProps = {\n    uid: '',\n    aggregateType: AGGREGATE_TYPE,\n    permissions: {adminAccess: false, readAccess: false, writeAccess: false},\n    teamId: '',\n    boardId: '',\n};\n\nexport const createBoardPermissionForTeamFromServerData = (data: any): Either<BoardPermissionValidationError, BoardPermissionForTeam> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('permissionsId'), \"permissionsId missing\"],\n        [hasKey('permissions'), \"permissions missing in \" + data.permissionsId],\n        [hasKey('teamId'), \"teamId missing in \" + data.permissionsId],\n        [hasKey('boardId'), \"boardId missing in \" + data.permissionsId],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new BoardPermissionForTeam({\n        uid: data.permissionsId,\n        aggregateType: AGGREGATE_TYPE,\n        permissions: data.permissions,\n        teamId: data.teamId,\n        boardId: data.boardId\n    }));\n};\n\nexport class BoardPermissionForTeam extends Record(defaultBoardPermissionProps) implements BoardPermissionForTeamProps, Aggregate {\n    public constructor(data: BoardPermissionForTeamProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    public changePermissions(permissions: Permissions): BoardPermissionForTeam\n    {\n        return this.set('permissions', permissions);\n    }\n}\n","import {Record} from 'immutable';\nimport {BoardId, BoardXml} from \"./Board\";\nimport {BoardVersion, defaultBoardVersionProps} from \"./BoardVersion\";\n\nexport interface BoardSnapshotProps {\n    boardId: BoardId,\n    xml: BoardXml,\n    boardVersion: BoardVersion\n}\n\nexport const defaultBoardSnapshotProps: BoardSnapshotProps = {\n    boardId: '',\n    xml: '',\n    boardVersion: new BoardVersion(defaultBoardVersionProps),\n};\n\nexport class BoardSnapshot extends Record(defaultBoardSnapshotProps) implements BoardSnapshotProps {\n    public constructor(data: BoardSnapshotProps) {\n        super(data);\n    }\n}\n","import {axiosApiPromise, ResponseType} from '../../api/util';\nimport { SERVER_CONTEXT } from '../../InspectioBoards/actions/constants';\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {Permissions} from \"../../InspectioBoards/model/BoardPermissionForTeam\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {Team} from \"../model\";\nimport {TeamId} from \"../model/Team\";\nimport {TeamInvitationId} from \"../model/TeamInvitation\";\nimport {BoardId} from \"../../InspectioBoards/model/Board\";\n\nexport const addTeam = (teamId: Team.TeamId, teamName: Team.TeamName,  organizationId: OrganizationId | null) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'AddTeam', { teamId, name: teamName, organizationId });\n};\n\nexport const renameTeam = (teamId: Team.TeamId, name: Team.TeamName) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RenameTeam', {teamId, name});\n};\n\nexport const changeTeamDescription = (teamId: Team.TeamId, newDescription: Team.TeamDescription) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ChangeTeamDescription', {teamId, newDescription});\n};\n\nexport const inviteUserToTeam = (invitationId: string, teamId: string, userEmail: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'InviteUserToTeam', { invitationId, teamId, invitedUser: userEmail });\n};\n\nexport const resendTeamInvitation = (invitationId: TeamInvitationId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'ResendTeamInvitation', {invitationId});\n};\n\nexport const revokeTeamInvitation = (invitationId: TeamInvitationId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RevokeTeamInvitation', {invitationId});\n};\n\nexport const removeMemberFromTeam = (teamId: string, memberId: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'RemoveMemberFromTeam', { teamId, memberId });\n};\n\nexport const deleteTeam = (teamId: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'DeleteTeam', {teamId});\n};\n\nexport const adminGrantTeamAccessToBoard = (boardId: BoardModel.BoardId, teamId: Team.TeamId, permissions?: Permissions) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'AdminGrantTeamAccessToBoard', {\n        boardId,\n        teamId,\n        boardPermissions: (permissions || {\n            readAccess: true,\n            writeAccess: true,\n            adminAccess: false,\n        })\n    });\n};\n\nexport const adminRevokeTeamAccessToBoard = (boardId: BoardModel.BoardId, teamId: Team.TeamId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'AdminRevokeTeamAccessToBoard', {\n        boardId,\n        teamId\n    });\n};\n\nexport const fetchUserTeams = () => {\n    return axiosApiPromise(SERVER_CONTEXT + 'UserTeams', {});\n};\n\nexport const ackTeamInvitation = (invitationId: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'AcknowledgeTeamInvitation', {invitationId})\n};\n\nexport const fetchTeamOfInvitation = (invitationId: string) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'InvitationTeam', {invitationId});\n};\n\nexport const fetchOpenTeamInvitations = (teamId: TeamId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'OpenTeamInvitations', {teamId});\n};\n\nexport const moveTeamToOrganization = (teamId: TeamId, organizationId: OrganizationId) => {\n    return axiosApiPromise(SERVER_CONTEXT + 'MoveTeamToOrganization', {teamId, organizationId});\n}\n","// Commands\nexport const ADD_TEAM = '@@InspectioTeams/AddTeam';\nexport const RENAME_TEAM = '@@InspectioTeams/RenameTeam';\nexport const CHANGE_TEAM_DESCRIPTION = '@@InspectioTeams/ChangeTeamDescription';\nexport const INVITE_USER_TO_TEAM = '@@InspectioTeams/InviteUserToTeam';\nexport const RESEND_TEAM_INVITATION = '@@InspectioTeams/ResendTeamInvitation';\nexport const REVOKE_TEAM_INVITATION = '@@InspectioTeams/RevokeTeamInvitation';\nexport const REMOVE_MEMBER_FROM_TEAM = '@@InspectioTeams/RemoveMemberFromTeam';\nexport const FETCH_USER_TEAMS = '@@InspectioTeams/FetchUserTeams';\nexport const UPDATE_TEAMS = '@@InspectioTeams/AddTeams';\nexport const ADMIN_GRANT_TEAM_ACCESS_TO_BOARD = '@@InspectioTeams/AdminGrantTeamAccessToBoard';\nexport const ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD = '@@InspectioTeams/AdminRevokeTeamAccessToBoard';\nexport const DELETE_TEAM = '@@InspectioTeams/DeleteTeam';\n\n// Events\nexport const TEAM_ADDED = '@@InspectioTeams/TeamAdded';\nexport const TEAM_RENAMED = '@@InspectioTeams/TeamRenamed';\nexport const TEAM_DESCRIPTION_CHANGED = '@@InspectioTeams/TeamDescriptionChanged';\nexport const TEAMS_FETCHED = '@@InspectioTeams/TeamsFetched';\nexport const MEMBER_REMOVED_FROM_TEAM = '@@InspectioTeams/MemberRemovedFromTeam';\nexport const TEAM_DELETED = '@@InspectioTeams/TeamDeleted';\nexport const TEAM_INVITATIONS_LOADED = '@@InspectioTeams/TeamInvitationsLoaded';\nexport const TEAM_INVITATION_RESENT = '@@InspectioTeams/TeamInvitationResent';\nexport const TEAM_INVITATION_REVOKED = '@@InspectioTeams/TeamInvitationRevoked';\n\n// @TODO move to inspectioBoards context?\nexport const TEAM_ACCESS_TO_BOARD_GRANTED = '@InspectioBoards/TeamAccessToBoardGranted';\nexport const TEAM_ACCESS_TO_BOARD_REVOKED = '@InspectioBoards/TeamAccessToBoardRevoked';\n\nexport const MOVE_TEAM_TO_ORGANIZATION = '@@InspectioTeams/MoveTeamToOrganization';\nexport const TEAM_MOVED_TO_ORGANIZATION = '@@InspectioTeams/TeamMovedToOrganization';\n","import {List} from \"immutable\";\nimport { action } from 'typesafe-actions';\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {Permissions} from \"../../InspectioBoards/model/BoardPermissionForTeam\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport * as TeamModel from \"../model/Team\";\nimport {Team, TeamDescription, TeamId, TeamName} from \"../model/Team\";\nimport {TeamInvitationId} from \"../model/TeamInvitation\";\nimport {\n    ADD_TEAM,\n    ADMIN_GRANT_TEAM_ACCESS_TO_BOARD,\n    ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD, CHANGE_TEAM_DESCRIPTION, DELETE_TEAM,\n    INVITE_USER_TO_TEAM, MOVE_TEAM_TO_ORGANIZATION,\n    REMOVE_MEMBER_FROM_TEAM, RENAME_TEAM, RESEND_TEAM_INVITATION, REVOKE_TEAM_INVITATION, UPDATE_TEAMS\n} from \"./constants\";\n\nexport const addTeam = (teamId: TeamId, teamName: TeamName, organizationId: OrganizationId | null) => action(ADD_TEAM, { teamId, teamName, organizationId });\nexport const renameTeam = (teamId: TeamId, newName: TeamName) => action(RENAME_TEAM, {teamId, newName});\nexport const changeTeamDescription = (teamId: TeamId, newDescription: TeamDescription) => action(CHANGE_TEAM_DESCRIPTION, {teamId, newDescription});\n\nexport const inviteUserToTeam = (invitationId: TeamInvitationId, teamId: string, userEmail: string) => action(INVITE_USER_TO_TEAM, { invitationId, teamId, userEmail });\nexport const resendTeamInvitation = (invitationId: TeamInvitationId) => action(RESEND_TEAM_INVITATION, {invitationId});\nexport const revokeTeamInvitation = (invitationId: TeamInvitationId) => action(REVOKE_TEAM_INVITATION, {invitationId});\n\nexport const removeMemberFromTeam = (teamId: string, memberId: string) => action(REMOVE_MEMBER_FROM_TEAM, { teamId, memberId });\n\nexport const updateTeams = (teams: List<TeamModel.Team>) => action(UPDATE_TEAMS, teams);\n\nexport const deleteTeam = (teamId: TeamModel.TeamId) => action(DELETE_TEAM, {teamId});\n\nexport const adminGrantTeamAccessToBoard = (boardId: BoardModel.BoardId, teamIds: TeamModel.TeamId[], permissions?: Permissions) => action(ADMIN_GRANT_TEAM_ACCESS_TO_BOARD, {boardId, teamIds, permissions});\nexport const adminRevokeTeamAccessToBoard = (boardId: BoardModel.BoardId, teamId: TeamModel.TeamId) => action(ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD, {boardId, teamId});\n\nexport const moveTeamToOrganization = (teamId: TeamId, organizationId: OrganizationId) => action(MOVE_TEAM_TO_ORGANIZATION, {teamId, organizationId});\n","import {List} from \"immutable\";\nimport {action} from \"typesafe-actions\";\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {Team} from \"../model\";\nimport {TeamInvitation} from \"../model/TeamInvitation\";\nimport {\n    MEMBER_REMOVED_FROM_TEAM,\n    TEAM_ACCESS_TO_BOARD_GRANTED,\n    TEAM_ACCESS_TO_BOARD_REVOKED,\n    TEAM_ADDED,\n    TEAM_DELETED,\n    TEAM_DESCRIPTION_CHANGED,\n    TEAM_INVITATION_RESENT,\n    TEAM_INVITATION_REVOKED,\n    TEAM_INVITATIONS_LOADED, TEAM_MOVED_TO_ORGANIZATION,\n    TEAM_RENAMED,\n    TEAMS_FETCHED\n} from \"./constants\";\n\nexport const teamAdded = (team: Team.Team) => action(TEAM_ADDED, team);\nexport const teamRenamed = (team: Team.Team) => action(TEAM_RENAMED, team);\nexport const teamDescriptionChanged = (team: Team.Team) => action(TEAM_DESCRIPTION_CHANGED, team);\nexport const memberRemovedFromTeam = (team: Team.Team) => action(MEMBER_REMOVED_FROM_TEAM, team);\nexport const teamDeleted = (team: Team.Team) => action(TEAM_DELETED, team);\nexport const teamInvitationsLoaded = (teamInvitations: List<TeamInvitation>) => action(TEAM_INVITATIONS_LOADED, teamInvitations);\nexport const teamInvitationResent = (teamInvitation: TeamInvitation) => action(TEAM_INVITATION_RESENT, teamInvitation);\nexport const teamInvitationRevoked = (teamInvitation: TeamInvitation) => action(TEAM_INVITATION_REVOKED, teamInvitation);\n\nexport const teamsFetched = (teams: List<Team.Team>) => action(TEAMS_FETCHED, teams);\n\nexport const teamAccessToBoardGranted = (boardId: BoardModel.BoardId, teamId: Team.TeamId) => action(TEAM_ACCESS_TO_BOARD_GRANTED, {boardId, teamId});\nexport const teamAccessToBoardRevoked = (boardId: BoardModel.BoardId, teamId: Team.TeamId) => action(TEAM_ACCESS_TO_BOARD_REVOKED, {boardId, teamId});\n\nexport const teamMovedToOrganization = (team: Team.Team) => action(TEAM_MOVED_TO_ORGANIZATION, team);\n","import {List, Record} from 'immutable';\nimport * as uuid from 'uuid';\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\n\nexport type TeamId = string;\nexport type TeamName = string;\nexport type TeamDescription = string;\nexport type TeamMemberQuota = number;\n\nexport type TeamValidationError = string;\n\nexport const AGGREGATE_TYPE = 'Team';\n\nexport interface TeamProps {\n    uid: TeamId;\n    name: TeamName;\n    description: TeamDescription;\n    ownerId: UserId;\n    members: List<UserId>;\n    admins: List<UserId>;\n    deleted: boolean;\n    aggregateType: AggregateType;\n    isNew: boolean;\n    organizationId: OrganizationId | null;\n}\n\nexport const defaultTeamProps: TeamProps = {\n    uid: '',\n    name: '',\n    description: '',\n    ownerId: '',\n    members: List(),\n    admins: List(),\n    deleted: true,\n    aggregateType: AGGREGATE_TYPE,\n    isNew: false,\n    organizationId: null,\n};\n\nexport const createTeamFromServerData = (data: any): Either<TeamValidationError, Team> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('teamId'), \"teamId missing\"],\n        [hasKey('name'), \"name missing in \"+data.teamId],\n        [hasKey('description'), \"description missing in \"+data.teamId],\n        [hasKey('ownerId'), \"ownerId missing in \"+data.teamId],\n        [hasKey('members'), \"members missing in \"+data.teamId],\n        [hasKey('admins'), \"admins missing in \"+data.teamId],\n        [hasKey('organizationId'), \"organizationId missing in \"+data.teamId],\n        [hasKey('deleted'), \"deleted missing in \"+data.teamId],\n    );\n\n    if(isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new Team({\n        uid: data.teamId,\n        name: data.name,\n        description: data.description,\n        ownerId: data.ownerId,\n        members: List(data.members),\n        admins: List(data.admins),\n        deleted: data.deleted,\n        aggregateType: AGGREGATE_TYPE,\n        isNew: data.isNew || false,\n        organizationId: data.organizationId || null,\n    }));\n};\n\nexport const createNewTeam = (uid: TeamId): Team => {\n    return new Team({...defaultTeamProps, uid, isNew: true});\n};\n\nexport class Team extends Record(defaultTeamProps) implements TeamProps, Aggregate {\n    public constructor(data: TeamProps) {\n        if(data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    public rename(newName: TeamName): Team {\n        return this.set('name', newName);\n    }\n\n    public changeDescription(newDescription: TeamDescription): Team {\n        return this.set('description', newDescription);\n    }\n\n    public removeMember(userId: UserId): Team {\n        const state = this.set('members', this.members.filter(member => member !== userId));\n        return state.set('admins', state.admins.filter(admin => admin !== userId));\n    }\n\n    public moveToOrganization(organizationId: OrganizationId): Team {\n        return this.set('organizationId', organizationId);\n    }\n\n    public isAdmin(userId: UserId): boolean {\n        return this.ownerId === userId || this.admins.contains(userId);\n    }\n}\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {\n    addAggregate,\n    removeAggregate,\n    removeAllAggregates,\n    updateAggregate,\n    upsertAggregates\n} from \"../../core/reducer/applyAggregateChanged\";\nimport {\n    MEMBER_REMOVED_FROM_TEAM,\n    TEAM_ADDED,\n    TEAM_DELETED,\n    TEAM_DESCRIPTION_CHANGED,\n    TEAM_MOVED_TO_ORGANIZATION,\n    TEAM_RENAMED,\n    TEAMS_FETCHED\n} from \"../actions/constants\";\nimport {Team} from '../model';\nimport {InspectioTeamEvent} from './index';\n\nexport interface TeamsState extends Map<string, Team.Team> {\n}\n\nexport const initialState: TeamsState = Map<string, Team.Team>();\n\nconst reducer: Reducer<TeamsState, InspectioTeamEvent> = (state: TeamsState = initialState, event: InspectioTeamEvent): TeamsState => {\n    switch (event.type) {\n        case TEAM_ADDED:\n            return addAggregate(state, event.payload);\n        case TEAM_RENAMED:\n        case TEAM_DESCRIPTION_CHANGED:\n        case MEMBER_REMOVED_FROM_TEAM:\n        case TEAM_MOVED_TO_ORGANIZATION:\n            return updateAggregate(state, event.payload);\n        case TEAMS_FETCHED:\n            state = removeAllAggregates(state);\n            return upsertAggregates(state, event.payload);\n        case TEAM_DELETED:\n            return removeAggregate(state, event.payload);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveTeamReducer };\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport {updateAggregate, upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {TEAM_INVITATION_RESENT, TEAM_INVITATION_REVOKED, TEAM_INVITATIONS_LOADED} from \"../actions/constants\";\nimport * as Events from \"../actions/events\";\nimport {TeamInvitation} from \"../model/TeamInvitation\";\n\ntype Event = ActionType<typeof Events>;\n\nexport interface TeamInvitationState extends Map<string, TeamInvitation> {\n}\n\nexport const initialState: TeamInvitationState = Map<string, TeamInvitation>();\n\nconst reducer: Reducer<TeamInvitationState, Event> = (state: TeamInvitationState = initialState, event: Event): TeamInvitationState => {\n    switch (event.type) {\n        case TEAM_INVITATIONS_LOADED:\n            return upsertAggregates(state, event.payload);\n        case TEAM_INVITATION_RESENT:\n            return updateAggregate(state, event.payload);\n        case TEAM_INVITATION_REVOKED:\n            return updateAggregate(state, event.payload);\n        default:\n            return state;\n    }\n};\n\nexport {reducer as saveTeamInvitationReducer};","import {fromJS} from \"immutable\";\nimport { combineReducers } from 'redux-immutable';\nimport {ActionType} from \"typesafe-actions\";\nimport * as Events from \"../actions/events\";\nimport {saveTeamReducer, TeamsState} from \"./applyTeamEvents\";\nimport {saveTeamInvitationReducer, TeamInvitationState} from \"./applyTeamInvitationEvents\";\n\nexport type InspectioTeamEvent = ActionType<typeof Events>;\n\nexport interface InspectioTeamsState {\n    Team: TeamsState,\n    TeamInvitation: TeamInvitationState,\n}\n\nexport const inspectioTeamsReducer = combineReducers<InspectioTeamsState, InspectioTeamEvent>({\n    Team: saveTeamReducer,\n    TeamInvitation: saveTeamInvitationReducer,\n}, () => fromJS({\n    Team: undefined,\n    TeamInvitation: undefined\n}));","import {List} from \"immutable\";\nimport { map } from 'lodash';\nimport { call, put } from 'redux-saga/effects';\nimport {ResponseType} from \"../../api/util\";\nimport { execForEach, execValidate, isFailure, isSuccess, pipe, Success} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as UserAction from \"../../User/actions\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport * as Action from \"../actions\";\nimport {teamsFetched} from \"../actions/events\";\nimport {Team} from \"../model\";\nimport {createTeamFromServerData} from \"../model/Team\";\n\nfunction* loadMembersOfAllTeams(teams: List<Team.Team>) {\n    let memberIds = List<UserId>();\n\n    teams.forEach(team => {memberIds = memberIds.merge(team.members)});\n\n    // Remove duplicate memberIds\n    memberIds = memberIds.toSet().toList();\n\n    yield put(UserAction.Query.loadUsersInfo(memberIds.toArray()));\n}\n\nexport function* loadUserTeams(newTeam?: Team.TeamId) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchUserTeams);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not load teams'));\n    }\n\n    if (response) {\n        const result = pipe(\n            response!.data,\n            execValidate([isArray(), \"Response data is not of type Array\"]),\n            execForEach((data: any) => {\n                if(newTeam && data.teamId === newTeam) {\n                    data.isNew = true;\n                }\n\n                return createTeamFromServerData(data);\n            }),\n        );\n\n        if(isFailure(result)) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Failed to process team response from server\", result.value, response.data);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load teams'));\n        }\n\n        if(isSuccess(result)) {\n            const teams = List(result.value);\n            yield put(teamsFetched(teams));\n            yield call(loadMembersOfAllTeams, teams);\n        }\n    }\n}\n","import { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport { ResponseType } from '../../api/util';\nimport { Action as NotifyAction } from '../../NotificationSystem/index';\nimport * as Action from '../actions/index';\nimport {createNewTeam} from \"../model/Team\";\nimport {loadUserTeams} from \"./loadUserTeams\";\n\ntype Command = ActionType<typeof Action.Command.addTeam>;\n\nfunction* handleAddTeam(command: Command) {\n    const {response, error}: ResponseType = yield call(Action.Api.addTeam, command.payload.teamId, command.payload.teamName, command.payload.organizationId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not add team.'));\n    }\n    if (response) {\n        const newTeam = createNewTeam(command.payload.teamId);\n        yield put(Action.Event.teamAdded(newTeam.rename(command.payload.teamName)));\n\n        yield put(NotifyAction.Command.info('Team created', 'Team created'));\n        yield call(loadUserTeams, command.payload.teamId);\n    }\n}\n\nexport function* addTeam() {\n\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.ADD_TEAM\n        ]);\n\n        yield fork(handleAddTeam, command);\n    }\n}\n","import {call, fork, put, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Api} from \"../actions\";\nimport {ADMIN_GRANT_TEAM_ACCESS_TO_BOARD, ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD} from \"../actions/constants\";\nimport {Action} from \"../index\";\n\ntype FlowAction = ActionType<typeof Action.Command.adminGrantTeamAccessToBoard> & ActionType<typeof Action.Command.adminRevokeTeamAccessToBoard>;\n\nfunction* onAdminGrantTeamAccessToBoard(action: ActionType<typeof Action.Command.adminGrantTeamAccessToBoard>) {\n    let success = false;\n\n    for (const teamId of action.payload.teamIds) {\n        const {response, error}: ResponseType = yield call(\n            Api.adminGrantTeamAccessToBoard,\n            action.payload.boardId,\n            teamId,\n            action.payload.permissions\n        );\n\n        if(error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not add team to board.'));\n        }\n\n        if(response) {\n            success = true;\n            yield put(Action.Event.teamAccessToBoardGranted(action.payload.boardId, teamId));\n\n        }\n    }\n\n\n    if(success) {\n        const plural = action.payload.teamIds.length > 1 ? 's' : '';\n        yield put(NotifyAction.Command.info('Team Added', `Team${plural} successfully added to board`));\n    }\n\n}\n\nfunction* onAdminRevokeTeamAccessToBoard(action: ActionType<typeof Action.Command.adminRevokeTeamAccessToBoard>) {\n    const {response, error}: ResponseType = yield call(Api.adminRevokeTeamAccessToBoard, action.payload.boardId, action.payload.teamId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not revoke team access.'));\n    }\n\n    if(response) {\n        yield put(Action.Event.teamAccessToBoardRevoked(action.payload.boardId, action.payload.teamId));\n        yield put(NotifyAction.Command.info('Team Access Revoked', 'The team has no longer access to the board.'))\n    }\n}\n\nexport function* adminGrantTeamAccessToBoard() {\n    while (true) {\n        const action: FlowAction = yield take([ADMIN_GRANT_TEAM_ACCESS_TO_BOARD, ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD]);\n\n        switch (action.type) {\n            case ADMIN_GRANT_TEAM_ACCESS_TO_BOARD:\n                yield fork(onAdminGrantTeamAccessToBoard, action);\n                break;\n            case ADMIN_REVOKE_TEAM_ACCESS_TO_BOARD:\n                yield fork(onAdminRevokeTeamAccessToBoard, action);\n                break;\n        }\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {Team} from \"../model\";\nimport {makeTeamSelector} from \"../selectors/selectTeam\";\n\ntype Command = ActionType<typeof Action.Command.changeTeamDescription>\n\nfunction* handleChangeTeamDescription(command: Command) {\n    const orgTeam: Team.Team = yield select(makeTeamSelector(command.payload.teamId));\n\n    const changedTeam = orgTeam.changeDescription(command.payload.newDescription);\n\n    yield put(Action.Event.teamDescriptionChanged(changedTeam));\n\n    const {response, error}: ResponseType = yield call(Action.Api.changeTeamDescription, command.payload.teamId, command.payload.newDescription);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not change team description.'));\n        yield put(Action.Event.teamDescriptionChanged(orgTeam));\n    }\n\n    if(response) {\n        yield put(NotifyAction.Command.info('Team Description Changed', 'Description saved successfully'));\n    }\n}\n\nexport function* changeTeamDescription() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.CHANGE_TEAM_DESCRIPTION\n        ]);\n\n        yield fork(handleChangeTeamDescription, command);\n    }\n}","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {Team} from \"../model\";\nimport {makeTeamSelector} from \"../selectors/selectTeam\";\nimport {loadUserTeams} from \"./loadUserTeams\";\n\ntype Command = ActionType<typeof Action.Command.deleteTeam>\n\nfunction* handleDeleteTeam(command: Command) {\n    const team: Team.Team = yield select(makeTeamSelector(command.payload.teamId));\n    const {response, error}: ResponseType = yield call(Action.Api.deleteTeam, command.payload.teamId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not delete team.'));\n    }\n    if (response) {\n        yield put(NotifyAction.Command.info('Team deleted', 'Team ' + team.name  + 'deleted'));\n        yield put(Action.Event.teamDeleted(team));\n    }\n}\n\nexport function* deleteTeam() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.DELETE_TEAM\n        ]);\n\n        yield fork(handleDeleteTeam, command);\n    }\n}","import {call, put, select, take} from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport { ResponseType } from '../../api/util';\nimport { Action as NotifyAction } from '../../NotificationSystem/index';\nimport * as Action from '../actions/index';\nimport {loadUserTeams} from \"./loadUserTeams\";\nimport {makeTeamSelector} from \"../selectors/selectTeam\";\n\ntype FlowAction = ActionType<typeof Action.Command.inviteUserToTeam>;\n\nexport function* inviteUserToTeam() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.INVITE_USER_TO_TEAM\n        ]);\n\n        const {response, error}: ResponseType = yield call(Action.Api.inviteUserToTeam, action.payload.invitationId, action.payload.teamId, action.payload.userEmail);\n\n        const team = yield select(makeTeamSelector(action.payload.teamId));\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not add user to team.'));\n        }\n        if (response) {\n            yield put(NotifyAction.Command.info('User invited', 'The user was invited to the team.'));\n\n            yield call(loadUserTeams, team.isNew? team.uid : undefined);\n        }\n    }\n}\n","import { call, fork, put, select, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport { ResponseType } from '../../api/util';\nimport { Action as NotifyAction } from '../../NotificationSystem/index';\nimport {memberRemovedFromTeam} from \"../actions/events\";\nimport * as Action from '../actions/index';\nimport {Team} from \"../model\";\nimport {makeTeamSelector} from \"../selectors/selectTeam\";\n\ntype Command = ActionType<typeof Action.Command.removeMemberFromTeam>;\n\nfunction* handleRemoveMemberFromTeam(command: Command) {\n    const team: Team.Team|undefined = yield select(makeTeamSelector(command.payload.teamId));\n\n    if(!team) {\n        yield put(NotifyAction.Command.error('Internal Error', 'Team could not be loaded from local store. Please contact support.'));\n        return;\n    }\n\n    const {response, error}: ResponseType = yield call(Action.Api.removeMemberFromTeam, command.payload.teamId, command.payload.memberId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not remove member from team.'));\n    }\n    if (response) {\n        yield put(memberRemovedFromTeam(team.removeMember(command.payload.memberId)));\n        yield put(NotifyAction.Command.info('Member removed', 'The member was removed from the team.'));\n    }\n}\n\nexport function* removeMemberFromTeam() {\n\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.REMOVE_MEMBER_FROM_TEAM\n        ]);\n\n        yield fork(handleRemoveMemberFromTeam, command);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {Team} from \"../model\";\nimport {makeTeamSelector} from \"../selectors/selectTeam\";\n\ntype Command = ActionType<typeof Action.Command.renameTeam>\n\nfunction* handleRenameTeam(command: Command) {\n    let team: Team.Team = yield select(makeTeamSelector(command.payload.teamId));\n\n    const oldName = team.name;\n\n    team = team.rename(command.payload.newName);\n\n    yield put(Action.Event.teamRenamed(team));\n\n    const {response, error}: ResponseType = yield call(Action.Api.renameTeam, command.payload.teamId, command.payload.newName);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not rename team.'));\n        team = team.rename(oldName);\n        yield put(Action.Event.teamRenamed(team));\n    }\n    if (response) {\n        yield put(NotifyAction.Command.info('Team renamed', 'Team renamed to: ' + command.payload.newName));\n    }\n}\n\nexport function* renameTeam() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.RENAME_TEAM\n        ]);\n\n        yield fork(handleRenameTeam, command);\n    }\n}","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {TeamInvitation, TeamInvitationId} from \"../model/TeamInvitation\";\n\nexport const getTeamInvitationById = (state: Record<ApplicationState>, uid: TeamInvitationId): TeamInvitation | undefined => state.getIn([MODULE, 'TeamInvitation', uid]);\n\nexport const makeTeamInvitationSelector = (uid: TeamInvitationId): (state: Record<ApplicationState>) => TeamInvitation | undefined => (state: Record<ApplicationState>) => getTeamInvitationById(state, uid);\n\nexport const teamInvitationListSelector = (state: Record<ApplicationState>, props: any): List<TeamInvitation> =>\n    List(state.getIn([MODULE, 'TeamInvitation']).toIndexedSeq().toArray()) || List();\n\nexport const makeTeamInvitationListSelector = (): (state: Record<ApplicationState>, props?: any) => List<TeamInvitation> => {\n    return createSelector(\n        [teamInvitationListSelector],\n        (TeamInvitationList): List<TeamInvitation> => {\n            return TeamInvitationList;\n        }\n    )\n};","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeTeamInvitationSelector} from \"../selectors/TeamInvitation\";\n\ntype Command = ActionType<typeof Action.Command.resendTeamInvitation>\n\nfunction* handleResendTeamInvitation(command: Command) {\n    const teamInvitation = yield select(makeTeamInvitationSelector(command.payload.invitationId));\n\n    if(teamInvitation) {\n        const {response, error} = yield call(Action.Api.resendTeamInvitation, command.payload.invitationId);\n\n        if(error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not resend team invitation.'));\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info(\n                'insp.team.notify.invitation_resend.success.title',\n                'insp.team.notify.invitation_resend.success.msg',\n                {email: teamInvitation.invitedUser}\n            ));\n        }\n\n        yield put(Action.Event.teamInvitationResent(teamInvitation.resend()));\n    }\n}\n\nexport function* resendTeamInvitation() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.RESEND_TEAM_INVITATION\n        ]);\n\n        yield fork(handleResendTeamInvitation, command);\n    }\n}","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {makeTeamInvitationSelector} from \"../selectors/TeamInvitation\";\n\ntype Command = ActionType<typeof Action.Command.revokeTeamInvitation>\n\nfunction* handleRevokeTeamInvitation(command: Command) {\n    const teamInvitation = yield select(makeTeamInvitationSelector(command.payload.invitationId));\n\n    if(teamInvitation) {\n        const {response, error} = yield call(Action.Api.revokeTeamInvitation, command.payload.invitationId);\n\n        if(error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not revoke team invitation.'));\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info(\n                'insp.team.notify.invitation_revoke.success.title',\n                'insp.team.notify.invitation_revoke.success.msg',\n                {email: teamInvitation.invitedUser}\n            ));\n\n            yield put(Action.Event.teamInvitationRevoked(teamInvitation.revoke()));\n        }\n    }\n}\n\nexport function* revokeTeamInvitation() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.REVOKE_TEAM_INVITATION\n        ]);\n\n        yield fork(handleRevokeTeamInvitation, command);\n    }\n}","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport * as UserModule from \"../../User\";\nimport {loadUserTeams} from \"./loadUserTeams\";\n\ntype Event = ActionType<typeof UserModule.Action.Event.activeOrganizationSwitched>\n\nfunction* handleRefreshUserTeams(event: Event) {\n    yield call(loadUserTeams);\n}\n\nexport function* refreshUserTeams() {\n    while (true) {\n        const event: Event = yield take([\n            UserModule.Action.Type.ACTIVE_ORGANIZATION_SWITCHED\n        ]);\n\n        yield fork(handleRefreshUserTeams, event);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {teamMovedToOrganization} from \"../actions/events\";\nimport {Action} from \"../index\";\nimport {Team} from \"../model\";\nimport {makeTeamSelector} from \"../selectors/selectTeam\";\n\ntype Command = ActionType<typeof Action.Command.moveTeamToOrganization>\n\nfunction* handleMoveTeamToOrganization(command: Command) {\n    const team: Team.Team|undefined = yield select(makeTeamSelector(command.payload.teamId));\n\n    if(!team) {\n        yield put(NotifyAction.Command.error('Internal Error', 'Team could not be loaded from local store. Please contact support.'));\n        return;\n    }\n\n    const {response, error}: ResponseType = yield call(Action.Api.moveTeamToOrganization, command.payload.teamId, command.payload.organizationId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not move team to organization'));\n    }\n    if (response) {\n        yield put(teamMovedToOrganization(team.moveToOrganization(command.payload.organizationId)));\n        yield put(NotifyAction.Command.info('Team moved', 'Moved team successfully to organization.'));\n    }\n}\n\nexport function* moveTeamToOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.MOVE_TEAM_TO_ORGANIZATION\n        ]);\n\n        yield fork(handleMoveTeamToOrganization, command);\n    }\n}\n","import * as Action from \"./actions\";\nimport * as Model from \"./model\";\nimport * as Reducer from \"./reducers\";\nimport * as Saga from \"./sagas\";\nimport * as Selector from \"./selectors\";\n\nconst MODULE = 'inspectioTeams';\n\nexport {\n    MODULE,\n    Reducer,\n    Action,\n    Model,\n    Saga,\n    Selector\n};\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Dropdown, DropdownItemProps, Icon} from \"semantic-ui-react\";\nimport * as Action from \"../../actions\";\nimport {makeGetBoardOverview} from \"../../selectors/boardList\";\nimport {makeUserSettingSelector} from \"../../../User/selectors/userSettings\";\nimport {useEffect, useState} from \"react\";\n\nexport enum SORT_OPTIONS {\n    NAME_ASC = 'NAME_ASC',\n    NAME_DESC = 'NAME_DESC',\n    CREATED_AT_ASC = 'CREATED_AT_ASC',\n    CREATED_AT_DESC = 'CREATED_AT_DESC',\n    LAST_MODIFIED_ASC = 'LAST_MODIFIED_ASC',\n    LAST_MODIFIED_DESC = 'LAST_MODIFIED_DESC'\n}\n\nenum SORT_BY {\n    NAME = 'NAME',\n    CREATED_AT = 'CREATED_AT',\n    LAST_MODIFIED = 'LAST_MODIFIED'\n}\n\ntype SORT_ORDER = \"up\" | \"down\";\n\ninterface OwnProps {\n\n}\n\ntype SortingProps = OwnProps & WithNamespaces;\n\nconst convertSortOptionToSortValues = (option: SORT_OPTIONS): [SORT_BY, SORT_ORDER] => {\n    switch (option) {\n        case SORT_OPTIONS.NAME_ASC:\n            return [SORT_BY.NAME, \"down\"];\n        case SORT_OPTIONS.NAME_DESC:\n            return [SORT_BY.NAME, \"up\"];\n        case SORT_OPTIONS.CREATED_AT_ASC:\n            return [SORT_BY.CREATED_AT, \"down\"];\n        case SORT_OPTIONS.CREATED_AT_DESC:\n            return [SORT_BY.CREATED_AT, \"up\"];\n        case SORT_OPTIONS.LAST_MODIFIED_ASC:\n            return [SORT_BY.LAST_MODIFIED, \"down\"];\n        case SORT_OPTIONS.LAST_MODIFIED_DESC:\n            return [SORT_BY.LAST_MODIFIED, \"up\"];\n    }\n}\n\nconst convertSortValuesToSortOption = (sortBy: SORT_BY, sortOrder: SORT_ORDER): SORT_OPTIONS => {\n    return sortBy + '_' + (sortOrder === \"up\"? \"DESC\" : \"ASC\") as SORT_OPTIONS;\n}\n\nconst Sorting = (props: SortingProps) => {\n    const boardOverviewState = useSelector(makeGetBoardOverview());\n    const [currentSortBy, currentSortOrder] = convertSortOptionToSortValues(boardOverviewState.sortBy);\n    const [sort, setSort] = useState<SORT_ORDER>(currentSortOrder);\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if(currentSortOrder !== sort) {\n            setSort(currentSortOrder);\n        }\n    }, [currentSortOrder]);\n\n    const options: DropdownItemProps[] = [\n        {key: SORT_BY.NAME, text: props.t('insp.overview.sort.'+SORT_BY.NAME), value: SORT_BY.NAME},\n        {key: SORT_BY.CREATED_AT, text: props.t('insp.overview.sort.'+SORT_BY.CREATED_AT), value: SORT_BY.CREATED_AT},\n        {key: SORT_BY.LAST_MODIFIED, text: props.t('insp.overview.sort.'+SORT_BY.LAST_MODIFIED), value: SORT_BY.LAST_MODIFIED},\n    ]\n\n    const handleSortChanged = (sortBy: SORT_BY): void => {\n        dispatch(Action.Command.sortBoardOverview(convertSortValuesToSortOption(sortBy, sort)));\n    }\n\n    const handleSortOrderChanged = (e: MouseEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n\n        if(sort === \"up\") {\n            setSort(\"down\")\n        } else {\n            setSort(\"up\")\n        }\n\n        dispatch(Action.Command.sortBoardOverview(convertSortValuesToSortOption(currentSortBy, sort === \"up\"? \"down\" : \"up\")));\n    }\n\n    const checkIconClick = (e: React.KeyboardEvent<HTMLElement>) => {\n        const clickedEl: HTMLElement = e.target as HTMLElement;\n        if(clickedEl.tagName === 'I') {\n            clickedEl.parentElement!.blur();\n        }\n    }\n\n    return <Dropdown\n        selection={true}\n        options={options}\n        fluid={true}\n        value={currentSortBy}\n        onClick={checkIconClick}\n        onChange={(e, data) => handleSortChanged(data.value as SORT_BY)}\n        icon={<Icon name={\"sort amount \"+sort as any} style={{float: \"right\", cursor: \"pointer\"}} onClick={handleSortOrderChanged} />}\n        style={{paddingRight: \"5px\"}}\n    />\n};\n\nexport default withNamespaces()(Sorting);\n","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {makeActiveOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {ApplicationState} from \"../../reducer\";\nimport * as UserModule from \"../../User\";\nimport {MODULE} from \"../index\";\nimport {Team, TeamId} from \"../model/Team\";\n\nexport const getTeamById = (state: Record<ApplicationState>, uid: TeamId): Team|undefined => state.getIn([MODULE, 'Team', uid]);\n\nexport const makeTeamSelector = (teamId: TeamId): (state: Record<ApplicationState>) => Team|undefined => (state: Record<ApplicationState>) => getTeamById(state, teamId);\n\nexport const teamListSelector = (state: Record<ApplicationState>, props: any): List<Team> =>\n    List(state.getIn([MODULE, 'Team']).toIndexedSeq().toArray()) || List();\n\nexport const makeTeamListSelector = (withAdminAccess?: boolean): (state: Record<ApplicationState>, props?: any) => List<Team> => {\n    const currentUserSelector = UserModule.UserSelector.makeGetCurrentUser();\n    const activeOrganizationSelector = makeActiveOrganizationSelector();\n\n    return createSelector(\n        [teamListSelector, currentUserSelector, activeOrganizationSelector],\n        (teams, user, activeOrganization): List<Team> =>  {\n            teams = teams.filter(team => !team.deleted).filter(team => activeOrganization\n                ? team.organizationId === activeOrganization.uid || (!activeOrganization.explicit && team.organizationId === null)\n                : team.organizationId === null);\n            if(withAdminAccess) {\n                teams = teams.filter(team => team.isAdmin(user.uid) || (activeOrganization && activeOrganization.admins.includes(user.uid)));\n            }\n\n            return teams;\n        }\n    )\n};\n","import { Map, Record } from 'immutable';\nimport { createSelector } from 'reselect';\nimport { ApplicationState } from '../../reducer';\nimport {UserSettingsValue, UserSettingsValues} from \"../model/UserSettings\";\nimport {BoardId} from \"../../InspectioBoards/model/Board\";\n\nexport const keyBoardHidden = (boardId: BoardId) => `board_${boardId}_hidden`;\nexport const keyUpdateViewed = (date: string) => `update_${date}_viewed`;\nexport const keyLiteMode = () => 'lite_mode';\n\nexport const userSettingsSelector = (state: Record<ApplicationState>, props: any) => state.getIn(['inspectioUsers', 'userSettings']);\n\nexport const makeUserSettingSelector = (key: string, defaultVal?: UserSettingsValue): (state: Record<ApplicationState>, props?: any) => UserSettingsValue => {\n    return createSelector(\n        [userSettingsSelector],\n        (settings: Map<string, UserSettingsValue>): any => settings.has(key) ? settings.get(key) : defaultVal\n    );\n};\n\nexport const makeUserSettingsSelector = (): (state: Record<ApplicationState>, props?: any) => UserSettingsValues => {\n    return createSelector(\n        [userSettingsSelector],\n        (settings: Map<string, UserSettingsValue>): UserSettingsValues => settings.toObject()\n    );\n};\n\nexport const makeUserSettingsLoadedSelector = (): (state: Record<ApplicationState>, props?: any) => boolean => {\n    return createSelector(\n        [userSettingsSelector],\n        (settings: Map<string, UserSettingsValue>): boolean => !!settings.get('settings_loaded')\n    );\n};\n\n","import {List, Record} from \"immutable\";\nimport { createSelector } from 'reselect';\nimport {Team} from \"../../InspectioTeams/model\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport {ApplicationState} from \"../../reducer\";\nimport {UserModel, UserSelector} from '../../User';\nimport {UserSettingsState} from \"../../User/reducers/applyUserSettingsActions\";\nimport {currentUserSelector} from \"../../User/selectors/currentUser\";\nimport {keyBoardHidden, userSettingsSelector} from \"../../User/selectors/userSettings\";\nimport {SORT_OPTIONS} from \"../components/BoardOverview/Sorting\";\nimport {BoardModel} from \"../model\";\nimport {BoardOverviewState} from \"../reducers/applyOverviewActions\";\n\nexport const boardListSelector = (state: Record<ApplicationState>, props: any): List<BoardModel.Board> => List(state.getIn(['inspectioBoards', 'boards']).toIndexedSeq().toArray()) || List();\n\nexport const boardLoadingSelector = (state: Record<ApplicationState>, props: any): boolean => !!state.getIn(['inspectioBoards', 'loadingBoards']);\n\nexport const initialBoardListLoadedSelector = (state: Record<ApplicationState>, props: any): boolean => state.getIn(['inspectioBoards', 'initialBoardListLoaded']) || false;\n\nexport const boardOverviewSelector = (state: Record<ApplicationState>, props?: any): BoardOverviewState => state.getIn(['inspectioBoards', 'overview']);\n\nexport const makeGetAllBoards = (): (state: Record<ApplicationState>, props?: any) => List<BoardModel.Board> => {\n    const activeUserOrganizationInfoSelector = makeActiveUserOrganizationInfoSelector();\n\n    return createSelector(\n        [boardListSelector,  activeUserOrganizationInfoSelector],\n        (boards, activeOrganization) => {\n            boards = boards.filter(board => {\n                if(activeOrganization) {\n                    if(!activeOrganization.explicitOrganization && board.organization === null) {\n                        return true;\n                    }\n\n                    return board.organization === activeOrganization.organizationId;\n                } else {\n                    return board.organization === null;\n                }\n            })\n\n            boards = boards.sortBy(board => board.name, (a, b) => a === b ? 0 : (a! > b! ? 1 : -1)  )\n\n            return boards;\n        }\n    );\n}\n\nexport const makeGetBoards = (returnHiddenBoards: boolean = false): (state: Record<ApplicationState>, props?: any) => List<BoardModel.Board> => {\n    const activeUserOrganizationInfoSelector = makeActiveUserOrganizationInfoSelector();\n\n    return createSelector(\n        [boardListSelector, boardOverviewSelector, userSettingsSelector, currentUserSelector, activeUserOrganizationInfoSelector],\n        (boards, boardOverview: BoardOverviewState, userSettings: UserSettingsState, currentUser: UserModel.UserInfo, activeOrganization): List<BoardModel.Board> =>  {\n\n            boards = boards.filter(board => {\n                if(activeOrganization) {\n                    if(!activeOrganization.explicitOrganization && board.organization === null) {\n                        return true;\n                    }\n\n                    return board.organization === activeOrganization.organizationId;\n                } else {\n                    return board.organization === null;\n                }\n            })\n\n            if(boardOverview.filter !== '') {\n                const parts = boardOverview.filter.split(\" \").map(part => part.trim());\n                const tags: string[] = parts.filter(part => part.charAt(0) === '#');\n                if(tags.length) {\n                    boards = boards.filter((board) => {\n                        let allTagsMatch = true;\n                        tags.forEach(tag => {\n                            if(!board.tags.contains(tag.slice(1))) {\n                                allTagsMatch = false;\n                            }\n                        })\n                        return allTagsMatch;\n                    })\n                }\n\n                const filterRest = parts.filter(part => part.charAt(0) !== '#').join(\" \").toLowerCase();\n\n                if(filterRest !== '') {\n                    boards = boards.filter((board) => {\n                        return board.name.toLowerCase().search(filterRest) !== -1;\n                    })\n                }\n            }\n\n            if(boardOverview.responsibleTeam) {\n                boards = boards.filter((board) => {\n                    return board.assignedTeams.contains(boardOverview.responsibleTeam as TeamId)\n                })\n            }\n\n            if(!returnHiddenBoards && boardOverview.allSharedBoardsHidden) {\n                boards = boards.filter(board => !board.shared);\n            }\n\n            if(!returnHiddenBoards && boardOverview.allOwnBoardsHidden) {\n                boards = boards.filter(board => board.shared);\n            }\n\n            if(!returnHiddenBoards) {\n                boards = boards.filter(board => {\n                    return userSettings.get(keyBoardHidden(board.uid)) !== true\n                })\n            }\n\n            switch (boardOverview.sortBy) {\n                case SORT_OPTIONS.NAME_ASC:\n                    boards = boards.sortBy(board => board.name, (a, b) => a === b ? 0 : (a! > b! ? 1 : -1)  )\n                    break;\n                case SORT_OPTIONS.NAME_DESC:\n                    boards = boards.sortBy(board => board.name, (a, b) => a === b ? 0 : (a! > b! ? -1 : 1)  )\n                    break;\n                case SORT_OPTIONS.LAST_MODIFIED_ASC:\n                    boards = boards.sortBy(board => board.lastModified, (a, b) => a === b ? 0 : (a! > b! ? 1 : -1)  )\n                    break;\n                case SORT_OPTIONS.LAST_MODIFIED_DESC:\n                    boards = boards.sortBy(board => board.lastModified, (a, b) => a === b ? 0 : (a! > b! ? -1 : 1)  )\n                    break;\n                case SORT_OPTIONS.CREATED_AT_ASC:\n                    boards = boards.sortBy(board => board.createdAt, (a, b) => a === b ? 0 : (a! > b! ? 1 : -1)  )\n                    break;\n                case SORT_OPTIONS.CREATED_AT_DESC:\n                    boards = boards.sortBy(board => board.createdAt, (a, b) => a === b ? 0 : (a! > b! ? -1 : 1)  )\n                    break;\n            }\n\n            return boards;\n        }\n    )\n};\n\nexport const makeGetTeamBoards = (teamId: Team.TeamId): (state: Record<ApplicationState>, props?: any) => List<BoardModel.Board> => {\n    return createSelector(\n        [boardListSelector],\n        (boards): List<BoardModel.Board> => boards.filter(board => board.assignedTeams.contains(teamId))\n    )\n}\n\nexport const makeIsLoadingBoards = (): (state: Record<ApplicationState>, props?: any) => boolean => {\n    return  createSelector(\n        [boardLoadingSelector],\n        (isLoading): boolean => isLoading\n    )\n};\n\nexport const makeInitialBoardListLoaded = (): (state: Record<ApplicationState>, props?: any) => boolean => {\n    return createSelector(\n        [initialBoardListLoadedSelector],\n        (listLoaded): boolean => listLoaded\n    )\n}\n\nexport const makeHasBoards = (): (state: Record<ApplicationState>, props?: any) => boolean => {\n    const activeUserOrganizationInfoSelector = makeActiveUserOrganizationInfoSelector();\n\n    return createSelector(\n        [boardListSelector, activeUserOrganizationInfoSelector],\n        (boards, activeOrganization): boolean => {\n            boards = boards.filter(board => {\n                if(activeOrganization) {\n                    if(!activeOrganization.explicitOrganization && board.organization === null) {\n                        return true;\n                    }\n\n                    return board.organization === activeOrganization.organizationId;\n                } else {\n                    return board.organization === null;\n                }\n            })\n\n            return boards.count() > 0;\n        }\n    )\n}\n\nexport const makeGetBoardOverview = (): (state: Record<ApplicationState>, props?: any) => BoardOverviewState => {\n    return createSelector(\n        [boardOverviewSelector],\n        (boardOverview: BoardOverviewState): BoardOverviewState => boardOverview\n    )\n}\n\nexport const makeMapStateToPropsBoardOverview = () => {\n    const getBoards = makeGetBoards();\n    const getQuota = UserSelector.makeGetCurrentBoardQuota();\n    const isLoadingBoards = makeIsLoadingBoards();\n\n    return (state: Record<ApplicationState>, props: any) => {\n        const boards = getBoards(state, props).filter(board => !board.tempBoard);\n        const userQuota = getQuota(state, props);\n        const loading = isLoadingBoards(state, props);\n\n        return {\n            boards,\n            userQuota,\n            loading,\n        }\n    }\n}\n","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {boardListSelector} from \"./boardList\";\n\nexport const makeGetTags = (): (state: Record<ApplicationState>, props?: any) => List<string> => {\n    return createSelector(\n        [boardListSelector],\n        (boards) => {\n            const tags: string[] = [];\n\n            boards.forEach(board => {\n                board.tags.forEach(tag => {\n                    if(!tags.includes(tag)) {\n                        tags.push(tag);\n                    }\n                })\n            })\n\n            return List(tags);\n        }\n    )\n}\n","import {Map} from \"immutable\";\nimport React, {FormEvent, useRef, useState} from 'react'\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport { Field, reduxForm } from 'redux-form/immutable'\nimport {\n    Button, Checkbox,\n    Divider,\n    Dropdown,\n    DropdownItemProps,\n    Header,\n    Icon, Input,\n    Transition,\n    TransitionGroup\n} from \"semantic-ui-react\";\nimport {makeTeamListSelector} from \"../../InspectioTeams/selectors/selectTeam\";\nimport {isStandalone} from \"../../standalone/util\";\nimport {deriveAbbreviationFromBoardName} from \"../model/Board\";\nimport {makeGetTags} from \"../selectors/tags\";\nimport {ADD_BOARD_FORM} from \"./constants\";\n\ninterface FormData  {\n    uid: string,\n    name: string;\n    nameAbbreviation: string;\n    tags: string[];\n    responsibleTeam: string;\n    codySuggestEnabled: string;\n    eventModelingEnabled: string;\n}\n\nexport interface ImFormData extends Map<string, string | string[]> {\n    toJS(): FormData\n}\n\nexport interface OwnProps {\n    onSubmit: (data: ImFormData) => void;\n    isAddingBoard?: boolean;\n}\n\nexport interface PropsFromDispatch {\n\n}\n\n\nexport type AddBoardFormProps = OwnProps & PropsFromDispatch & WithNamespaces;\n\nconst required = (val: string|undefined) => val? undefined : 'Required';\n\nconst AddBoardForm = (props: AddBoardFormProps) => {\n    const [showSettings, setShowSettings] = useState(false);\n    const existingTags = useSelector(makeGetTags());\n    const availableTags = useRef<DropdownItemProps[]>(existingTags.map(tag => ({key: tag, text: '#'+tag, value: tag})).toJS());\n    const teams = useSelector(makeTeamListSelector());\n    const teamOptions: DropdownItemProps[] = [];\n\n    const [boardName, setBoardName] = useState('');\n    const [boardNameInvalid, setBoardNameInvalid] = useState(false);\n\n    const [abbr, setAbbr] = useState('');\n    const [abbrTouched, setAbbrTouched] = useState(false);\n    const [abbrInvalid, setAbbrInvalid] = useState(false);\n\n    const [codySuggestEnabled, setCodySuggestEnabled] = useState(true);\n    const [eventModelingEnabled, setEventModelingEnabled] = useState(true);\n\n    const [tags, setTags] = useState<string[]>([]);\n    const [responsibleTeam, setResponsibleTeam] = useState<string|undefined>(undefined);\n\n    teamOptions.push({\n        key: 'none',\n        text: 'No Team',\n        value: undefined\n    });\n\n    teams.forEach(team => teamOptions.push({key: team.uid, text: team.name, value: team.uid}));\n\n    const addTagOption = (tag: string) => {\n        if(tag.length === 0) {\n            return;\n        }\n\n        if(tag.charAt(0) !== '#') {\n            tag = '#'+tag;\n        }\n\n        const tagVal = tag.slice(1);\n\n        availableTags.current.push({\n            key: tagVal,\n            text: tag,\n            value: tagVal\n        })\n    }\n\n    const handleChangeBoardName = (val: string) => {\n        setBoardNameInvalid(false);\n        setBoardName(val);\n\n        if(!abbrTouched) {\n            setAbbr(deriveAbbreviationFromBoardName(val));\n        }\n    }\n\n    const handleChangeAbbr = (val: string) => {\n        setAbbr(val);\n        setAbbrTouched(true);\n\n        if(val === '' || val.length > 3) {\n            setAbbrInvalid(true);\n        } else if(abbrInvalid) {\n            setAbbrInvalid(false);\n        }\n    }\n\n    const handleCodySuggestEnabledChanged = (enabled: boolean) => {\n        setCodySuggestEnabled(enabled);\n    }\n\n    const handleEventModelingEnabledChanged = (enabled: boolean) => {\n        setEventModelingEnabled(enabled);\n    }\n\n    const handleSubmit = (evt: FormEvent) => {\n        evt.preventDefault();\n        evt.stopPropagation();\n\n        if(!boardName) {\n            setBoardNameInvalid(true);\n            return;\n        }\n\n        if(abbrInvalid) {\n            return;\n        }\n\n        props.onSubmit(Map({\n            name: boardName,\n            nameAbbreviation: abbr,\n            tags,\n            responsibleTeam,\n            codySuggestEnabled: codySuggestEnabled? '1' : '',\n            eventModelingEnabled: eventModelingEnabled? '1': '',\n        }) as ImFormData)\n    }\n\n    return <form className=\"ui form\" onSubmit={handleSubmit}>\n        <div className={'field' + (boardNameInvalid? ' error' : '')}>\n            <Input name=\"name\"\n                   type=\"text\"\n                   placeholder={props.t('insp.board.form.board_name') as string}\n                   autoFocus={true}\n                   onChange={(evt, data) => handleChangeBoardName(data.value)}\n                   error={boardNameInvalid}\n                   value={boardName}\n            />\n        </div>\n        <Divider horizontal={true}>\n            <Header as=\"h4\" onClick={() => setShowSettings(!showSettings)} style={{cursor: 'pointer'}}>\n                {props.t('insp.board.advanced_settings')}\n                &nbsp;\n                {showSettings? '-' : '+'}\n            </Header>\n        </Divider>\n        <div className={showSettings ? 'slidedown' : 'slideup'}>\n            <div className=\"field\">\n                <Checkbox toggle={true}\n                          label={<label>{props.t('insp.board.form.cody_suggest')}&nbsp;&nbsp;<Icon\n                            name=\"question circle outline\" title={props.t('insp.board.cody_suggest_sub')}/></label>}\n                          name=\"codySuggestEnabled\"\n                          checked={codySuggestEnabled}\n                          value={codySuggestEnabled ? '1' : ''}\n                          onChange={(e, data) => handleCodySuggestEnabledChanged(data.value !== '1')}\n                />\n            </div>\n            <div className=\"field\">\n                <Checkbox toggle={true}\n                          label={<label>{props.t('insp.board.form.event_modeling')}&nbsp;&nbsp;<Icon\n                            name=\"question circle outline\" title={props.t('insp.board.event_modeling_sub')}/></label>}\n                          name=\"eventModelingEnabled\"\n                          checked={eventModelingEnabled}\n                          value={eventModelingEnabled ? '1' : ''}\n                          onChange={(e, data) => handleEventModelingEnabledChanged(data.value !== '1')}\n                />\n            </div>\n            <div className={'field' + (abbrInvalid ? ' error' : '')}>\n                <Input name=\"nameAbbreviation\"\n                       type=\"text\"\n                       placeholder={props.t('insp.board.form.board_abbr') as string}\n                       value={abbr}\n                       onChange={(evt, data) => handleChangeAbbr(data.value)}\n                       error={abbrInvalid}\n                />\n            </div>\n            <div className=\"field\">\n                <Dropdown\n                  multiple={true}\n                  allowAdditions={true}\n                  name=\"tags\"\n                  placeholder=\"Tags\"\n                  fluid={true}\n                  search={true}\n                  selection={true}\n                  options={availableTags.current}\n                  value={tags}\n                  onAddItem={(evt, data) => addTagOption(data.value as string)}\n                  onChange={(evt, data) => setTags(data.value as string[])}\n                />\n            </div>\n            {!isStandalone() && <div className=\"field\">\n                <Dropdown\n                  name=\"responsibleTeam\"\n                  placeholder={props.t('insp.board.form.responsible_team') as string}\n                  fluid={true}\n                  selection={true}\n                  options={teamOptions}\n                  value={responsibleTeam}\n                  onChange={(evt, data) => setResponsibleTeam(data.value as string | undefined)}\n                />\n            </div>}\n            <p>&nbsp;</p>\n        </div>\n        <Button primary={true} type=\"submit\"\n                disabled={props.isAddingBoard}>{props.t('insp.board.form.btn_add_save')}</Button>\n    </form>;\n}\n\nexport default withNamespaces()(reduxForm<ImFormData, OwnProps & WithNamespaces>({form: ADD_BOARD_FORM})(AddBoardForm));\n","export const ADD_BOARD_FORM = \"AddBoardForm\";\nexport const EDIT_BOARD_FORM = \"EditBoardForm\";\nexport const SHARE_BOARD_FORM = \"ShareBoardForm\";\nexport const SHARE_BOARD_WITH_TEAM_FORM = \"ShareBoardWithTeamForm\";\nexport const CONFIRM_BOARD_DELETION_FORM = 'ConfirmBoardDeletionForm';","import {History} from \"history\";\nimport {fromJS} from \"immutable\";\nimport * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps} from \"react-router\";\nimport {Message, Modal} from 'semantic-ui-react';\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport {UserInfo} from \"../../User/model/UserInfo\";\nimport * as Action from \"../actions\";\nimport {BoardModel} from \"../model\";\nimport {default as AddBoardForm, ImFormData} from './AddBoardForm';\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {withRouter} from \"react-router-dom\";\n\ninterface OwnProps {\n    open: boolean;\n    onClose: () => void;\n    disabled: boolean;\n}\n\nexport type AddBoardProps = OwnProps & WithNamespaces & RouteComponentProps;\n\nconst submitForm = (data: ImFormData, user: UserInfo, dispatch: ReturnType<typeof useDispatch>, history: History<any>): void => {\n    const board = BoardModel.createUserBoard(\n        user.uid,\n        data.get('name') as BoardModel.BoardName,\n        data.get('nameAbbreviation') as string,\n        data.get('tags') as string[],\n        data.get('responsibleTeam') as TeamId | undefined,\n        data.get('codySuggestEnabled') === '1',\n      data.get('eventModelingEnabled') === '1'\n    );\n\n    dispatch(Action.Command.addBoard(board, history));\n}\n\nconst AddBoardModal = (props: AddBoardProps) => {\n    const [isAddingBoard, setIsAddingBoard] = useState(false);\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n    const user = useSelector(makeGetCurrentUser());\n    const dispatch = useDispatch();\n\n    return <Modal open={ props.open} closeIcon={true} onClose={ props.onClose} size=\"mini\">\n    <Modal.Header>{  props.t(\"insp.board.add\") }</Modal.Header>\n    <Modal.Content>\n        { props.disabled && !isAddingBoard && <Message icon=\"dollar\" warning={true}\n                                                       content={activeOrganization && activeOrganization.userIsGuest\n                                                           ? props.t('insp.user.quota_reached_guest')\n                                                           : activeOrganization && activeOrganization.explicitOrganization\n                                                               ? props.t('insp.user.quota_reached')\n                                                               : props.t('insp.user.quota_reached_user')\n                                                       } />}\n        {! props.disabled && <AddBoardForm initialValues={fromJS(BoardModel.defaultBoardProps)}\n                                           isAddingBoard={isAddingBoard}\n                                           onSubmit={(data: ImFormData) => {setIsAddingBoard(true); submitForm(data,  user, dispatch, props.history)}}\n        />}\n        {isAddingBoard && <span>...</span>}\n    </Modal.Content>\n</Modal>};\n\nexport default withNamespaces()(withRouter(AddBoardModal));\n\n\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {Button} from \"semantic-ui-react\";\nimport {AddBoard} from \"../index\";\n\ninterface OwnProps {\n    disabled: boolean;\n    primary?: boolean;\n}\n\ntype AddBoardButtonProps = OwnProps & WithNamespaces;\n\n// Needed for typescript to compile\nconst AddBoardModal: any = AddBoard;\n\nconst AddBoardButton = (props: AddBoardButtonProps) => {\n    const [addBoard, setAddBoard] = useState(false);\n\n    return  <>\n        <Button primary={props.primary} onClick={e => {e.preventDefault(); setAddBoard(true)}}>Add Board</Button>\n        <AddBoardModal open={addBoard} onClose={() => {setAddBoard(false)}} disabled={props.disabled} />\n    </>;\n};\n\nexport default withNamespaces()(AddBoardButton);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Icon} from 'semantic-ui-react';\nimport AddBoardModal from \"./AddBoardModal\";\n\nexport interface AddBoardCardProps {\n    disabled: boolean;\n}\n\ntype EnhancedProps = AddBoardCardProps & WithNamespaces;\n\nconst AddBoardCard = (props: EnhancedProps) => {\n    const [addBoard, setAddBoard] = useState(false);\n\n    return  <>\n        <a href=\"#\" className=\"ui card event add board\" onClick={e => {e.preventDefault(); setAddBoard(true)}}>\n            <div className=\"content\" style={{display: \"flex\", flexDirection: \"column\", verticalAlign: \"middle\",\n                textAlign: \"center\", justifyContent: \"center\", alignItems: \"center\"}}>\n                <div><button className=\"ui big circular icon button\">\n                    <Icon name=\"plus\" size=\"large\" />\n                </button></div>\n                <button className=\"ui big basic button noborder\">\n                { props.t('insp.overview.add_board') }\n                </button>\n            </div>\n        </a>\n        <AddBoardModal open={addBoard} onClose={() => {setAddBoard(false)}} disabled={props.disabled} />\n    </>;\n};\n\nexport default withNamespaces()(AddBoardCard);\n","export const printIsoDateString = (isoDateTime: string): string => {\n    const d = new Date(isoDateTime);\n    return d.toLocaleString();\n}","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Link} from 'react-router-dom';\nimport {Icon, Popup} from 'semantic-ui-react';\nimport {printIsoDateString} from \"../../core/dateTime\";\nimport {compileInspectioBoardEdit, compileInspectioBoardWorkspace} from \"../../routes\";\nimport * as Action from \"../actions\";\nimport {BoardModel} from \"../model\";\n\nexport interface BoardCardProps {\n    board: BoardModel.Board;\n    isAdmin: boolean;\n}\n\ntype EnhancedProps = BoardCardProps & WithNamespaces;\n\nconst BoardCard = (props: EnhancedProps) => {\n    return <div className=\"ui card event\">\n        <Link to={compileInspectioBoardWorkspace(props.board.uid)}>\n            <div className=\"content\">\n                <div className=\"header\"/>\n                <div className=\"description\">\n                    <span style={{ width: '100%', wordBreak: 'break-word', overflowWrap: 'break-word' }}>\n                        {props.board.name}\n                    </span>\n                </div>\n            </div>\n        </Link>\n        <div className=\"extra\">\n            {(props.isAdmin || !props.board.shared) && <Link to={compileInspectioBoardEdit(props.board.uid)} className=\"ui right floated\">\n                <Icon name=\"edit outline\" size={\"large\"} link={true} />\n            </Link>}\n            {(!props.isAdmin && props.board.shared) && <Popup trigger={<Icon name=\"share\" size=\"large\" className=\"ui right floated\" />} content={props.t('insp.overview.shared_board')} />}\n            <span style={{color: \"rgb(160, 156, 156)\", fontSize: \"0.9em\"}}>{ props.t('insp.overview.last_modified') + \": \" + printIsoDateString(props.board.lastModified as string) }</span>\n        </div>\n    </div>\n};\n\nexport default withNamespaces()(BoardCard);\n","import * as React from 'react';\nimport {SyntheticEvent} from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Search} from \"semantic-ui-react\";\nimport {filterBoardOverview} from \"../actions/commands\";\nimport {makeGetBoardOverview} from \"../selectors/boardList\";\nimport {makeGetTags} from \"../selectors/tags\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\n\ninterface OwnProps {}\n\ntype BoardOverviewSearchProps = OwnProps & WithNamespaces;\n\nconst BoardOverviewSearch = (props: BoardOverviewSearchProps) => {\n    const tags = useSelector(makeGetTags());\n    const dispatch = useDispatch();\n\n    const boardOverviewSelector = makeGetBoardOverview();\n    const boardOverviewState = useSelector(boardOverviewSelector);\n    const filter = boardOverviewState.filter;\n\n    const handleChange = (val: string) => {\n        if(val.charAt(0) === ' ') {\n            val = val.slice(1);\n        }\n        dispatch(filterBoardOverview(val));\n    };\n\n    const handleResultSelect = (result: {title: string}) => {\n        if(filter === '') {\n            dispatch(filterBoardOverview(result.title))\n        } else {\n            const parts = filter.split(\" \");\n            parts.splice(-1, 1);\n            const filterWithoutLastPart = parts.join(\" \").trim();\n            dispatch(filterBoardOverview(filterWithoutLastPart + ' ' + result.title))\n        }\n    }\n\n    const tagsInFilter = filter.split(\" \").map(part => part.trim()).filter(part => part.charAt(0) === '#');\n\n    const handleClear = (e: SyntheticEvent) => {\n        e.preventDefault();\n        dispatch(filterBoardOverview(''));\n    };\n\n\n    let results = tags.filter(tag => !tagsInFilter.includes('#'+tag)).map(tag => ({title: '#'+tag})).toJS();\n\n    let lastPart = filter.split(\" \").pop();\n\n    if(lastPart) {\n        lastPart = lastPart.trim();\n        if(lastPart !== '') {\n            results = results.filter(result => result.title.toLowerCase().search(lastPart!.toLowerCase()) !== -1);\n        }\n    }\n\n    return <Search\n            placeholder={props.t('insp.overview.search.label')}\n            results={results}\n            value={filter}\n            onSearchChange={(e,data) => handleChange(data.value as string)}\n            onResultSelect={(e, data) => handleResultSelect(data.result)}\n            icon={filter === '' ? <i className=\"search icon\" /> : <i className=\"close link icon\" style={{cursor: \"pointer\"}} onClick={handleClear} />}\n            fluid={true}\n            showNoResults={false}\n        />\n};\n\nexport default withNamespaces()(BoardOverviewSearch);\n","import * as React from 'react';\nimport BoardOverviewSearch from \"../BoardOverviewSearch\";\n\ninterface OwnProps {\n\n}\n\ntype FilterProps = OwnProps;\n\nconst Filter = (props: FilterProps) => {\n    return <BoardOverviewSearch />\n};\n\nexport default Filter;\n","import * as React from 'react';\nimport {Divider, Grid, GridColumn, GridRow} from \"semantic-ui-react\";\nimport {isStandalone} from \"../../../standalone/util\";\nimport Filter from \"./Filter\";\nimport Sorting from \"./Sorting\";\nimport TeamFilter from \"./TeamFilter\";\n\ninterface OwnProps {\n\n}\n\ntype HeaderBarProps = OwnProps;\n\nconst HeaderBar = (props: HeaderBarProps) => {\n    return <Grid stackable={true} padded={true}>\n        <GridRow columns={ 3 }>\n            <GridColumn>\n                <Sorting />\n            </GridColumn>\n            <GridColumn>\n                {!isStandalone() && <TeamFilter/>}\n            </GridColumn>\n            <GridColumn>\n                <Filter />\n            </GridColumn>\n        </GridRow>\n        <Grid.Row>\n            <Grid.Column>\n                <Divider horizontal={true} content=\"Boards\" />\n            </Grid.Column>\n        </Grid.Row>\n    </Grid>\n};\n\nexport default HeaderBar;\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Dropdown, DropdownItemProps} from \"semantic-ui-react\";\nimport {TeamId} from \"../../../InspectioTeams/model/Team\";\nimport {makeTeamListSelector} from \"../../../InspectioTeams/selectors/selectTeam\";\nimport * as Action from \"../../actions\";\nimport {makeGetBoardOverview} from \"../../selectors/boardList\";\n\ninterface OwnProps {\n\n}\n\ntype ResponsibleTeamFilterProps = OwnProps & WithNamespaces;\n\nconst TeamFilter = (props: ResponsibleTeamFilterProps) => {\n    const boardOverviewState = useSelector(makeGetBoardOverview());\n    const teams = useSelector(makeTeamListSelector());\n    const dispatch = useDispatch();\n\n    const options: DropdownItemProps[] = teams.map(team => ({key: team.uid, text: team.name, value: team.uid })).toJS();\n    options.unshift({key: '_all_', text: props.t('insp.overview.teamFilter.all'), value: '_all_'});\n\n    const handleFilterChange = (teamId: TeamId | undefined) => {\n        if(teamId === '_all_') {\n            teamId = undefined;\n        }\n        dispatch(Action.Command.filterBoardOverviewByResponsibleTeam(teamId));\n    }\n\n    return <Dropdown\n        selection={true}\n        placeholder={props.t('insp.board.form.responsible_team') as string}\n        options={options}\n        fluid={true}\n        value={boardOverviewState.responsibleTeam || '_all_'}\n        onChange={(e,data) => handleFilterChange(data.value as string | undefined)}\n        />\n};\n\nexport default withNamespaces()(TeamFilter);\n","import * as React from 'react';\nimport {Icon} from \"semantic-ui-react\";\n\nexport const LoadingBoardCard = () => {\n    return <div className=\"ui card event\">\n        <div className=\"content\" >\n            <div className=\"header\" />\n            <div className=\"description\"><Icon loading={true} name=\"spinner\" size=\"big\" /></div>\n        </div>\n    </div>\n};","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Icon, Message, Modal} from \"semantic-ui-react\";\n\ninterface OwnProps {\n    open: boolean;\n    onClose: () => void;\n}\n\ntype NewDomainModalProps = OwnProps & WithNamespaces;\n\nconst NewDomainModal = (props: NewDomainModalProps) => {\n return (<Modal open={ props.open} closeIcon={true} onClose={ props.onClose}>\n     <Modal.Header>{  props.t(\"insp.hint.new_domain_header\") }</Modal.Header>\n     <Modal.Content>\n         { <Message icon=\"bullhorn\" info={true}\n                content={\n                    <div>\n                        <p>{props.t('insp.hint.new_domain_text')}</p>\n                        <p><Icon name=\"arrow right\"/>&nbsp;<a href=\"https://github.com/event-engine/inspectio/wiki/Rebranding\" target=\"_blank\">{props.t('insp.hint.learn_more')}</a></p>\n                    </div>\n                } />}\n     </Modal.Content>\n </Modal>);\n};\n\nexport default withNamespaces()(NewDomainModal);\n","import * as React from 'react';\n\ninterface OwnProps {\n    board: {\n        link: string;\n        name: string;\n    };\n}\n\ntype StandaloneExampleBoardCardProps = OwnProps;\n\nconst StandaloneExampleBoardCard = (props: StandaloneExampleBoardCardProps) => {\n    return <div className=\"ui card event\">\n        <a href={props.board.link}>\n            <div className=\"content\">\n                <div className=\"header\"/>\n                <div className=\"description\">\n                    <span style={{ width: '100%', wordBreak: 'break-word', overflowWrap: 'break-word' }}>\n                        {props.board.name}\n                    </span>\n                </div>\n            </div>\n        </a>\n        <div className=\"extra\">\n            <span style={{color: \"rgb(160, 156, 156)\", fontSize: \"0.9em\"}}>Example</span>\n        </div>\n    </div>\n};\n\nexport default StandaloneExampleBoardCard;\n","import * as React from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Message} from \"semantic-ui-react\";\nimport * as Action from \"../../actions\";\nimport {makeGetBoardOverview} from \"../../selectors/boardList\";\n\ninterface OwnProps {\n\n}\n\ntype MaintenanceMessageProps = OwnProps;\n\nconst MaintenanceMessage = (props: MaintenanceMessageProps) => {\n  const boardOverviewSelector = makeGetBoardOverview();\n  const boardOverviewState = useSelector(boardOverviewSelector);\n  const dispatch = useDispatch();\n\n  const handleDismiss = () => {\n    dispatch(Action.Command.dismissMaintenanceMessage());\n  }\n\n  return <>{boardOverviewState.showMaintenanceMessage && <Message\n    header=\"Scheduled Maintenance Downtime\"\n    content=\"Please note a scheduled maintenance downtime on Friday, 12th July, 2024 starting at 2 pm (CEST). The service will be unavailable for 2-4 hours due to a database migration. If this causes trouble, please contact support. We might be able to move the time window.\"\n    color=\"blue\"\n    onDismiss={handleDismiss}\n  />}</>\n};\n\nexport default MaintenanceMessage;\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps} from \"react-router\";\nimport {withRouter} from \"react-router-dom\";\nimport {\n    Card,\n    Container,\n    Divider,\n    Grid, Header, Icon, Segment,\n} from 'semantic-ui-react';\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {UserSelector} from \"../../User\";\nimport {upsertUserSetting} from \"../../User/actions/commands\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeUserSettingSelector, makeUserSettingsLoadedSelector} from \"../../User/selectors/userSettings\";\nimport {makeGetBoards, makeHasBoards, makeIsLoadingBoards} from \"../selectors/boardList\";\nimport AddBoardButton from \"./AddBoardButton\";\nimport {default as AddBoardCard} from \"./AddBoardCard\";\nimport {default as BoardCard} from \"./BoardCard\";\nimport HeaderBar from \"./BoardOverview/HeaderBar\";\nimport {LoadingBoardCard} from \"./LoadingBoardCard\";\nimport NewDomainModal from \"./NewDomainModal\";\nimport StandaloneExampleBoardCard from \"./StandaloneExampleBoardCard\";\nimport MaintenanceMessage from \"./BoardOverview/MaintenanceMessage\";\n\ninterface OwnProps {\n\n}\n\nexport type EnhancedProps = OwnProps & WithNamespaces & RouteComponentProps;\n\nconst BoardOverview = (props: EnhancedProps) => {\n    const boards = useSelector(makeGetBoards());\n    const hasBoards = useSelector(makeHasBoards());\n    const loading = useSelector(makeIsLoadingBoards());\n    const boardQuota = useSelector(UserSelector.makeGetCurrentBoardQuota());\n    const dispatch = useDispatch();\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const settingsLoaded = useSelector(makeUserSettingsLoadedSelector());\n    const showHint = useSelector(makeUserSettingSelector('show_pb_domain_hint', false));\n    const [popupOpen, setPopupOpen] = useState(false);\n\n    useEffect(() => {\n        if(settingsLoaded && showHint) {\n            setPopupOpen(true);\n        }\n    }, [settingsLoaded, showHint])\n\n    const isAdmin = organization ? organization.isAdmin(currentUser.uid) : false;\n\n    const handleCloseNewDomainModal = () => {\n        setPopupOpen(false);\n        dispatch(upsertUserSetting('show_pb_domain_hint', false));\n    }\n\n    return <Container>\n        <MaintenanceMessage />\n        {(hasBoards || loading )&& <HeaderBar />}\n    <Grid stackable={true} padded={true}>\n    {(hasBoards || loading )&& <Grid.Row>\n        <Grid.Column>\n                <Card.Group itemsPerRow={3}>\n                    <AddBoardCard disabled={boardQuota === 0} />\n                    {loading && <LoadingBoardCard/>}\n                    {boards.filter(board => !board.example)\n                        .map(board =>\n                        <BoardCard key={board.uid} board={board}\n                                   isAdmin={board.organization? isAdmin  || board.isCreator(currentUser.uid) : board.owner === currentUser.uid}\n                                    />\n                    ).toArray()}\n                </Card.Group>\n        </Grid.Column>\n    </Grid.Row>}\n    {!hasBoards && !loading && <Grid.Row>\n        <Grid.Column>\n            <Segment placeholder={true}>\n                <Header icon={true} style={{color: 'grey'}}>\n                    <Icon name='lightbulb' color=\"yellow\" />\n                    {props.t('insp.overview.empty_space')}\n                </Header>\n                <Segment.Inline>\n                    <a href=\"https://wiki.prooph-board.com\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"ui yellow button\">Check Wiki</a>\n                    <AddBoardButton disabled={boardQuota === 0} primary={false} />\n                </Segment.Inline>\n            </Segment>\n        </Grid.Column>\n    </Grid.Row>}\n    <Grid.Row>\n        <Grid.Column>\n            <Divider horizontal={true} content=\"Example Boards\" />\n        </Grid.Column>\n    </Grid.Row>\n    <Grid.Row>\n        <Grid.Column>\n            <Card.Group itemsPerRow={3}>\n                <StandaloneExampleBoardCard key='proophboard' board={{name: 'Design & Prototyping', link: '/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fevent-engine%2Finspectio%2Fmaster%2Fassets%2FExample%2520Boards%2Fprooph%20board%2520Example.xml'}} />\n                <StandaloneExampleBoardCard key='Event_Centric_Workflow' board={{name: 'Holistic, Event-Centric Workflow', link: '/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fproophboard%2Fexample-boards%2Fmain%2FHolistic%252C%2520Event-Centric%2520Workflow.xml?temp=1'}} />\n                <StandaloneExampleBoardCard key='Cody_Tutorial' board={{name: 'Cody Tutorial', link: '/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fproophboard%2Fexample-boards%2Fmain%2FCody%2520Tutorial.xml?temp=1'}} />\n                <StandaloneExampleBoardCard key='Event_Storming' board={{name: 'Event Storming - The Picture', link: '/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fevent-engine%2Finspectio%2Fmaster%2Fassets%2FExample%2520Boards%2FThe%2520Picture.xml?temp=1'}} />\n                <StandaloneExampleBoardCard key='Event_Modeling' board={{name: 'Event Modeling', link: '/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fevent-engine%2Finspectio%2Fmaster%2Fassets%2FExample%2520Boards%2FEvent%2520Modeling.xml?temp=1'}} />\n            </Card.Group>\n        </Grid.Column>\n    </Grid.Row>\n    </Grid>\n        <NewDomainModal open={popupOpen} onClose={handleCloseNewDomainModal} />\n    </Container>\n};\n\nexport default withNamespaces()(withRouter(BoardOverview));\n","import {Map} from \"immutable\";\nimport React, {InputHTMLAttributes, MouseEvent} from 'react'\nimport {InjectedFormProps, WrappedFieldProps} from \"redux-form\";\nimport { Field, reduxForm } from 'redux-form/immutable';\nimport {Button, Form, Icon, Message, Segment} from \"semantic-ui-react\";\nimport {CONFIRM_BOARD_DELETION_FORM, EDIT_BOARD_FORM} from \"./constants\";\n\ninterface FormData  {\n    uid: string;\n    confirmedName: string;\n}\n\nexport interface ImFormData extends Map<string, string> {\n    confirmedName: string;\n    toJS(): FormData;\n}\n\nexport interface OwnProps {\n    boardName: string;\n    t: (val: string) => string;\n    onCancel: () => void;\n}\n\nexport interface PropsFromDispatch {\n\n}\n\n\nexport type ConfirmBoardDeletionFormProps = OwnProps & PropsFromDispatch & InjectedFormProps<ImFormData, OwnProps>;\n\nconst renderConfirm = (componentProps: WrappedFieldProps & InputHTMLAttributes<HTMLInputElement>) => {\n    const { input, placeholder, meta: { touched, error } } = componentProps;\n\n    return <Form.Input {...input} placeholder={placeholder} error={(touched && error)? true : false}/>\n};\n\nconst validateName = (boardName: string): (confirmedName: string) => undefined | string => confirmedName => confirmedName === boardName? undefined : 'Name is not correct';\n\nconst handleAbortClick = (e: MouseEvent<HTMLButtonElement>, props: ConfirmBoardDeletionFormProps) => {\n    e.preventDefault();\n\n    props.onCancel();\n}\n\nconst ConfirmBoardDeletionForm = (props: ConfirmBoardDeletionFormProps) => <Message error={true}>\n    <Icon name=\"warning sign\" />\n    {props.t('insp.board.really_delete')}\n    <Segment>\n        <form className=\"ui form\" onSubmit={props.handleSubmit}>\n            <div className=\"field\">\n                <Field name=\"confirmedName\" type=\"text\" component={renderConfirm} placeholder={props.t('insp.board.form.board_name')} />\n            </div>\n            <Button color=\"red\" type=\"submit\" disabled={props.pristine || !props.valid}>{props.t('app.form.confirm')}</Button>\n            <Button basic={true} className=\"noborder\" onClick={(e) => handleAbortClick(e, props)}>{ props.t('app.form.cancel') }</Button>\n        </form>\n    </Segment>\n</Message>;\n\nexport default reduxForm<ImFormData, OwnProps>({\n    form: CONFIRM_BOARD_DELETION_FORM,\n    validate: (values, props) => {\n        if(values) {\n            const error = validateName(props.boardName)(values.get('confirmedName') || '');\n            if(error) {\n                return {confirmedName: error};\n            }\n        }\n\n        return {};\n    }\n})(ConfirmBoardDeletionForm);\n\n","import { Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {BoardClient} from \"../model/BoardClient\";\nimport {BoardClientsState} from \"../reducers/applyBoardClientActions\";\n\nexport const boardClientsSelector = (state: Record<ApplicationState>, props: any): BoardClientsState =>\n    state.getIn([MODULE, 'boardClients']);\n\nexport const makeBoardClientSelector = (boardId: string): (state: Record<ApplicationState>, props?: any) => BoardClient|null|undefined => {\n    return createSelector(\n        [boardClientsSelector],\n        (boardClients): BoardClient|null|undefined =>  {\n            return boardClients.has(boardId) ? boardClients.get(boardId) : undefined;\n        }\n    )\n};\n","import React, {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Confirm, Message} from \"semantic-ui-react\";\nimport {createBoardClient} from \"../../../actions/commands\";\nimport * as BoardModel from \"../../../model/Board\";\n\ninterface OwnProps {\n    boardId: BoardModel.BoardId;\n}\n\ntype BoardClientNotConfiguredMessageProps = OwnProps & WithNamespaces;\n\nconst BoardClientNotConfiguredMessage = (props: BoardClientNotConfiguredMessageProps) => {\n\n    const dispatch = useDispatch();\n    const [confirmOpen, setConfirmOpen] = useState<boolean>(false);\n\n    const handleCreateBoardClientClick = (event: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        setConfirmOpen(true);\n    };\n\n    const handleCreateBoardClient = () => {\n        dispatch(createBoardClient(props.boardId));\n        setConfirmOpen(false);\n    };\n\n    return (<>\n        <Message>\n            <p>\n                {props.t('insp.board.client.notConfigured')}\n                <a href={'#'} onClick={handleCreateBoardClientClick}> {props.t('insp.board.client.createClient')}</a>\n            </p>\n        </Message>\n        <Confirm\n            header={props.t('insp.board.client.createConfirmTitle')}\n            content={props.t('insp.board.client.createConfirmText')}\n            open={confirmOpen}\n            onCancel={() => setConfirmOpen(false)}\n            onConfirm={handleCreateBoardClient}\n        />\n    </>);\n};\n\nexport default withNamespaces()(BoardClientNotConfiguredMessage);\n","import React, {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Confirm, Icon, Message, Table} from \"semantic-ui-react\";\nimport {copyToClipboard} from \"../../../../core/copyToClipboard\";\nimport {removeBoardClient, resetBoardClientSecret} from \"../../../actions/commands\";\nimport {fetchBoardClientSecret} from \"../../../actions/queries\";\nimport * as BoardModel from \"../../../model/Board\";\nimport {BoardClient} from \"../../../model/BoardClient\";\n\ninterface OwnProps {\n    boardId: BoardModel.BoardId;\n    client: BoardClient;\n}\n\ntype BoardClientTableProps = OwnProps & WithNamespaces;\n\nconst BoardClientTable = (props: BoardClientTableProps) => {\n\n    const dispatch = useDispatch();\n    const [resetConfirmOpen, setResetConfirmOpen] = useState<boolean>(false);\n    const [removeConfirmOpen, setRemoveConfirmOpen] = useState<boolean>(false);\n    const [resetLoading, setResetLoading] = useState<boolean>(false);\n    const [clientSecretCopied, setClientSecretCopied] = useState<boolean>(false);\n\n    useEffect(() => {\n        if (props.client && props.client.clientSecret) {\n            setResetLoading(false);\n        }\n    }, [props.client]);\n\n    const retrieveClientSecret = (event: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        dispatch(fetchBoardClientSecret(props.boardId));\n    };\n\n    const openResetConfirm = () => setResetConfirmOpen(true);\n    const closeResetConfirm = () => setResetConfirmOpen(false);\n    const openRemoveConfirm = () => setRemoveConfirmOpen(true);\n    const closeRemoveConfirm = () => setRemoveConfirmOpen(false);\n\n    const resetClientSecret = () => {\n        closeResetConfirm();\n        setResetLoading(true);\n        dispatch(resetBoardClientSecret(props.boardId));\n    };\n\n    const removeClientSecret = () => {\n        closeRemoveConfirm();\n        dispatch(removeBoardClient(props.boardId));\n    };\n\n    const copyClientSecretToClipboard = () => {\n        copyToClipboard(props.client.clientSecret!);\n        setClientSecretCopied(true);\n        setTimeout(() => setClientSecretCopied(false), 2000);\n    };\n\n    return (<>\n        <Table unstackable={true} basic={'very'}>\n            <Table.Body>\n                <Table.Row>\n                    <Table.Cell style={{ width: '150px' }}>\n                        <strong>{props.t('insp.board.client.clientId')}:</strong>\n                    </Table.Cell>\n                    <Table.Cell>\n                        {props.client.clientId}\n                    </Table.Cell>\n                    <Table.Cell style={{ width: '125px' }} />\n                </Table.Row>\n                <Table.Row>\n                    <Table.Cell>\n                        <strong>{props.t('insp.board.client.clientSecret')}:</strong>\n                    </Table.Cell>\n                    <Table.Cell>\n                        {props.client.clientSecret && (\n                            <>\n                                {props.client.clientSecret}\n                                <Icon\n                                    name={clientSecretCopied ? 'clipboard check' : 'copy'}\n                                    style={{ cursor: 'pointer', marginLeft: '5px' }}\n                                    title={props.t('insp.board.client.copyToClipboard')}\n                                    onClick={copyClientSecretToClipboard}\n                                />\n                            </>\n                        )}\n                        {!props.client.clientSecret && (\n                            <a href={'#'} onClick={retrieveClientSecret}>\n                                {props.t('insp.board.client.retrieveSecret')}\n                            </a>\n                        )}\n                    </Table.Cell>\n                    <Table.Cell style={{ paddingTop: '10px', paddingBottom: '10px' }}>\n                        <Button\n                            icon={true}\n                            labelPosition={'left'}\n                            title={props.t('app.form.reset')}\n                            onClick={openResetConfirm}\n                            loading={resetLoading}\n                            style={props.client.clientSecret ? null : { visibility: 'hidden' }}\n                            children={<><Icon name={'redo'} />{props.t('app.form.reset')}</>}\n                        />\n                    </Table.Cell>\n                </Table.Row>\n            </Table.Body>\n        </Table>\n        <Message>\n            <Table unstackable={true} basic={'very'}>\n                <Table.Body>\n                    <Table.Row>\n                        <Table.Cell>\n                            {props.t('insp.board.client.removeText')}\n                        </Table.Cell>\n                        <Table.Cell>\n                            <Button\n                                icon={true}\n                                labelPosition={'left'}\n                                negative={true}\n                                floated={'right'}\n                                title={props.t('app.form.remove')}\n                                onClick={openRemoveConfirm}\n                                children={<><Icon name={'delete'} />{props.t('app.form.remove')}</>}\n                            />\n                        </Table.Cell>\n                    </Table.Row>\n                </Table.Body>\n            </Table>\n        </Message>\n        <Confirm\n            header={props.t('insp.board.client.resetConfirmTitle')}\n            content={props.t('insp.board.client.resetConfirmText')}\n            open={resetConfirmOpen}\n            onCancel={closeResetConfirm}\n            onConfirm={resetClientSecret}\n        />\n        <Confirm\n            header={props.t('insp.board.client.removeConfirmTitle')}\n            content={props.t('insp.board.client.removeConfirmText')}\n            open={removeConfirmOpen}\n            onCancel={closeRemoveConfirm}\n            onConfirm={removeClientSecret}\n        />\n    </>);\n};\n\nexport default withNamespaces()(BoardClientTable);\n","\n/**\n * Copies the value provided to the clipboard.\n * Sometimes it is necessary to append the temporary input to a specific element to make this work.\n *\n * @param value\n * @param appendTo\n */\nexport const copyToClipboard = (value: string, appendTo?: HTMLElement) => {\n    const inputElement = document.createElement('input');\n    inputElement.type = 'text';\n    inputElement.value = value;\n    inputElement.style.position = 'fixed';\n    inputElement.style.left = '-1000px';\n    inputElement.style.top = '-1000px';\n\n    (appendTo || document.body).append(inputElement);\n    inputElement.select();\n    document.execCommand('copy');\n\n    inputElement.parentNode!.removeChild(inputElement);\n};\n","import React, {useEffect} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport HeaderSubHeader from \"semantic-ui-react/dist/commonjs/elements/Header/HeaderSubheader\";\nimport {fetchBoardClient} from \"../../actions/queries\";\nimport * as BoardModel from \"../../model/Board\";\nimport {BoardClient} from \"../../model/BoardClient\";\nimport {makeBoardClientSelector} from \"../../selectors/boardClient\";\nimport BoardClientNotConfiguredMessage from \"./BoardClientConfiguration/BoardClientNotConfiguredMessage\";\nimport BoardClientTable from \"./BoardClientConfiguration/BoardClientTable\";\n\ninterface OwnProps {\n    boardId: BoardModel.BoardId;\n}\n\ntype BoardClientConfigurationProps = OwnProps & WithNamespaces;\n\nconst BoardClientConfiguration = (props: BoardClientConfigurationProps) => {\n\n    const dispatch = useDispatch();\n    const client: BoardClient|null|undefined = useSelector(makeBoardClientSelector(props.boardId));\n\n    useEffect(() => {\n        dispatch(fetchBoardClient(props.boardId));\n    }, [props.boardId]);\n\n    return (\n        <div className=\"ui segments\">\n            <div className=\"ui segment\">\n                {client === undefined && (\n                    <div className=\"ui active dimmer\">\n                        <div className=\"ui loader\" />\n                    </div>\n                )}\n\n                <h2 className=\"ui header\">\n                    {props.t('insp.board.client.headline')}\n                    <HeaderSubHeader>{props.t('insp.board.client.description')}</HeaderSubHeader>\n                </h2>\n                <div>\n                    {client === null && (\n                        <BoardClientNotConfiguredMessage boardId={props.boardId} />\n                    )}\n                    {client && (\n                        <BoardClientTable boardId={props.boardId} client={client} />\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default withNamespaces()(BoardClientConfiguration);\n","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {BoardId} from \"../model/Board\";\nimport {BoardPermissionForTeam, PermissionsId} from \"../model/BoardPermissionForTeam\";\nimport {BoardPermissionForUser} from \"../model/BoardPermissionForUser\";\n\nexport const getBoardPermissionForTeamById = (state: Record<ApplicationState>, permissionId: PermissionsId): BoardPermissionForTeam =>\n    state.getIn([MODULE, 'boardPermissionsForTeams', permissionId]);\n\nexport const makeBoardPermissionForTeamSelector = (boardId: BoardId, teamId: TeamId): (state: Record<ApplicationState>, props?: any) => BoardPermissionForTeam|undefined => {\n    return createSelector(\n        [boardPermissionForTeamListSelector],\n        (boardPermissions): BoardPermissionForTeam|undefined => {\n            return boardPermissions.find(permission => permission.teamId === teamId && permission.boardId === boardId);\n        }\n    )\n};\n\nexport const boardPermissionForUserListSelector = (state: Record<ApplicationState>, props: any): List<BoardPermissionForUser> =>\n    List(state.getIn([MODULE, 'boardPermissionsForUsers']).toIndexedSeq().toArray()) || List();\n\nexport const boardPermissionForTeamListSelector = (state: Record<ApplicationState>, props: any): List<BoardPermissionForTeam> =>\n    List(state.getIn([MODULE, 'boardPermissionsForTeams']).toIndexedSeq().toArray()) || List();\n\nexport const makeBoardPermissionForUserListSelector = (boardId: string): (state: Record<ApplicationState>, props?: any) => List<BoardPermissionForUser> => {\n    return createSelector(\n        [boardPermissionForUserListSelector],\n        (boardPermissions): List<BoardPermissionForUser> =>  {\n            return boardPermissions.filter(boardPermission => boardPermission.boardId === boardId);\n        }\n    )\n};\n\nexport const makeBoardPermissionForTeamListSelector = (boardId: string): (state: Record<ApplicationState>, props?: any) => List<BoardPermissionForTeam> => {\n    return createSelector(\n        [boardPermissionForTeamListSelector],\n        (boardPermissions): List<BoardPermissionForTeam> =>  {\n            return boardPermissions.filter(boardPermission => boardPermission.boardId === boardId);\n        }\n    )\n};\n","import * as React from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Header, Icon, Image, Label, Table} from \"semantic-ui-react\";\nimport {Action as TeamAction} from \"../../../InspectioTeams\";\nimport {makeTeamSelector} from \"../../../InspectioTeams/selectors/selectTeam\";\nimport * as Action from \"../../actions\";\nimport {Board} from \"../../model/Board\";\nimport {BoardPermissionForTeam} from \"../../model/BoardPermissionForTeam\";\n\ninterface PropsFromState {\n}\n\ninterface PropsFromDispatch {\n\n}\n\ninterface OwnProps {\n    board: Board;\n    boardPermission: BoardPermissionForTeam;\n}\n\nexport type BoardPermissionsForTeamsTableEntryProps = PropsFromState & PropsFromDispatch & OwnProps & WithNamespaces;\n\nconst BoardPermissionsForTeamsTableEntry = (props: BoardPermissionsForTeamsTableEntryProps) => {\n\n    const dispatch = useDispatch();\n    const team = useSelector(makeTeamSelector(props.boardPermission.teamId));\n\n    const hasReadAccess = props.boardPermission.permissions.readAccess;\n    const hasWriteAccess = props.boardPermission.permissions.writeAccess;\n\n    if (!hasReadAccess && !hasWriteAccess) {\n        return null;\n    }\n\n    if (!team) {\n        return null;\n    }\n\n    const handleRevokeAccessToBoard = () => {\n        dispatch(TeamAction.Command.adminRevokeTeamAccessToBoard(props.board.uid, team.uid));\n    };\n\n    const handleChangeReadBoardPermissions = () => {\n        if(!props.boardPermission.permissions.writeAccess) {\n            return;\n        }\n\n        dispatch(Action.Command.adminChangeTeamBoardPermissions(\n            props.board.uid,\n            team.uid,\n            { ...props.boardPermission.permissions, writeAccess: false }\n        ));\n    };\n\n    const handleChangeWriteBoardPermissions = () => {\n        dispatch(Action.Command.adminChangeTeamBoardPermissions(\n            props.board.uid,\n            team.uid,\n            { ...props.boardPermission.permissions, writeAccess: !props.boardPermission.permissions.writeAccess }\n        ));\n    };\n\n    const handleChangeResponsibleTeam = () => {\n        const responsibleTeam = props.board.responsibleTeam === props.boardPermission.teamId? undefined : props.boardPermission.teamId;\n        const changedBoard = props.board.merge({responsibleTeam})\n        dispatch(Action.Command.changeResponsibleTeam(changedBoard));\n    }\n\n    return (\n        <Table.Row>\n            <Table.Cell style={{width: \"310px\"}}>\n                <Header as='h4' image={true}>\n                    <img className=\"ui avatar image\" src={`/avatar/team-${team.uid}?displayName=${team.name}`} />\n                    <Header.Content>\n                        {team.name}\n                        <Header.Subheader>{team.description}</Header.Subheader>\n                    </Header.Content>\n                </Header>\n            </Table.Cell>\n            <Table.Cell>\n                <Button.Group>\n                    <Button\n                        className={'positive'}\n                        children={'Read'}\n                        onClick={handleChangeReadBoardPermissions}\n                    />\n                    <Button.Or text=\"+\" />\n                    <Button\n                        className={hasWriteAccess ? 'positive' : ''}\n                        children={'Write'}\n                        onClick={handleChangeWriteBoardPermissions}\n                    />\n                </Button.Group>\n                <Button\n                    icon={true}\n                    className=\"right floated basic circular noborder\"\n                    children={<Icon className=\"red close icon\" />}\n                    onClick={handleRevokeAccessToBoard}\n                />\n                <Button\n                    icon={true}\n                    className=\"right floated basic circular noborder responsible-team\"\n                    title={props.t('insp.board.form.responsible_team')}\n                    children={<Icon className={props.board.responsibleTeam === props.boardPermission.teamId? 'yellow star icon' : 'star outline icon'} />}\n                    onClick={handleChangeResponsibleTeam}\n                />\n            </Table.Cell>\n        </Table.Row>\n    );\n};\n\nexport default withNamespaces()(BoardPermissionsForTeamsTableEntry);\n","import * as React from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {Table} from \"semantic-ui-react\";\nimport {Board} from \"../../model/Board\";\nimport {makeBoardPermissionForTeamListSelector} from \"../../selectors/boardPermission\";\nimport BoardPermissionsForTeamsTableEntry from \"./BoardPermissionsForTeamsTableEntry\";\n\ninterface PropsFromState {\n}\n\ninterface PropsFromDispatch {\n\n}\n\ninterface OwnProps {\n    board: Board;\n}\n\nexport type BoardPermissionsForTeamsTableProps = PropsFromState & PropsFromDispatch & OwnProps;\n\nexport const BoardPermissionsForTeamsTable = (props: BoardPermissionsForTeamsTableProps) => {\n\n    const boardPermissions = useSelector(makeBoardPermissionForTeamListSelector(props.board.uid));\n\n    return (\n        <Table unstackable={true} basic=\"very\">\n            <Table.Body>\n                {boardPermissions.filter(p => p.teamId === props.board.responsibleTeam).map(boardPermission => (\n                    <BoardPermissionsForTeamsTableEntry\n                        board={props.board}\n                        boardPermission={boardPermission}\n                        key={boardPermission.uid}\n                    />\n                ))}\n                {boardPermissions.filter(p => p.teamId !== props.board.responsibleTeam).map(boardPermission => (\n                    <BoardPermissionsForTeamsTableEntry\n                        board={props.board}\n                        boardPermission={boardPermission}\n                        key={boardPermission.uid}\n                    />\n                ))}\n            </Table.Body>\n        </Table>\n    );\n};\n","import * as React from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Header, Icon, Image, Label, Table} from \"semantic-ui-react\";\nimport {IioUserInfo} from \"../../../User/model/IioUserInfo\";\nimport {makeGetIioUserInfoByIdSelector} from \"../../../User/selectors/iioUserInfo\";\nimport * as Action from \"../../actions\";\nimport {Board} from \"../../model/Board\";\nimport {BoardPermissionForUser} from \"../../model/BoardPermissionForUser\";\n\ninterface PropsFromState {\n}\n\ninterface PropsFromDispatch {\n\n}\n\ninterface OwnProps {\n    board: Board;\n    boardPermission: BoardPermissionForUser;\n}\n\nexport type BoardPermissionsTableEntryProps = PropsFromState & PropsFromDispatch & OwnProps;\n\nexport const BoardPermissionTableEntry = (props: BoardPermissionsTableEntryProps) => {\n\n    const dispatch = useDispatch();\n    const userInfo: IioUserInfo|undefined = useSelector(makeGetIioUserInfoByIdSelector(props.boardPermission.userId));\n\n    const isOwner = props.board.owner === props.boardPermission.userId || props.board.creator === props.boardPermission.userId;\n    const hasReadAccess = props.boardPermission.permissions.readAccess;\n    const hasWriteAccess = props.boardPermission.permissions.writeAccess;\n\n    if (!hasReadAccess && !hasWriteAccess) {\n        return null;\n    }\n\n    if (!userInfo) {\n        return null;\n    }\n\n    const handleRevokeAccessToBoard = () => {\n        dispatch(Action.Command.revokeAccessToBoard(props.board.uid, userInfo.userId));\n    };\n\n    const handleChangeReadBoardPermissions = () => {\n        if(!props.boardPermission.permissions.writeAccess) {\n            return;\n        }\n\n        dispatch(Action.Command.changeBoardPermissions(\n            props.board.uid,\n            userInfo.userId,\n            { ...props.boardPermission.permissions, writeAccess: false }\n        ));\n    };\n\n    const handleChangeWriteBoardPermissions = () => {\n        dispatch(Action.Command.changeBoardPermissions(\n            props.board.uid,\n            userInfo.userId,\n            { ...props.boardPermission.permissions, writeAccess: !props.boardPermission.permissions.writeAccess }\n        ));\n    };\n\n    return (\n        <Table.Row>\n            <Table.Cell style={{width: \"310px\"}}>\n                <Header as='h4' image={true}>\n                    <img className=\"ui avatar image\" src={userInfo.avatar()} alt={userInfo.username} />\n                    <Header.Content>\n                        {userInfo.username}\n                        {isOwner && (\n                            <Label color='blue' style={{marginBottom:\"0.2rem\", marginLeft:\"0\"}} basic={true}>Owner</Label>\n                        )}\n                        <Header.Subheader>{userInfo.position}</Header.Subheader>\n                    </Header.Content>\n                </Header>\n            </Table.Cell>\n            <Table.Cell>\n                <Button.Group>\n                    <Button\n                        className={'positive'}\n                        children={'Read'}\n                        disabled={isOwner}\n                        onClick={handleChangeReadBoardPermissions}\n                    />\n                    <Button.Or text=\"+\" />\n                    <Button\n                        className={hasWriteAccess ? 'positive' : ''}\n                        children={'Write'}\n                        disabled={isOwner}\n                        onClick={handleChangeWriteBoardPermissions}\n                    />\n                </Button.Group>\n                {!isOwner && (\n                    <Button\n                        icon={true}\n                        className=\"right floated basic noborder circular button\"\n                        children={<Icon className=\"red close icon\" />}\n                        onClick={handleRevokeAccessToBoard}\n                    />\n                )}\n            </Table.Cell>\n        </Table.Row>\n    );\n};\n","import * as React from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {Table} from \"semantic-ui-react\";\nimport {Board} from \"../../model/Board\";\nimport {AGGREGATE_TYPE, BoardPermissionForUser} from \"../../model/BoardPermissionForUser\";\nimport {makeBoardPermissionForUserListSelector} from \"../../selectors/boardPermission\";\nimport {BoardPermissionTableEntry} from \"./BoardPermissionsTableEntry\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\n\ninterface PropsFromState {\n}\n\ninterface PropsFromDispatch {\n\n}\n\ninterface OwnProps {\n    board: Board;\n}\n\nexport type BoardPermissionsTableProps = PropsFromState & PropsFromDispatch & OwnProps;\n\nexport const BoardPermissionTable = (props: BoardPermissionsTableProps) => {\n\n    const currentUser = useSelector(makeGetCurrentUser());\n    const boardPermissions = useSelector(makeBoardPermissionForUserListSelector(props.board.uid));\n\n    const onwerId = props.board.owner || props.board.creator;\n\n    return (\n        <Table unstackable={true} basic=\"very\">\n            <Table.Body>\n                <BoardPermissionTableEntry\n                    board={props.board}\n                    boardPermission={new BoardPermissionForUser({\n                        uid: '',\n                        aggregateType: AGGREGATE_TYPE,\n                        permissions: { readAccess: true, writeAccess: true, adminAccess: true },\n                        userId: onwerId as string,\n                        boardId: props.board.uid\n                    })}\n                />\n                {boardPermissions.map(boardPermission => (\n                    <BoardPermissionTableEntry\n                        key={boardPermission.uid}\n                        board={props.board}\n                        boardPermission={boardPermission}\n                    />\n                ))}\n            </Table.Body>\n        </Table>\n    );\n};\n","import React from 'react'\nimport {Button, ButtonProps} from \"semantic-ui-react\";\n\nconst SecondaryButton = (props: ButtonProps) => {\n    const btnProps = {...props, basic: true};\n    return <Button  {...btnProps} className=\"noborder\" />\n};\n\nexport default SecondaryButton;","import * as React from 'react';\nimport {Button, Image, Label, Popup, SemanticSIZES} from \"semantic-ui-react\";\nimport {IioUserInfo} from \"../model\";\n\ninterface OwnProps {\n    user: IioUserInfo.IioUserInfo,\n    size?: SemanticSIZES,\n    namePopup?: boolean,\n}\n\ntype UserAvatarProps = OwnProps;\n\nconst UserAvatar = (props: UserAvatarProps) => {\n    if(props.user.anonymous) {\n        // Label looks ugly with an Icon only, hence we use a disabled button here. Icon alone does not work, because icons use other size options :-(\n        return <Button circular={true} size={props.size || 'small'} className=\"user\" icon=\"user\" disabled={true} style={{cursor: \"default\"}}/>\n    } else {\n        const avatar = <Image size={props.size || 'small'} src={props.user.avatar()} avatar={true} verticalAlign=\"middle\" />;\n\n        if(props.namePopup) {\n            return <Popup   trigger={avatar}\n                            content={props.user.username}\n                            position=\"bottom center\" />\n        }\n\n        return avatar;\n    }\n\n};\n\nexport default UserAvatar;","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {BoardInvitation, BoardInvitationId} from \"../model/BoardInvitation\";\n\nexport const getBoardInvitationById = (state: Record<ApplicationState>, uid: BoardInvitationId): BoardInvitation | undefined =>\n    state.getIn([MODULE, 'boardInvitations', uid]);\n\nexport const makeBoardInvitationSelector = (uid: BoardInvitationId): (state: Record<ApplicationState>) => BoardInvitation | undefined =>\n    (state: Record<ApplicationState>) => getBoardInvitationById(state, uid);\n\nexport const boardInvitationListSelector = (state: Record<ApplicationState>, props: any): List<BoardInvitation> =>\n    List(state.getIn([MODULE, 'boardInvitations']).toIndexedSeq().toArray()) || List();\n\nexport const makeOpenBoardInvitationListSelector = (boardId: string): (state: Record<ApplicationState>, props?: any) => List<BoardInvitation> => {\n    return createSelector(\n        [boardInvitationListSelector],\n        (boardInvitations): List<BoardInvitation> =>  {\n            return boardInvitations.filter(boardInvitation =>\n                boardInvitation.boardId === boardId && boardInvitation.status === 'pending'\n            );\n        }\n    )\n};\n","import * as React from \"react\";\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {ButtonGroup, ListItem, Table} from \"semantic-ui-react\";\nimport SecondaryButton from \"../../../core/components/SecondaryButton\";\nimport {isSuccess} from \"../../../core/validation/either\";\nimport * as UserModule from \"../../../User\";\nimport UserAvatar from \"../../../User/components/UserAvatar\";\nimport {createAnonymous} from \"../../../User/model/IioUserInfo\";\nimport * as Action from \"../../actions\";\nimport {Board} from \"../../model/Board\";\nimport {BoardInvitation} from \"../../model/BoardInvitation\";\nimport {makeBoardInvitationSelector} from \"../../selectors/boardInvitation\";\n\ninterface PropsFromState {\n}\n\ninterface PropsFromDispatch {\n\n}\n\ninterface OwnProps {\n    board: Board;\n    boardInvitation: BoardInvitation;\n}\n\nexport type OpenBoardInvitationTableEntryProps = PropsFromState & PropsFromDispatch & OwnProps & WithNamespaces;\n\nconst OpenBoardInvitationsTableEntry = (props: OpenBoardInvitationTableEntryProps) => {\n\n    const dispatch = useDispatch();\n    const [userInfo, setUserInfo] = useState(createAnonymous());\n    const [isResending, setIsResending] = useState<boolean>(false);\n    const [isRevoking, setIsRevoking] = useState<boolean>(false);\n    const invitation = useSelector(makeBoardInvitationSelector(props.boardInvitation.uid));\n\n    useEffect(() => {\n        UserModule.Action.Api.getInspectioUserInfoByEmail(props.boardInvitation.invitedUserEmail).then(({response, error}) => {\n            if(response) {\n                const result = UserModule.IioUserInfo.createIioUserInfoFromServerData(response.data);\n\n                if(isSuccess(result)) {\n                    setUserInfo(result.value);\n                }\n            }\n        })\n    }, [props.boardInvitation.invitedUserEmail]);\n\n    useEffect(\n        () => {\n            setIsResending(false);\n            setIsRevoking(false);\n        },\n        [invitation]\n    );\n\n    const handleResendInvitation = () => {\n        if (isResending || isRevoking) {\n            return;\n        }\n\n        setIsResending(true);\n        dispatch(Action.Command.resendBoardInvitation(props.boardInvitation.uid));\n    };\n\n    const handleRevokeInvitation = () => {\n        if (isResending || isRevoking) {\n            return;\n        }\n\n        setIsRevoking(true);\n        dispatch(Action.Command.revokeBoardInvitation(props.boardInvitation.uid));\n    };\n\n    return (\n        <Table.Row>\n            <Table.Cell style={{ width: \"250px\" }}>\n                <UserAvatar user={userInfo} size=\"mini\" />\n                <span style={{paddingLeft: \"10px\"}}>{props.boardInvitation.invitedUserEmail}</span>\n            </Table.Cell>\n            <Table.Cell>\n                <ButtonGroup floated=\"right\">\n                    <SecondaryButton\n                        content={props.t('app.form.resend')}\n                        icon=\"paper plane\"\n                        loading={isResending}\n                        onClick={handleResendInvitation}\n                    />\n                    <SecondaryButton\n                        content={props.t('app.form.revoke')}\n                        icon=\"delete\"\n                        loading={isRevoking}\n                        onClick={handleRevokeInvitation}\n                    />\n                </ButtonGroup>\n            </Table.Cell>\n        </Table.Row>\n    );\n};\n\nexport default withNamespaces()(OpenBoardInvitationsTableEntry);\n","import * as React from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {Table} from \"semantic-ui-react\";\nimport {Board} from \"../../model/Board\";\nimport {makeOpenBoardInvitationListSelector} from \"../../selectors/boardInvitation\";\nimport OpenBoardInvitationsTableEntry from \"./OpenBoardInvitationsTableEntry\";\nimport {List} from \"immutable\";\nimport {BoardInvitation} from \"../../model/BoardInvitation\";\n\ninterface PropsFromState {\n}\n\ninterface PropsFromDispatch {\n\n}\n\ninterface OwnProps {\n    board: Board;\n    openInvitations: List<BoardInvitation>;\n}\n\nexport type OpenBoardInvitationsTableProps = PropsFromState & PropsFromDispatch & OwnProps;\n\nexport const OpenBoardInvitationsTable = (props: OpenBoardInvitationsTableProps) => {\n\n    return (\n        <Table unstackable={true} basic=\"very\">\n            <Table.Body>\n                {props.openInvitations.map(boardInvitation => (\n                    <OpenBoardInvitationsTableEntry\n                        key={boardInvitation.uid}\n                        board={props.board}\n                        boardInvitation={boardInvitation}\n                    />\n                ))}\n            </Table.Body>\n        </Table>\n    );\n};\n","import React, {useState} from 'react'\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Label, Search, Table} from \"semantic-ui-react\";\nimport {Action as Notify} from \"../../../NotificationSystem\";\nimport {BoardId} from \"../../model/Board\";\nimport {Permissions} from \"../../model/BoardPermissionForUser\";\nimport {Email, UserId, Username} from \"../../../User/model/UserInfo\";\nimport {List} from \"immutable\";\n\nexport interface ShareBoardWithUserFormData  {\n    boardId: BoardId,\n    email: string,\n    permissions: Permissions\n}\n\nexport interface OwnProps {\n    boardId: BoardId,\n    email: string,\n    permissions: Permissions,\n    users: List<{ userId: UserId, name: Username, email: Email, avatar: string }>,\n    handleSubmit: (data: ShareBoardWithUserFormData) => void,\n}\n\nexport interface PropsFromDispatch {\n\n}\n\n\nexport type ShareBoardFormProps = OwnProps & PropsFromDispatch & WithNamespaces;\n\nconst PAGE_EMAIL_INPUT = 1;\nconst PAGE_PERMISSIONS = 2;\n\nconst ShareBoardForm = (props: ShareBoardFormProps) => {\n\n    const dispatch = useDispatch();\n    const [email, setEmail] = useState<string>(props.email);\n    const [writeAccess, setWriteAccess] = useState<boolean>(props.permissions.writeAccess);\n\n    const filteredUsers = props.users\n        .filter(user => user.name.toLocaleLowerCase().includes(email.toLocaleLowerCase()) || user.email.toLocaleLowerCase().includes(email.toLocaleLowerCase()))\n        .sortBy(user => user.name)\n        .map(user => {\n        return {\n            id: user.userId,\n            title: user.name,\n            description: user.email,\n            image: user.avatar,\n        }\n    });\n\n    const reset = () => {\n        setWriteAccess(true);\n        setEmail('');\n    };\n\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n        event.preventDefault();\n\n        if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i.test(email)) {\n            dispatch(Notify.Command.error('Invalid email address', 'Invalid email address'));\n            return;\n        }\n\n        props.handleSubmit({\n            boardId: props.boardId,\n            email,\n            permissions: { ...props.permissions, writeAccess }\n        });\n        reset();\n    };\n\n    return (\n        <form className=\"ui form\" onSubmit={handleSubmit}>\n            <div className=\"fields\" style={{margin:\"0\"}}>\n                <Table unstackable={true} basic=\"very\">\n                    <Table.Body>\n                        <Table.Row>\n                            <Table.Cell style={{width: \"310px\"}}>\n                                <Search\n                                    fluid={true}\n                                    value={email}\n                                    results={filteredUsers.toArray()}\n                                    placeholder={props.t('insp.board.form.email') as string}\n                                    showNoResults={false}\n                                    resultRenderer={data => {\n                                        return <div key={data.id}>\n                                            <div className=\"ui image avatar\">\n                                                <img src={data.image} alt={data.title} />\n                                            </div>\n                                            <div className=\"content\">\n                                                <div className=\"title\">{data.title}</div>\n                                                <div className=\"description\">{data.description}</div>\n                                            </div>\n                                        </div>\n                                    }}\n                                    onSearchChange={(e, data) => setEmail(data.value || '')}\n                                    onResultSelect={(e, data) => {\n                                        setEmail(data.result.description)\n                                    }}\n                                />\n                            </Table.Cell>\n                            <Table.Cell>\n                                <Button.Group>\n                                    <Button\n                                        type={'button'}\n                                        className={'positive'}\n                                        children={'Read'}\n                                        onClick={() => setWriteAccess(false)}\n                                    />\n                                    <Button.Or text=\"+\" />\n                                    <Button\n                                        type={'button'}\n                                        className={writeAccess ? 'positive' : ''}\n                                        children={'Write'}\n                                        onClick={() => setWriteAccess(!writeAccess)}\n                                    />\n                                </Button.Group>\n                            </Table.Cell>\n                            <Table.Cell>\n                                <Button primary={true} type=\"submit\" floated=\"right\">\n                                    {props.t('insp.board.form.btn_share')}\n                                </Button>\n                            </Table.Cell>\n                        </Table.Row>\n                    </Table.Body>\n                </Table>\n            </div>\n        </form>\n    );\n};\n\nexport default withNamespaces()(ShareBoardForm);\n","import React, {useState} from 'react'\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Button, Dropdown, DropdownProps, Label, Table} from \"semantic-ui-react\";\nimport {Model as TeamModel} from \"../../../InspectioTeams\";\nimport {makeTeamListSelector} from \"../../../InspectioTeams/selectors/selectTeam\";\nimport {UserInfo} from \"../../../User/model/UserInfo\";\nimport {BoardId} from \"../../model/Board\";\nimport {Permissions} from \"../../model/BoardPermissionForUser\";\nimport {makeBoardPermissionForTeamListSelector} from \"../../selectors/boardPermission\";\n\nexport interface ShareBoardWithTeamFormData {\n    boardId: BoardId,\n    teamIds: TeamModel.Team.TeamId[],\n    permissions: Permissions,\n}\n\nexport interface OwnProps {\n    boardId: BoardId,\n    user: UserInfo,\n    permissions: Permissions,\n    handleSubmit: (data: ShareBoardWithTeamFormData) => void,\n}\n\nexport type ShareBoardWithTeamFormProps = OwnProps & WithNamespaces;\n\nconst PAGE_TEAM_NAME_INPUT = 1;\nconst PAGE_PERMISSIONS = 2;\n\nconst ShareBoardWithTeamForm = (props: ShareBoardWithTeamFormProps) => {\n\n    const teams = useSelector(makeTeamListSelector());\n    const [page, setPage] = useState<number>(PAGE_TEAM_NAME_INPUT);\n    const [selectedTeams, setSelectedTeams] = useState<string[]>([]);\n    const [writeAccess, setWriteAccess] = useState<boolean>(props.permissions.writeAccess);\n\n    const boardPermissions = useSelector(makeBoardPermissionForTeamListSelector(props.boardId));\n    const teamBlacklist = boardPermissions.map(boardPermission => boardPermission.teamId);\n\n    const filteredTeams = teams.filter(team => !teamBlacklist.contains(team.uid));\n\n    const ownTeamsOptions = teams.map(team => ({\n        key: team.uid,\n        value: team.uid,\n        text: team.name\n    })).toArray();\n\n    const reset = () => {\n        setWriteAccess(props.permissions.writeAccess);\n        setSelectedTeams([]);\n    };\n\n    const handleChange = (e: React.SyntheticEvent, dProps: DropdownProps) => setSelectedTeams(dProps.value as string[]);\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n\n        props.handleSubmit({\n            boardId: props.boardId,\n            teamIds: selectedTeams,\n            permissions: { ...props.permissions, writeAccess }\n        });\n        reset();\n    };\n\n    return (\n        <form className=\"ui form\" onSubmit={handleSubmit}>\n            <div className=\"fields\" style={{margin: \"0\"}}>\n                <Table unstackable={true} basic=\"very\">\n                    <Table.Body>\n                        <Table.Row>\n                            <Table.Cell style={{width: \"310px\", verticalAlign: \"top\"}}>\n                                <div className=\"inline field\" style={{width: '100%'}}>\n                                    <Dropdown\n                                        placeholder={props.t('insp.board.form.team_name') as string}\n                                        search={true}\n                                        selection={true}\n                                        multiple={true}\n                                        options={ownTeamsOptions}\n                                        value={selectedTeams}\n                                        onChange={handleChange}\n                                        style={{width: '100%'}}\n                                    />\n                                </div>\n                            </Table.Cell>\n                            <Table.Cell style={{verticalAlign: \"top\"}}>\n                                <Button.Group>\n                                    <Button\n                                        type={'button'}\n                                        className={'positive'}\n                                        children={'Read'}\n                                        onClick={() => setWriteAccess(false)}\n                                    />\n                                    <Button.Or text=\"+\" />\n                                    <Button\n                                        type={'button'}\n                                        className={writeAccess ? 'positive' : ''}\n                                        children={'Write'}\n                                        onClick={() => setWriteAccess(!writeAccess)}\n                                    />\n                                </Button.Group>\n                            </Table.Cell>\n                            <Table.Cell style={{verticalAlign: \"top\"}}>\n                                <Button primary={true} type=\"submit\" disabled={selectedTeams.length === 0}>\n                                    {props.t('insp.board.form.btn_share')}\n                                </Button>\n                            </Table.Cell>\n                        </Table.Row>\n                    </Table.Body>\n                </Table>\n            </div>\n        </form>\n    );\n};\n\nexport default withNamespaces()(ShareBoardWithTeamForm);\n","export const CONNECT_SOCKET = '@@api/ConnectSocket';\nexport const DISCONNECT_SOCKET = '@@api/DisconnectSocket';\nexport const SOCKET_CONNECTED = '@@api/SocketConnected';\nexport const SOCKET_DISCONNECTED = '@@api/SocketConnected';\nexport const SOCKET_CONNECTION_LOST = '@@api/SocketConnectionLost';\nexport const SEND_SOCKET_CMD = '@@api/SendSocketCmd';\nexport const LISTEN_ON_SOCKET_CHANNEL = '@@api/ListenOnSocketChannel';\nexport const STOP_LISTENING_ON_SOCKET_CHANNEL = '@@api/StopListeningOnSocketChannel';\nexport const DEFAULT_SOCKET_CMD_TIMEOUT = 2000;\n\n","import { action } from 'typesafe-actions';\nimport {\n    CONNECT_SOCKET, DEFAULT_SOCKET_CMD_TIMEOUT,\n    DISCONNECT_SOCKET,\n    LISTEN_ON_SOCKET_CHANNEL, SEND_SOCKET_CMD, SOCKET_CONNECTED,\n    SOCKET_CONNECTION_LOST,\n    SOCKET_DISCONNECTED, STOP_LISTENING_ON_SOCKET_CHANNEL,\n} from './constants';\n\nexport const connectSocket = () => action(CONNECT_SOCKET);\nexport const disconnectSocket = () => action(DISCONNECT_SOCKET);\nexport const socketConnected = () => action(SOCKET_CONNECTED);\nexport const socketDisconnected = () => action(SOCKET_DISCONNECTED);\nexport const socketConnectionLost = (reason: string) => action(SOCKET_CONNECTION_LOST, {reason});\n\nexport const sendSocketCmd = <D, TMeta>(name: string, data: D, responseActionType: string, metadata?: TMeta, timeout: number = DEFAULT_SOCKET_CMD_TIMEOUT) => action(SEND_SOCKET_CMD, {\n    name,\n    data,\n    responseActionType,\n    metadata,\n    timeout,\n});\nexport const notifySocketCmdSent = <D, TMeta>(responseActionType: string, socketCmd: SocketCmd<D>, metadata?: TMeta) => action(responseActionType, {\n    socketCmd,\n    metadata,\n});\nexport const ackSocketCmd = <D, TMeta>(responseActionType: string, socketCmd: SocketCmd<D>, metadata?: TMeta) => action(responseActionType, {\n    socketCmd,\n    metadata,\n});\nexport const rejectSocketCmd = <D, TMeta>(responseActionType: string, socketCmd: SocketCmd<D>, metadata?: TMeta) => action(responseActionType, {\n    socketCmd,\n    metadata,\n});\n\nexport const listenOnSocketChannel = <D, TMeta>(channelName: string, emitActionType: string, metadata?: TMeta) => action(LISTEN_ON_SOCKET_CHANNEL, {\n    channelName,\n    emitActionType,\n    metadata,\n});\nexport const stopListeningOnSocketChannel = (channelName: string) => action(STOP_LISTENING_ON_SOCKET_CHANNEL, {channelName});\nexport const emitChannelEvent = <D, TMeta>(emitActionType: string, event: D, metadata?: TMeta) => action(emitActionType, {\n    event,\n    metadata,\n});\n\n\ninterface SocketCmdPending<D> {\n    name: string;\n    type: 'pending';\n    payload: D;\n    reason?: undefined;\n}\n\ninterface SocketCmdError<D> {\n    name: string;\n    type: 'error';\n    payload: D;\n    reason: string;\n}\n\ninterface SocketCmdSuccess<D> {\n    name: string;\n    type: 'success';\n    payload: D;\n    reason?: undefined;\n}\n\nexport type SocketCmd<D> = SocketCmdPending<D> | SocketCmdError<D> | SocketCmdSuccess<D>;\n\nexport const isAcknowledged = <D>(cmd: SocketCmd<D>): boolean => {\n    return cmd.type === 'success';\n};\n\nexport const isNotAcknowledged = <D>(cmd: SocketCmd<D>): boolean => {\n    return cmd.type === 'pending';\n};\n\nexport const isError = <D>(cmd: SocketCmd<D>): boolean => {\n    return cmd.type === 'error';\n};\n\n\n\n\n\n","import { Record } from 'immutable';\n\nexport const STATUS_CONNECTED = 'connected';\nexport const STATUS_CONNECTING = 'connecting';\nexport const STATUS_DISCONNECTED = 'disconnected';\nexport const STATUS_DISCONNECTING = 'disconnecting';\nexport const STATUS_CONNECTION_LOST = 'connectionLost';\n\nexport type SocketStatus = 'connected' | 'connecting' | 'disconnected' | 'connectionLost' | 'disconnecting';\n\nexport interface StatusProps {\n    status: SocketStatus;\n}\n\nexport interface StatusMethods {\n    isConnected(): boolean;\n\n    isDisconnected(): boolean;\n\n    isConnecting(): boolean;\n\n    isDisconnecting(): boolean;\n\n    hasConnectionLost(): boolean;\n\n    equals(other: Status): boolean;\n}\n\nexport interface StatusRecord extends StatusProps, StatusMethods {\n}\n\nexport const defaultUserProps: StatusProps = {\n    status: STATUS_DISCONNECTED,\n};\n\nexport const fromtString = (status: SocketStatus): Status => new Status({status});\n\nexport const disconnectedStatus = (): Status => new Status({status: STATUS_DISCONNECTED});\n\nexport const assertSocketStatus = (status: string): void => {\n    switch (status) {\n        case STATUS_CONNECTED:\n        case STATUS_CONNECTING:\n        case STATUS_DISCONNECTED:\n        case STATUS_CONNECTION_LOST:\n        case STATUS_DISCONNECTING:\n            break;\n        default:\n            throw new Error('Invalid socket status \"' + status + '\" provided');\n    }\n};\n\nexport class Status extends Record(defaultUserProps) implements StatusRecord {\n    public constructor(data: StatusProps) {\n        assertSocketStatus(data.status);\n        super(data);\n    }\n\n    public isConnected(): boolean {\n        return this.status === STATUS_CONNECTED;\n    }\n\n    public isDisconnected(): boolean {\n        return this.status === STATUS_DISCONNECTED;\n    }\n\n    public isConnecting(): boolean {\n        return this.status === STATUS_CONNECTING;\n    }\n\n    public isDisconnecting(): boolean {\n        return this.status === STATUS_DISCONNECTING;\n    }\n\n    public hasConnectionLost(): boolean {\n        return this.status === STATUS_CONNECTION_LOST;\n    }\n\n    public equals(other: Status): boolean {\n        return this.status === other.status;\n    }\n}\n","export const AUTHENTICATE = '@@Auth/Authenticate';\nexport const USER_AUTHENTICATED = '@@Auth/UserAuthenticated';","import { action } from 'typesafe-actions';\nimport {AUTHENTICATE} from \"./constants\";\n\nexport const authenticate = (auth: any) => action(AUTHENTICATE, {auth});\n","import { action } from 'typesafe-actions';\nimport { USER_AUTHENTICATED } from './constants';\n\nexport const userAuthenticated = (kc: Keycloak.KeycloakInstance) => action(USER_AUTHENTICATED, {kc});\n","import { KeycloakProfile, KeycloakTokenParsed } from 'keycloak-js';\nimport Keycloak from 'keycloak-js';\nimport { delay, put, select, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport configuredAxios from '../../api/ConfiguredAxios';\nimport verifyJwt from '../../api/ConfiguredJwtVerify';\nimport configuredSocket from '../../api/ConfiguredSocket';\nimport {distributeNewToken} from \"../../api/util\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport {Action as UserAction, UserModel, UserSelector} from '../../User';\nimport { AccountModel, RoleMapModel } from '../../User/model';\nimport * as Action from '../actions';\n\ntype AuthFlowAction = ActionType<typeof Action.Event.userAuthenticated>;\n\ninterface KcUserAttributes {\n    attributes: {\n        display_name: string[],\n        avatar_url: string[],\n        company_name: string[],\n        job_title: string[]\n    }\n};\n\ntype KcProfile = KeycloakProfile & KcUserAttributes;\n\nexport const keycloakPromise = <TSuccess>(promise: Keycloak.KeycloakPromise<TSuccess, any>) => new Promise<TSuccess>((resolve, reject) =>\n    promise\n        .success((result: TSuccess) => resolve(result))\n        .error((e: any) => reject(e)),\n);\n\nexport function* tokenRefreshFlow() {\n\n    const action: AuthFlowAction = yield take([\n        Action.Type.USER_AUTHENTICATED,\n    ]);\n\n    let authErrors = 0;\n    const kc: Keycloak.KeycloakInstance = action.payload.kc;\n\n    try {\n        yield verifyJwt(kc.token!);\n    } catch (e) {\n        yield keycloakPromise(kc.login());\n    }\n\n    const profile: KcProfile = yield keycloakPromise<KeycloakProfile>(kc.loadUserProfile());\n\n    // Sync currentUser -> either default or quota request was faster and has set quota already\n    let user = yield select(UserSelector.currentUserSelector, undefined);\n\n    user = user.set('uid', kc.tokenParsed!.sub!);\n    user = user.set('name', profile.username!);\n\n    const attr = profile.attributes;\n\n    if(attr.display_name) {\n        user = user.set('displayName', attr.display_name[0]!);\n    } else {\n        user = user.set('displayName', profile.username!);\n    }\n\n    if(attr.avatar_url && attr.avatar_url[0] !== '') {\n        user = user.set('avatarUrl', attr.avatar_url[0]!);\n    } else {\n        user = user.set('avatarUrl', user.generateDefaultAvatarUrl());\n    }\n\n    if(attr.company_name) {\n        user = user.set('companyName', attr.company_name[0]);\n    }\n\n    if(attr.job_title) {\n        user = user.set('jobTitle', attr.job_title[0]);\n    }\n\n    user = user.set('email', profile.email!);\n    user = user.set('givenName', profile.firstName!);\n    user = user.set('familyName', profile.lastName!);\n    user = user.set('roles', RoleMapModel.fromToken(kc.resourceAccess!.inspectio.roles));\n    user = user.set('account', AccountModel.fromUserToken(kc.resourceAccess!.inspectio.roles));\n    user = user.set('signedIn', true);\n\n    yield put(UserAction.Command.signIn(user));\n\n    yield put(Action.Command.authenticate({token: kc.token}));\n\n    while (true) {\n        yield delay(10000);\n        try {\n            const refreshed = yield keycloakPromise<boolean>(kc.updateToken(31));\n\n            if (refreshed === false) {\n                continue;\n            }\n\n            try {\n                yield verifyJwt(kc.token!);\n\n                distributeNewToken(kc.token!);\n            } catch (e) {\n                yield keycloakPromise(kc.login());\n            }\n\n            yield put(Action.Command.authenticate({token: kc.token}));\n\n            if (authErrors > 0) {\n                yield put(NotifyAction.Command.info('Authorization established', 'You will be able to work ahead.'));\n            }\n\n            authErrors = 0;\n        } catch (e) {\n            if(authErrors === 0) {\n                yield put(NotifyAction.Command.error('Authorization error', 'You will be logged out shortly if connection can not be restored.'));\n            }\n            authErrors++;\n\n            if (authErrors > 2) {\n                // TODO maybe not logged out\n                yield keycloakPromise(kc.login());\n            }\n        }\n    }\n}\n","import {Record} from \"immutable\";\nimport { AuthState } from '../reducers/applyAuth';\n\nconst getToken = (state: Record<AuthState>, token: string): string => state.getIn(['auth', 'auth', 'token']);\n\nexport const makeTokenSelector = (): (state: Record<AuthState>) => string => (state: Record<AuthState>) => getToken(state, 'token');\n","import {func} from \"prop-types\";\nimport { buffers, eventChannel, EventChannel } from 'redux-saga';\nimport { call, cancel, delay, fork, put, race, select, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport { default as socket } from '../../api/ConfiguredSocket';\nimport * as Auth from '../../Auth';\nimport { Action, Type } from '../actions';\nimport {\n    connectSocket as connectSocketActionFactory, disconnectSocket as disconnectSocketActionFactory,\n    listenOnSocketChannel,\n    sendSocketCmd,\n    stopListeningOnSocketChannel,\n} from '../actions/actions';\nimport * as Socket from \"../index\";\n\ninterface ChannelRegistry {\n    [key: string]: EventChannel<any>\n}\n\ntype AuthFlowAction = ActionType<typeof Auth.Action.Event.userAuthenticated>;\n\ntype ConnectAction = ActionType<typeof connectSocketActionFactory>\n    | ActionType<typeof disconnectSocketActionFactory>\n    ;\n\nexport type SocketFlowAction = ActionType<typeof sendSocketCmd>\n    | ActionType<typeof listenOnSocketChannel>\n    | ActionType<typeof stopListeningOnSocketChannel>\n    ;\n\nexport function* manageSocketConnection() {\n    const authAction: AuthFlowAction = yield take([\n        Auth.Action.Type.USER_AUTHENTICATED,\n    ]);\n    yield fork(flow);\n}\n\nfunction* flow() {\n    console.log(\"[Socket Flow] Auto connect.\");\n    yield call(connectSocket);\n\n    try {\n        while (true) {\n            const action: ConnectAction = yield take([Type.CONNECT_SOCKET, Type.DISCONNECT_SOCKET]);\n\n            switch (action.type) {\n                case Type.CONNECT_SOCKET:\n                    console.log(\"[Socket Flow] Received ConnectSocket command.\");\n                    const success = yield call(connectSocket);\n\n                    // success can also be NULL, which indicates that a socket connection exists, so we don't need to start background tasks\n                    if (success === true || success === null) {\n                        // Always answer with socket connected event, even in case socket connection exists already\n                        yield put(Action.socketConnected());\n\n                        if(success === true) {\n                            // New socket connection established, so we need to start background tasks to handle IO\n                            yield fork(runBackgroundTasks);\n                        }\n                    } else if (success === false) {\n                        console.warn(\"[Socket Flow] ConnectSocket command failed. Calling socket.disconnect now.\");\n                        yield call([socket, socket.disconnect]);\n                    }\n                    break;\n                case Type.DISCONNECT_SOCKET:\n                    console.log(\"[Socket Flow] Received DisconnectSocket command.\");\n                    yield call([socket, socket.disconnect]);\n                    break;\n\n            }\n\n        }\n    } finally {\n        yield put(Action.socketConnectionLost('Socket saga cancelled'));\n    }\n\n}\n\nfunction* runBackgroundTasks(): any {\n    console.log(\"[Socket Flow] Running backgound tasks: listenDisconnectSaga, listenReconnectSaga, handleIO\");\n\n    const disconnectTask = yield fork(listenDisconnectSaga);\n    const reconnectTask = yield fork(listenReconnectSaga);\n    const ioTask = yield fork(handleIO);\n\n    // wait for disconnecting action\n    const action: SocketFlowAction = yield take([Type.DISCONNECT_SOCKET]);\n\n    console.warn(\"[Socket Flow] Received DisconnectSocket command. Canceling backgound tasks.\");\n\n    yield cancel(disconnectTask);\n    yield cancel(reconnectTask);\n    yield cancel(ioTask);\n}\n\nfunction* onHandleIO(action: SocketFlowAction, channelRegistry: ChannelRegistry) {\n    console.log(\"[Socket Flow] Received action \", action);\n\n    switch (action.type) {\n        case Type.SEND_SOCKET_CMD:\n            const socketStatus: Socket.Model.StatusModel.Status = yield select(Socket.Selector.StatusSelector.makeGetStatus());\n\n            if(socketStatus.isConnected()) {\n                yield call(sendCmd, action);\n            } else {\n                console.warn(\"[Socket Flow] Cannot send socket command: \", action.payload, \"Socket is not connected\");\n            }\n            break;\n        case Type.LISTEN_ON_SOCKET_CHANNEL:\n            if (channelRegistry.hasOwnProperty(action.payload.channelName)) {\n                stopListeningOnChannel(action.payload.channelName, channelRegistry);\n            }\n            yield fork(listenOnChannel, action, channelRegistry);\n            break;\n        case Type.STOP_LISTENING_ON_SOCKET_CHANNEL:\n            stopListeningOnChannel(action.payload.channelName, channelRegistry);\n            break;\n        default:\n        // ignore\n    }\n}\n\nfunction* handleIO() {\n    const channelRegistry: ChannelRegistry = {};\n\n    while (true) {\n        const action: SocketFlowAction = yield take([Type.SEND_SOCKET_CMD, Type.LISTEN_ON_SOCKET_CHANNEL, Type.STOP_LISTENING_ON_SOCKET_CHANNEL]);\n\n        yield fork(onHandleIO, action, channelRegistry);\n    }\n}\n\nconst listenOnChannel = function* (cmd: ActionType<typeof Action.listenOnSocketChannel>, registry: ChannelRegistry) {\n    console.log(\"[Socket Flow] Start listening on channel: \", cmd.payload.channelName);\n\n    const chan = eventChannel((emit) => {\n        const handler = (data: any) => {\n            emit(data);\n        };\n\n        const errorHandler = (err: Error) => {\n            if (typeof err === 'undefined') {\n                emit(new Error('Unknown error occurred.'));\n                return;\n            }\n            // create an Error object and put it into the channel\n            emit(new Error(err.message));\n        };\n\n        socket.on(cmd.payload.channelName, handler);\n\n        socket.on('connect_error', errorHandler);\n        socket.on('error', errorHandler);\n\n        return () => {\n            console.log(\"[Socket Flow] stop listening on channel, because redux-saga event channel was closed: \", cmd.payload.channelName);\n            socket.off(cmd.payload.channelName);\n        };\n    }, buffers.expanding(10));\n\n    registry[cmd.payload.channelName] = chan;\n\n    while (true) {\n        try {\n            const event = yield take(chan);\n            yield put(Action.emitChannelEvent(cmd.payload.emitActionType, event, cmd.payload.metadata));\n        } catch (e) {\n            chan.close();\n            yield put(Action.socketConnectionLost(e.message));\n            return;\n        }\n    }\n};\n\nconst connectSocket = (): Promise<boolean|null> => {\n    return new Promise<boolean|null>((resolve) => {\n        if(socket.connected) {\n            resolve(null);\n            return;\n        }\n\n        socket.on('connect', () => resolve(true));\n        socket.open();\n    }).then(\n        response => response,\n    ).catch(\n        error => false,\n    );\n};\n\nconst reconnectSocket = (): Promise<boolean> => {\n    return new Promise((resolve) => {\n        socket.io.on('reconnect', () => {\n            resolve(true);\n        });\n    });\n};\n\nconst disconnectSocket = (): Promise<string> => {\n    return new Promise((resolve) => {\n        socket.on('disconnect', (reason: string) => {\n            resolve(reason);\n        });\n    });\n};\n\n// connection monitoring sagas\nconst listenDisconnectSaga = function* () {\n    while (true) {\n        const reason = yield call(disconnectSocket);\n        console.warn(\"[Socket Flow] Socket connection lost: \", reason);\n        yield put(Action.socketConnectionLost(reason));\n    }\n};\n\nconst listenReconnectSaga = function* () {\n    while (true) {\n        yield call(reconnectSocket);\n        console.log(\"[Socket Flow] socket reconnected.\");\n\n        // Wait a moment before telling the app that the socket is available again.\n        // This is needed, because otherwise the socket can still be flagged as disconnected\n        // if the saga receives new cmds too fast\n        yield delay(100);\n        yield put(Action.socketConnected());\n    }\n};\n\n\nconst stopListeningOnChannel = (channelName: string, registry: ChannelRegistry) => {\n    if (registry.hasOwnProperty(channelName)) {\n        console.log(\"[Socket Flow] Stop listening on channel: \", channelName);\n        registry[channelName].close();\n        delete registry[channelName];\n    }\n};\n\nconst sendCmd = function* <D>(cmd: ActionType<typeof Action.sendSocketCmd>) {\n\n    yield put(Action.notifySocketCmdSent(cmd.payload.responseActionType, {\n        name: cmd.payload.name,\n        type: 'pending',\n        payload: cmd.payload.data,\n    }, cmd.payload.metadata));\n\n    try {\n        const token = yield select(Auth.Selector.AuthSelector.makeTokenSelector());\n\n        const {ack, timeout} = yield race<any>({\n            ack: call(pushCmd, {\n                name: cmd.payload.name,\n                type: 'pending',\n                payload: {\n                    ...cmd.payload.data,\n                    token,\n                },\n            }),\n            timeout: delay(cmd.payload.timeout),\n        });\n\n        if (ack) {\n            yield put(Action.ackSocketCmd(cmd.payload.responseActionType, {\n                name: cmd.payload.name,\n                type: 'success',\n                payload: cmd.payload.data,\n            }, cmd.payload.metadata));\n        }\n\n        if (timeout) {\n            yield put(Action.rejectSocketCmd(cmd.payload.responseActionType, {\n                name: cmd.payload.name,\n                type: 'error',\n                payload: cmd.payload.data,\n                reason: 'Timed out after ' + cmd.payload.timeout + ' ms',\n            }, cmd.payload.metadata));\n        }\n    } catch (e) {\n        yield put(Action.rejectSocketCmd(cmd.payload.responseActionType, {\n            name: cmd.payload.name,\n            type: 'error',\n            payload: cmd.payload.data,\n            reason: e.toString(),\n        }, cmd.payload.metadata));\n    }\n\n\n};\n\nconst pushCmd = <D>(cmd: Action.SocketCmd<D>): Promise<true> => {\n    return new Promise((resolve, reject) => {\n        try {\n            if (socket.disconnected) {\n                reject(new Error('Socket not connected'));\n                return;\n            }\n            socket.emit(cmd.name, cmd.payload, () => resolve(true));\n        } catch (e) {\n            reject(e);\n        }\n    });\n};\n\n","import { Record } from 'immutable';\nimport { createSelector } from 'reselect';\nimport { ApplicationState } from '../../reducer';\nimport { StatusModel } from '../model';\n\nexport const statusSelector = (state: Record<ApplicationState>) => state.getIn(['socket', 'status', 'status']);\n\nexport const makeGetStatus = (): (state: Record<ApplicationState>, props?: any) => StatusModel.Status => {\n    return createSelector(\n        [statusSelector],\n        (status: StatusModel.SocketStatus): StatusModel.Status => StatusModel.fromtString(status),\n    );\n};\n","import {List, Record} from \"immutable\";\nimport {RouteComponentProps} from \"react-router\";\nimport { createSelector } from 'reselect';\nimport {ApplicationState} from \"../../reducer\";\nimport {Selector as SocketSelector} from \"../../Socket\";\nimport {UserSelector} from \"../../User\";\nimport {keyLiteMode, makeUserSettingSelector} from \"../../User/selectors/userSettings\";\nimport {EditBoardProps} from \"../components/EditBoard\";\nimport {MxGraphBoardProps, PropsFromState} from \"../components/MxGraphBoard\";\nimport {BoardRouteMatchParams} from \"../components/types\";\nimport {BoardModel} from \"../model\";\n\nconst getBoardById = (state: Record<ApplicationState>, boardId: BoardModel.BoardId): BoardModel.Board => state.getIn(['inspectioBoards', 'boards', boardId]);\n\nexport const boardSelector = (state: Record<ApplicationState>, props: RouteComponentProps<BoardRouteMatchParams>) => getBoardById(state, props.match.params.uid);\n\nexport const makeBoardByIdSelector = (boardId: BoardModel.BoardId): (state: Record<ApplicationState>) => BoardModel.Board => (state: Record<ApplicationState>) => getBoardById(state, boardId);\n\nexport const makeGetBoard = (): (state: Record<ApplicationState>, props: RouteComponentProps<BoardRouteMatchParams>) => BoardModel.Board => {\n    return createSelector(\n        [boardSelector],\n        (board): BoardModel.Board => board\n    )\n}\n\nexport const makeMapStateToPropsAddBoard = () => {\n    const getCurrentUser = UserSelector.makeGetCurrentUser();\n\n    return (state: Record<ApplicationState>, props: any) => {\n        const currentUser = getCurrentUser(state, props);\n\n        return {\n            user: currentUser\n        }\n    }\n}\n\nexport const makeMapStateToPropsEditBoard = () => {\n    const getBoard = makeGetBoard();\n\n    return (state: Record<ApplicationState>, props: EditBoardProps) => {\n        const board = getBoard(state, props);\n\n        return {\n            board\n        }\n    }\n}\n\nexport  const makeMapStateToPropsMxGraphBoard = (): (state: Record<ApplicationState>, props: MxGraphBoardProps) => PropsFromState => {\n    const getBoard = makeGetBoard();\n    const getCurrentUser = UserSelector.makeGetCurrentUser();\n    const getSocketStatus = SocketSelector.StatusSelector.makeGetStatus();\n    const getLiteModeSetting = makeUserSettingSelector(keyLiteMode(), false);\n\n    return (state: Record<ApplicationState>, props: MxGraphBoardProps): PropsFromState => {\n        const board = getBoard(state, props);\n        const user = getCurrentUser(state, props);\n        const socketStatus = getSocketStatus(state, props);\n        const liteMode = getLiteModeSetting(state, props) as boolean;\n\n        return {\n            board,\n            user,\n            socketStatus,\n            liteMode\n        }\n    }\n}\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Header, Icon, TableCell, TableRow} from \"semantic-ui-react\";\nimport * as Action from \"../../actions\";\nimport {BoardId} from \"../../model/Board\";\nimport {DEFAULT_PERMISSIONS} from \"../../model/BoardPermissionForUser\";\nimport {makeBoardByIdSelector} from \"../../selectors/board\";\n\ninterface OwnProps {\n  boardId: BoardId\n}\n\ntype BoardPermissionsForAnyoneTableEntryProps = OwnProps & WithNamespaces;\n\nconst BoardPermissionsForAnyoneTableEntry = (props: BoardPermissionsForAnyoneTableEntryProps) => {\n  const board = useSelector(makeBoardByIdSelector(props.boardId));\n  const dispatch = useDispatch();\n\n  const hasReadAccess = board.anyonePermissions.readAccess;\n  const hasWriteAccess = board.anyonePermissions.writeAccess;\n\n  const handleChangeReadBoardPermissions = () => {\n    const permissions = board.anyonePermissions;\n    const changedPermissions = {...permissions, readAccess: !hasReadAccess};\n    if(hasReadAccess) {\n      // If read access gets revoked write access should be revoked, too\n      changedPermissions.writeAccess = false;\n    }\n    dispatch(Action.Command.shareBoardWithAnyone(board.uid, changedPermissions));\n  }\n\n  const handleChangeWriteBoardPermissions = () => {\n    const permissions = board.anyonePermissions;\n    const changedPermissions = {...permissions, writeAccess: !hasWriteAccess};\n    if(!hasWriteAccess) {\n      // If write access is granted, read access needs to be granted as well\n      changedPermissions.readAccess = true;\n    }\n    dispatch(Action.Command.shareBoardWithAnyone(board.uid, changedPermissions));\n  }\n\n  return <TableRow>\n    <TableCell style={{width: \"310px\"}}>\n      <Header as='h4' image={true}>\n        <Icon circular={true} name='user outline' />\n        <Header.Content>\n          {props.t('insp.board.permissions.anyonePane.anyone')}\n        </Header.Content>\n      </Header>\n    </TableCell>\n    <TableCell>\n      <Button.Group>\n        <Button\n          className={hasReadAccess ? 'positive' : ''}\n          children={'Read'}\n          onClick={handleChangeReadBoardPermissions}\n        />\n        <Button.Or text=\"+\" />\n        <Button\n          className={hasWriteAccess ? 'positive' : ''}\n          children={'Write'}\n          onClick={handleChangeWriteBoardPermissions}\n        />\n      </Button.Group>\n    </TableCell>\n  </TableRow>\n};\n\nexport default withNamespaces()(BoardPermissionsForAnyoneTableEntry);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Header, Icon, TableCell, TableRow} from \"semantic-ui-react\";\nimport * as Action from \"../../actions\";\nimport {BoardId} from \"../../model/Board\";\nimport {makeBoardByIdSelector} from \"../../selectors/board\";\nimport {DEFAULT_PERMISSIONS} from \"../../model/BoardPermissionForUser\";\n\ninterface OwnProps {\n  boardId: BoardId\n}\n\ntype BoardPermissionsForOrganizationMembersTableEntryProps = OwnProps & WithNamespaces;\n\nconst BoardPermissionsForOrganizationMembersTableEntry = (props: BoardPermissionsForOrganizationMembersTableEntryProps) => {\n\n  const board = useSelector(makeBoardByIdSelector(props.boardId));\n  const dispatch = useDispatch();\n\n  const hasReadAccess = board.orgaMemberPermissions.readAccess;\n  const hasWriteAccess = board.orgaMemberPermissions.writeAccess;\n\n  const handleChangeReadBoardPermissions = () => {\n    const permissions = board.orgaMemberPermissions;\n    const changedPermissions = {...permissions, readAccess: !hasReadAccess};\n    if(hasReadAccess) {\n      // If read access gets revoked write access should be revoked, too\n      changedPermissions.writeAccess = false;\n    }\n    dispatch(Action.Command.shareBoardWithOrganizationMembers(board.uid, changedPermissions));\n  }\n\n  const handleChangeWriteBoardPermissions = () => {\n    const permissions = board.orgaMemberPermissions;\n    const changedPermissions = {...permissions, writeAccess: !hasWriteAccess};\n    if(!hasWriteAccess) {\n      // If write access is granted, read access needs to be granted as well\n      changedPermissions.readAccess = true;\n    }\n    dispatch(Action.Command.shareBoardWithOrganizationMembers(board.uid, changedPermissions));\n  }\n\n  return <TableRow>\n    <TableCell style={{width: \"310px\"}}>\n      <Header as='h4' image={true}>\n        <Icon circular={true} name='building outline' />\n        <Header.Content>\n          {props.t('insp.board.permissions.anyonePane.orgaMembers')}\n        </Header.Content>\n      </Header>\n    </TableCell>\n    <TableCell>\n      <Button.Group>\n        <Button\n          className={hasReadAccess ? 'positive' : ''}\n          children={'Read'}\n          onClick={handleChangeReadBoardPermissions}\n        />\n        <Button.Or text=\"+\" />\n        <Button\n          className={hasWriteAccess ? 'positive' : ''}\n          children={'Write'}\n          onClick={handleChangeWriteBoardPermissions}\n        />\n      </Button.Group>\n    </TableCell>\n  </TableRow>\n};\n\nexport default withNamespaces()(BoardPermissionsForOrganizationMembersTableEntry);\n","import * as React from 'react';\nimport {Table} from \"semantic-ui-react\";\nimport {BoardId} from \"../../model/Board\";\nimport BoardPermissionsForAnyoneTableEntry from \"./BoardPermissionsForAnyoneTableEntry\";\nimport BoardPermissionsForOrganizationMembersTableEntry from \"./BoardPermissionsForOrganizationMembersTableEntry\";\n\ninterface OwnProps {\n  boardId: BoardId\n}\n\ntype BoardPermissionsForAnyoneTableProps = OwnProps;\n\nconst BoardPermissionsForAnyoneTable = (props: BoardPermissionsForAnyoneTableProps) => {\n  return <Table unstackable={true} basic=\"very\">\n    <Table.Body>\n      <BoardPermissionsForOrganizationMembersTableEntry boardId={props.boardId} />\n      <BoardPermissionsForAnyoneTableEntry boardId={props.boardId} />\n    </Table.Body>\n  </Table>\n};\n\nexport default BoardPermissionsForAnyoneTable;\n","\nexport const readFile = (file: File): Promise<string> => {\n    return new Promise<string>((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = () => resolve(reader.result as string);\n        reader.onerror = () => reject();\n        reader.readAsText(file, 'UTF-8');\n    });\n};\n\nexport const readFileArrayBuffer = (file: File): Promise<ArrayBuffer> => {\n    return new Promise<ArrayBuffer>((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = () => resolve(reader.result as ArrayBuffer);\n        reader.onerror = () => reject();\n        reader.readAsArrayBuffer(file);\n    });\n}\n\nexport const readFileBase64 = (file: File): Promise<string> => {\n    return new Promise<string>((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = () => resolve(reader.result as string);\n        reader.onerror = () => reject();\n        reader.readAsDataURL(file);\n    });\n};\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Divider, Tab} from \"semantic-ui-react\";\nimport {Action as TeamAction} from \"../../../InspectioTeams\";\nimport {makeOrganizationSelector} from \"../../../Organization/selectors/selectOrganization\";\nimport {UserId} from \"../../../User/model/UserInfo\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\nimport {makeIioFilteredUserListSelector} from \"../../../User/selectors/iioUserInfo\";\nimport * as Action from \"../../actions\";\nimport {BoardModel} from \"../../model\";\nimport {BoardPermissionsForTeamsTable} from \"./BoardPermissionsForTeamsTable\";\nimport {BoardPermissionTable} from \"./BoardPermissionsTable\";\nimport {OpenBoardInvitationsTable} from \"./OpenBoardInvitationsTable\";\nimport {default as ShareBoardForm, ShareBoardWithUserFormData} from \"./ShareBoardForm\";\nimport ShareBoardWithTeamForm, {ShareBoardWithTeamFormData} from \"./ShareBoardWithTeamForm\";\nimport {makeOpenBoardInvitationListSelector} from \"../../selectors/boardInvitation\";\nimport BoardPermissionsForAnyoneTable from \"./BoardPermissionsForAnyoneTable\";\n\ninterface OwnProps {\n    board?: BoardModel.Board;\n}\n\ntype BoardPermissionsMenuProps = OwnProps & WithNamespaces;\n\nconst BoardPermissionsMenu = (props: BoardPermissionsMenuProps) => {\n    const dispatch = useDispatch();\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const organizationUserIds = List<UserId>(organization ? [organization.ownerId, ...organization.members.toJS()] : []);\n    const organizationUsers = useSelector(makeIioFilteredUserListSelector(organizationUserIds));\n    const openBoardInvitations = useSelector(makeOpenBoardInvitationListSelector(props.board ? props.board.uid : ''));\n\n    const shareBoard = (data: ShareBoardWithUserFormData): void => {\n        dispatch(Action.Command.shareBoard(data.boardId, data.email, data.permissions));\n    };\n\n    const shareBoardWithTeams = (data: ShareBoardWithTeamFormData): void => {\n        dispatch(TeamAction.Command.adminGrantTeamAccessToBoard(data.boardId, data.teamIds, data.permissions));\n    };\n\n    if (!props.board || !organization) {\n        return <></>;\n    }\n\n    const usersPane = <>\n        <ShareBoardForm\n            boardId={props.board.uid}\n            email={''}\n            permissions={{ readAccess: true, writeAccess: true, adminAccess: false }}\n            handleSubmit={shareBoard}\n            users={organizationUsers.map(user => ({\n                userId: user.userId,\n                name: user.username,\n                avatar: user.avatarUrl,\n                email: user.email\n            }))}\n        />\n        <Divider />\n        <BoardPermissionTable board={props.board} />\n        {openBoardInvitations.count() > 0 && <>\n            <Divider horizontal={true}>Open Invitations</Divider>\n            <OpenBoardInvitationsTable openInvitations={openBoardInvitations} board={props.board} />\n        </>}\n    </>;\n\n    const teamsPane = <>\n        <ShareBoardWithTeamForm\n            boardId={props.board.uid}\n            user={currentUser}\n            permissions={{ readAccess: true, writeAccess: true, adminAccess: false }}\n            handleSubmit={shareBoardWithTeams}\n        />\n        <Divider />\n        <BoardPermissionsForTeamsTable board={props.board} />\n    </>;\n\n    const anyonePane = <>\n        <BoardPermissionsForAnyoneTable boardId={props.board.uid} />\n    </>;\n\n    const panes = [\n        {\n            \"menuItem\": \"User\",\n            render: () => usersPane,\n        },\n        {\n            \"menuItem\": \"Teams\",\n            render: () => teamsPane,\n        },\n        {\n            \"menuItem\": props.t('insp.board.permissions.all'),\n            render: () => anyonePane,\n        }\n    ];\n\n    return <Tab menu={{ secondary: true, pointing: true, color: 'orange' }} panes={panes} />\n};\n\nexport default withNamespaces()(BoardPermissionsMenu);\n","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {BoardId} from \"./Board\";\nimport {NodeType} from \"./Graph\";\n\nexport const AGGREGATE_TYPE = 'StickyTemplate';\n\nexport type StickyTemplateId = string;\nexport type StickyTemplateError = string;\nexport type TemplateString = string;\nexport type TemplateType = 'json'|'xml'|'yaml';\nexport type TemplateSchema = string|null;\n\nexport interface StickyTemplateProps {\n    uid: StickyTemplateId;\n    aggregateType: AggregateType;\n    cellType: NodeType;\n    template: TemplateString;\n    templateType: TemplateType;\n    templateSchema?: TemplateSchema;\n    boardId: BoardId;\n}\n\nexport const defaultStickyTemplateProps: StickyTemplateProps = {\n    uid: '',\n    aggregateType: AGGREGATE_TYPE,\n    cellType: NodeType.misc,\n    template: '',\n    templateType: 'json',\n    templateSchema: undefined,\n    boardId: '',\n};\n\nexport const deriveStickTemplateId = (boardId: BoardId, cellType: NodeType): StickyTemplateId => {\n    return `${boardId}__${cellType}`;\n}\n\nexport const createStickyTemplateFromServerData = (data: any): Either<StickyTemplateError, StickyTemplate> => {\n    const validatedData: Either<StickyTemplateError, any> = validate(data,\n        [hasKey('boardId'), \"boardId missing\"],\n        [hasKey('cellType'), \"cellType missing\"],\n        [hasKey('template'), \"template missing\"],\n        [hasKey('templateType'), \"templateType is missing\"]\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new StickyTemplate({\n        ...defaultStickyTemplateProps,\n        ...data,\n        uid: deriveStickTemplateId(data.boardId, data.cellType)\n    }));\n};\n\nexport const createStickyTemplateFromDefault = (boardId: BoardId, cellType: NodeType, template: string): StickyTemplate => {\n    return new StickyTemplate({\n        uid: deriveStickTemplateId(boardId, cellType),\n        aggregateType: AGGREGATE_TYPE,\n        cellType,\n        boardId,\n        template,\n        templateType: 'json',\n    });\n};\n\nexport class StickyTemplate extends Record(defaultStickyTemplateProps) implements StickyTemplateProps, Aggregate {\n    public constructor(data: StickyTemplateProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        if (!data.templateSchema) {\n            data.templateSchema = undefined;\n        }\n\n        super(data);\n    }\n\n    public setTemplate(template: TemplateString): StickyTemplate {\n        return this.set('template', template);\n    }\n\n    public setTemplateType(templateType: TemplateType): StickyTemplate {\n        return this.set('templateType', templateType);\n    }\n\n    public setTemplateSchema(templateSchema: TemplateSchema): StickyTemplate {\n        return this.set('templateSchema', templateSchema);\n    }\n}\n","const OBJ_SCHEMA = `{\n    \"type\": \"object\",\n    \"properties\": {\n      \n    },\n    \"required\": [],\n    \"additionalProperties\": false\n  }`;\n\nexport const DEFAULT_TEMPLATE: {[index: string]: string} = {\n    command: `\\\n{\n  \"newAggregate\": false,\n  \"schema\": ${OBJ_SCHEMA} \n}\n`,\n    event: `\\\n{\n  \"public\": false,\n  \"schema\": ${OBJ_SCHEMA}\n}\n`,\n    aggregate: `\\\n{\n  \"schema\": ${OBJ_SCHEMA}\n}  \n`,\n    document: `\\\n{\n  \"schema\": ${OBJ_SCHEMA}\n}  \n`,\n    policy: `\\\n{\n  \"streams\": []\n}\n`,\n    role: `\\\n{\n  \n}\n`,\n    hotSpot: `\\\n{\n  \n}\n`,\n    externalSystem: `\\\n{\n  \n}\n`,\n    ui: `\\\n{\n  \n}\n`,\n    feature: `\\\n{\n  \n}\n`,\n    boundedContext: `\\\n{\n  \n}\n`,\n    siwmlanes: `\\\n{\n  \n}\n`,\n    icon: `\\\n{\n  \n}\n`,\n    image: `\\\n{\n  \n}\n`,\n    freeText: `\\\n{\n  \n}\n`,\n};\n","import {List, Map, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {BoardId} from \"../model/Board\";\nimport {DEFAULT_TEMPLATE} from \"../model/DefaultStickyTemplate\";\nimport {NodeType} from \"../model/Graph\";\nimport {createStickyTemplateFromDefault, StickyTemplate, StickyTemplateId} from \"../model/StickyTemplate\";\n\nexport const getStickyTemplateById = (state: Record<ApplicationState>, uid: StickyTemplateId): StickyTemplate | undefined => state.getIn([MODULE, 'StickyTemplate', uid]);\n\nexport const makeStickyTemplateSelector = (uid: StickyTemplateId): (state: Record<ApplicationState>) => StickyTemplate | undefined => (state: Record<ApplicationState>) => getStickyTemplateById(state, uid);\n\nexport const stickyTemplateListSelector = (state: Record<ApplicationState>, props: any): List<StickyTemplate> =>\n    List(state.getIn([MODULE, 'StickyTemplate']).toIndexedSeq().toArray()) || List();\n\nexport const makeStickyTemplateListSelector = (): (state: Record<ApplicationState>, props?: any) => List<StickyTemplate> => {\n    return createSelector(\n        [stickyTemplateListSelector],\n        (StickyTemplateList): List<StickyTemplate> => {\n            return StickyTemplateList;\n        }\n    )\n};\n\nexport const boardStickyTemplateMapSelector = (state: Record<ApplicationState>, props: {boardId: BoardId}): Map<NodeType, StickyTemplate> => {\n    let stickyMap = Map<NodeType, StickyTemplate>();\n\n    (state.getIn([MODULE, 'StickyTemplate']) || List()).toIndexedSeq()\n        .filter((stickyTemplate: StickyTemplate) => {\n            return stickyTemplate.boardId === props.boardId;\n        })\n        .forEach((stickyTemplate: StickyTemplate) => {\n            stickyMap = stickyMap.set(stickyTemplate.cellType, stickyTemplate);\n        });\n\n    return stickyMap;\n};\n    List();\n\nexport const makeBoardStickyTemplateMapSelector = (boardId: BoardId): (state: Record<ApplicationState>) => Map<NodeType, StickyTemplate> => {\n    return (state: Record<ApplicationState>): Map<NodeType, StickyTemplate> => {\n        let stickyTemplateMap = boardStickyTemplateMapSelector(state, {boardId});\n\n        for (const cellType in DEFAULT_TEMPLATE) {\n            if(!stickyTemplateMap.has(cellType as NodeType)) {\n                stickyTemplateMap = stickyTemplateMap.set(\n                    cellType as NodeType,\n                    createStickyTemplateFromDefault(boardId, cellType as NodeType, DEFAULT_TEMPLATE[cellType] as string)\n                )\n            }\n        }\n        return stickyTemplateMap;\n    }\n};\n","import * as _ from 'lodash';\n\nexport type JSONSchema = any;\n\nexport const convertJsonSchemaToEditorValue = (schema: JSONSchema, definitions?: Record<string, JSONSchema>): any => {\n    let editorValue: any = '';\n    schema = _.clone(schema);\n\n    if (!schema.type && schema.$ref && definitions) {\n        schema = {...resolveRef(schema.$ref, schema, definitions)};\n    }\n\n    if (!schema.type && !schema.enum) {\n        // Object is the default type if no type is set\n        return { type: 'object' };\n    }\n\n    if (schema.enum && Array.isArray(schema.enum)) {\n        return schema.enum.join('|');\n    }\n\n    if (Array.isArray(schema.type)) {\n        for (const type of schema.type) {\n            // Pick first non null type from the list\n            if (type.toLowerCase() !== 'null') {\n                schema.type = type;\n                break;\n            }\n        }\n    }\n\n    switch (schema.type.toLowerCase()) {\n        case 'string':\n            return 'string';\n        case 'number':\n            return 0;\n        case 'integer':\n            return 0;\n        case 'boolean':\n            return false;\n        case 'array':\n            return [\n                convertJsonSchemaToEditorValue(schema.items || {}, definitions),\n            ];\n        case 'object':\n            editorValue = {};\n            if(!schema.properties) {\n                schema.properties = {};\n            }\n\n            Object.keys(schema.properties).forEach(prop => {\n                editorValue[prop] = convertJsonSchemaToEditorValue(schema.properties[prop], definitions);\n            });\n\n            return editorValue;\n        default:\n            return 'unknown';\n    }\n};\n\nconst resolveRef = (ref: string, schema: JSONSchema, definitions: Record<string, JSONSchema>): JSONSchema => {\n    ref = ref.replace('#/definitions/', '');\n\n    // eslint-disable-next-line no-prototype-builtins\n    if(definitions.hasOwnProperty(ref)) {\n        return definitions[ref];\n    }\n\n    // We use string as default schema for unknown refs\n    return { type: 'string'};\n};\n","export class JSONRepairError extends Error {\n  public position: number\n\n  constructor(message: string, position: number) {\n    super(`${message} at position ${position}`)\n\n    this.position = position\n  }\n}\n","const codeSpace = 0x20 // \" \"\nconst codeNewline = 0xa // \"\\n\"\nconst codeTab = 0x9 // \"\\t\"\nconst codeReturn = 0xd // \"\\r\"\nconst codeNonBreakingSpace = 0xa0\nconst codeEnQuad = 0x2000\nconst codeHairSpace = 0x200a\nconst codeNarrowNoBreakSpace = 0x202f\nconst codeMediumMathematicalSpace = 0x205f\nconst codeIdeographicSpace = 0x3000\n\nexport function isHex(char: string): boolean {\n  return /^[0-9A-Fa-f]$/.test(char)\n}\n\nexport function isDigit(char: string): boolean {\n  return char >= '0' && char <= '9'\n}\n\nexport function isValidStringCharacter(char: string): boolean {\n  // note that the valid range is between \\u{0020} and \\u{10ffff},\n  // but in JavaScript it is not possible to create a code point larger than\n  // \\u{10ffff}, so there is no need to test for that here.\n  return char >= '\\u0020'\n}\n\nexport function isDelimiter(char: string): boolean {\n  return ',:[]/{}()\\n+'.includes(char)\n}\n\nexport function isFunctionNameCharStart(char: string) {\n  return (\n    (char >= 'a' && char <= 'z') || (char >= 'A' && char <= 'Z') || char === '_' || char === '$'\n  )\n}\n\nexport function isFunctionNameChar(char: string) {\n  return (\n    (char >= 'a' && char <= 'z') ||\n    (char >= 'A' && char <= 'Z') ||\n    char === '_' ||\n    char === '$' ||\n    (char >= '0' && char <= '9')\n  )\n}\n\n// matches \"https://\" and other schemas\nexport const regexUrlStart = /^(http|https|ftp|mailto|file|data|irc):\\/\\/$/\n\n// matches all valid URL characters EXCEPT \"[\", \"]\", and \",\", since that are important JSON delimiters\nexport const regexUrlChar = /^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/\n\nexport function isUnquotedStringDelimiter(char: string): boolean {\n  return ',[]/{}\\n+'.includes(char)\n}\n\nexport function isStartOfValue(char: string): boolean {\n  return isQuote(char) || regexStartOfValue.test(char)\n}\n\n// alpha, number, minus, or opening bracket or brace\nconst regexStartOfValue = /^[[{\\w-]$/\n\nexport function isControlCharacter(char: string) {\n  return char === '\\n' || char === '\\r' || char === '\\t' || char === '\\b' || char === '\\f'\n}\n\nexport interface Text {\n  charCodeAt: (index: number) => number\n}\n\n/**\n * Check if the given character is a whitespace character like space, tab, or\n * newline\n */\nexport function isWhitespace(text: Text, index: number): boolean {\n  const code = text.charCodeAt(index)\n\n  return code === codeSpace || code === codeNewline || code === codeTab || code === codeReturn\n}\n\n/**\n * Check if the given character is a whitespace character like space or tab,\n * but NOT a newline\n */\nexport function isWhitespaceExceptNewline(text: Text, index: number): boolean {\n  const code = text.charCodeAt(index)\n\n  return code === codeSpace || code === codeTab || code === codeReturn\n}\n\n/**\n * Check if the given character is a special whitespace character, some\n * unicode variant\n */\nexport function isSpecialWhitespace(text: Text, index: number): boolean {\n  const code = text.charCodeAt(index)\n\n  return (\n    code === codeNonBreakingSpace ||\n    (code >= codeEnQuad && code <= codeHairSpace) ||\n    code === codeNarrowNoBreakSpace ||\n    code === codeMediumMathematicalSpace ||\n    code === codeIdeographicSpace\n  )\n}\n\n/**\n * Test whether the given character is a quote or double quote character.\n * Also tests for special variants of quotes.\n */\nexport function isQuote(char: string): boolean {\n  // the first check double quotes, since that occurs most often\n  return isDoubleQuoteLike(char) || isSingleQuoteLike(char)\n}\n\n/**\n * Test whether the given character is a double quote character.\n * Also tests for special variants of double quotes.\n */\nexport function isDoubleQuoteLike(char: string): boolean {\n  return char === '\"' || char === '\\u201c' || char === '\\u201d'\n}\n\n/**\n * Test whether the given character is a double quote character.\n * Does NOT test for special variants of double quotes.\n */\nexport function isDoubleQuote(char: string): boolean {\n  return char === '\"'\n}\n\n/**\n * Test whether the given character is a single quote character.\n * Also tests for special variants of single quotes.\n */\nexport function isSingleQuoteLike(char: string): boolean {\n  return (\n    char === \"'\" || char === '\\u2018' || char === '\\u2019' || char === '\\u0060' || char === '\\u00b4'\n  )\n}\n\n/**\n * Test whether the given character is a single quote character.\n * Does NOT test for special variants of single quotes.\n */\nexport function isSingleQuote(char: string): boolean {\n  return char === \"'\"\n}\n\n/**\n * Strip last occurrence of textToStrip from text\n */\nexport function stripLastOccurrence(\n  text: string,\n  textToStrip: string,\n  stripRemainingText = false\n): string {\n  const index = text.lastIndexOf(textToStrip)\n  return index !== -1\n    ? text.substring(0, index) + (stripRemainingText ? '' : text.substring(index + 1))\n    : text\n}\n\nexport function insertBeforeLastWhitespace(text: string, textToInsert: string): string {\n  let index = text.length\n\n  if (!isWhitespace(text, index - 1)) {\n    // no trailing whitespaces\n    return text + textToInsert\n  }\n\n  while (isWhitespace(text, index - 1)) {\n    index--\n  }\n\n  return text.substring(0, index) + textToInsert + text.substring(index)\n}\n\nexport function removeAtIndex(text: string, start: number, count: number) {\n  return text.substring(0, start) + text.substring(start + count)\n}\n\n/**\n * Test whether a string ends with a newline or comma character and optional whitespace\n */\nexport function endsWithCommaOrNewline(text: string): boolean {\n  return /[,\\n][ \\t\\r]*$/.test(text)\n}\n","import {JSONRepairError} from \"./utils/JSONRepairError\";\nimport {\n  endsWithCommaOrNewline,\n  insertBeforeLastWhitespace,\n  isControlCharacter,\n  isDelimiter,\n  isDigit,\n  isDoubleQuote,\n  isDoubleQuoteLike,\n  isFunctionNameChar,\n  isFunctionNameCharStart,\n  isHex,\n  isQuote,\n  isSingleQuote,\n  isSingleQuoteLike,\n  isSpecialWhitespace,\n  isStartOfValue,\n  isUnquotedStringDelimiter,\n  isValidStringCharacter,\n  isWhitespace,\n  isWhitespaceExceptNewline,\n  regexUrlChar,\n  regexUrlStart,\n  removeAtIndex,\n  stripLastOccurrence\n} from './utils/stringUtils'\n\n/**\n * Taken from https://github.com/josdejong/jsonrepair\n *\n * Patched to preserve comments instead of removing them\n */\n\nconst controlCharacters: { [key: string]: string } = {\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t'\n}\n\n// map with all escape characters\nconst escapeCharacters: { [key: string]: string } = {\n  '\"': '\"',\n  '\\\\': '\\\\',\n  '/': '/',\n  b: '\\b',\n  f: '\\f',\n  n: '\\n',\n  r: '\\r',\n  t: '\\t'\n  // note that \\u is handled separately in parseString()\n}\n\n/**\n * Repair a string containing an invalid JSON document.\n * For example changes JavaScript notation into JSON notation.\n *\n * Example:\n *\n *     try {\n *       const json = \"{name: 'John'}\"\n *       const repaired = jsonrepair(json)\n *       console.log(repaired)\n *       // '{\"name\": \"John\"}'\n *     } catch (err) {\n *       console.error(err)\n *     }\n *\n */\nexport function jsonrepair(text: string, forceObject?: boolean): string {\n  let i = 0 // current index in text\n  let output = '' // generated output\n\n  if(forceObject && (text === '' || (text[0] !== \"{\" && text[0] !== \"[\"))) {\n    text = \"{\\n\" + text;\n  }\n\n  parseMarkdownCodeBlock()\n\n  const processed = parseValue()\n  if (!processed) {\n    throwUnexpectedEnd()\n  }\n\n  parseMarkdownCodeBlock()\n\n  const processedComma = parseCharacter(',')\n  if (processedComma) {\n    parseWhitespaceAndKeepComments()\n  }\n\n  if (isStartOfValue(text[i]) && endsWithCommaOrNewline(output)) {\n    // start of a new value after end of the root level object: looks like\n    // newline delimited JSON -> turn into a root level array\n    if (!processedComma) {\n      // repair missing comma\n      output = insertBeforeLastWhitespace(output, ',')\n    }\n\n    parseNewlineDelimitedJSON()\n  } else if (processedComma) {\n    // repair: remove trailing comma\n    output = stripLastOccurrence(output, ',')\n  }\n\n  // repair redundant end quotes\n  while (text[i] === '}' || text[i] === ']') {\n    i++\n    parseWhitespaceAndKeepComments()\n  }\n\n  if (i >= text.length) {\n    // reached the end of the document properly\n    return output\n  }\n\n  throwUnexpectedCharacter()\n\n  return '';\n\n  function parseValue(): boolean {\n    parseWhitespaceAndKeepComments()\n    // tslint:disable-next-line:no-shadowed-variable\n    const processed =\n      parseObject() ||\n      parseArray() ||\n      parseString() ||\n      parseNumber() ||\n      parseKeywords() ||\n      parseUnquotedString(false) ||\n      parseRegex()\n    parseWhitespaceAndKeepComments()\n\n    return !!processed\n  }\n\n  function parseWhitespaceAndKeepComments(skipNewline = true): boolean {\n    const start = i\n\n    let changed = parseWhitespace(skipNewline)\n    do {\n      changed = parseComment()\n      if (changed) {\n        changed = parseWhitespace(skipNewline)\n      }\n    } while (changed)\n\n    return i > start\n  }\n\n  function parseWhitespace(skipNewline: boolean): boolean {\n    const _isWhiteSpace = skipNewline ? isWhitespace : isWhitespaceExceptNewline\n    let whitespace = ''\n\n    while (true) {\n      if (_isWhiteSpace(text, i)) {\n        whitespace += text[i]\n        i++\n      } else if (isSpecialWhitespace(text, i)) {\n        // repair special whitespace\n        whitespace += ' '\n        i++\n      } else {\n        break\n      }\n    }\n\n    if (whitespace.length > 0) {\n      output += whitespace\n      return true\n    }\n\n    return false\n  }\n\n  function parseComment(): boolean {\n    // find a block comment '/* ... */'\n    if (text[i] === '/' && text[i + 1] === '*') {\n      // repair block comment by skipping it\n      while (i < text.length && !atEndOfBlockComment(text, i)) {\n        output += text[i];\n        i++\n      }\n      i += 2\n\n      output += '*/';\n\n      return true\n    }\n\n    // find a line comment '// ...'\n    if (text[i] === '/' && text[i + 1] === '/') {\n      // repair line comment by skipping it\n      while (i < text.length && text[i] !== '\\n') {\n        output += text[i];\n        i++\n      }\n\n      return true\n    }\n\n    return false\n  }\n\n  function parseMarkdownCodeBlock(): boolean {\n    // find and skip over a Markdown fenced code block:\n    //     ``` ... ```\n    // or\n    //     ```json ... ```\n    if (text.slice(i, i + 3) === '```') {\n      i += 3\n\n      if (isFunctionNameCharStart(text[i])) {\n        // strip the optional language specifier like \"json\"\n        while (i < text.length && isFunctionNameChar(text[i])) {\n          i++\n        }\n      }\n\n      parseWhitespaceAndKeepComments()\n\n      return true\n    }\n\n    return false\n  }\n\n  function parseCharacter(char: string): boolean {\n    if (text[i] === char) {\n      output += text[i]\n      i++\n      return true\n    }\n\n    return false\n  }\n\n  function skipCharacter(char: string): boolean {\n    if (text[i] === char) {\n      i++\n      return true\n    }\n\n    return false\n  }\n\n  function skipEscapeCharacter(): boolean {\n    return skipCharacter('\\\\')\n  }\n\n  /**\n   * Skip ellipsis like \"[1,2,3,...]\" or \"[1,2,3,...,9]\" or \"[...,7,8,9]\"\n   * or a similar construct in objects.\n   */\n  function skipEllipsis(): boolean {\n    parseWhitespaceAndKeepComments()\n\n    if (text[i] === '.' && text[i + 1] === '.' && text[i + 2] === '.') {\n      // repair: remove the ellipsis (three dots) and optionally a comma\n      i += 3\n      parseWhitespaceAndKeepComments()\n      skipCharacter(',')\n\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Parse an object like '{\"key\": \"value\"}'\n   */\n  function parseObject(): boolean {\n    if (text[i] === '{') {\n      output += '{'\n      i++\n      parseWhitespaceAndKeepComments()\n\n      // repair: skip leading comma like in {, message: \"hi\"}\n      if (skipCharacter(',')) {\n        parseWhitespaceAndKeepComments()\n      }\n\n      let initial = true\n      while (i < text.length && text[i] !== '}') {\n        // tslint:disable-next-line:no-shadowed-variable\n        let processedComma: boolean\n        if (!initial) {\n          processedComma = parseCharacter(',')\n          if (!processedComma) {\n            // repair missing comma\n            output = insertBeforeLastWhitespace(output, ',')\n          }\n          parseWhitespaceAndKeepComments()\n        } else {\n          processedComma = true\n          initial = false\n        }\n\n        skipEllipsis()\n\n        const processedKey = parseString() || parseUnquotedString(true)\n        if (!processedKey) {\n          if (\n            text[i] === '}' ||\n            text[i] === '{' ||\n            text[i] === ']' ||\n            text[i] === '[' ||\n            text[i] === undefined\n          ) {\n            // repair trailing comma\n            output = stripLastOccurrence(output, ',')\n          } else {\n            throwObjectKeyExpected()\n          }\n          break\n        }\n\n        parseWhitespaceAndKeepComments()\n        const processedColon = parseCharacter(':')\n        const truncatedText = i >= text.length\n        if (!processedColon) {\n          if (isStartOfValue(text[i]) || truncatedText) {\n            // repair missing colon\n            output = insertBeforeLastWhitespace(output, ':')\n          } else {\n            throwColonExpected()\n          }\n        }\n        const processedValue = parseValue()\n        if (!processedValue) {\n          if (processedColon || truncatedText) {\n            // repair missing object value\n            output += 'null'\n          } else {\n            throwColonExpected()\n          }\n        }\n      }\n\n      if (text[i] === '}') {\n        output += '}'\n        i++\n      } else {\n        // repair missing end bracket\n        output = insertBeforeLastWhitespace(output, '}')\n      }\n\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Parse an array like '[\"item1\", \"item2\", ...]'\n   */\n  function parseArray(): boolean {\n    if (text[i] === '[') {\n      output += '['\n      i++\n      parseWhitespaceAndKeepComments()\n\n      // repair: skip leading comma like in [,1,2,3]\n      if (skipCharacter(',')) {\n        parseWhitespaceAndKeepComments()\n      }\n\n      let initial = true\n      while (i < text.length && text[i] !== ']') {\n        if (!initial) {\n          // tslint:disable-next-line:no-shadowed-variable\n          const processedComma = parseCharacter(',')\n          if (!processedComma) {\n            // repair missing comma\n            output = insertBeforeLastWhitespace(output, ',')\n          }\n        } else {\n          initial = false\n        }\n\n        skipEllipsis()\n\n        const processedValue = parseValue()\n        if (!processedValue) {\n          // repair trailing comma\n          output = stripLastOccurrence(output, ',')\n          break\n        }\n      }\n\n      if (text[i] === ']') {\n        output += ']'\n        i++\n      } else {\n        // repair missing closing array bracket\n        output = insertBeforeLastWhitespace(output, ']')\n      }\n\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Parse and repair Newline Delimited JSON (NDJSON):\n   * multiple JSON objects separated by a newline character\n   */\n  function parseNewlineDelimitedJSON() {\n    // repair NDJSON\n    let initial = true\n    let processedValue = true\n    while (processedValue) {\n      if (!initial) {\n        // parse optional comma, insert when missing\n        // tslint:disable-next-line:no-shadowed-variable\n        const processedComma = parseCharacter(',')\n        if (!processedComma) {\n          // repair: add missing comma\n          output = insertBeforeLastWhitespace(output, ',')\n        }\n      } else {\n        initial = false\n      }\n\n      processedValue = parseValue()\n    }\n\n    if (!processedValue) {\n      // repair: remove trailing comma\n      output = stripLastOccurrence(output, ',')\n    }\n\n    // repair: wrap the output inside array brackets\n    output = `[\\n${output}\\n]`\n  }\n\n  /**\n   * Parse a string enclosed by double quotes \"...\". Can contain escaped quotes\n   * Repair strings enclosed in single quotes or special quotes\n   * Repair an escaped string\n   *\n   * The function can run in two stages:\n   * - First, it assumes the string has a valid end quote\n   * - If it turns out that the string does not have a valid end quote followed\n   *   by a delimiter (which should be the case), the function runs again in a\n   *   more conservative way, stopping the string at the first next delimiter\n   *   and fixing the string by inserting a quote there, or stopping at a\n   *   stop index detected in the first iteration.\n   */\n  function parseString(stopAtDelimiter = false, stopAtIndex = -1): boolean {\n    let skipEscapeChars = text[i] === '\\\\'\n    if (skipEscapeChars) {\n      // repair: remove the first escape character\n      i++\n      skipEscapeChars = true\n    }\n\n    if (isQuote(text[i])) {\n      // double quotes are correct JSON,\n      // single quotes come from JavaScript for example, we assume it will have a correct single end quote too\n      // otherwise, we will match any double-quote-like start with a double-quote-like end,\n      // or any single-quote-like start with a single-quote-like end\n      const isEndQuote = isDoubleQuote(text[i])\n        ? isDoubleQuote\n        : isSingleQuote(text[i])\n          ? isSingleQuote\n          : isSingleQuoteLike(text[i])\n            ? isSingleQuoteLike\n            : isDoubleQuoteLike\n\n      const iBefore = i\n      const oBefore = output.length\n\n      let str = '\"'\n      i++\n\n      while (true) {\n        if (i >= text.length) {\n          // end of text, we are missing an end quote\n\n          const iPrev = prevNonWhitespaceIndex(i - 1)\n          if (!stopAtDelimiter && isDelimiter(text.charAt(iPrev))) {\n            // if the text ends with a delimiter, like [\"hello],\n            // so the missing end quote should be inserted before this delimiter\n            // retry parsing the string, stopping at the first next delimiter\n            i = iBefore\n            output = output.substring(0, oBefore)\n\n            return parseString(true)\n          }\n\n          // repair missing quote\n          str = insertBeforeLastWhitespace(str, '\"')\n          output += str\n\n          return true\n          // biome-ignore lint/style/noUselessElse: <explanation>\n        } else if (i === stopAtIndex) {\n          // use the stop index detected in the first iteration, and repair end quote\n          str = insertBeforeLastWhitespace(str, '\"')\n          output += str\n\n          return true\n          // biome-ignore lint/style/noUselessElse: <explanation>\n        } else if (isEndQuote(text[i])) {\n          // end quote\n          // let us check what is before and after the quote to verify whether this is a legit end quote\n          const iQuote = i\n          const oQuote = str.length\n          str += '\"'\n          i++\n          output += str\n\n          parseWhitespaceAndKeepComments(false)\n\n          if (\n            stopAtDelimiter ||\n            i >= text.length ||\n            isDelimiter(text[i]) ||\n            isQuote(text[i]) ||\n            isDigit(text[i])\n          ) {\n            // The quote is followed by the end of the text, a delimiter,\n            // or a next value. So the quote is indeed the end of the string.\n            parseConcatenatedString()\n\n            return true\n          }\n\n          const iPrevChar = prevNonWhitespaceIndex(iQuote - 1)\n          const prevChar = text.charAt(iPrevChar)\n\n          if (prevChar === ',') {\n            // A comma followed by a quote, like '{\"a\":\"b,c,\"d\":\"e\"}'.\n            // We assume that the quote is a start quote, and that the end quote\n            // should have been located right before the comma but is missing.\n            i = iBefore\n            output = output.substring(0, oBefore)\n\n            return parseString(false, iPrevChar)\n          }\n\n          if (isDelimiter(prevChar)) {\n            // This is not the right end quote: it is preceded by a delimiter,\n            // and NOT followed by a delimiter. So, there is an end quote missing\n            // parse the string again and then stop at the first next delimiter\n            i = iBefore\n            output = output.substring(0, oBefore)\n\n            return parseString(true)\n          }\n\n          // revert to right after the quote but before any whitespace, and continue parsing the string\n          output = output.substring(0, oBefore)\n          i = iQuote + 1\n\n          // repair unescaped quote\n          str = `${str.substring(0, oQuote)}\\\\${str.substring(oQuote)}`\n        } else if (stopAtDelimiter && isUnquotedStringDelimiter(text[i])) {\n          // we're in the mode to stop the string at the first delimiter\n          // because there is an end quote missing\n\n          // test start of an url like \"https://...\" (this would be parsed as a comment)\n          if (text[i - 1] === ':' && regexUrlStart.test(text.substring(iBefore + 1, i + 2))) {\n            while (i < text.length && regexUrlChar.test(text[i])) {\n              str += text[i]\n              i++\n            }\n          }\n\n          // repair missing quote\n          str = insertBeforeLastWhitespace(str, '\"')\n          output += str\n\n          parseConcatenatedString()\n\n          return true\n        } else if (text[i] === '\\\\') {\n          // handle escaped content like \\n or \\u2605\n          const char = text.charAt(i + 1)\n          const escapeChar = escapeCharacters[char]\n          if (escapeChar !== undefined) {\n            str += text.slice(i, i + 2)\n            i += 2\n          } else if (char === 'u') {\n            let j = 2\n            while (j < 6 && isHex(text[i + j])) {\n              j++\n            }\n\n            if (j === 6) {\n              str += text.slice(i, i + 6)\n              i += 6\n            } else if (i + j >= text.length) {\n              // repair invalid or truncated unicode char at the end of the text\n              // by removing the unicode char and ending the string here\n              i = text.length\n            } else {\n              throwInvalidUnicodeCharacter()\n            }\n          } else {\n            // repair invalid escape character: remove it\n            str += char\n            i += 2\n          }\n        } else {\n          // handle regular characters\n          const char = text.charAt(i)\n\n          if (char === '\"' && text[i - 1] !== '\\\\') {\n            // repair unescaped double quote\n            str += `\\\\${char}`\n            i++\n          } else if (isControlCharacter(char)) {\n            // unescaped control character\n            str += controlCharacters[char]\n            i++\n          } else {\n            if (!isValidStringCharacter(char)) {\n              throwInvalidCharacter(char)\n            }\n            str += char\n            i++\n          }\n        }\n\n        if (skipEscapeChars) {\n          // repair: skipped escape character (nothing to do)\n          skipEscapeCharacter()\n        }\n      }\n    }\n\n    return false\n  }\n\n  /**\n   * Repair concatenated strings like \"hello\" + \"world\", change this into \"helloworld\"\n   */\n  function parseConcatenatedString(): boolean {\n    // tslint:disable-next-line:no-shadowed-variable\n    let processed = false\n\n    parseWhitespaceAndKeepComments()\n    while (text[i] === '+') {\n      processed = true\n      i++\n      parseWhitespaceAndKeepComments()\n\n      // repair: remove the end quote of the first string\n      output = stripLastOccurrence(output, '\"', true)\n      const start = output.length\n      const parsedStr = parseString()\n      if (parsedStr) {\n        // repair: remove the start quote of the second string\n        output = removeAtIndex(output, start, 1)\n      } else {\n        // repair: remove the + because it is not followed by a string\n        output = insertBeforeLastWhitespace(output, '\"')\n      }\n    }\n\n    return processed\n  }\n\n  /**\n   * Parse a number like 2.4 or 2.4e6\n   */\n  function parseNumber(): boolean {\n    const start = i\n    if (text[i] === '-') {\n      i++\n      if (atEndOfNumber()) {\n        repairNumberEndingWithNumericSymbol(start)\n        return true\n      }\n      if (!isDigit(text[i])) {\n        i = start\n        return false\n      }\n    }\n\n    // Note that in JSON leading zeros like \"00789\" are not allowed.\n    // We will allow all leading zeros here though and at the end of parseNumber\n    // check against trailing zeros and repair that if needed.\n    // Leading zeros can have meaning, so we should not clear them.\n    while (isDigit(text[i])) {\n      i++\n    }\n\n    if (text[i] === '.') {\n      i++\n      if (atEndOfNumber()) {\n        repairNumberEndingWithNumericSymbol(start)\n        return true\n      }\n      if (!isDigit(text[i])) {\n        i = start\n        return false\n      }\n      while (isDigit(text[i])) {\n        i++\n      }\n    }\n\n    if (text[i] === 'e' || text[i] === 'E') {\n      i++\n      if (text[i] === '-' || text[i] === '+') {\n        i++\n      }\n      if (atEndOfNumber()) {\n        repairNumberEndingWithNumericSymbol(start)\n        return true\n      }\n      if (!isDigit(text[i])) {\n        i = start\n        return false\n      }\n      while (isDigit(text[i])) {\n        i++\n      }\n    }\n\n    // if we're not at the end of the number by this point, allow this to be parsed as another type\n    if (!atEndOfNumber()) {\n      i = start\n      return false\n    }\n\n    if (i > start) {\n      // repair a number with leading zeros like \"00789\"\n      const num = text.slice(start, i)\n      const hasInvalidLeadingZero = /^0\\d/.test(num)\n\n      output += hasInvalidLeadingZero ? `\"${num}\"` : num\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Parse keywords true, false, null\n   * Repair Python keywords True, False, None\n   */\n  function parseKeywords(): boolean {\n    return (\n      parseKeyword('true', 'true') ||\n      parseKeyword('false', 'false') ||\n      parseKeyword('null', 'null') ||\n      // repair Python keywords True, False, None\n      parseKeyword('True', 'true') ||\n      parseKeyword('False', 'false') ||\n      parseKeyword('None', 'null')\n    )\n  }\n\n  function parseKeyword(name: string, value: string): boolean {\n    if (text.slice(i, i + name.length) === name) {\n      output += value\n      i += name.length\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Repair an unquoted string by adding quotes around it\n   * Repair a MongoDB function call like NumberLong(\"2\")\n   * Repair a JSONP function call like callback({...});\n   */\n  function parseUnquotedString(isKey: boolean) {\n    // note that the symbol can end with whitespaces: we stop at the next delimiter\n    // also, note that we allow strings to contain a slash / in order to support repairing regular expressions\n    const start = i\n\n    if (isFunctionNameCharStart(text[i])) {\n      while (i < text.length && isFunctionNameChar(text[i])) {\n        i++\n      }\n\n      let j = i\n      while (isWhitespace(text, j)) {\n        j++\n      }\n\n      if (text[j] === '(') {\n        // repair a MongoDB function call like NumberLong(\"2\")\n        // repair a JSONP function call like callback({...});\n        i = j + 1\n\n        parseValue()\n\n        if (text[i] === ')') {\n          // repair: skip close bracket of function call\n          i++\n          if (text[i] === ';') {\n            // repair: skip semicolon after JSONP call\n            i++\n          }\n        }\n\n        return true\n      }\n    }\n\n    while (\n      i < text.length &&\n      !isUnquotedStringDelimiter(text[i]) &&\n      !isQuote(text[i]) &&\n      (!isKey || text[i] !== ':')\n    ) {\n      i++\n    }\n\n    // test start of an url like \"https://...\" (this would be parsed as a comment)\n    if (text[i - 1] === ':' && regexUrlStart.test(text.substring(start, i + 2))) {\n      while (i < text.length && regexUrlChar.test(text[i])) {\n        i++\n      }\n    }\n\n    if (i > start) {\n      // repair unquoted string\n      // also, repair undefined into null\n\n      // first, go back to prevent getting trailing whitespaces in the string\n      while (isWhitespace(text, i - 1) && i > 0) {\n        i--\n      }\n\n      const symbol = text.slice(start, i)\n      output += symbol === 'undefined' ? 'null' : JSON.stringify(symbol)\n\n      if (text[i] === '\"') {\n        // we had a missing start quote, but now we encountered the end quote, so we can skip that one\n        i++\n      }\n\n      return true\n    }\n  }\n\n  function parseRegex() {\n    if (text[i] === '/') {\n      const start = i\n      i++\n\n      while (i < text.length && (text[i] !== '/' || text[i - 1] === '\\\\')) {\n        i++\n      }\n      i++\n\n      output += `\"${text.substring(start, i)}\"`\n\n      return true\n    }\n  }\n\n  function prevNonWhitespaceIndex(start: number): number {\n    let prev = start\n\n    while (prev > 0 && isWhitespace(text, prev)) {\n      prev--\n    }\n\n    return prev\n  }\n\n  function atEndOfNumber() {\n    return i >= text.length || isDelimiter(text[i]) || isWhitespace(text, i)\n  }\n\n  function repairNumberEndingWithNumericSymbol(start: number) {\n    // repair numbers cut off at the end\n    // this will only be called when we end after a '.', '-', or 'e' and does not\n    // change the number more than it needs to make it valid JSON\n    output += `${text.slice(start, i)}0`\n  }\n\n  function throwInvalidCharacter(char: string) {\n    throw new JSONRepairError(`Invalid character ${JSON.stringify(char)}`, i)\n  }\n\n  function throwUnexpectedCharacter() {\n    throw new JSONRepairError(`Unexpected character ${JSON.stringify(text[i])}`, i)\n  }\n\n  function throwUnexpectedEnd() {\n    throw new JSONRepairError('Unexpected end of json string', text.length)\n  }\n\n  function throwObjectKeyExpected() {\n    throw new JSONRepairError('Object key expected', i)\n  }\n\n  function throwColonExpected() {\n    throw new JSONRepairError('Colon expected', i)\n  }\n\n  function throwInvalidUnicodeCharacter() {\n    const chars = text.slice(i, i + 6)\n    throw new JSONRepairError(`Invalid unicode character \"${chars}\"`, i)\n  }\n}\n\nfunction atEndOfBlockComment(text: string, i: number) {\n  return text[i] === '*' && text[i + 1] === '/'\n}\n","export const JexlFlavouredJSON = {\n  tokenPostfix: '.json',\n\n  // Jexl functions & transforms\n  keywords: [\n    // general functions\n    'count', 'merge', 'deepMerge', 'uuid', 'isRole', 'userAttr', 'pageData', 'mediaQuery',\n    // general transforms\n    'data', 'role', 'attr', 'typeof', 'default', 'call',\n    // string extension\n    'upperCase', 'upper', 'lowerCase', 'lower', 'split', 'trim', 'trimEnd', 'trimStart', 'pad', 'padStart', 'padEnd',\n    // type cast extension\n    'toInt', 'toFloat', 'toStr', 'toJSON', 'fromJSON', 'toArray',\n    // Math extension\n    'round', 'ceil', 'floor',\n    // Array extension\n    'push', 'contains', 'filter', 'map', 'join', 'first', 'last', 'orderBy', 'list',\n    // Obj extension\n    'get', 'set', 'unset', 'keys', 'values', 'pick', 'omit',\n    // Sequence extension\n    'nextval',\n    // Datetime Extension\n    'now', 'date', 'utc', 'isoDate', 'isoTime', 'isoDateTime', 'localDate', 'localTime', 'localDateTime',\n    'year', 'utcYear', 'month', 'utcMonth', 'day', 'utcDay', 'weekDay', 'utcWeekDay', 'hours', 'utcHours',\n    'minutes', 'utcMinutes', 'seconds', 'utcSeconds', 'milliseconds', 'utcMilliseconds', 'timezoneOffset',\n    'timestamp', 'addMilliseconds', 'subMilliseconds', 'addSeconds', 'subSeconds', 'addMinutes', 'subMinutes',\n    'addHours', 'subHours', 'addDays', 'subDays', 'addWeeks', 'subWeeks', 'twoDigit',\n  ],\n\n  jsonKeywords: [\n    'true', 'false', 'null'\n  ],\n\n  typeKeywords: [\n    'any', 'boolean', 'number', 'object', 'string', 'undefined',\n  ],\n\n  operators: [\n    '<=', '>=', '==', '!=', '=>', '+', '-', '**',\n    '*', '/', '%', '++', '--', '<<', '</', '>>', '>>>', '&',\n    '|', '^', '!', '~', '&&', '||', '?', ':', '=', '+=', '-=',\n    '*=', '**=', '/=', '%=', '<<=', '>>=', '>>>=', '&=', '|=',\n    '^=', '@',\n  ],\n\n  // we include these common regular expressions\n  symbols: /[=><!~?:&|+\\-*\\/\\^%]+/,\n  escapes: /\\\\(?:[abfnrtv\\\\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,\n  digits: /\\d+(_+\\d+)*/,\n  octaldigits: /[0-7]+(_+[0-7]+)*/,\n  binarydigits: /[0-1]+(_+[0-1]+)*/,\n  hexdigits: /[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,\n\n  regexpctl: /[(){}\\[\\]\\$\\^|\\-*+?\\.]/,\n  regexpesc: /\\\\(?:[bBdDfnrstvwWn0\\\\\\/]|@regexpctl|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})/,\n\n  tokenizer: {\n    root: [\n      [/\\{/, 'delimiter.bracket', '@json_obj'],\n      [/\\[/, 'delimiter.bracket', '@json_array'],\n      [/\"/, 'string', '@string_double'],\n      [/(@digits)[eE]([\\-+]?(@digits))?/, 'number.float'],\n      [/(@digits)\\.(@digits)([eE][\\-+]?(@digits))?/, 'number.float'],\n      [/0[xX](@hexdigits)/, 'number.hex'],\n      [/0[oO]?(@octaldigits)/, 'number.octal'],\n      [/0[bB](@binarydigits)/, 'number.binary'],\n      [/(@digits)/, 'number'],\n      [/true/, 'keyword'],\n      [/false/, 'keyword'],\n      [/null/, 'keyword'],\n      { include: '@whitespace' },\n    ],\n\n    json_obj: [\n      [/\"/, 'string', '@string_double'],\n      [/:/, 'delimiter', '@json_val'],\n      { include: '@whitespace' },\n      [/}/, 'delimiter.bracket', '@pop'],\n    ],\n\n    json_array: [\n      [/\\{/, 'delimiter.bracket', '@json_obj'],\n      [/\\[]/, 'delimiter.bracket', '@json_array'],\n      [/(@digits)[eE]([\\-+]?(@digits))?/, 'number.float'],\n      [/(@digits)\\.(@digits)([eE][\\-+]?(@digits))?/, 'number.float'],\n      [/0[xX](@hexdigits)/, 'number.hex'],\n      [/0[oO]?(@octaldigits)/, 'number.octal'],\n      [/0[bB](@binarydigits)/, 'number.binary'],\n      [/(@digits)/, 'number'],\n      [/[a-z_$][\\w$]*/, {\n        cases: {\n          '@jsonKeywords': 'keyword',\n          '@default': 'identifier'\n        }\n      }],\n      [/\"\\$>/, { token: \"source.js\", next: \"@jexl\" }],\n      [/\"/, 'keyword', '@json_val_string'],\n      { include: 'whitespace' },\n      [/]/, 'delimiter.bracket', '@pop'],\n    ],\n\n    json_val: [\n      [/\\{/, 'delimiter.bracket', '@json_obj'],\n      [/\\[/, 'delimiter.bracket', '@json_array'],\n      [/(@digits)[eE]([\\-+]?(@digits))?/, 'number.float'],\n      [/(@digits)\\.(@digits)([eE][\\-+]?(@digits))?/, 'number.float'],\n      [/0[xX](@hexdigits)/, 'number.hex'],\n      [/0[oO]?(@octaldigits)/, 'number.octal'],\n      [/0[bB](@binarydigits)/, 'number.binary'],\n      [/(@digits)/, 'number'],\n      [/[a-z_$][\\w$]*/, {\n        cases: {\n          '@jsonKeywords': 'keyword',\n          '@default': 'identifier'\n        }\n      }],\n      [/\"\\$>/, { token: \"source.js\", next: \"@jexl\" }],\n      [/\"/, 'keyword', '@json_val_string'],\n      { include: 'whitespace' },\n      [/,/, \"delimiter\", \"@pop\"],\n      [/\\n/, '', '@pop']\n    ],\n\n    json_val_string: [\n      [/[^\\\\\"]+/, 'keyword'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/\"/, 'keyword', '@pop']\n    ],\n\n    common: [\n      // identifiers and keywords\n      [/[a-z_$][\\w$]*/, {\n        cases: {\n          '@typeKeywords': 'keyword',\n          '@keywords': 'keyword',\n          '@jsonKeywords': 'keyword',\n          '@default': 'identifier'\n        }\n      }],\n      [/[A-Z][\\w\\$]*/, 'type.identifier'],  // to show class names nicely\n      // [/[A-Z][\\w\\$]*/, 'identifier'],\n\n      // whitespace\n      { include: '@whitespace' },\n\n      // regular expression: ensure it is terminated before beginning (otherwise it is an opeator)\n      /*[/\\/(?=([^\\\\\\/]|\\\\.)+\\/([gimsuy]*)(\\s*)(\\.|;|\\/|,|\\)|\\]|\\}|$))/, { token: 'regexp', bracket: '@open', next: '@regexp' }],*/\n\n      // delimiters and operators\n      [/[()\\[\\]]/, '@brackets'],\n      [/[<>](?!@symbols)/, '@brackets'],\n      [/@symbols/, {\n        cases: {\n          '@operators': 'delimiter',\n          '@default': ''\n        }\n      }],\n\n      // numbers\n      [/(@digits)[eE]([\\-+]?(@digits))?/, 'number.float'],\n      [/(@digits)\\.(@digits)([eE][\\-+]?(@digits))?/, 'number.float'],\n      [/0[xX](@hexdigits)/, 'number.hex'],\n      [/0[oO]?(@octaldigits)/, 'number.octal'],\n      [/0[bB](@binarydigits)/, 'number.binary'],\n      [/(@digits)/, 'number'],\n\n      // delimiter: after number because of .\\d floats\n      [/[;,.]/, 'delimiter'],\n\n      // strings\n      [/\"([^\"\\\\]|\\\\.)*$/, 'string.invalid'],  // non-teminated string\n      [/'([^'\\\\]|\\\\.)*$/, 'string.invalid'],  // non-teminated string\n      [/\"/, 'string', '@string_double'],\n      [/'/, 'string', '@string_single'],\n      [/`/, 'string', '@string_backtick'],\n    ],\n\n    whitespace: [\n      [/[ \\t\\r\\n]+/, ''],\n      [/\\/\\*\\*(?!\\/)/, 'comment.doc', '@jsdoc'],\n      [/\\/\\*/, 'comment', '@comment'],\n      [/\\/\\/.*$/, 'comment'],\n    ],\n\n    comment: [\n      [/[^\\/*]+/, 'comment'],\n      [/\\*\\//, 'comment', '@pop'],\n      [/[\\/*]/, 'comment']\n    ],\n\n    jexl: [\n      [/\\\\\".*\\\\\"/, 'string'],\n      [/\"/, \"jexl\", \"@pop\"],\n      { include: 'common' }\n    ],\n\n    jsdoc: [\n      [/[^\\/*]+/, 'comment.doc'],\n      [/\\*\\//, 'comment.doc', '@pop'],\n      [/[\\/*]/, 'comment.doc']\n    ],\n\n    // We match regular expression quite precisely\n    /*regexp: [\n      [/(\\{)(\\d+(?:,\\d*)?)(\\})/, ['regexp.escape.control', 'regexp.escape.control', 'regexp.escape.control']],\n      [/(\\[)(\\^?)(?=(?:[^\\]\\\\\\/]|\\\\.)+)/, ['regexp.escape.control', { token: 'regexp.escape.control', next: '@regexrange' }]],\n      [/(\\()(\\?:|\\?=|\\?!)/, ['regexp.escape.control', 'regexp.escape.control']],\n      [/[()]/, 'regexp.escape.control'],\n      [/@regexpctl/, 'regexp.escape.control'],\n      [/[^\\\\\\/]/, 'regexp'],\n      [/@regexpesc/, 'regexp.escape'],\n      [/\\\\\\./, 'regexp.invalid'],\n      [/(\\/)([gimsuy]*)/, [{ token: 'regexp', bracket: '@close', next: '@pop' }, 'keyword.other']],\n    ],\n\n    regexrange: [\n      [/-/, 'regexp.escape.control'],\n      [/\\^/, 'regexp.invalid'],\n      [/@regexpesc/, 'regexp.escape'],\n      [/[^\\]]/, 'regexp'],\n      [/\\]/, { token: 'regexp.escape.control', next: '@pop', bracket: '@close' }],\n    ],*/\n\n    string_double: [\n      [/[^\\\\\"]+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/\"/, 'string', '@pop']\n    ],\n\n    string_val_double: [\n      [/[^\\\\\"]+/, 'identifier'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/\"/, 'identifier', '@pop']\n    ],\n\n    string_single: [\n      [/[^\\\\']+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/'/, 'string', '@pop']\n    ],\n\n    string_backtick: [\n      [/\\$\\{/, { token: 'delimiter.bracket', next: '@bracketCounting' }],\n      [/[^\\\\`$]+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/`/, 'string', '@pop']\n    ],\n\n    bracketCounting: [\n      [/\\{/, 'delimiter.bracket', '@bracketCounting'],\n      [/\\}/, 'delimiter.bracket', '@pop'],\n      { include: 'common' }\n    ],\n  }\n};\n","import * as React from \"react\";\nimport {jsonrepair} from \"../../../InspectioBoards/service/jsonrepair/jsonrepair\";\nimport {JexlFlavouredJSON} from \"./JexlFlavouredJSON\";\n\nexport const monaco = (window as any).monaco;\n\nexport interface ModelData {\n    fileId: string;\n    language: 'json'|'xml'|'yaml';\n    value: string;\n    schema?: string|undefined;\n    onChange?: (e: { isFlush: boolean, isRedoing: boolean, isUndoing: boolean }) => void;\n}\n\ninterface OwnState {\n    internalData: Record<string, { onChangeDisposable: any }>;\n}\n\ninterface OwnProps {\n    options?: object;\n    style?: React.CSSProperties;\n    className?: string;\n    onFocus?: () => void;\n    onBlur?: () => void;\n    containerId?: string;\n    onOpenInformationReference?: (ref: string) => void;\n    repairJson?: boolean;\n    asDiffEditor?: boolean;\n}\n\ntype CodeEditorProps = OwnProps;\n\nconst globalSchemaRegistry: {[fileId: string]: {uri: string, fileMatch: string[], schema: any}} = {};\nconst globalRefSupport: {[fileId: string]: {supportRefLinks: boolean}} = {};\nlet globalLinkProviderRegistered = false;\n\n((globalMonaco: any) => {\n    globalMonaco.languages.setMonarchTokensProvider('json', JexlFlavouredJSON);\n})(monaco);\n\nlet isRefOpening = false;\n\n\nclass CodeEditor extends React.Component<CodeEditorProps, OwnState> {\n\n    private editor: any;\n    private containerId: string;\n    private asDiffEditor: boolean;\n\n    constructor(props: CodeEditorProps) {\n        super(props);\n\n        this.disposeOnChangeHandler = this.disposeOnChangeHandler.bind(this);\n\n        this.containerId = props.containerId || 'monaco-container';\n        this.asDiffEditor = !!props.asDiffEditor;\n\n        this.state = {\n            internalData: {}\n        };\n    }\n\n    public componentDidMount() {\n        this.editor = this.asDiffEditor\n          ? monaco.editor.createDiffEditor(document.getElementById(this.containerId), this.props.options || {})\n          : monaco.editor.create(document.getElementById(this.containerId), this.props.options || {});\n        const props = this.props;\n        // @TODO: OpenService works across editors, so this is a global change. Find a local variant!!!\n        if(props.onOpenInformationReference) {\n            this.editor.getContribution('editor.linkDetector').openerService.open = async (url: string) => {\n                if(url.includes('node://#')) {\n                    // This is needed to prevent wrong schemaChanged events due to onBlur firing when ref is loaded\n                    isRefOpening = true;\n                    if(props.onOpenInformationReference) {\n                        props.onOpenInformationReference(url.replace('node://#', '').replace('[]', ''))\n                    }\n\n                    window.setTimeout(() => {\n                        // This is needed to prevent wrong schemaChanged events due to onBlur firing when ref is loaded\n                        isRefOpening = false;\n                    }, 500);\n\n                    return true;\n                }\n\n                window.open(url, '_blank');\n\n                return true;\n            }\n        }\n\n\n        if(this.props.repairJson) {\n            this.addKeyDownHandler(e => {\n                if(this.editor && e.altKey && e.code === 'KeyF') {\n                    const rawValue = this.editor.getValue();\n                    try {\n                        const repaired = jsonrepair(rawValue, true);\n\n                        if(repaired !== rawValue) {\n                            const currentPosition = this.editor.getPosition();\n                            const currentLineLength = this.editor.getModel().getLineLength(currentPosition.lineNumber);\n                            const editor = this.editor;\n                            this.editor.setValue(repaired);\n                            const newLineLength = this.editor.getModel().getLineLength(currentPosition.lineNumber);\n                            const newPosition = {\n                                ...currentPosition,\n                                column: currentLineLength !== newLineLength ? newLineLength + 1 : currentPosition.column\n                            }\n                            this.editor.setPosition(newPosition);\n                            e.stopPropagation();\n                            e.preventDefault();\n                        }\n                    } catch (e) {\n                        // ignore error\n                        console.error(e);\n                    }\n                }\n            })\n        }\n\n    }\n\n    public componentWillUnmount() {\n        this.editor.dispose();\n        Object.keys(this.state.internalData).forEach(fileId => {\n            this.disposeOnChangeHandler(fileId, true);\n            this.disposeModel(fileId);\n        });\n        this.editor = undefined;\n    }\n\n    public render() {\n        return (\n            <div\n                id={this.containerId}\n                style={this.props.style}\n                className={this.props.className}\n                onFocus={() => {\n                    if(this.editor) {\n                        this.editor.updateOptions({scrollBeyondLastLine: true});\n                    }\n\n                    if(this.props.onFocus) {\n                        this.props.onFocus();\n                    }\n                }}\n                onBlur={() => {\n                    if(this.editor) {\n                        this.editor.updateOptions({scrollBeyondLastLine: false});\n                    }\n\n                    if(isRefOpening) {\n                        window.setTimeout(() => {\n                            isRefOpening = false;\n                        }, 500);\n                        return true;\n                    }\n\n                    if(this.props.onBlur) {\n                        this.props.onBlur();\n                    }\n                }}\n            />\n        );\n    }\n\n    public retrievePayload(): string {\n        const value = this.editor.getValue();\n\n        if(!this.props.repairJson) {\n            return value;\n        }\n\n        try {\n            const repaired = jsonrepair(value, true);\n            if(repaired !== value) {\n                this.editor.setValue(repaired);\n            }\n\n            return repaired;\n        } catch (e) {\n            console.log(e);\n            return value;\n        }\n\n    }\n\n    public initializeDiffModel(original: ModelData, modified: ModelData): void {\n        const originalModel = this.prepareModel(original);\n        const modifiedModel = this.prepareModel(modified);\n\n        this.editor.setModel({\n            original: originalModel,\n            modified: modifiedModel\n        })\n    }\n\n    public initializeModel(modelData: ModelData): void {\n        const model = this.prepareModel(modelData);\n        this.editor.setModel(model);\n    }\n\n    public addCommand(keybinding: number, handler: () => void): void {\n        this.editor.addCommand(keybinding, handler);\n    }\n\n    public addKeyDownHandler(handler: (e: KeyboardEvent) => void): {dispose: () => void} {\n        return this.editor.onKeyDown(handler);\n    }\n\n    public focus(): void {\n        this.editor.focus();\n    }\n\n    private prepareModel(modelData: ModelData): any {\n        const modelUri = monaco.Uri.parse(modelData.fileId);\n        let model = monaco.editor.getModel(modelUri);\n\n        this.disposeOnChangeHandler(modelData.fileId);\n\n        if(this.props.onOpenInformationReference) {\n            globalRefSupport['/'+modelData.fileId] = {supportRefLinks: true};\n        }\n\n        if (null === model) {\n            model = monaco.editor.createModel(modelData.value, modelData.language, modelUri);\n            model.updateOptions({ tabSize: 2 });\n        } else {\n            monaco.editor.setModelLanguage(model, modelData.language);\n\n            if (modelData.value !== model.getValue()) {\n                model.setValue(modelData.value);\n            }\n        }\n\n        if (modelData.onChange) {\n            this.initializeOnChangeHandler(modelData.fileId, model, modelData.onChange);\n        } else {\n            this.updateInternalData(modelData.fileId, { onChangeDisposable: undefined });\n        }\n\n        if (modelData.language === 'json' && modelData.schema) {\n            this.initializeJsonDiagnostics(modelData.fileId, modelUri, modelData.schema);\n        }\n\n        return model;\n    }\n\n    private disposeOnChangeHandler(fileId: string, willUnmount?: boolean) {\n        if (this.state.internalData[fileId] && this.state.internalData[fileId].onChangeDisposable) {\n            this.state.internalData[fileId].onChangeDisposable.dispose();\n            if(!willUnmount) {\n                this.updateInternalData(fileId, { onChangeDisposable: undefined });\n            }\n        }\n    }\n\n    private disposeModel(fileId: string) {\n        const modelUri = monaco.Uri.parse(fileId);\n        const model = monaco.editor.getModel(modelUri);\n        if(model) {\n            // Workaround for: https://github.com/microsoft/monaco-editor/issues/4702\n            // so that canceled error is not caught by react error boundary\n            window.setTimeout(() => {\n                model.dispose();\n            })\n        }\n    }\n\n    private initializeOnChangeHandler(fileId: string, model: any, onChange: (e: { isFlush: boolean, isRedoing: boolean, isUndoing: boolean }) => void): void {\n        // Make sure that any existing handler is disposed upon setting a new one\n        this.disposeOnChangeHandler(fileId);\n\n        const newDisposable = model.onDidChangeContent((e: { isFlush: boolean, isRedoing: boolean, isUndoing: boolean }) => {\n            onChange(e);\n        });\n\n        this.updateInternalData(fileId, { onChangeDisposable: newDisposable });\n    }\n\n    private initializeJsonDiagnostics(fileId: string, modelUri: any, schema: string): void {\n        globalSchemaRegistry[fileId] = {\n            uri: modelUri.toString(),\n            fileMatch: [modelUri.toString()],\n            schema: JSON.parse(schema)\n        };\n\n        monaco.languages.json.jsonDefaults.setModeConfiguration({\n            tokens: false,\n            completionItems: true,\n            diagnostics: true,\n            documentFormattingEdits: true,\n            documentRangeFormattingEdits: true,\n            documentSymbols: true,\n            foldingRanges: true,\n            hovers: true,\n            selectionRanges: true\n        });\n\n        monaco.languages.json.jsonDefaults.setDiagnosticsOptions({\n            validate: true,\n            enableSchemaRequest: false,\n            allowComments: true,\n            trailingCommas: 'ignore',\n            schemas: Object.values(globalSchemaRegistry),\n        });\n\n        if(!globalLinkProviderRegistered) {\n            const linkProvider: any = {\n                provideLinks:\n                  (model: any, token: any): any => {\n                    if(!globalRefSupport[model.uri.path]) {\n                        return;\n                    }\n\n                    const matches = model.findMatches('\"/[^\"]{1,}', true, true, false, null, true);\n\n                    console.log(\"link matches\", matches);\n\n                      return {\n                          links: matches.map((match: any) => {\n                              return {\n                                  range: {...match.range, startColumn: match.range.startColumn + 1},\n                                  url: \"node://#\"+match.matches[0].replace('\"', '')\n                              }\n                          })\n                      };\n                },\n                resolveLink:\n                  (link: any, token: any): any => {\n                      return {range: link.range}\n                  }\n            };\n\n            monaco.languages.registerLinkProvider('json', linkProvider);\n            globalLinkProviderRegistered = true;\n        }\n    }\n\n    private updateInternalData(fileId: string, data: { onChangeDisposable: any }): void {\n        this.setState({\n            internalData: {\n                ...this.state.internalData,\n                [fileId]: data\n            }\n        });\n    }\n}\n\nexport default CodeEditor;\n","import {\n    CodyCallback,\n    EmptyLayer,\n    Graph,\n    GraphPoint,\n    MoveVideoToPositionListener,\n    NextToPosition,\n    Node, NodeDescription, NodeLabel, NodeMetadata, NodeTag,\n    PanningListener, Size,\n    ZoomListener\n} from \"../model/Graph\";\nimport shortUUID from \"short-uuid\";\nimport {List} from \"immutable\";\nimport {CodyResponse} from \"../service/Cody\";\nimport {ActiveGraphElement} from \"../reducers/applyActiveGraphElementActions\";\n\ntype SelectionListener = (hasSelection: boolean) => void;\n\nclass GraphRef implements Graph {\n    private graphRef: Graph | undefined;\n    private selectionListeners: SelectionListener[] = [];\n\n    public setGraph(graph: Graph | undefined): void {\n        this.graphRef = graph;\n\n        if(graph) {\n            this.selectionListeners.forEach(listener => graph.onSelectionChanged(listener));\n        }\n\n        this.selectionListeners = [];\n    }\n\n    public createCellId(): string {\n        if(this.graphRef) {\n            return this.graphRef.createCellId();\n        }\n\n        return shortUUID().new();\n    }\n\n    public getCurrentScale(): number {\n        if(this.graphRef) {\n            return this.graphRef.getCurrentScale();\n        }\n\n        return 1.0;\n    }\n\n    public getCurrentTranslate(): GraphPoint {\n        if(this.graphRef) {\n            return this.graphRef.getCurrentTranslate();\n        }\n\n        return {x: 0, y: 0};\n    }\n\n    public onPanning(listener: PanningListener): void {\n        if(this.graphRef) {\n            this.graphRef.onPanning(listener);\n        }\n    }\n\n    public offPanning(listener: PanningListener): void {\n        if(this.graphRef) {\n            this.graphRef.offPanning(listener);\n        }\n    }\n\n    public translateMousePoint(x: number, y: number): GraphPoint {\n        if(this.graphRef) {\n            return this.graphRef.translateMousePoint(x, y);\n        }\n\n        return {x, y};\n    }\n\n    public onZoom(listener: ZoomListener): void {\n        if(this.graphRef) {\n            this.graphRef.onZoom(listener);\n        }\n    }\n\n    public offZoom(listener: ZoomListener): void {\n        if(this.graphRef) {\n            this.graphRef.offZoom(listener);\n        }\n    }\n\n    public getRoot(): Node {\n        return this.graphRef? this.graphRef.getRoot() : new EmptyLayer();\n    }\n\n    public openLayersDialog(): void {\n        if(this.graphRef) {\n            this.graphRef.openLayersDialog();\n        }\n    }\n\n    public triggerCody(): void {\n        if(this.graphRef) {\n            this.graphRef.triggerCody();\n        }\n    }\n\n    public selectNode(node: Node): boolean {\n        if(this.graphRef) {\n            return this.graphRef.selectNode(node);\n        }\n\n        return false;\n    }\n\n    public focusNode(node: Node, animateScroll?: boolean): void {\n        if(this.graphRef) {\n            return this.graphRef.focusNode(node, animateScroll);\n        }\n    }\n\n    public hasUserLevelVisibilityChanges(): boolean {\n        return this.graphRef? this.graphRef.hasUserLevelVisibilityChanges() : false;\n    }\n\n    public isVisible(node: Node): boolean {\n        return this.graphRef? this.graphRef.isVisible(node) : false;\n    }\n\n    public setUserVisible(node: Node, visible: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.setUserVisible(node, visible);\n        }\n    }\n\n    public applyVisibilityGlobally(): void {\n        if(this.graphRef) {\n            this.graphRef.applyVisibilityGlobally();\n        }\n    }\n\n    public isLocked(node: Node): boolean {\n        return this.graphRef? this.graphRef.isLocked(node) : false;\n    }\n\n    public setLocked(node: Node, locked: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.setLocked(node, locked);\n        }\n    }\n\n    public deleteNode(node: Node): void {\n        if(this.graphRef) {\n            this.graphRef.deleteNode(node);\n        }\n    }\n\n    public addLayer(name: string): void {\n        if(this.graphRef) {\n            this.graphRef.addLayer(name);\n        }\n    }\n\n    public deleteLayer(node: Node): void {\n        if(this.graphRef) {\n            this.graphRef.deleteLayer(node);\n        }\n    }\n\n    public isActiveLayer(node: Node): boolean {\n        return this.graphRef? this.graphRef.isActiveLayer(node) : false;\n    }\n\n    public setAsActiveLayer(node: Node): void {\n        if(this.graphRef) {\n            return this.graphRef.setAsActiveLayer(node);\n        }\n    }\n\n    public setDefaultLayerAsActive(): void {\n        if(this.graphRef) {\n            this.graphRef.setDefaultLayerAsActive();\n        }\n    }\n\n    public highlightLayer(node: Node): void {\n        if(this.graphRef) {\n            this.graphRef.highlightLayer(node);\n        }\n    }\n\n    public addNode(node: Node): void {\n        if(this.graphRef) {\n            this.graphRef.addNode(node);\n        }\n    }\n\n    public getNode(nodeId: string): Node | null {\n        if(this.graphRef) {\n            return this.graphRef.getNode(nodeId);\n        }\n        return null;\n    }\n\n    public addNodeNextToAnother(newNode: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.addNodeNextToAnother(newNode, existingNode, position, margin, center);\n        }\n    }\n\n    public moveNodeNextToAnother(node: Node, existingNode: Node, position: NextToPosition, margin: number | {x: number, y: number}, center?: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.moveNodeNextToAnother(node, existingNode, position, margin, center);\n        }\n    }\n\n    public changeNodeName(node: Node, newName: string): void {\n        if(this.graphRef) {\n            this.graphRef.changeNodeName(node, newName);\n        }\n    }\n\n    public changeNodeDescription(node: Node, description: NodeDescription): void {\n        if(this.graphRef) {\n            this.graphRef.changeNodeDescription(node, description);\n        }\n    }\n\n    public changeNodeLabel(node: Node, label: NodeLabel): void {\n        if(this.graphRef) {\n            this.graphRef.changeNodeLabel(node, label);\n        }\n    }\n\n    public changeNodeMetadata(node: Node, metadata: NodeMetadata): void {\n        if(this.graphRef) {\n            this.graphRef.changeNodeMetadata(node, metadata);\n        }\n    }\n\n    public changeNodeTags(node: Node, tags: List<NodeTag>): void {\n        if(this.graphRef) {\n            this.graphRef.changeNodeTags(node, tags);\n        }\n    }\n\n    public resizeNode(node: Node, size: Size): void {\n        if(this.graphRef) {\n            this.graphRef.resizeNode(node, size);\n        }\n    }\n\n    public moveNode(node: Node, toPosition: GraphPoint): void {\n        if(this.graphRef) {\n            this.graphRef.moveNode(node, toPosition);\n        }\n    }\n\n    public switchParent(node: Node, parent: Node | null, geo?: GraphPoint, expandIfNeeded?: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.switchParent(node, parent, geo, expandIfNeeded);\n        }\n    }\n\n    public connectNodes(source: Node, target: Node, connectionLabel?: string, edgePoints?: GraphPoint[], invertCurve?: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.connectNodes(source, target, connectionLabel, edgePoints, invertCurve);\n        }\n    }\n\n    public highlightNodes(nodes: Node[]): void {\n        if(this.graphRef) {\n            this.graphRef.highlightNodes(nodes);\n        }\n    }\n\n    public copySelectionToActiveLayer(): boolean {\n        if(this.graphRef) {\n            return this.graphRef.copySelectionToActiveLayer();\n        }\n\n        return false;\n    }\n\n    public changeFeatureStatus(feature: Node, status: \"important\" | \"planned\" | \"ready\" | \"deployed\"): void {\n        if(this.graphRef) {\n            this.graphRef.changeFeatureStatus(feature, status);\n        }\n    }\n\n    public getFeatureTaskLink(feature: Node): string | null {\n        if(this.graphRef) {\n            return this.graphRef.getFeatureTaskLink(feature);\n        }\n\n        return null;\n    }\n\n    public setFeatureTaskLink(feature: Node, link: string | null): void {\n        if(this.graphRef) {\n            this.graphRef.setFeatureTaskLink(feature, link);\n        }\n    }\n\n    public exportXmlSnapshot(): string {\n        if(this.graphRef) {\n            return this.graphRef.exportXmlSnapshot();\n        }\n\n        return '';\n    }\n\n    public onSelectionChanged(listener: (hasSelection: boolean) => void): void {\n        this.selectionListeners.push(listener);\n        if(this.graphRef) {\n            this.graphRef.onSelectionChanged(listener);\n        }\n    }\n\n    public setCockpitBaseUrl(baseUrl: string): void {\n        if(this.graphRef) {\n            this.graphRef.setCockpitBaseUrl(baseUrl);\n        }\n    }\n\n    public focus(): void {\n        if(this.graphRef) {\n            this.graphRef.focus();\n        }\n    }\n\n    public clearMoveVideoAvatarToPositionListener(): void {\n        if(this.graphRef) {\n            this.graphRef.clearMoveVideoAvatarToPositionListener();\n        }\n    }\n\n    public onMoveVideoAvatarToPosition(listener: MoveVideoToPositionListener): void {\n        if(this.graphRef) {\n            this.graphRef.onMoveVideoAvatarToPosition(listener);\n        }\n    }\n\n    public setVideoAvatarEnabled(enabled: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.setVideoAvatarEnabled(enabled);\n        }\n    }\n\n    public trackVideoAvatarPosition(x: number, y: number): void {\n        if(this.graphRef) {\n            this.graphRef.trackVideoAvatarPosition(x,y);\n        }\n    }\n\n    public setCodyDownCb(cb: CodyCallback | null): void {\n        if(this.graphRef) {\n            this.graphRef.setCodyDownCb(cb);\n        }\n    }\n\n    public setCodyLeftCb(cb: CodyCallback | null): void {\n        if(this.graphRef) {\n            this.graphRef.setCodyLeftCb(cb);\n        }\n    }\n\n    public setCodyRightCb(cb: CodyCallback | null): void {\n        if(this.graphRef) {\n            this.graphRef.setCodyRightCb(cb);\n        }\n    }\n\n    public setCodyUpCb(cb: CodyCallback | null): void {\n        if(this.graphRef) {\n            this.graphRef.setCodyUpCb(cb);\n        }\n    }\n\n    public openCodyWizard(runCody?: boolean): void {\n        if(this.graphRef) {\n            this.graphRef.openCodyWizard(runCody);\n        }\n    }\n\n    public mergeIntoSchema(source: Node, target: Node): void {\n        if(this.graphRef) {\n            this.graphRef.mergeIntoSchema(source, target);\n        }\n    }\n\n    public isEventModelingEnabled(): boolean {\n        if(this.graphRef) {\n            return this.graphRef.isEventModelingEnabled();\n        }\n\n        return true;\n    }\n\n    public makeDraggable(ele: HTMLElement, nodeToDrop: Node): void {\n        if(this.graphRef) {\n            return this.graphRef.makeDraggable(ele, nodeToDrop);\n        }\n    }\n\n    public makeActiveGraphElementIfPossible(node: Node): ActiveGraphElement | null {\n        if(this.graphRef) {\n            return this.graphRef.makeActiveGraphElementIfPossible(node);\n        }\n\n        return null;\n    }\n}\n\nlet currentGraph: GraphRef|undefined;\n\nexport function useGraph(): [Graph, (graph: Graph | undefined) => void] {\n    if(!currentGraph) {\n        currentGraph = new GraphRef();\n    }\n\n    return [currentGraph, (graph: Graph | undefined) => { currentGraph!.setGraph(graph) }];\n}\n","import React, {useEffect, useImperativeHandle, useRef} from \"react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {StickyTemplate} from \"../../../model/StickyTemplate\";\nimport jsonSchemaMetaSchema from \"./jsonSchemaMetaSchema.json\";\n\nexport interface BoardStickySchemaEditorRef {\n    retrievePayload: () => string;\n}\n\ninterface OwnProps {\n    boardStickyTemplate: StickyTemplate;\n}\n\ntype BoardStickySchemaEditorProps = OwnProps;\n\nconst BoardStickySchemaEditor = (props: BoardStickySchemaEditorProps, ref: React.Ref<BoardStickySchemaEditorRef>) => {\n    const codeEditorRef = useRef<CodeEditor|null>(null);\n\n    useEffect(() => {\n        if (!codeEditorRef.current) {\n            return;\n        }\n\n        codeEditorRef.current.initializeModel({\n            fileId: `board_${props.boardStickyTemplate.boardId}_sticky_${props.boardStickyTemplate.cellType}_schema.json`,\n            language: 'json',\n            value: props.boardStickyTemplate.templateSchema || '{\\n\\t\"type\": \"object\",\\n\\t\"properties\": {}\\n}',\n            schema: JSON.stringify(jsonSchemaMetaSchema)\n        });\n    }, [props.boardStickyTemplate.boardId, props.boardStickyTemplate.cellType, props.boardStickyTemplate.templateSchema]);\n\n    useImperativeHandle<BoardStickySchemaEditorRef, BoardStickySchemaEditorRef>(ref, () => ({\n        retrievePayload: (): string => codeEditorRef.current!.retrievePayload(),\n    }));\n\n    return (\n        <CodeEditor\n            ref={codeEditorRef}\n            style={{ height: '280px', width: '100%', marginTop: '10px' }}\n            options={{\n                fontSize: 12,\n                folding: false,\n                glyphMargin: false,\n                lineNumbers: 'off',\n                lineDecorationsWidth: 3,\n                minimap: {\n                    enabled: false\n                },\n                formatOnPaste: true,\n                scrollBeyondLastLine: false,\n            }}\n        />\n    );\n}\n\nexport default React.forwardRef(BoardStickySchemaEditor);\n","import * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Container, Select} from \"semantic-ui-react\";\nimport {convertJsonSchemaToEditorValue} from \"../../../../core/convertJsonSchemaToEditorValue\";\nimport * as Action from \"../../../actions\";\nimport {BoardId} from \"../../../model/Board\";\nimport {StickyTemplate, TemplateType} from \"../../../model/StickyTemplate\";\nimport BoardStickySchemaEditor from \"./BoardStickySchemaEditor\";\nimport {BoardStickyTemplateEditorRef} from \"./BoardStickyTemplateEditor\";\n\ninterface OwnProps {\n    boardId: BoardId;\n    boardStickyTemplate: StickyTemplate;\n    onClose: () => void;\n    onTemplateGenerated: (template: string) => void;\n}\n\ntype BoardStickyAdvancedConfigProps = OwnProps & WithNamespaces;\n\nconst BoardStickyAdvancedConfig = (props: BoardStickyAdvancedConfigProps) => {\n\n    const dispatch = useDispatch();\n    const [templateType, setTemplateType] = useState<TemplateType>(props.boardStickyTemplate.templateType);\n    const boardStickySchemaEditorRef = useRef<BoardStickyTemplateEditorRef|null>(null);\n\n    useEffect(\n        () => {\n            setTemplateType(props.boardStickyTemplate.templateType);\n        },\n        [props.boardStickyTemplate]\n    );\n\n    const handleUpdateStickyAdvancedConfig = async () => {\n        dispatch(Action.Command.updateStickyAdvancedConfig(\n            props.boardId,\n            props.boardStickyTemplate.cellType,\n            templateType,\n            templateType === 'json' && boardStickySchemaEditorRef.current\n                ? boardStickySchemaEditorRef.current!.retrievePayload()\n                : undefined\n        ));\n    };\n\n    const handleGenerateDefaultValue = (e: React.MouseEvent<HTMLAnchorElement>) => {\n        e.preventDefault();\n        try {\n            const rawSchema = templateType === 'json' && boardStickySchemaEditorRef.current\n                ? boardStickySchemaEditorRef.current!.retrievePayload()\n                : undefined;\n\n            if(!rawSchema) {\n                return;\n            }\n\n            const parsedSchema = JSON.parse(rawSchema);\n            const newTemplate = JSON.stringify(convertJsonSchemaToEditorValue(parsedSchema), null, 2);\n\n            props.onTemplateGenerated(newTemplate);\n\n            window.setTimeout(() => {\n                dispatch(Action.Command.updateStickyAdvancedConfig(\n                    props.boardId,\n                    props.boardStickyTemplate.cellType,\n                    templateType,\n                    rawSchema,\n                    true\n                ));\n            }, 1000)\n        } catch (e) {\n            // tslint:disable-next-line\n            console.error(e);\n            return;\n        }\n    }\n\n    return (<>\n        <Container style={{ height: '333px' }}>\n            <Select\n                options={[\n                    { key: 'json', value: 'json', text: 'JSON' },\n                    { key: 'xml', value: 'xml', text: 'XML' },\n                    { key: 'yaml', value: 'yaml', text: 'YAML' }\n                ]}\n                value={templateType}\n                onChange={(event, data) => setTemplateType(data.value as TemplateType)}\n            />\n            {templateType === 'json' && (\n                <BoardStickySchemaEditor\n                    ref={boardStickySchemaEditorRef}\n                    boardStickyTemplate={props.boardStickyTemplate}\n                />\n            )}\n        </Container>\n        {props.boardStickyTemplate.templateSchema && (\n            <a href={'#'} onClick={handleGenerateDefaultValue}>\n                {props.t('app.form.generateTemplate')}\n            </a>\n\n        )}\n        <Button primary={true} onClick={handleUpdateStickyAdvancedConfig} content={props.t('app.form.save')} floated=\"right\" />\n        <Button onClick={props.onClose} content={props.t('app.form.back')} floated=\"right\" />\n    </>);\n};\n\nexport default withNamespaces()(BoardStickyAdvancedConfig)\n","export const Palette: {stickyColors: { [type: string]: string }} = {\n    stickyColors: {\n        event: '#FF9F4B',\n        command: '#26C0E7',\n        role: '#f7f727',\n        projection: '#3acbc0',\n        aggregate: '#F5E339',\n        document: '#73dd8e',\n        policy: '#EABFF1',\n        hotSpot: '#f31d30',\n        externalSystem: '#ec98ac',\n        ui: '#000000',\n        feature: '#cfcfcf',\n        boundedContext: '#a2a2a2',\n        edge: '#414141',\n        textCard: '#ffdfd3'\n    }\n};\n","import * as React from 'react';\nimport {Icon, Label} from \"semantic-ui-react\";\nimport {IconSizeProp} from \"semantic-ui-react/dist/commonjs/elements/Icon/Icon\";\nimport {Palette} from \"../../theme/palette\";\nimport {HistoryCellType} from \"../model/HistoryEntry\";\n\ninterface OwnProps {\n    cellType: HistoryCellType;\n    size?: IconSizeProp | 'normal';\n    title?: string;\n    className?: string;\n}\n\ntype CellIconProps = OwnProps;\n\nconst CellIcon = (props: CellIconProps) => {\n    let size: IconSizeProp | undefined;\n\n    if(props.size !== 'normal') {\n        size = props.size || 'large';\n    }\n\n    switch (props.cellType) {\n        case HistoryCellType.event:\n        case HistoryCellType.command:\n        case HistoryCellType.role:\n        case HistoryCellType.projection:\n        case HistoryCellType.aggregate:\n        case HistoryCellType.document:\n        case HistoryCellType.policy:\n        case HistoryCellType.hotSpot:\n        case HistoryCellType.externalSystem:\n        case HistoryCellType.ui:\n            return <Icon name='sticky note' size={size} style={{color: Palette.stickyColors[props.cellType]}} title={props.title} className={props.className} />;\n        case HistoryCellType.icon:\n            return <Icon name='heart' size={size} title={props.title} className={props.className} />;\n        case HistoryCellType.image:\n            return <Icon name='image' size={size} title={props.title} className={props.className} />;\n        case HistoryCellType.feature:\n            return <Icon name=\"square\" size={size} style={{Color: Palette.stickyColors.feature}} title={props.title} className={props.className} >\n                <span style={{\n                    position: \"absolute\",\n                    marginTop: size? \"0.17em\" : \"0.03em\",\n                    marginLeft: \"-0.84em\",\n                    fontFamily: 'sans-serif',\n                    fontSize: '0.8em',\n                    color: 'white',\n                }}>F</span>\n            </Icon>;\n        case HistoryCellType.slice:\n            return <Icon name=\"square\" size={size} style={{Color: Palette.stickyColors.feature}} title={props.title} className={props.className} >\n                <span style={{\n                    position: \"absolute\",\n                    marginTop: size? \"0.17em\" : \"0.03em\",\n                    marginLeft: \"-0.86em\",\n                    fontFamily: 'sans-serif',\n                    fontSize: '0.8em',\n                    color: 'white',\n                }}>S</span>\n            </Icon>;\n        case HistoryCellType.swimlanes:\n            return <Icon name=\"square\" size={size} style={{Color: Palette.stickyColors.feature}} title={props.title} className={props.className} >\n                <span style={{\n                    position: \"absolute\",\n                    marginTop: size? \"0.17em\" : \"0.03em\",\n                    marginLeft: \"-0.86em\",\n                    fontFamily: 'sans-serif',\n                    fontSize: '0.8em',\n                    color: 'white',\n                }}>S</span>\n            </Icon>;\n        case HistoryCellType.boundedContext:\n            return <Icon name=\"square\" size={size} style={{Color: Palette.stickyColors.feature}} title={props.title} className={props.className}>\n                <span style={{\n                    position: \"absolute\",\n                    marginTop: size? \"0.17em\" : \"0.03em\",\n                    marginLeft: \"-0.89em\",\n                    fontFamily: 'sans-serif',\n                    fontSize: '0.8em',\n                    color: 'white',\n                }}>C</span>\n            </Icon>;\n        case HistoryCellType.multiple:\n            return <Icon name=\"sitemap\" size={size} style={{fontSize: '1.25em'}} title={props.title} className={props.className} />;\n        case HistoryCellType.edge:\n            return <Icon size={size} title={props.title} className={props.className}><img\n                style={{width: '1em', height: '1em'}}\n                src={`data:image/svg+xml;utf8,<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"${encodeURIComponent(Palette.stickyColors.edge)}\" d=\"M476 480H324a36 36 0 0 1-36-36V96h-96v156a36 36 0 0 1-36 36H16a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h112V68a36 36 0 0 1 36-36h152a36 36 0 0 1 36 36v348h96V260a36 36 0 0 1 36-36h140a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H512v156a36 36 0 0 1-36 36z\"></path></svg>`}/>\n            </Icon>;\n        case HistoryCellType.textCard:\n            return <Icon name=\"square\" size={size} style={{color: Palette.stickyColors.textCard}} title={props.title} className={props.className}>\n                <span style={{\n                    position: \"absolute\",\n                    marginTop: \"0.17em\",\n                    marginLeft: \"-0.84em\",\n                    fontFamily: 'sans-serif',\n                    color: '#494949',\n                    fontSize: '0.8em'\n                }}>\n                    T\n                </span>\n            </Icon>;\n        case HistoryCellType.freeText:\n            return <Icon name=\"align center\" size={size} title={props.title} className={props.className} />;\n        default:\n            return <Icon name='square' size={size} title={props.title} className={props.className} />;\n    }\n};\n\nexport default CellIcon;\n","import {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {Map} from \"immutable\";\nimport {NodeType} from \"../../../model/Graph\";\nimport {StickyTemplate} from \"../../../model/StickyTemplate\";\nimport {List} from \"semantic-ui-react\";\nimport CellIcon from \"../../CellIcon\";\nimport {HistoryCellType} from \"../../../model/HistoryEntry\";\nimport * as React from \"react\";\n\ninterface OwnProps {\n    boardStickyTemplates: Map<NodeType, StickyTemplate>;\n    activeCellType: NodeType|undefined;\n    onSetActiveCellType: (nodeType: NodeType) => void;\n}\n\ntype BoardStickySelectionProps = OwnProps & WithNamespaces;\n\nconst isFrame = (cellType: NodeType): boolean => {\n    return cellType === NodeType.boundedContext || cellType === NodeType.feature;\n}\n\nconst isSpecialShape = (cellType: NodeType): boolean => {\n    return cellType === NodeType.freeText || cellType === NodeType.image || cellType === NodeType.icon;\n}\n\nconst isCard = (cellType: NodeType): boolean => {\n    return !isFrame(cellType) && !isSpecialShape(cellType);\n}\n\nconst BoardStickySelection = (props: BoardStickySelectionProps) => {\n    let isFirst = true;\n\n    const stickies = props.boardStickyTemplates\n        .sort((a, b) => {\n            if(isCard(a.cellType) === isCard(b.cellType)) {\n                if(a.cellType < b.cellType) {\n                    return -1;\n                }\n\n                if(a.cellType > b.cellType) {\n                    return 1;\n                }\n\n                return 0;\n            }\n\n            if(isCard(a.cellType)) {\n                return -1;\n            }\n\n            if(isCard(b.cellType)) {\n                return 1;\n            }\n\n            if(isFrame(a.cellType)) {\n                return -1;\n            }\n\n            if(isFrame(b.cellType)) {\n                return 1;\n            }\n\n            if(a.cellType === NodeType.freeText) {\n                return -1;\n            }\n\n            if(b.cellType === NodeType.freeText) {\n                return 1;\n            }\n\n            return 0;\n        })\n        .map((stickyTemplate) => {\n            const active = props.activeCellType ? props.activeCellType === stickyTemplate.cellType : isFirst;\n\n            if(!props.activeCellType && isFirst) {\n                props.onSetActiveCellType(stickyTemplate.cellType);\n            }\n\n            isFirst = false;\n            return (\n                <List.Item\n                    key={stickyTemplate.cellType}\n                    as='a' active={active}\n                    onClick={() => {props.onSetActiveCellType(stickyTemplate.cellType)}}\n                >\n                    <CellIcon cellType={stickyTemplate.cellType as HistoryCellType} size=\"large\" />\n                    <List.Content>{props.t('app.stickyTypes.' + stickyTemplate.cellType)}</List.Content>\n                </List.Item>\n            );\n        })\n        .toIndexedSeq()\n        .toArray();\n\n    return (\n        <List link={true}>\n            {stickies}\n        </List>\n    );\n};\n\nexport default withNamespaces()(BoardStickySelection);\n","import * as React from \"react\";\nimport {StickyTemplate} from \"../../../model/StickyTemplate\";\nimport CodeEditor, {monaco} from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {Ref, useEffect, useImperativeHandle, useRef} from \"react\";\n\nexport interface BoardStickyTemplateEditorRef {\n    retrievePayload: () => string;\n    updateModelValue: (value: string) => void;\n}\n\ninterface OwnProps {\n    boardStickyTemplate: StickyTemplate;\n    onSave: () => void;\n}\n\ntype BoardStickyTemplateEditorProps = OwnProps;\n\nconst BoardStickyTemplateEditor = (props: BoardStickyTemplateEditorProps, ref: Ref<BoardStickyTemplateEditorRef>) => {\n    const codeEditorRef = useRef<CodeEditor|null>(null);\n\n    const initializeModelWithValue = (value: string) => {\n        codeEditorRef.current!.initializeModel({\n            fileId: `board_${props.boardStickyTemplate.boardId}_sticky_${props.boardStickyTemplate.cellType}.json`,\n            language: props.boardStickyTemplate.templateType,\n            value,\n            schema: props.boardStickyTemplate.templateSchema || undefined\n        });\n    }\n\n    useEffect(\n        () => {\n            initializeModelWithValue(props.boardStickyTemplate.template);\n\n            codeEditorRef.current!.addCommand(\n                /* tslint:disable-next-line:no-bitwise */\n                monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_S,\n                props.onSave\n            );\n        },\n        [\n            props.boardStickyTemplate.boardId,\n            props.boardStickyTemplate.cellType,\n            props.boardStickyTemplate.templateType,\n            props.boardStickyTemplate.template,\n            props.boardStickyTemplate.templateSchema\n        ]\n    );\n\n    useImperativeHandle<BoardStickyTemplateEditorRef, BoardStickyTemplateEditorRef>(ref, () => ({\n        retrievePayload: (): string => codeEditorRef.current!.retrievePayload(),\n        updateModelValue: (value: string): void => initializeModelWithValue(value)\n    }));\n\n    return (\n        <CodeEditor\n            ref={codeEditorRef}\n            style={{ height: '300px', width: '100%' }}\n            options={{\n                fontSize: 12,\n                folding: false,\n                glyphMargin: false,\n                lineNumbers: 'off',\n                lineDecorationsWidth: 3,\n                minimap: {\n                    enabled: false\n                },\n                formatOnPaste: true,\n                scrollBeyondLastLine: false,\n            }}\n        />\n    );\n};\n\nexport default React.forwardRef(BoardStickyTemplateEditor);\n","import {List} from \"immutable\";\nimport {ChangeEvent, useEffect, useRef, useState} from \"react\";\nimport * as React from 'react';\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Dimmer, Dropdown, Grid, Loader} from \"semantic-ui-react\";\nimport HeaderSubHeader from \"semantic-ui-react/dist/commonjs/elements/Header/HeaderSubheader\";\nimport {readFile} from \"../../../core/readFile\";\nimport * as NOTIFY from \"../../../NotificationSystem/actions\";\nimport * as Action from \"../../actions\";\nimport {BoardId} from \"../../model/Board\";\nimport {NodeType} from \"../../model/Graph\";\nimport {createStickyTemplateFromDefault, TemplateSchema} from \"../../model/StickyTemplate\";\nimport {makeBoardByIdSelector, makeGetBoard} from \"../../selectors/board\";\nimport {makeBoardStickyTemplateMapSelector} from \"../../selectors/StickyTemplate\";\nimport BoardStickyAdvancedConfig from \"./BoardStickyConfiguration/BoardStickyAdvancedConfig\";\nimport BoardStickySelection from \"./BoardStickyConfiguration/BoardStickySelection\";\nimport BoardStickyTemplateEditor, {BoardStickyTemplateEditorRef} from \"./BoardStickyConfiguration/BoardStickyTemplateEditor\";\n\ninterface OwnProps {\n    boardId: BoardId;\n}\n\ntype BoardStickyTemplatesProps = OwnProps & WithNamespaces;\n\nconst BoardStickyTemplates = (props: BoardStickyTemplatesProps) => {\n    const dispatch = useDispatch();\n    const [activeCellType, setActiveCellType] = useState<NodeType|undefined>();\n    const [advancedConfigActive, setAdvancedConfigActive] = useState<boolean>(false);\n    const boardStickyTemplates = useSelector(makeBoardStickyTemplateMapSelector(props.boardId));\n    const board = useSelector(makeBoardByIdSelector(props.boardId));\n    const stickyTemplateEditorRef = useRef<BoardStickyTemplateEditorRef|null>(null);\n    const uploadEl = useRef<HTMLInputElement>(null);\n    const [isImporting, setIsImporting] = useState(false);\n\n    useEffect(() => {\n        dispatch(Action.Query.fetchBoardStickyTemplates(props.boardId))\n    }, []);\n\n    const handleUpdateTemplate = () => {\n        if (!activeCellType) {\n            return;\n        }\n\n        if (stickyTemplateEditorRef && stickyTemplateEditorRef.current) {\n            const editorValue = stickyTemplateEditorRef.current.retrievePayload();\n\n            if (boardStickyTemplates.get(activeCellType)!.templateType === 'json') {\n                try {\n                    JSON.parse(editorValue);\n                } catch {\n                    dispatch(NOTIFY.Command.error(\n                        props.t('insp.sidebar.element_details.json_invalid_title'),\n                        props.t('insp.sidebar.element_details.json_invalid_text')\n                    ));\n                    return;\n                }\n            }\n\n            dispatch(Action.Command.setStickyTemplate(props.boardId, activeCellType, editorValue));\n        }\n    };\n\n    const handleSwitchToAdvancedConfig = (e: React.MouseEvent<HTMLAnchorElement>) => {\n        e.preventDefault();\n        setAdvancedConfigActive(true);\n    }\n\n    const handleTemplateGenerated = (newTemplate: string) => {\n        if (!activeCellType) {\n            return;\n        }\n\n        setAdvancedConfigActive(false);\n        dispatch(Action.Command.setStickyTemplate(props.boardId, activeCellType, newTemplate));\n\n        window.setTimeout(() => {\n            if(stickyTemplateEditorRef.current) {\n                stickyTemplateEditorRef.current.updateModelValue(newTemplate);\n            }\n        }, 10)\n    }\n\n    const downloadTemplates = () => {\n        const templatesStr = JSON.stringify(boardStickyTemplates.map(tpl => ({\n            templateType: tpl.templateType,\n            template: tpl.template,\n            templateSchema: tpl.templateSchema\n        })), null, 2);\n\n        const jsonBlob = new Blob([templatesStr], {type: \"application/json\"});\n        const url = URL.createObjectURL(jsonBlob);\n\n        const a = document.createElement('a');\n        a.download = board.name + ' ' + 'Card Templates.json';\n        a.href = url;\n        document.body.append(a);\n        a.click();\n\n        window.setTimeout(() => {\n            a.remove();\n            URL.revokeObjectURL(url);\n        }, 150);\n    }\n\n    const uploadTemplates = () => {\n        if(uploadEl.current) {\n            uploadEl.current.click();\n        }\n    }\n\n    const handleFileSelected = (e: ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files![0] || null;\n\n        readFile(file).then(templatesStr => {\n            let templates: {[cellType: string]: {templateType: string, template: string, templateSchema?: string}};\n            try {\n                templates = JSON.parse(templatesStr);\n            } catch {\n                dispatch(NOTIFY.Command.error(\n                    props.t('insp.sidebar.element_details.json_invalid_title'),\n                    props.t('insp.sidebar.element_details.json_invalid_text')\n                ));\n                return;\n            }\n\n            if(typeof templates !== 'object') {\n                dispatch(NOTIFY.Command.error(\n                    'Invalid Card Templates File',\n                    props.t('Selected file does not contain a JSON object of card templates')\n                ));\n                return;\n            }\n\n            const cellTypes = Object.keys(boardStickyTemplates.toJSON());\n            const tplCellTypes = Object.keys(templates);\n            const importableStickyTemplates = [];\n\n            for (const tplCellType of tplCellTypes) {\n                if(!cellTypes.includes(tplCellType)) {\n                    dispatch(NOTIFY.Command.error(\n                        'Invalid Card Templates File',\n                        props.t('File contains unknown cell type: ' + tplCellType)\n                    ));\n                    return;\n                }\n\n                let stickyTemplate = createStickyTemplateFromDefault(props.boardId, tplCellType as NodeType, templates[tplCellType].template || '');\n                stickyTemplate = stickyTemplate.setTemplateType(templates[tplCellType].templateType || 'json' as any);\n                if(templates[tplCellType].templateSchema) {\n                    stickyTemplate = stickyTemplate.setTemplateSchema(templates[tplCellType].templateSchema as TemplateSchema);\n                }\n\n                importableStickyTemplates.push(stickyTemplate);\n            }\n\n            setIsImporting(true);\n            dispatch(Action.Command.importStickyTemplates(props.boardId, List(importableStickyTemplates), () => {\n                setIsImporting(false);\n            }));\n        })\n\n\n    }\n\n    return (\n        <div className=\"ui segments\">\n            <div className=\"ui segment\">\n                <Dropdown item={true} icon=\"ellipsis vertical\" style={{float: \"right\", marginTop: '30px', fontSize: '1.2rem'}}>\n                    <Dropdown.Menu direction=\"left\" >\n                        <Dropdown.Item icon=\"download\" text=\"Import Templates\" onClick={uploadTemplates} />\n                        <Dropdown.Item icon=\"upload\" text=\"Export Templates\" onClick={downloadTemplates} />\n                    </Dropdown.Menu>\n                </Dropdown>\n                <h2 className=\"ui header\">\n                    {props.t('insp.board.sticky_templates.headline')}\n                    <HeaderSubHeader>{props.t('insp.board.sticky_templates.description')}</HeaderSubHeader>\n                </h2>\n                <p>&nbsp;</p>\n                <Grid columns={2}>\n                    <Grid.Column mobile=\"6\" tablet=\"6\" computer=\"5\" largeScreen=\"5\" widescreen=\"5\">\n                        <BoardStickySelection\n                            boardStickyTemplates={boardStickyTemplates}\n                            activeCellType={activeCellType}\n                            onSetActiveCellType={setActiveCellType}\n                        />\n                    </Grid.Column>\n                    {activeCellType && (\n                        <Grid.Column mobile=\"10\" tablet=\"10\" computer=\"11\" largeScreen=\"11\" widescreen=\"11\" style={{borderLeft: \"1px solid #d8dee2\"}}>\n                            {!advancedConfigActive && (<>\n                                <BoardStickyTemplateEditor\n                                    ref={stickyTemplateEditorRef}\n                                    boardStickyTemplate={boardStickyTemplates.get(activeCellType)!}\n                                    onSave={handleUpdateTemplate}\n                                />\n                                <p>&nbsp;</p>\n                                <a href={'#'} onClick={handleSwitchToAdvancedConfig}>\n                                    {props.t('insp.board.sticky_templates.advanced_config')}\n                                </a>\n                                <Button\n                                    primary={true}\n                                    onClick={handleUpdateTemplate}\n                                    content={props.t('app.form.save')}\n                                    floated=\"right\"\n                                />\n                            </>)}\n                            {advancedConfigActive && (\n                                <BoardStickyAdvancedConfig\n                                    boardId={props.boardId}\n                                    boardStickyTemplate={boardStickyTemplates.get(activeCellType)!}\n                                    onClose={() => setAdvancedConfigActive(false)}\n                                    onTemplateGenerated={handleTemplateGenerated}\n                                />\n                            )}\n                            <Dimmer inverted={true} active={isImporting}>\n                                <Loader inverted={true}>Importing</Loader>\n                            </Dimmer>\n                        </Grid.Column>\n                    )}\n                </Grid>\n                <input type=\"file\" ref={uploadEl} style={{display: 'none'}} onChange={handleFileSelected} />\n            </div>\n        </div>\n    );\n};\n\nexport default withNamespaces()(BoardStickyTemplates);\n","import * as React from 'react';\nimport {SyntheticEvent, useEffect, useRef, useState} from \"react\";\nimport {Input, Message} from \"semantic-ui-react\";\n\ninterface OwnProps {\n    text: string;\n    textSuggestion?: string;\n    charSize: number;\n    widthUnit: string;\n    onTextChanged: (text: string) => void;\n    placeholder?: string;\n    padding?: number;\n    minWidth?: number;\n    fixedWidth?: boolean;\n    required?: boolean;\n    maxLength?: number;\n    border?: string;\n    focus?: boolean;\n    onCancel?: () => void;\n    disabled?: boolean;\n    textStyle?: React.CSSProperties;\n    validate?: (text: string) => boolean | string;\n}\n\ntype EditableTextlineProps = OwnProps;\n\nconst EditableTextline = (props: EditableTextlineProps) => {\n    const [enterText, setEnterText] = useState(props.focus || false);\n    const [hasError, setHasError] = useState(false);\n    const [errMsg, setErrMsg] = useState('');\n    const [value, setValue] = useState(props.text || props.textSuggestion || '');\n    const inputEl = useRef<Input>(null);\n\n    useEffect(() => {\n        setValue(props.text || props.textSuggestion || '');\n\n        if(!props.text && props.textSuggestion && props.validate) {\n            handleChange(props.textSuggestion);\n        }\n\n    }, [props.text, props.textSuggestion]);\n\n    const handleTextClick = () => {\n        setEnterText(true);\n        window.setTimeout(() => {\n            if(inputEl && inputEl.current) {\n                inputEl.current.focus();\n            }\n        }, 200);\n    };\n\n    const handleChange = (newVal: string) => {\n        if(newVal !== '' && hasError) {\n            setHasError(false);\n        }\n\n        if(newVal === '' && props.required && !hasError) {\n            setHasError(true);\n        }\n\n        if(props.maxLength && newVal.length > props.maxLength) {\n            setHasError(true);\n        }\n\n        if(props.validate) {\n            const result = props.validate(newVal);\n\n            if(result === false) {\n                setHasError(true);\n            } else if (result === true) {\n                setHasError(false);\n                setErrMsg('');\n            } else {\n                setHasError(true);\n                setErrMsg(result);\n            }\n        }\n\n        setValue(newVal);\n    }\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n        if(e.key === 'Enter') {\n            handleBlur();\n        } else if (e.key === 'Escape') {\n            setValue(props.text);\n            setHasError(false);\n            setEnterText(false);\n            if(props.onCancel) {\n                props.onCancel();\n            }\n        }\n    }\n\n    const handleBlur = () => {\n        if(props.required && value === '') {\n            setHasError(true);\n            refocus();\n        } else {\n            if(value !== props.text && !hasError) {\n                props.onTextChanged(value);\n            }\n\n            if(!hasError) {\n                setEnterText(false);\n            } else {\n                refocus();\n            }\n        }\n    }\n\n    const refocus = () => {\n        window.setTimeout(() => {\n            if(inputEl && inputEl.current) {\n                inputEl.current.focus();\n            }\n        }, 200);\n    }\n\n    const valueLength = value !== '' ? value.length : (props.placeholder? props.placeholder.length : 0);\n    const padding = props.padding || 0;\n    let width = (props.charSize * valueLength + padding);\n    if(props.minWidth && (props.fixedWidth || width < props.minWidth)) {\n        width = props.minWidth;\n    }\n\n    let border = props.border || '2px solid #4593CE';\n\n    if(hasError) {\n        border = '4px solid #E0B4B4';\n    }\n\n    const text = props.text === ''? props.placeholder || '' : props.text;\n\n    const showInput = enterText && !props.disabled;\n\n    return <>\n        {showInput && <Input\n                            transparent={true}\n                            error={hasError}\n                            value={value}\n                            ref={inputEl}\n                            onBlur={handleBlur}\n                            onChange={(e, data) => handleChange(data.value)}\n                            onKeyDown={handleKeyDown}\n                            placeholder={props.placeholder}\n                            autoFocus={props.focus}\n                            style={{width: width + props.widthUnit, borderBottom: border}}/>}\n        {showInput && hasError && errMsg && <Message error={true} content={errMsg} style={{display: 'block'}} />}\n        {!showInput && <span onClick={handleTextClick} style={props.textStyle}>{ text }</span>}\n        </>;\n};\n\nexport default EditableTextline;\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Grid, GridColumn, Message, Select} from \"semantic-ui-react\";\nimport {OrganizationId} from \"../../../Organization/model/Organization\";\nimport {UserOrganizationInfo} from \"../../../Organization/model/UserOrganizationInfo\";\nimport * as Action from \"../../actions\";\nimport {BoardId} from \"../../model/Board\";\n\ninterface OwnProps {\n    boardId: BoardId;\n    organizations: List<UserOrganizationInfo>\n}\n\ntype MoveBoardMenuProps = OwnProps & WithNamespaces;\n\nconst MoveBoardMenu = (props: MoveBoardMenuProps) => {\n    const dispatch = useDispatch();\n    const [selectedOrganization, setSelectedOrganization] = useState<OrganizationId|undefined>();\n\n    const options = props.organizations.map(orga => ({\n        key: orga.uid,\n        value: orga.uid,\n        text: orga.organizationName\n    }));\n\n    const handleMoveBoard = () => {\n        if(selectedOrganization) {\n            dispatch(Action.Command.moveUserBoardToOrganization(selectedOrganization, props.boardId))\n            setSelectedOrganization(undefined);\n        }\n    }\n\n    return <>\n        <Select options={options.toJS()}\n                placeholder={props.t('insp.board.move_to_organization_select') as string}\n                onChange={(e, data) => setSelectedOrganization(data.value as OrganizationId)}\n        />\n        <Button primary={true} floated=\"right\" onClick={() => handleMoveBoard()}>{props.t('insp.board.move_to_organization_submit')}</Button>\n        <Message size=\"small\" info={true}>{props.t('insp.board.move_to_organization_desc')}</Message>\n    </>;\n};\n\nexport default withNamespaces()(MoveBoardMenu);\n","import {List} from \"immutable\";\nimport React from 'react'\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport EditableTextline from \"../../core/components/EditableTextline\";\nimport * as Action from \"../actions\";\nimport {Board, BoardName} from \"../model/Board\";\n\nconst INPUT_CHAR_SIZE = 9;\nconst CHAR_SIZE_UNIT = 'px';\nconst ADDITIONAL_CHAR_PADDING = 20;\n\nexport interface OwnProps {\n    board: Board;\n}\n\n\nexport type EditBoardFormProps = OwnProps & WithNamespaces;\n\n\n\nconst EditBoardForm = (props: EditBoardFormProps) => {\n    const dispatch = useDispatch();\n\n    const handleNameChanged = (newName: BoardName) => {\n        const changedBoard = props.board.merge({name: newName});\n        dispatch(Action.Command.renameBoard(changedBoard));\n    }\n\n    const handleAbbreviationChanged = (newAbbr: string) => {\n        const changedBoard = props.board.merge({nameAbbreviation: newAbbr});\n        dispatch(Action.Command.changeBoardAbbreviation(changedBoard));\n    }\n\n    return <form className=\"ui form\">\n        <h3 style={{margin: 0, cursor: \"pointer\"}}>\n            <EditableTextline\n                text={props.board.name}\n                charSize={INPUT_CHAR_SIZE}\n                widthUnit={CHAR_SIZE_UNIT}\n                padding={ADDITIONAL_CHAR_PADDING}\n                required={true}\n                onTextChanged={handleNameChanged}\n                placeholder={props.t('insp.board.form.board_name') as string}\n            />\n            &nbsp;/&nbsp;\n            <EditableTextline\n                text={props.board.nameAbbreviation}\n                charSize={INPUT_CHAR_SIZE}\n                widthUnit={CHAR_SIZE_UNIT}\n                padding={ADDITIONAL_CHAR_PADDING}\n                required={true}\n                maxLength={3}\n                onTextChanged={handleAbbreviationChanged}\n                placeholder={props.t('insp.board.form.board_name') as string}\n            />\n        </h3>\n    </form>\n};\n\nexport default withNamespaces()(EditBoardForm);\n\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useRef} from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Dropdown, DropdownItemProps} from \"semantic-ui-react\";\nimport * as Action from \"../../actions\";\nimport {Board} from \"../../model/Board\";\nimport {makeGetTags} from \"../../selectors/tags\";\n\ninterface OwnProps {\n    board: Board;\n}\n\ntype BoardTagsProps = OwnProps;\n\nconst BoardTags = (props: BoardTagsProps) => {\n    const dispatch = useDispatch();\n    const existingTags = useSelector(makeGetTags());\n    const availableTags = useRef<DropdownItemProps[]>(existingTags.map(tag => ({key: tag,text: '#'+tag,value: tag})).toJS());\n\n    const addTagOption = (tag: string) => {\n        if(tag.length === 0) {\n            return;\n        }\n\n        if(tag.charAt(0) !== '#') {\n            tag = '#'+tag;\n        }\n\n        const tagVal = tag.slice(1);\n\n        availableTags.current.push({\n            key: tagVal,\n            text: tag,\n            value: tagVal\n        })\n    }\n\n    const setTags = (newTags: string[]) => {\n        const changedBoard = props.board.merge({tags: List(newTags)});\n        dispatch(Action.Command.setBoardTags(changedBoard));\n    }\n\n    const tags = props.board.tags.toJS();\n\n    const currentTagList = availableTags.current.map(tag => tag.value);\n\n    tags.forEach(tag => {\n        if(!currentTagList.includes(tag.value)) {\n            availableTags.current.push({key: tag, text: '#'+tag, value: tag})\n        }\n    });\n\n    return <div className=\"field\">\n        <Dropdown\n            multiple={true}\n            allowAdditions={true}\n            name=\"tags\"\n            placeholder=\"Tags\"\n            search={true}\n            selection={true}\n            options={availableTags.current}\n            value={tags}\n            onAddItem={(evt, data) => addTagOption(data.value as string)}\n            onChange={(evt, data) => setTags(data.value as string[])}\n        />\n    </div>\n};\n\nexport default BoardTags;\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Checkbox} from \"semantic-ui-react\";\nimport {useEffect, useState} from \"react\";\nimport {Board} from \"../../model/Board\";\nimport {useDispatch} from \"react-redux\";\nimport {toggleCodySuggestEnabled} from \"../../actions/commands\";\n\ninterface OwnProps {\n  board: Board;\n}\n\ntype CodySuggestEnabledProps = OwnProps & WithNamespaces;\n\nconst CodySuggestEnabled = (props: CodySuggestEnabledProps) => {\n  const [codySuggestEnabled, setCodySuggestEnabled] = useState(true);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    setCodySuggestEnabled(props.board.codySuggestEnabled);\n  }, [props.board.uid]);\n\n  const handleToggle = (enabled: boolean) => {\n    setCodySuggestEnabled(enabled);\n    dispatch(toggleCodySuggestEnabled(props.board.merge({codySuggestEnabled: enabled})))\n  }\n\n\n  return <Checkbox toggle={true} checked={codySuggestEnabled} value={codySuggestEnabled? '1' : ''} onChange={(e, data) => handleToggle(data.value !== '1')} />\n};\n\nexport default withNamespaces()(CodySuggestEnabled);\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Checkbox} from \"semantic-ui-react\";\nimport {toggleEventModelingEnabled} from \"../../actions/commands\";\nimport {Board} from \"../../model/Board\";\n\ninterface OwnProps {\n  board: Board;\n}\n\ntype EventModelingEnabledProps = OwnProps & WithNamespaces;\n\nconst EventModelingEnabled = (props: EventModelingEnabledProps) => {\n  const [eventModelingEnabled, setEventModelingEnabled] = useState(true);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    setEventModelingEnabled(props.board.eventModelingEnabled);\n  }, [props.board.uid]);\n\n  const handleToggle = (enabled: boolean) => {\n    setEventModelingEnabled(enabled);\n    dispatch(toggleEventModelingEnabled(props.board.merge({eventModelingEnabled: enabled})))\n  }\n\n  return <Checkbox toggle={true} checked={eventModelingEnabled} value={eventModelingEnabled? '1' : ''} onChange={(e, data) => handleToggle(data.value !== '1')} />\n};\n\nexport default withNamespaces()(EventModelingEnabled);\n","import {List, Record} from \"immutable\";\nimport {BoardVersion} from \"./BoardVersion\";\nimport {BoardHistory} from \"./HistoryEntry\";\n\nexport interface HistoryStateData {\n    history: BoardHistory;\n    loading: boolean;\n    olderPatchesAvailable: boolean;\n    oldestBoardVersion?: BoardVersion;\n}\n\nconst defaultHistoryStateData: HistoryStateData = {\n    history: List(),\n    loading: false,\n    oldestBoardVersion: undefined,\n    olderPatchesAvailable: true,\n};\n\nexport class HistoryState extends Record(defaultHistoryStateData) implements HistoryStateData {}","import {List, Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\nimport {BoardModel, BoardSync} from \"../model\";\nimport {BoardHistory} from \"../model/HistoryEntry\";\nimport {HistoryState} from \"../model/HistoryState\";\n\nconst getBoardHistoryById = (state: Record<ApplicationState>, boardId: BoardModel.BoardId): HistoryState => state.getIn(['inspectioBoards', 'history', boardId]) || new HistoryState();\n\nexport const makeBoardHistoryByIdSelector = (boardId: BoardModel.BoardId): (state: Record<ApplicationState>) => HistoryState => (state: Record<ApplicationState>) => getBoardHistoryById(state, boardId);","import {withNamespaces} from \"react-i18next\";\nimport { connect } from 'react-redux';\nimport {withRouter} from \"react-router\";\nimport { compose, lifecycle } from 'recompose';\nimport {bindActionCreators, Dispatch} from \"redux\";\nimport {Command} from \"../actions\";\nimport {EditBoard, EditBoardProps} from \"../components/EditBoard\";\nimport {BoardSelector} from \"../selectors\";\n\nconst mapStateToProps = BoardSelector.makeMapStateToPropsEditBoard();\n\nconst mapDispatchToProps = (dispatch: Dispatch) => bindActionCreators(\n    {\n        confirmDeleteBoard: Command.confirmDeleteBoard,\n        deleteBoard: Command.deleteBoard,\n        abortDeletion: Command.abortBoardDeletion,\n        shareBoard: Command.shareBoard,\n    },\n    dispatch\n);\n\nexport default withNamespaces()(withRouter<EditBoardProps, any>(compose<EditBoardProps, any>(\n    connect(mapStateToProps, mapDispatchToProps),\n    lifecycle({\n\n    })\n)(EditBoard)));\n","import {fromJS, List} from \"immutable\";\nimport {useEffect} from \"react\";\nimport * as React from 'react';\nimport {WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps} from \"react-router\";\nimport {Container, Dimmer, Grid, Header, Icon, Loader, Message} from 'semantic-ui-react';\nimport HeaderSubHeader from \"semantic-ui-react/dist/commonjs/elements/Header/HeaderSubheader\";\nimport {\n    makeActiveUserOrganizationInfoSelector,\n    makeUserOrganizationInfoListSelector\n} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport * as Routes from \"../../routes\";\nimport {isStandalone} from \"../../standalone/util\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {Command} from \"../actions\";\nimport {\n    fetchBoardPermissionsForTeams,\n    fetchBoardPermissionsForUsers,\n    fetchOpenBoardInvitations,\n    fetchUserBoard\n} from \"../actions/queries\";\nimport {BoardModel} from \"../model\";\nimport {default as ConfirmBoardDeletionForm, ImFormData as DeletionImFormData} from './ConfirmBoardDeletionForm';\nimport BoardClientConfiguration from \"./EditBoard/BoardClientConfiguration\";\nimport BoardPermissionsMenu from \"./EditBoard/BoardPermissionsMenu\";\nimport BoardStickyTemplates from \"./EditBoard/BoardStickyTemplates\";\nimport MoveBoardMenu from \"./EditBoard/MoveBoardMenu\";\nimport {default as EditBoardForm} from './EditBoardForm';\nimport {BoardRouteMatchParams} from \"./types\";\nimport BoardTags from \"./EditBoard/BoardTags\";\nimport CodySuggestEnabled from \"./EditBoard/CodySuggestEnabled\";\nimport EventModelingEnabled from \"./EditBoard/EventModelingEnabled\";\n\ninterface PropsFromState {\n    board?: BoardModel.Board;\n}\n\ninterface PropsFromDispatch {\n    confirmDeleteBoard: typeof Command.confirmDeleteBoard;\n    deleteBoard: typeof Command.deleteBoard;\n    abortDeletion: typeof Command.abortBoardDeletion;\n    shareBoard: typeof Command.shareBoard;\n}\n\ninterface OwnProps {\n\n}\n\nexport type EditBoardProps = PropsFromState & PropsFromDispatch & OwnProps & WithNamespaces & RouteComponentProps<BoardRouteMatchParams>;\n\nconst handleConfirmDeletion = (data: DeletionImFormData, props: EditBoardProps) => {\n    props.deleteBoard(data.get('uid') as string);\n    props.history.replace(Routes.inspectio);\n}\n\n\nexport const EditBoard = (props: EditBoardProps) => {\n\n    const dispatch = useDispatch();\n    const boardId = props.board ? props.board.uid : undefined;\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organizations = useSelector(makeUserOrganizationInfoListSelector(currentUser.uid));\n\n    useEffect(\n        () => {\n            if (props.board) {\n                dispatch(fetchBoardPermissionsForUsers(props.board.uid));\n                dispatch(fetchBoardPermissionsForTeams(props.board.uid));\n                dispatch(fetchOpenBoardInvitations(props.board.uid));\n            }\n        },\n        [boardId]\n    );\n\n    if(!props.board) {\n        dispatch(fetchUserBoard(props.match.params.uid));\n        return <Dimmer className=\"page\"><Loader size=\"large\">Loading Board</Loader></Dimmer>;\n    }\n\n    const isPrivateWorkspace = !activeOrganization || !activeOrganization.explicitOrganization;\n    const validTargetOrganizations = isPrivateWorkspace? organizations.filter(orga => orga.explicitOrganization && !orga.userIsGuest) : List();\n    const isMovableBoard = isPrivateWorkspace\n        && !props.board.organization\n        && validTargetOrganizations.count() > 0;\n\n    return <Container>\n    <Grid stackable={true} padded={true}>\n    <Grid.Row>\n        <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n        <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n            <Header as=\"h1\" icon={true} textAlign='center'>\n            <Icon name='settings' />\n            <Header.Content>\n                { props.t(\"insp.board.edit\").replace('%name%', props.board.name) }\n                <Header.Subheader>{ props.t(\"insp.board.edit_header\")}</Header.Subheader>\n            </Header.Content>\n            </Header>\n        </Grid.Column>\n    </Grid.Row>\n    <Grid.Row>\n        <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n        <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n        <div className=\"ui segments\">\n            <div className=\"ui segment\">\n            <EditBoardForm board={props.board} />\n            </div>\n            <div className=\"ui segment\">\n                {!props.board.inDeletion &&\n                <Message>\n                    {props.t('insp.board.delete_txt1')}<a href=\"#\" onClick={e => {e.preventDefault(); e.stopPropagation(); props.confirmDeleteBoard(props.board!.uid)}}>{props.t('insp.board.delete_link')}</a>{props.t('insp.board.delete_txt2')}\n                </Message>\n                }\n                {props.board.inDeletion &&\n                <ConfirmBoardDeletionForm\n                    boardName={props.board.name}\n                    initialValues={fromJS({confirmedName: '', uid: props.board.uid})}\n                    t={props.t}\n                    onSubmit={(data) => {handleConfirmDeletion(data, props)}}\n                    onCancel={() => props.abortDeletion(props.board!.uid)}/>\n                }\n            </div>\n        </div>\n        </Grid.Column>\n    </Grid.Row>\n    <Grid.Row>\n        <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n        <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n            <div className=\"ui segments\">\n                <div className=\"ui segment\">\n                    <h2 className=\"ui header\">\n                        {props.t('insp.board.form.cody_suggest')}\n                        <HeaderSubHeader>{ props.t('insp.board.cody_suggest_sub') }</HeaderSubHeader>\n                    </h2>\n                    <CodySuggestEnabled board={props.board} />\n                </div>\n            </div>\n        </Grid.Column>\n    </Grid.Row>\n    <Grid.Row>\n        <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n        <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n            <div className=\"ui segments\">\n                <div className=\"ui segment\">\n                    <h2 className=\"ui header\">\n                        {props.t('insp.board.form.event_modeling')}\n                        <HeaderSubHeader>{ props.t('insp.board.event_modeling_sub') }</HeaderSubHeader>\n                    </h2>\n                    <EventModelingEnabled board={props.board} />\n                </div>\n            </div>\n        </Grid.Column>\n    </Grid.Row>\n    <Grid.Row>\n        <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n        <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n            <div className=\"ui segments\">\n                <div className=\"ui segment\">\n                    <h2 className=\"ui header\">\n                        Tags\n                        <HeaderSubHeader>{ props.t('insp.board.tags_sub') }</HeaderSubHeader>\n                    </h2>\n                    <BoardTags board={props.board} />\n                </div>\n            </div>\n        </Grid.Column>\n    </Grid.Row>\n    {!isStandalone() && (\n        <Grid.Row>\n            <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n            <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                <div className=\"ui segments\">\n                    <div className=\"ui segment\">\n                        <h2 className=\"ui header\">\n                            {props.t('insp.board.share')}\n                            <HeaderSubHeader>\n                                { props.t('insp.board.share_sub') }\n                                <a href=\"https://wiki.prooph-board.com/access_management/Access-Rights.html\"\n                                   target=\"_blank\" style={{float: 'right'}}\n                                   title=\"Learn more in the wiki\"\n                                ><Icon name=\"question circle outline\" /></a>\n                            </HeaderSubHeader>\n                        </h2>\n                        <BoardPermissionsMenu board={props.board} />\n                    </div>\n                </div>\n            </Grid.Column>\n        </Grid.Row>\n    )}\n    <Grid.Row>\n        <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n        <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n            {props.board && <BoardStickyTemplates boardId={props.board.uid} />}\n        </Grid.Column>\n    </Grid.Row>\n    {!isStandalone() && isMovableBoard && (\n        <Grid.Row>\n            <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n            <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                <div className=\"ui segments\">\n                    <div className=\"ui segment\">\n                        <h2 className=\"ui header\">\n                            {props.t('insp.board.move_to_organization_title')}\n                            <HeaderSubHeader>{ props.t('insp.board.move_to_organization_sub_title') }</HeaderSubHeader>\n                        </h2>\n                        <MoveBoardMenu boardId={props.board.uid} organizations={validTargetOrganizations} />\n                    </div>\n                </div>\n            </Grid.Column>\n        </Grid.Row>\n    )}\n    {!isStandalone() && (\n        <Grid.Row>\n            <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n            <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                {props.board && <BoardClientConfiguration boardId={props.board.uid} />}\n            </Grid.Column>\n        </Grid.Row>\n    )}\n</Grid>\n</Container>};\n\n\n","export const TOGGLE_SIDEBAR_COLLAPSED = '@@InspectioLayout/ToggleSidebarCollapsed';\nexport const SET_SIDEBAR_WIDTH = '@@InspectioLayout/SetSidebarWidth';\nexport const SET_RIGHT_SIDEBAR_WIDTH = '@@InspectioLayout/SetRightSidebarWidth';\nexport const SET_SIDEBYSIDE_WIDTH = '@@InspectioLayout/SetSideBySideWidth';\nexport const SET_SIDEBYSIDE_CELL = '@@InspectionLayout/SetSideBySideCell';\nexport const SET_CODY_CONSOLE_HEIGHT = '@@InspectioLayout/SetCodyConsoleHeight';\nexport const TOGGLE_SIDEBAR_DIVIDER = '@@InspectioLayout/ToggleSidebarDivider';\nexport const TOGGLE_SIDEBAR_EDITOR = '@@InspectioLayout/ToggleSidebarEditor';\n","import {action} from \"typesafe-actions\";\nimport {\n    SET_CODY_CONSOLE_HEIGHT,\n    SET_RIGHT_SIDEBAR_WIDTH,\n    SET_SIDEBAR_WIDTH, SET_SIDEBYSIDE_CELL, SET_SIDEBYSIDE_WIDTH,\n    TOGGLE_SIDEBAR_COLLAPSED, TOGGLE_SIDEBAR_DIVIDER, TOGGLE_SIDEBAR_EDITOR,\n\n} from \"./constants\";\n\nexport const toggleSidebarCollapsed = (collapsed: boolean) => action(TOGGLE_SIDEBAR_COLLAPSED, {collapsed});\nexport const setSidebarWidth = (width: number) => action(SET_SIDEBAR_WIDTH, {width});\nexport const setRightSidebarWidth = (width: number) => action(SET_RIGHT_SIDEBAR_WIDTH, {width});\nexport const setSideBySideWidth = (width: number) => action(SET_SIDEBYSIDE_WIDTH, {width});\nexport const setSideBySideCell = (cell: string | null) => action(SET_SIDEBYSIDE_CELL, {cell});\nexport const setCodyConsoleHeight = (height: number) => action(SET_CODY_CONSOLE_HEIGHT, {height});\nexport const toggleSidebarDivider = (divider: string, collapsed: boolean) => action(TOGGLE_SIDEBAR_DIVIDER, {divider, collapsed});\nexport const toggleSidebarEditor = (editor: string, expanded: boolean, double: boolean) => action(TOGGLE_SIDEBAR_EDITOR, {editor, expanded, double});\n","import {UserModel} from \"../../User\";\nimport {BoardTimer} from \"../model/BoardTimer\";\nimport {\n    AutoScrollEvent,\n    GestureChanged,\n    MouseDelta,\n    UserJoinedListener, UserLeftListener,\n    UserMouseJoined,\n    UserMouseLeft,\n    UserMouseMove,\n    UserMouseScroll\n} from \"../service/RemoteMouseSync\";\n\nexport type BoardTimerListener = (timer: BoardTimer) => void;\n\nexport abstract class MouseSync {\n    public abstract startSync(joined: UserMouseJoined): void;\n    public abstract stopSync(left: UserMouseLeft): void;\n    public abstract keepMousePositionsInPlaceOnPanning(move: UserMouseMove, mouseDelta: MouseDelta): void;\n    public abstract syncLastKnownAbsolutePointsAfterPanning(): void;\n    public abstract emitUserMouseMove(move: UserMouseMove, mouseDelta?: MouseDelta): void;\n    public abstract emitUserMouseScroll(scroll: UserMouseScroll): void;\n    public abstract emitUserGestureChanged(gestureChanged: GestureChanged): void;\n    public abstract emitUserIsAutoScrolling(autoScrollEvent: AutoScrollEvent): void;\n    public abstract trackMouseOfRemoteUser(userId: UserModel.UserId, userName: UserModel.Username, avatar: UserModel.AvatarUrl): void;\n    public abstract stopMouseTrackingOfUser(userId: UserModel.UserId): void;\n    public abstract observeUser(userId: UserModel.UserId): void;\n    public abstract hideObservingFrame(): void;\n    public abstract stopObservingUser(): void;\n    public abstract onUserJoined(listener: UserJoinedListener): void;\n    public abstract offUserJoined(listener: UserJoinedListener): void;\n    public abstract onUserLeft(listener: UserLeftListener): void;\n    public abstract offUserLeft(listener: UserLeftListener): void;\n    public abstract startBoardTimer(timer: BoardTimer): void;\n    public abstract onBoardTimerStarted(listener: BoardTimerListener): void;\n    public abstract offBoardTimerStarted(listener: BoardTimerListener): void;\n    public abstract pauseBoardTimer(timer: BoardTimer): void;\n    public abstract onBoardTimerPaused(listener: BoardTimerListener): void;\n    public abstract offBoardTimerPaused(listener: BoardTimerListener): void;\n    public abstract stopBoardTimer(timer: BoardTimer): void;\n    public abstract onBoardTimerStopped(listener: BoardTimerListener): void;\n    public abstract offBoardTimerStopped(listener: BoardTimerListener): void;\n}\n\n// tslint:disable-next-line:max-classes-per-file\nclass MouseSyncRef implements MouseSync {\n\n    private mouseSyncRef: MouseSync | undefined;\n\n    private cachedUserJoinedListeners: UserJoinedListener[] = [];\n    private cachedUserLeftListeners: UserLeftListener[] = [];\n    private cachedBoardTimerStartedListeners: BoardTimerListener[] = [];\n    private cachedBoardTimerPausedListeners: BoardTimerListener[] = [];\n    private cachedBoardTimerStoppedListeners: BoardTimerListener[] = [];\n\n    public setMouseSync(mouseSync: MouseSync | undefined): void {\n        this.mouseSyncRef = mouseSync;\n\n        if(this.mouseSyncRef) {\n            this.cachedUserJoinedListeners.forEach(l => this.mouseSyncRef!.onUserJoined(l))\n            this.cachedUserLeftListeners.forEach(l => this.mouseSyncRef!.onUserLeft(l))\n            this.cachedBoardTimerStartedListeners.forEach(l => this.mouseSyncRef!.onBoardTimerStarted(l))\n            this.cachedBoardTimerPausedListeners.forEach(l => this.mouseSyncRef!.onBoardTimerPaused(l))\n            this.cachedBoardTimerStoppedListeners.forEach(l => this.mouseSyncRef!.onBoardTimerStopped(l))\n        }\n\n        this.cachedUserJoinedListeners = [];\n        this.cachedUserLeftListeners = [];\n        this.cachedBoardTimerStartedListeners = [];\n        this.cachedBoardTimerPausedListeners = [];\n        this.cachedBoardTimerStoppedListeners = [];\n    }\n\n    public emitUserGestureChanged(gestureChanged: GestureChanged): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.emitUserGestureChanged(gestureChanged);\n        }\n\n    }\n\n    public emitUserIsAutoScrolling(autoScrollEvent: AutoScrollEvent): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.emitUserIsAutoScrolling(autoScrollEvent);\n        }\n    }\n\n    public emitUserMouseMove(move: UserMouseMove, mouseDelta?: MouseDelta): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.emitUserMouseMove(move, mouseDelta);\n        }\n    }\n\n    public emitUserMouseScroll(scroll: UserMouseScroll): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.emitUserMouseScroll(scroll);\n        }\n    }\n\n    public hideObservingFrame(): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.hideObservingFrame();\n        }\n    }\n\n    public keepMousePositionsInPlaceOnPanning(move: UserMouseMove, mouseDelta: MouseDelta): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.keepMousePositionsInPlaceOnPanning(move, mouseDelta);\n        }\n    }\n\n    public observeUser(userId: UserModel.UserId): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.observeUser(userId);\n        }\n    }\n\n    public onUserJoined(listener: UserJoinedListener): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.onUserJoined(listener);\n        } else {\n            this.cachedUserJoinedListeners.push(listener);\n        }\n    }\n\n    public offUserJoined(listener: UserJoinedListener) {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.offUserJoined(listener);\n        } else {\n            this.cachedUserJoinedListeners = this.cachedUserJoinedListeners.filter(l => l !== listener);\n        }\n    }\n\n    public onUserLeft(listener: UserLeftListener): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.onUserLeft(listener);\n        } else {\n            this.cachedUserLeftListeners.push(listener);\n        }\n    }\n\n    public offUserLeft(listener: UserLeftListener) {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.offUserLeft(listener);\n        } else {\n            this.cachedUserLeftListeners = this.cachedUserLeftListeners.filter(l => l !== listener);\n        }\n    }\n\n    public startSync(joined: UserMouseJoined): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.startSync(joined);\n        }\n    }\n\n    public stopMouseTrackingOfUser(userId: UserModel.UserId): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.stopMouseTrackingOfUser(userId);\n        }\n    }\n\n    public stopObservingUser(): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.stopObservingUser();\n        }\n    }\n\n    public stopSync(left: UserMouseLeft): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.stopSync(left);\n        }\n    }\n\n    public syncLastKnownAbsolutePointsAfterPanning(): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.syncLastKnownAbsolutePointsAfterPanning();\n        }\n    }\n\n    public trackMouseOfRemoteUser(userId: UserModel.UserId, userName: UserModel.Username, avatar: UserModel.AvatarUrl): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.trackMouseOfRemoteUser(userId, userName, avatar);\n        }\n    }\n\n    public startBoardTimer(timer: BoardTimer): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.startBoardTimer(timer);\n        }\n    }\n\n    public onBoardTimerPaused(listener: BoardTimerListener): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.onBoardTimerPaused(listener);\n        } else {\n            this.cachedBoardTimerPausedListeners.push(listener);\n        }\n    }\n\n    public offBoardTimerPaused(listener: BoardTimerListener) {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.offBoardTimerPaused(listener);\n        } else {\n            this.cachedBoardTimerPausedListeners = this.cachedBoardTimerPausedListeners.filter(l => l !== listener);\n        }\n    }\n\n    public onBoardTimerStarted(listener: BoardTimerListener): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.onBoardTimerStarted(listener);\n        } else {\n            this.cachedBoardTimerStartedListeners.push(listener);\n        }\n    }\n\n    public offBoardTimerStarted(listener: BoardTimerListener) {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.offBoardTimerStarted(listener);\n        } else {\n            this.cachedBoardTimerStartedListeners = this.cachedBoardTimerStartedListeners.filter(l => l !== listener);\n        }\n    }\n\n    public onBoardTimerStopped(listener: BoardTimerListener): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.onBoardTimerStopped(listener);\n        } else {\n            this.cachedBoardTimerStoppedListeners.push(listener);\n        }\n    }\n\n    public offBoardTimerStopped(listener: BoardTimerListener) {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.offBoardTimerStopped(listener);\n        } else {\n            this.cachedBoardTimerStoppedListeners = this.cachedBoardTimerStoppedListeners.filter(l => l !== listener);\n        }\n    }\n\n    public pauseBoardTimer(timer: BoardTimer): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.pauseBoardTimer(timer);\n        }\n    }\n\n    public stopBoardTimer(timer: BoardTimer): void {\n        if(this.mouseSyncRef) {\n            this.mouseSyncRef.stopBoardTimer(timer);\n        }\n    }\n}\n\nlet currentMouseSync: MouseSyncRef | undefined;\n\nexport function useMouseSync(): [MouseSync, (mouseSync: MouseSync | undefined) => void] {\n    if(!currentMouseSync) {\n        currentMouseSync = new MouseSyncRef();\n    }\n\n    return [currentMouseSync, (mouseSync => currentMouseSync!.setMouseSync(mouseSync))]\n}\n","import {AxiosInstance} from \"axios\";\nimport {CodyResponse, CodyResponseType} from \"../Cody\";\nimport {CodyServer} from \"./CodyServer\";\n\nexport class AxiosServer implements CodyServer {\n  public readonly name: string;\n  private readonly axios: AxiosInstance;\n  private sync: boolean = false;\n\n  public constructor(name: string, axios: AxiosInstance) {\n    this.name = name;\n    this.axios = axios;\n  }\n\n  public async sendMessage(messageName: string, payload: any): Promise<CodyResponse> {\n    const res = await this.axios.post<CodyResponse>(messageName, payload, {validateStatus: () => true});\n\n    if(res.status !== 200) {\n      return {\n        cody: `Did not receive a valid response from ${this.name}.`,\n        type: CodyResponseType.Error,\n        details: JSON.stringify(res)\n      }\n    }\n\n    return res.data;\n  }\n\n  public async fullSync(messageName: string, payload: any): Promise<CodyResponse> {\n    return this.sendMessage(messageName, payload);\n  }\n\n  public async syncNodes(messageName: string, payload: any): Promise<CodyResponse> {\n    const res = await this.axios.put<CodyResponse>(messageName, payload);\n\n    if(res.status !== 200) {\n      return {\n        cody: `Did not receive a valid response from ${this.name}.`,\n        type: CodyResponseType.Error,\n        details: JSON.stringify(res)\n      }\n    }\n\n    return res.data;\n  }\n\n  public async syncDeletedNodes(messageName: string, payload: any): Promise<CodyResponse> {\n    const res = await this.axios.post<CodyResponse>(messageName, payload);\n\n    if(res.status !== 200) {\n      return {\n        cody: `Did not receive a valid response from ${this.name}.`,\n        type: CodyResponseType.Error,\n        details: JSON.stringify(res)\n      }\n    }\n\n    return res.data;\n  }\n\n  public enableSync(): void {\n    this.sync = true;\n  }\n\n  public isSyncEnabled(): boolean {\n    return this.sync;\n  }\n}\n","export enum Command {\n    Sync = 'Sync',\n    SyncDeleted = 'SyncDeleted',\n}\n","export enum Event {\n    IioSaidHello = 'IioSaidHello',\n    UserReplied = 'UserReplied',\n    ElementEdited = 'ElementEdited',\n    ConfirmTest = 'ConfirmTest',\n}\n","import axios, {AxiosInstance} from \"axios\";\nimport {List} from \"immutable\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {BoardId, BoardName} from \"../model/Board\";\nimport {convertNodeToJs, Node, NodeId} from \"../model/Graph\";\nimport {AxiosServer} from \"./Cody/AxiosServer\";\nimport {CodyServer} from \"./Cody/CodyServer\";\nimport {Command} from \"./Cody/Command\";\nimport {Event} from \"./Cody/Event\";\nimport {PlayServer} from \"./Cody/PlayServer\";\n\nexport const NO_CODY_CONNECTION = \"No connection to Cody. Try to connect with him first!\";\nexport const CODY_PLAY_SERVER_NAME = \"Cody Play\";\n\ninterface Session {\n    nodes: Node[];\n    currentNodeIndex: number;\n    currentServerIndex: number;\n    boardId: BoardId;\n    boardName: BoardName;\n    userId: UserId;\n    syncPerformed: boolean;\n}\n\nconst printCodyResponse = (res: CodyResponse, codyName: string) => {\n    const cody = (typeof res.cody === 'string')? [res.cody] : res.cody as [];\n    const details = (typeof res.details === 'string')? [res.details] : res.details as [];\n    const type = res.type? res.type : CodyResponseType.Info;\n\n    switch (type) {\n        case CodyResponseType.Info:\n            if(cody.length === 1) {\n                cody[0] = '%c'+cody[0];\n                cody.push('color: #32c0e7;font-weight: bold')\n            }\n            console.info('%c ['+codyName+']: '+cody[0], 'color: #414141', ...cody.slice(1));\n            if(res.details) {\n                console.log('%c ['+codyName+']: '+details[0], 'color: #414141', ...details.slice(1));\n            }\n            break;\n        case CodyResponseType.Error:\n            if(cody.length === 1) {\n                cody[0] = '%c'+cody[0];\n                cody.push('color: color: #f31c30;font-weight: bold')\n            }\n            console.error('%c ['+codyName+']: '+cody[0], 'color: #414141', ...cody.slice(1));\n            if(res.details) {\n                console.error('%c ['+codyName+']: '+details[0], 'color: #414141', ...details.slice(1));\n            }\n            break;\n        case CodyResponseType.Warning:\n        case CodyResponseType.Question:\n            if(cody.length === 1) {\n                cody[0] = '%c'+cody[0];\n                cody.push('font-weight: bold')\n            }\n            console.warn('%c ['+codyName+']: '+cody[0], 'color: #414141', ...cody.slice(1));\n            if(res.details) {\n                console.warn('%c ['+codyName+']: '+details[0], 'color: #414141', ...details.slice(1));\n            }\n            break;\n        case CodyResponseType.SyncRequired:\n            console.warn(\"%c [\"+codyName+\"]: I need to sync all board content. Lean back for a moment. I'll tell you when I'm done.\");\n            break;\n        default:\n            console.log('%c ['+codyName+']: '+cody[0], 'color: #414141', ...cody.slice(1));\n            if(res.details) {\n                console.log('%c ['+codyName+']: '+details[0], 'color: #414141', ...details.slice(1));\n            }\n    }\n}\n\nconst printError = (error: string) => {\n    console.error(error);\n}\n\nconst printWarning = (warn: string) => {\n    console.warn(warn);\n}\n\nconst sortNodes = (nodes: Node[]): Node[] => {\n    const sortedNodes: Node[] = [];\n\n    const nodesWithoutSourceInNodeList = nodes.filter(n => {\n        if(n.getSources().count() === 0) {\n            return true\n        }\n\n        let allSourcesNotInNodeList = true;\n\n        n.getSources().forEach(source => {\n            if(nodes.find(orgN => orgN.getId() === source.getId())) {\n                allSourcesNotInNodeList = false;\n            }\n        })\n\n        return allSourcesNotInNodeList;\n    });\n\n    sortedNodes.push(...nodesWithoutSourceInNodeList);\n\n    nodesWithoutSourceInNodeList.forEach(nodeNoSource => {\n        addTargetsToSortedNodesList(nodeNoSource.getTargets(), nodes, sortedNodes);\n    })\n\n    return sortedNodes;\n}\n\nconst addTargetsToSortedNodesList = (targets: List<Node>, originalNodes: Node[], sortedNodes: Node[], nestingLevel = 0): void => {\n    targets.forEach(target => {\n        if(originalNodes.find(orgN => orgN.getId() === target.getId())) {\n            const targetInSortedNodes = sortedNodes.find(sN => sN.getId() === target.getId());\n\n            if(!targetInSortedNodes) {\n                sortedNodes.push(target);\n            } else {\n                // Target should always come after all of its sources\n                sortedNodes.splice(sortedNodes.indexOf(targetInSortedNodes), 1);\n                sortedNodes.push(target);\n            }\n\n        }\n\n        nestingLevel++;\n\n        if(nestingLevel < 5) {\n            addTargetsToSortedNodesList(target.getTargets(), originalNodes, sortedNodes, nestingLevel);\n        }\n    })\n}\n\nlet currentSession: Session | undefined;\nlet codyResponsePrinter = printCodyResponse;\nlet errorPrinter = printError;\nlet warningPrinter = printWarning;\nlet syncRequiredCallback: SyncRequiredCallback | undefined;\nlet newlyConnectedCodySyncIndex: number | undefined;\nlet codyResponseListeners: CodyResponseListener[] = [];\n\nconst triggerCody: TriggerCody = (boardId: BoardId, boardName: BoardName, userId: UserId, nodes, currentNodeIndex?: number, currentServerIndex?: number) => {\n    if(nodes.length === 0) {\n        warningPrinter(\"Selection is empty. Nothing to do for Cody!\");\n        return false;\n    }\n\n    if(typeof currentNodeIndex === 'undefined' && currentSession) {\n        if(IIO.codyServers) {\n            IIO.codyServers.forEach(cody => {\n                codyResponsePrinter({\n                    cody: \"Wait, wait, wait! I'm still working on last session.\",\n                    details: [\"You can stop me by pressing %cESC\", \"background-color: rgba(251, 159, 75, 0.2)\"],\n                    type: CodyResponseType.Warning\n                }, cody.name);\n            })\n        } else {\n            codyResponsePrinter({\n                cody: \"Wait, wait, wait! I'm still working on last session.\",\n                details: [\"You can stop me by pressing %cESC\", \"background-color: rgba(251, 159, 75, 0.2)\"],\n                type: CodyResponseType.Warning\n            }, 'Cody');\n        }\n\n        return false;\n    }\n\n    if(IIO.codyServers) {\n        if(typeof currentNodeIndex === 'undefined') {\n            currentSession = {nodes, currentNodeIndex: 0, boardId, boardName, userId, currentServerIndex: 0, syncPerformed: false};\n\n            nodes = sortNodes(nodes);\n\n            triggerCody(boardId, boardName, userId, nodes, 0);\n        } else {\n            if(typeof currentServerIndex === 'undefined') {\n                currentServerIndex = 0;\n            }\n\n            const cody = IIO.codyServers![currentServerIndex];\n\n            const context = {boardId, boardName, userId};\n\n            cody.sendMessage(Event.ElementEdited, {node: convertNodeToJs(nodes[currentNodeIndex], true), context}).then(\n              codyRes => {\n                    codyResponsePrinter(codyRes, cody.name);\n\n                    if(codyRes.type !== CodyResponseType.Question\n                        && codyRes.type !== CodyResponseType.StopSession\n                        && codyRes.type !== CodyResponseType.SyncRequired\n                        && codyRes.type !== CodyResponseType.Error) {\n                        currentServerIndex!++;\n                        if(currentServerIndex! < IIO.codyServers!.length) {\n                            currentSession!.currentServerIndex = currentServerIndex!;\n                            triggerCody(boardId, boardName, userId, nodes, currentNodeIndex, currentServerIndex);\n                        } else {\n                            currentNodeIndex = currentNodeIndex! + 1;\n                            currentSession!.currentNodeIndex = currentNodeIndex;\n                            currentSession!.currentServerIndex = 0;\n\n                            if(currentNodeIndex < nodes.length) {\n                                triggerCody(boardId, boardName, userId, nodes, currentNodeIndex, 0);\n                            }\n                        }\n                    }\n\n                    if(codyRes.type === CodyResponseType.SyncRequired) {\n                        if(syncRequiredCallback) {\n                            syncRequiredCallback();\n                        }\n                    }\n\n                    if(codyRes.type === CodyResponseType.StopSession\n                        || codyRes.type === CodyResponseType.Error\n                        || (currentNodeIndex! === nodes.length && currentServerIndex === IIO.codyServers!.length && codyRes.type !== CodyResponseType.Question)) {\n                        currentSession = undefined;\n                    }\n                },\n                reason => {\n                    if(typeof reason !== 'string') {\n                        if(typeof reason.toString === 'function') {\n                            reason = reason.toString();\n                        } else {\n                            reason = 'Unknown Error'\n                        }\n                    }\n\n                    errorPrinter(reason)\n                }\n            );\n        }\n        return true;\n    }\n\n    errorPrinter(NO_CODY_CONNECTION);\n    return false;\n}\n\nconst runCommand = (boardId: BoardId, boardName: BoardName, userId: UserId, commandName: string, payload: any, codyName?: string): boolean => {\n    if(!IIO.codyServers) {\n        return false;\n    }\n\n    const servers = IIO.codyServers.filter(s => !codyName || s.name === codyName);\n    const context = {boardId, boardName, userId};\n\n    servers.forEach(s => s.sendMessage(commandName, {payload, context}).then(codyResponse => {\n        codyResponsePrinter(codyResponse, s.name)\n    }));\n\n    return true;\n}\n\nexport const IIO: IIO = {\n    syncRequired: () => {\n        if(!IIO.codyServers) {\n            return false;\n        }\n\n        return IIO.codyServers.filter(server => server.isSyncEnabled()).length > 0;\n    },\n    isConnected: (codyName?: string): boolean => {\n        return !!IIO.codyServers && IIO.codyServers.filter(s => !codyName || s.name === codyName).length > 0;\n    },\n    connect: {\n        Cody: (uri: string, user: string, boardId, codyName?: string) => {\n            if(!codyName) {\n                codyName = 'Cody';\n            }\n\n            if(!IIO.codyServers) {\n                IIO.codyServers = [];\n            }\n\n            const connectedServers = IIO.codyServers.filter(cody => cody.name !== codyName);\n\n            const codyServer = uri === 'play'\n              ? new PlayServer(CODY_PLAY_SERVER_NAME, process.env.REACT_APP_CODY_PLAY_URL || 'https://play.prooph-board.com', boardId)\n              : new AxiosServer(codyName, axios.create({\n                baseURL:  uri + '/messages/',\n            }));\n\n            connectedServers.push(codyServer);\n\n            IIO.codyServers = connectedServers;\n\n            codyServer.sendMessage(Event.IioSaidHello, {user}).then(\n                res => {\n                    codyResponsePrinter(res, codyServer.name)\n\n                    if(res.type === CodyResponseType.SyncRequired) {\n\n                        if(syncRequiredCallback) {\n                            newlyConnectedCodySyncIndex = connectedServers.indexOf(codyServer);\n                            syncRequiredCallback();\n                        }\n                    }\n                },\n                reason => codyResponsePrinter({\n                    cody: 'Failed to reach out to server',\n                    details: [reason],\n                    type: CodyResponseType.Error\n                }, codyServer.name)\n            );\n            return true;\n        }\n    },\n    disconnect: (codyName?: string) => {\n        if(IIO.codyServers) {\n            if(codyName) {\n                IIO.codyServers = IIO.codyServers.filter(cody => cody.name !== codyName);\n\n                codyResponsePrinter({\n                    cody: 'Bye Bye',\n                    type: CodyResponseType.Warning\n                }, codyName)\n                return;\n            }\n            IIO.codyServers = undefined;\n            currentSession = undefined;\n            codyResponsePrinter = printCodyResponse;\n            errorPrinter = printError;\n            warningPrinter = printWarning;\n        }\n    },\n    reply: (reply: any) => {\n        if(currentSession && IIO.codyServers && IIO.codyServers[currentSession.currentServerIndex]) {\n            const cody = IIO.codyServers[currentSession.currentServerIndex];\n\n            cody.sendMessage(Event.UserReplied, {reply}).then(\n              codyRes => {\n                    codyResponsePrinter(codyRes, cody.name);\n\n                    if (codyRes.type !== CodyResponseType.Question &&\n                        codyRes.type !== CodyResponseType.StopSession &&\n                        codyRes.type !== CodyResponseType.Error && currentSession) {\n\n                        const {nodes} = currentSession;\n                        let {currentNodeIndex} = currentSession;\n\n                        const currentServerIndex = currentSession.currentServerIndex + 1;\n                        if(currentServerIndex! < IIO.codyServers!.length) {\n                            currentSession!.currentServerIndex = currentServerIndex!;\n                            triggerCody(\n                              currentSession.boardId,\n                              currentSession.boardName,\n                              currentSession.userId,\n                              nodes,\n                              currentNodeIndex,\n                              currentServerIndex\n                            );\n                        } else {\n                            currentNodeIndex = currentNodeIndex! + 1;\n                            currentSession!.currentNodeIndex = currentNodeIndex;\n                            currentSession!.currentServerIndex = 0;\n\n                            if(currentNodeIndex < nodes.length) {\n                                triggerCody(\n                                  currentSession.boardId,\n                                  currentSession.boardName,\n                                  currentSession.userId,\n                                  nodes,\n                                  currentNodeIndex,\n                                  0\n                                );\n                            } else {\n                                // Set back so that check in next if can pass!\n                                currentSession!.currentServerIndex = currentServerIndex;\n                            }\n                        }\n\n                    }\n\n                    if (codyRes.type === CodyResponseType.StopSession\n                        || codyRes.type === CodyResponseType.Error\n                        || (currentSession\n                            && (currentSession.currentNodeIndex === currentSession.nodes.length || currentSession.nodes.length === 0)\n                            && currentSession.currentServerIndex === IIO.codyServers!.length)\n                    ) {\n                        currentSession = undefined;\n                    }\n                },\n                reason => {\n                    if (typeof reason !== 'string') {\n                        if (typeof reason.toString === 'function') {\n                            reason = reason.toString();\n                        } else {\n                            reason = 'Unknown Error'\n                        }\n                    }\n\n                    errorPrinter(reason)\n                }\n            );\n\n            return true;\n        }\n\n        errorPrinter(NO_CODY_CONNECTION);\n    },\n    talk: {\n        to: {\n            Cody: () => {\n                if(IIO.codyServers) {\n                    // Only talk to last server\n                    const lastServer = IIO.codyServers[IIO.codyServers.length - 1];\n                    currentSession = {nodes: [], currentNodeIndex: 0, boardId: '', boardName: '', userId: '', currentServerIndex: IIO.codyServers.length - 1, syncPerformed: false};\n\n                    lastServer.sendMessage(Event.ConfirmTest, {}).then(\n                        res => {\n                            codyResponsePrinter(res, lastServer.name)\n                        },\n                        reason => {\n                            if(typeof reason !== 'string') {\n                                if(typeof reason.toString === 'function') {\n                                    reason = reason.toString();\n                                } else {\n                                    reason = 'Unknown Error'\n                                }\n                            }\n\n                            errorPrinter(reason)\n                        }\n                    );\n\n                    return true;\n                }\n\n                errorPrinter(NO_CODY_CONNECTION);\n            }\n        }\n    },\n    trigger: {\n        Cody: triggerCody,\n    },\n    runCommand,\n    onSyncRequired: (cb) => {\n        syncRequiredCallback = cb;\n    },\n    syncNodes: async (boardId: BoardId, nodes: Node[]) => {\n        if(IIO.codyServers && (currentSession || typeof newlyConnectedCodySyncIndex !== 'undefined')) {\n            const cody = currentSession? IIO.codyServers[currentSession.currentServerIndex] : IIO.codyServers[newlyConnectedCodySyncIndex!];\n\n            if(currentSession && currentSession.syncPerformed) {\n                codyResponsePrinter({\n                    cody: \"Something went wrong. I already synced the entire board, but need to sync again.\",\n                    details: \"Looks like an endless loop. The developer who created the hooks gave me wrong instructions. Please contact them!\",\n                    type: CodyResponseType.Error\n                }, cody.name);\n\n                return false;\n            }\n\n            const codyRes = await cody.fullSync(Command.Sync, {boardId, nodes: nodes.map(n => convertNodeToJs(n, true))});\n\n            if(codyRes.type !== CodyResponseType.Empty) {\n                codyResponsePrinter(codyRes, cody.name);\n            }\n\n            cody.enableSync();\n        }\n\n        return true;\n    },\n    syncChangedNodes: async (boardId: BoardId, nodes: Node[]) => {\n        if(IIO.codyServers) {\n            for(const cody of IIO.codyServers) {\n                if(!cody.isSyncEnabled()) {\n                    continue;\n                }\n\n                const performSync = async (currentChunk: Node[]) => {\n                    const codyRes = await cody.syncNodes(Command.Sync, {boardId, nodes: currentChunk.map(n => convertNodeToJs(n, true))});\n\n                    if(codyRes.type !== CodyResponseType.Empty) {\n                        codyResponsePrinter(codyRes, cody.name);\n                    }\n                }\n\n                let chunk: Node[] = [];\n\n                for(const node of nodes) {\n                    chunk.push(node);\n\n                    if(chunk.length >= 10) {\n                        await performSync(chunk);\n\n                        chunk = [];\n                    }\n                }\n\n                if(chunk.length > 0) {\n                    await performSync(chunk);\n                }\n            }\n        }\n\n        return true;\n    },\n    syncDeletedNodes: async (boardId: BoardId, nodes: Node[]) => {\n        if(IIO.codyServers) {\n            for(const cody of IIO.codyServers) {\n                if(!cody.isSyncEnabled()) {\n                    continue;\n                }\n\n                const performSync = async (currentChunk: Node[]) => {\n                    const codyRes = await cody.syncDeletedNodes(Command.SyncDeleted, {boardId, nodes: currentChunk.map(n => convertNodeToJs(n, true))});\n\n                    if(codyRes.type !== CodyResponseType.Empty) {\n                        codyResponsePrinter(codyRes, cody.name);\n                    }\n                }\n\n                let chunk: Node[] = [];\n\n                for(const node of nodes) {\n                    chunk.push(node);\n\n                    if(chunk.length >= 10) {\n                        await performSync(chunk);\n\n                        chunk = [];\n                    }\n                }\n\n                if(chunk.length > 0) {\n                    await performSync(chunk);\n                }\n            }\n        }\n\n        return true;\n    },\n    syncFinished: () => {\n        if(typeof newlyConnectedCodySyncIndex !== 'undefined' && IIO.codyServers) {\n            const cody = IIO.codyServers[newlyConnectedCodySyncIndex];\n\n            codyResponsePrinter({\n                cody: \"Sync finished. We can continue!\",\n                type: CodyResponseType.Info\n            }, cody.name);\n\n            newlyConnectedCodySyncIndex = undefined;\n            return;\n        }\n\n         if(currentSession && IIO.codyServers) {\n             const cody = IIO.codyServers[currentSession.currentServerIndex];\n\n             codyResponsePrinter({\n                 cody: \"Sync finished. We can continue!\",\n                 type: CodyResponseType.Info\n             }, cody.name);\n\n             currentSession.syncPerformed = true;\n\n             triggerCody(\n               currentSession.boardId,\n               currentSession.boardName,\n               currentSession.userId,\n               currentSession.nodes,\n               currentSession.currentNodeIndex,\n               currentSession.currentServerIndex\n             );\n         }\n    },\n    abortSession: () => {\n        currentSession = undefined;\n\n        if(IIO.codyServers) {\n            IIO.codyServers.forEach(cody => {\n                codyResponsePrinter({\n                    cody: \"Yeah, no problem. I stopped my work.\"\n                }, cody.name);\n            })\n        } else {\n            codyResponsePrinter({\n                cody: \"Yeah, no problem. I stopped my work.\"\n            }, 'Cody');\n        }\n\n        return true;\n    },\n    ask: {\n        Cody: {\n            forHelp: () => {\n                codyResponsePrinter({\n                    cody: \"It's easy. You design the solution and I'll code it for you!\",\n                    details: [\n                        \"%cJust select one or more elements on the board and press %cCtrl+G (Cmd+G on Mac)%c or choose %cTrigger Cody%c from context menu of an element.\\n\\nPressing %cCtrl+Q (Cmd+Q on Mac)%c closes the console.\\n\\nTo enable Cockpit integration use %c/cockpit https://localhost:<cockpit_port>\",\n                        'color: #414141',\n                        'background-color: rgba(251, 159, 75, 0.2)',\n                        'color: #414141',\n                        'background-color: rgba(251, 159, 75, 0.2)',\n                        'color: #414141',\n                        'background-color: rgba(251, 159, 75, 0.2)',\n                        'color: #414141',\n                        'background-color: rgba(251, 159, 75, 0.2)',\n                    ]\n                }, 'Cody')\n            }\n        }\n    },\n    ping: {\n        Cody: () => {\n            codyResponsePrinter({\n                cody: \"I'm ready. Let's develop some awesome software together!\",\n                type: CodyResponseType.Info\n            }, 'Cody');\n        }\n    },\n    codyServers: undefined,\n    print: (res: CodyResponse, codyName: string): void => {\n        codyResponsePrinter(res, codyName);\n    },\n    setCodyResponsePrinter: (printer: (res: CodyResponse, codyName: string) => void) => {\n        codyResponsePrinter = (codyRes: CodyResponse, cName: string): void => {\n            printer(codyRes, cName);\n            codyResponseListeners.forEach(l => l(codyRes));\n        };\n    },\n    setErrorPrinter: (printer: (error: string) => void) => {\n        errorPrinter = printer;\n    },\n    setWarningPrinter: (printer: (warn: string) => void) => {\n        warningPrinter = printer;\n    },\n    attachCodyResponseListener: (listener: CodyResponseListener): DisposeCodyResponseListener => {\n        const dispose: DisposeCodyResponseListener = () => {\n            codyResponseListeners = codyResponseListeners.filter(l => l !== listener);\n        }\n\n        codyResponseListeners.push(listener);\n\n        return dispose;\n    }\n}\n\n// @ts-ignore\nwindow.IIO = IIO;\n\nexport const useIIO = (): IIO => {\n    return IIO;\n}\n\n// tslint:disable-next-line:interface-name\nexport interface IIO {\n    syncRequired: () => boolean;\n    isConnected: (codyName?: string) => boolean;\n    connect: Connect;\n    disconnect: (codyName?: string) => void;\n    reply: Reply;\n    talk: {\n        to: {\n            Cody: () => void;\n        }\n    },\n    trigger: {\n        Cody: TriggerCody;\n    },\n    runCommand: (boardId: BoardId, boardName: BoardName, userId: UserId, commandName: string, payload: any, codyName?: string) => boolean;\n    // Callback should use \"syncNodes()\" to pass all nodes to Cody\n    onSyncRequired: (cb: undefined | SyncRequiredCallback) => void;\n    // If user is on a large board, syncNodes() can be called multiple times in a row with a chunk of nodes\n    syncNodes: SyncNodes;\n    // If all nodes are synced, Callback should use syncFinished() to tell Cody to continue with current session\n    syncFinished: () => void;\n    // With a SyncRequired cody response the server automatically registers for a permanent sync of changes\n    // Following two methods are used sync ongoing changes like adding, updating or deleting nodes on the board\n    syncChangedNodes: SyncChangedNodes;\n    syncDeletedNodes: SyncDeletedNodes;\n    abortSession: () => void;\n    ask: {\n        Cody: {\n            forHelp: () => void;\n        }\n    },\n    ping: {\n        Cody: () => void;\n    }\n    codyServers: CodyServer[] | undefined;\n    print: (res: CodyResponse, codyName: string) => void;\n    setCodyResponsePrinter: (printer: (res: CodyResponse, codyName: string) => void) => void;\n    setErrorPrinter: (printer: (error: string) => void) => void;\n    setWarningPrinter: (printer: (warn: string) => void) => void;\n    attachCodyResponseListener: (listner: CodyResponseListener) => DisposeCodyResponseListener;\n}\n\ninterface Connect {\n    Cody: (uri: string, user: string, boardId: BoardId, codyName?: string) => void;\n}\n\ntype SyncRequiredCallback = () => void;\n\ntype Reply = (reply: any) => void;\n\nexport type TriggerCody = (\n  boardId: BoardId,\n  boardName: BoardName,\n  userId: UserId,\n  nodes: Node[],\n  currentNodeIndex?: number,\n  currentServerIndex?: number\n) => boolean;\n\nexport type CodyResponseListener = (codyResponse: CodyResponse) => void;\n\nexport type DisposeCodyResponseListener = () => void;\n\nexport type SyncNodes = (boardId: BoardId, nodes: Node[]) => Promise<boolean>;\n\nexport type SyncChangedNodes = (boardId: BoardId, nodes: Node[]) => Promise<boolean>;\n\nexport type SyncDeletedNodes = (boardId: BoardId, nodes: Node[]) => Promise<boolean>;\n\nexport enum CodyResponseType {\n    Info= 'Info',\n    Error = 'Error',\n    Warning = 'Warning',\n    Empty = 'Empty',\n    Question = 'Question',\n    StopSession = 'StopSession',\n    SyncRequired = 'SyncRequired',\n}\n\nexport interface CodyResponse {\n    cody: string | string[];\n    details?: string | string[];\n    type?: CodyResponseType;\n}\n\n","import {List} from \"immutable\";\nimport { call, delay, fork, put, race, select, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {Action as UserAction, IioUserInfo, IioUserInfoSelector, UserModel} from \"../../User\";\nimport {} from \"../../User\";\nimport * as Action from '../actions';\nimport {appendHistoryEntries, prependHistoryEntries} from \"../actions/commands\";\nimport {LOCAL_BOARD_CHANGED, REMOTE_BOARD_CHANGED} from \"../actions/constants\";\nimport {BoardId} from \"../model/Board\";\nimport {BoardChanged} from \"../model/BoardChanged\";\nimport {BoardHistory, HistoryEntry, makeHistoryEntry} from \"../model/HistoryEntry\";\nimport {BoardModel} from \"../model\";\n\ntype FlowAction = ActionType<typeof Action.Event.remoteBoardChanged> & ActionType<typeof Action.Event.localBoardChanged> & ActionType<typeof Action.Event.boardInitialized>;\ntype UserInfoLoaded = ActionType<typeof UserAction.Event.iioUsersInfoLoaded>;\n\nexport function* onBoardChanged(boardChangedList: BoardChanged[], prependEntries = false) {\n    let history: BoardHistory = List<HistoryEntry>();\n    let boardId: BoardId|undefined;\n\n    for(const boardChanged of boardChangedList) {\n        let iioUserInfo: IioUserInfo.IioUserInfo = yield select(IioUserInfoSelector.getIioUserInfoById, boardChanged.userId);\n        boardId = boardChanged.board;\n\n        if(!iioUserInfo) {\n            yield put(UserAction.Query.loadUsersInfo([boardChanged.userId]));\n\n            let noMatchingInfo = true;\n\n            while (noMatchingInfo) {\n                const {infoLoaded, timeout}: {infoLoaded: UserInfoLoaded, timeout: boolean} = yield race({\n                    infoLoaded: take([UserAction.Type.IIO_USERS_INFO_LOADED]),\n                    timeout: delay(5000)\n                });\n\n                if(timeout) {\n                    return;\n                }\n\n                infoLoaded.payload.usersInfo.forEach(loadedInfo => {\n                    if(loadedInfo.userId === boardChanged.userId) {\n                        iioUserInfo = loadedInfo;\n                        noMatchingInfo = false;\n                    }\n                });\n            }\n        }\n\n        const historyEntry = makeHistoryEntry(boardChanged, iioUserInfo);\n        if(prependEntries) {\n            history = history.unshift(historyEntry);\n        } else {\n            history = history.push(historyEntry);\n        }\n    }\n\n    if(boardId) {\n        if(prependEntries) {\n            yield put(prependHistoryEntries(boardId, history));\n        } else {\n            yield put(appendHistoryEntries(boardId, history));\n        }\n    }\n}\n\nexport function* prepareBoardHistoryFlow() {\n    let  latestBoardId: BoardModel.BoardId = '';\n\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.REMOTE_BOARD_CHANGED, Action.Type.LOCAL_BOARD_CHANGED, Action.Type.BOARD_INITIALIZED]);\n\n        switch (action.type) {\n            case Action.Type.BOARD_INITIALIZED:\n                latestBoardId = action.payload.board.uid;\n                break;\n            case REMOTE_BOARD_CHANGED:\n            case LOCAL_BOARD_CHANGED:\n                if(latestBoardId === action.payload.boardChanged.board) {\n                    yield fork(onBoardChanged, [action.payload.boardChanged], true);\n                }\n                break;\n\n        }\n    }\n}\n","import {List} from \"immutable\";\nimport { map } from 'lodash';\nimport { call, delay, fork, put, race, select, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport * as Action from \"../actions\";\nimport {\n    loadFirstBoardHistoryChunk,\n    loadNextBoardHistoryChunk,\n    setIsLoadingHistory,\n    setNoMoreHistoryAvailable\n} from \"../actions/commands\";\nimport {LOAD_FIRST_BOARD_HISTORY_CHUNK, LOAD_NEXT_BOARD_HISTORY_CHUNK} from \"../actions/constants\";\nimport {Board} from \"../model/Board\";\nimport {BoardChanged} from \"../model/BoardChanged\";\nimport {BoardHistory, HistoryAction, HistoryCellType} from \"../model/HistoryEntry\";\nimport {HistoryState} from \"../model/HistoryState\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport {makeBoardHistoryByIdSelector} from \"../selectors/boardHistory\";\nimport {onBoardChanged} from \"./prepareBoardHistoryFlow\";\nimport {BoardVersion} from \"../model/BoardVersion\";\n\ntype FlowAction = ActionType<typeof loadNextBoardHistoryChunk> & ActionType<typeof loadFirstBoardHistoryChunk>;\n\ninterface ServerPatch {\n    action: string;\n    boardId: string;\n    boardVersion: {\n        version: number;\n        userId: string;\n        head: null|boolean;\n    },\n    cellId: null|string;\n    cellLabel: string;\n    cellType: string;\n    patch: string[];\n    patchId: string;\n    recordedAt: string;\n    userId: string;\n}\n\nexport const marshalBoardChanged = (data: ServerPatch): BoardChanged => {\n    return new BoardChanged({\n        board: data.boardId,\n        cellId: data.cellId || undefined,\n        cellLabel: data.cellLabel,\n        cellType: data.cellType as HistoryCellType,\n        action: data.action as HistoryAction,\n        recordedAt: data.recordedAt,\n        userId: data.boardVersion.userId,\n        version: data.boardVersion.version,\n        changeSet: List(data.patch),\n        name: 'BoardChanged',\n        uid: data.patchId,\n    })\n};\n\nfunction* onLoadFirst(action: ActionType<typeof loadFirstBoardHistoryChunk>) {\n    const getBoardById = makeBoardByIdSelector(action.payload.boardId);\n    const getBoardHistory = makeBoardHistoryByIdSelector(action.payload.boardId);\n\n    const board: Board = yield select(getBoardById);\n    const history: HistoryState = yield select(getBoardHistory);\n\n    if(board && !history.loading) {\n        yield put(setIsLoadingHistory(action.payload.boardId, true));\n\n        const {response, error}: ResponseType = yield call(Action.Api.fetchOlderPatches, action.payload.boardId, board.version);\n\n        if(error) {\n            yield put(setNoMoreHistoryAvailable(action.payload.boardId));\n            yield put(setIsLoadingHistory(action.payload.boardId, false));\n            return;\n        }\n\n        if(response) {\n            const patches = map(response.data as any, (data: any) => marshalBoardChanged(data));\n\n            if(patches.length <= 1) {\n                yield put(setNoMoreHistoryAvailable(action.payload.boardId));\n            }\n\n            yield call(onBoardChanged, patches);\n        }\n\n        yield put(setIsLoadingHistory(action.payload.boardId, false));\n    }\n}\n\nfunction* onLoadNext(action: ActionType<typeof loadNextBoardHistoryChunk>) {\n\n    yield put(setIsLoadingHistory(action.payload.boardId, true));\n\n    const {response, error}: ResponseType = yield call(Action.Api.fetchOlderPatches, action.payload.boardId, action.payload.boardVersion);\n\n    if(error) {\n        yield put(setNoMoreHistoryAvailable(action.payload.boardId));\n        yield put(setIsLoadingHistory(action.payload.boardId, false));\n        return;\n    }\n\n    if(response) {\n        const patches = map(response.data as any, (data: any) => marshalBoardChanged(data));\n\n        if(patches.length <= 1) {\n            yield put(setNoMoreHistoryAvailable(action.payload.boardId));\n        }\n\n        yield call(onBoardChanged, patches)\n    }\n\n    yield put(setIsLoadingHistory(action.payload.boardId, false));\n}\n\n\nexport function* loadBoardHistoryFlow() {\n    while (true) {\n        const action: FlowAction = yield take([LOAD_FIRST_BOARD_HISTORY_CHUNK, LOAD_NEXT_BOARD_HISTORY_CHUNK]);\n\n        switch (action.type) {\n            case LOAD_NEXT_BOARD_HISTORY_CHUNK:\n                yield fork(onLoadNext, action);\n                break;\n            case LOAD_FIRST_BOARD_HISTORY_CHUNK:\n                yield fork(onLoadFirst, action);\n        }\n    }\n}\n","import {map} from \"lodash\";\nimport ConfiguredSocket from '../../api/ConfiguredSocket';\nimport {ResponseType} from \"../../api/util\";\nimport {getToken} from \"../../Auth/service/tokenCache\";\nimport {UserId, Username} from \"../../User/model/UserInfo\";\nimport {Api} from \"../actions\";\nimport { BoardSync } from '../model';\nimport {Board} from \"../model/Board\";\nimport {BoardVersion} from \"../model/BoardVersion\";\nimport {marshalBoardChanged} from \"../sagas/loadBoardHistoryFlow\";\n\ntype ConfiguredSocket = typeof ConfiguredSocket;\n\nexport class RealtimeBoardSync {\n    private socket: ConfiguredSocket;\n    private board: Board;\n    private userId: UserId;\n    private username: Username;\n    private localQueue: BoardSync.BoardChanged[] = [];\n    private incomingQueue: BoardSync.BoardChanged[] = [];\n    private lastProcessedVersion: number;\n    private lastRemoteVersion: number;\n    private reconnectListener: (attempts?: number) => void;\n    private isFetchingLatestPatches: boolean = false;\n    private onHandledRemoteEvent: (event: BoardSync.BoardChanged, syncInitialized: boolean) => void;\n    private onPublished: () => void;\n    private locked: boolean = false;\n    private initialized: boolean = false;\n\n    public constructor(socket: ConfiguredSocket, board: Board, userId: UserId, username: Username, onHandledRemoteEvent: (event: BoardSync.BoardChanged, syncInitialized: boolean) => void, onPublished: () => void) {\n        this.socket = socket;\n        this.board = board;\n        this.userId = userId;\n        this.username = username;\n        this.lastProcessedVersion = board.version.version;\n        this.lastRemoteVersion = board.version.version;\n        this.onHandledRemoteEvent = onHandledRemoteEvent;\n        this.onPublished = onPublished;\n        this.reconnectListener = (attempts?: number) => {\n            console.log(\"[BoardSync] Socket reconnected\");\n\n            if(this.socket.connected) {\n                this.restartSync();\n            } else if (!attempts || attempts < 10) {\n                console.log(\"[BoardSync] Socket not fully reconnected yet. Waiting another 100ms\");\n                window.setTimeout(() => {\n                    if(!attempts) {\n                        attempts = 1;\n                    }\n\n                    this.reconnectListener(attempts + 1);\n                }, 100);\n            } else {\n                console.log(\"[BoardSync] Socket is not coming back. Trying to force a reconnect\");\n                this.socket.disconnect();\n                this.socket.connect();\n                window.setTimeout(() => {\n                    this.reconnectListener();\n                }, 1000);\n            }\n        }\n    }\n\n    public isInitialized(): boolean {\n        return this.initialized;\n    }\n\n    public restartSync() {\n        const token = getToken();\n        this.socket.emit('BoardOpened', {\n            boardId: this.board.uid,\n            userId: this.userId,\n            username: this.username,\n            token,\n        });\n        this.loadAndProcessLatestPatchesFromServer();\n\n        if(this.localQueue.length >= 2) {\n            alert(\"Backend service is available again. Your changes will be saved now! Sorry for any inconvenient caused.\");\n        }\n\n        this.processLocalQueue();\n    }\n\n    public startSync() {\n        const init = () => {\n            const token = getToken();\n            console.log(\"[BoardSync] Socket connected\")\n            this.socket.emit('BoardOpened', {\n                boardId: this.board.uid,\n                userId: this.userId,\n                username: this.username,\n                token,\n            });\n        }\n\n        this.socket.on('BoardChanged', (event: BoardSync.RawBoardChangedProps) => {\n            this.handleBoardChanged(BoardSync.remoteBoardChanged(event));\n        })\n\n        this.socket.io.on('reconnect', this.reconnectListener);\n        this.socket.on('error', () => console.error('[BoardSync] Socket error occurred'));\n\n        if(this.socket.connected) {\n            init();\n        } else {\n            console.log(\"[BoardSync] Awaiting socket connect\")\n            this.socket.once('connect', init);\n        }\n\n        this.loadAndProcessLatestPatchesFromServer();\n    }\n\n    public stopSync() {\n        console.log(\"[BoardSync] Stopping sync\");\n        this.socket.off('BoardChanged');\n        this.socket.io.off('reconnect', this.reconnectListener);\n    }\n\n    public currentVersion(): number {\n        return this.lastProcessedVersion;\n    }\n\n    public publishChanges(event: BoardSync.BoardChanged, retry?: number) {\n\n        if(this.locked && !retry) {\n            console.log(\"[BoardSync] Sync is locked. Pushing event to local queue for later processing\", event.toBoardVersion().version);\n            this.localQueue.push(event);\n            return;\n        }\n\n        if(this.socket.connected) {\n            if(this.localQueue.length && !retry) {\n                console.log(\"[BoardSync] Processing local queue before publishing new change\")\n                this.processLocalQueue();\n                return;\n            }\n\n            if(!retry) {\n                this.locked = true;\n\n                window.setTimeout(() => {\n                    this.locked = false;\n                    this.processLocalQueue();\n                }, 500);\n            }\n\n            const eventData = event.toJS();\n            console.log(\"[BoardSync] Emitting new local changes\", eventData);\n            const token = getToken();\n            this.socket.emit('BoardChanged', {...eventData, token}, (res: {success: boolean, boardVersion?: number, error?: any}) => {\n                // @todo: handle negative ack received from server\n                if(!res.success) {\n                    console.error(\"[BoardSync] Local change was not saved by socket server. BE returned error: \", res.error)\n                    if(retry !== 3) {\n                        if(!retry) {\n                            retry = 0;\n                        }\n                        retry++;\n                        console.log(\"[BoardSync] Retrying event: \", eventData, \" retry count: \", retry);\n                        this.publishChanges(event, retry);\n                    }\n                } else {\n                    if(res.boardVersion && res.boardVersion === (this.lastProcessedVersion + 1) || res.boardVersion === (this.lastRemoteVersion + 1)) {\n                        this.lastProcessedVersion = res.boardVersion;\n                        if(res.boardVersion === (this.lastRemoteVersion + 1)) {\n                            this.lastRemoteVersion = res.boardVersion;\n                            console.log(\"[BoardSync] Remote version is up to date with processed version.\");\n                        }\n                        console.log(\"[BoardSync] Patch saved successfully. Last processed version set to: \", this.lastProcessedVersion);\n                    } else if (res.boardVersion && res.boardVersion > this.lastProcessedVersion) {\n                        this.lastProcessedVersion = res.boardVersion;\n                        console.log(\"[BoardSync] Patch saved successfully, but remote version is behind: \", this.lastProcessedVersion, this.lastRemoteVersion);\n                        console.log(\"[BoardSync] Only setting last processed version to keep gap detection active\");\n                    }\n                    this.onPublished();\n                }\n            })\n        } else {\n            console.log(\"[BoardSync] Socket not connected. Pushing change to local queue\");\n            this.localQueue.push(event);\n\n            if(this.localQueue.length === 2) {\n                alert(\"Connection to server lost. A reload might fix the problem. Otherwise, you can work offline and backup your work at the end by making an export (see top menu). We try to reconnect you as soon as possible!\")\n            }\n        }\n    }\n\n    private async loadAndProcessLatestPatchesFromServer(done?: () => void, err?: () => void) {\n        this.isFetchingLatestPatches = true;\n        console.log(\"[BoardSync] Going to fetch latest patches from server. Last remote version is: \", this.lastRemoteVersion);\n        const {response, error}: ResponseType = await Api.fetchNewerPatches(this.board.uid, new BoardVersion({userId: this.userId, version: this.lastRemoteVersion}));\n        this.isFetchingLatestPatches = false;\n\n        if(response) {\n            console.log(\"[BoardSync] Successfully loaded latest patches\");\n            const patches = map(response.data as any, (data: any) => marshalBoardChanged(data));\n\n            // On init all patches should be processed, after init only remote patches\n            patches.filter(patch => !this.initialized || patch.userId !== this.userId).forEach(patch => this.handleBoardChanged(patch, true));\n\n            // If called from init function, we can now set initialized: true\n            this.initialized = true;\n\n            console.log(\"[BoardSync] Processing incomingQueue now\");\n            const prevEvents = [...this.incomingQueue];\n            this.incomingQueue = [];\n            prevEvents.forEach(prevEvent => this.handleBoardChanged(prevEvent, true));\n\n            if(done) {\n                done();\n            }\n        }\n\n        if(error) {\n            console.error(\"[BoardSync] Failed to load latest patches: \", error);\n\n            if(err) {\n                err();\n            }\n\n            this.initialized = true;\n        }\n    }\n\n    private handleBoardChanged(event: BoardSync.BoardChanged, skipGapDetection?: boolean) {\n        if(this.isFetchingLatestPatches) {\n            console.log(\"[BoardSync] Fetching latest patches ATM. BoardChanged event is pushed to incomingQueue: \", event.toBoardVersion().version);\n            this.incomingQueue.push(event);\n            return;\n        }\n\n        if(this.lastRemoteVersion + 1 === event.toBoardVersion().version || (skipGapDetection && event.toBoardVersion().version > this.lastRemoteVersion)) {\n            this.lastRemoteVersion = event.toBoardVersion().version;\n            console.log(\"[BoardSync] Increased last remote version to: \", this.lastRemoteVersion);\n            if(this.lastRemoteVersion > this.lastProcessedVersion) {\n                console.log(\"[BoardSync] Last remote version is greater than last processed version. Setting remote version as processed version. \", this.lastRemoteVersion, this.lastProcessedVersion);\n                this.lastProcessedVersion = this.lastRemoteVersion;\n            }\n        } else if (this.lastRemoteVersion + 1 < event.toBoardVersion().version) {\n            // Gap detected\n            console.log(\"[BoardSync] Gap detected. Last remote version is: \", this.lastRemoteVersion, \" but received event with version: \", event.toBoardVersion().version);\n            console.log(\"[BoardSync] Fetching latest patches from server first. Event is pushed to incoming queue\");\n            this.incomingQueue.push(event);\n            this.loadAndProcessLatestPatchesFromServer();\n        } else {\n            // outdated event, ignore\n            console.warn(\"[BoardSync] Skipped outdated event. Last remote version is: \", this.lastRemoteVersion, \" but event has version: \", event.toBoardVersion().version);\n            return;\n        }\n\n        this.onHandledRemoteEvent(event, this.initialized);\n    }\n\n    private processLocalQueue(done?: () => void) {\n        console.log(\"[BoardSync] Processing local queue: \", this.localQueue.length);\n        const queue = [...this.localQueue];\n        this.localQueue = [];\n\n        queue.forEach(event => {\n            console.log(\"[BoardSync] Publishing event from local queue.\", event.toBoardVersion().version);\n            this.publishChanges(event);\n        })\n\n        if(done) {\n            done();\n        }\n    }\n}\n","import {BoardModel} from \"../../InspectioBoards/index\";\nimport {UserModel} from \"../../User/index\";\nimport {BoardTimerListener, MouseSync} from \"../hooks/useMouseSync\";\nimport {BoardTimer, BoardTimerProps, createBoardTimerFromServerData} from \"../model/BoardTimer\";\nimport ConfiguredSocket from '../../api/ConfiguredSocket';\n\nexport const MOUSE_MOVE_CHAN = 'MouseMove';\nexport const MOUSE_SCROLL_CHAN = 'MouseScroll';\nexport const MOUSE_JOINED_CHAN = 'MouseJoined';\nexport const MOUSE_LEFT_CHAN = 'MouseLeft';\nexport const GET_CURRENT_MOUSES = 'GetCurrentMouses';\nexport const GESTURE_CHANGED_CHAN = 'GestureChanged';\nexport const AUTO_SCROLL_CHAN = 'AutoScrolling';\n\nexport const BOARD_TIMER_STARTED_CHAN = 'BoardTimerStarted';\nexport const BOARD_TIMER_PAUSED_CHAN = 'BoardTimerPaused';\nexport const BOARD_TIMER_STOPPED_CHAN = 'BoardTimerStopped';\nexport const GET_ACTIVE_BOARD_TIMER = 'GetActiveBoardTimer';\n\nexport interface GraphPoint {\n    x: number;\n    y: number;\n}\n\nexport enum Gesture {\n    Default = 'Default',\n    Moving = 'Moving',\n    Typing = 'Typing',\n}\n\n\nexport interface UserMouseMove {\n    userId: UserModel.UserId;\n    boardId: BoardModel.BoardId;\n    point: GraphPoint;\n    vT: GraphPoint;\n    scale: number;\n    isPanning: boolean;\n}\n\nexport interface UserMouseScroll {\n    userId: UserModel.UserId;\n    boardId: BoardModel.BoardId;\n    vT: GraphPoint;\n    scale: number;\n}\n\nexport interface UserMouseJoined {\n    userId: UserModel.UserId;\n    boardId: BoardModel.BoardId;\n    name: UserModel.DisplayName;\n    avatar: UserModel.AvatarUrl;\n}\n\nexport interface UserMouseLeft {\n    userId: UserModel.UserId;\n    boardId: BoardModel.BoardId;\n}\n\nexport interface GestureChanged {\n    userId: UserModel.UserId;\n    boardId: BoardModel.BoardId;\n    gesture: Gesture;\n}\n\nexport interface AutoScrollEvent {\n    userId: UserModel.UserId;\n    boardId: BoardModel.BoardId;\n    scale: number;\n    translate: GraphPoint;\n    isPanning: boolean;\n}\n\nexport interface MouseDelta {\n    dx: number;\n    dy: number;\n    startX: number;\n    startY: number;\n}\n\nexport interface ActiveBoardTimerResponse {\n    timer: BoardTimerProps | null,\n    isPaused: boolean,\n}\n\nexport type UserJoinedListener = (userId: UserModel.UserId, name: UserModel.DisplayName, avatar: UserModel.AvatarUrl, color: Color) => void;\nexport type UserLeftListener = (userId: UserModel.UserId) => void;\n\ntype ConfiguredSocket = typeof ConfiguredSocket;\n\nexport type Color = string;\n\nconst ownColor = '#423fbc';\n\nconst colors = [\n    '#15A2B0',\n    '#715671',\n    '#CF3241',\n    '#ED6842',\n    '#EECA51',\n    '#1F8A6D',\n    '#dd3cd3',\n    '#1114dd',\n    '#7add3a',\n    '#dd8794',\n    '#b16fdd',\n    '#9fa0bb',\n    '#bad63c',\n    '#7886dd',\n    '#8510dd',\n    '#dd796d',\n];\n\nlet nextPointerColor = 0;\n\nconst makeNewPointer = (userName: UserModel.DisplayName): [HTMLElement, HTMLElement, Color] => {\n\n    const color = colors[nextPointerColor];\n    nextPointerColor++;\n\n    if(nextPointerColor === colors.length) {\n        nextPointerColor = 0;\n    }\n\n    const pointerDiv = document.createElement('div');\n    pointerDiv.className = 'geRemoteMouse';\n    pointerDiv.style.position = 'absolute';\n    pointerDiv.style.display = 'none';\n\n    const pointerP = document.createElement('p');\n\n    const pointer = document.createElement('i');\n    pointer.className = getPointerIconFromGesture(Gesture.Default) + ' icon';\n    pointer.style.color = color;\n    pointerP.appendChild(pointer)\n    pointerDiv.appendChild(pointerP);\n\n    const labelP = document.createElement('p');\n    labelP.className = 'geMouseLabel';\n    labelP.innerHTML = userName;\n    labelP.style.color = color;\n    pointerDiv.appendChild(labelP);\n    return [pointerDiv, pointer, color];\n};\n\nconst getPointerIconFromGesture = (gesture: Gesture): string => {\n    switch (gesture) {\n        case Gesture.Moving:\n            return 'hand rock';\n        case Gesture.Typing:\n            return 'keyboard';\n        default:\n            return 'user';\n    }\n};\n\nexport class RemoteMouseSync implements MouseSync {\n    private socket: ConfiguredSocket;\n    private container: HTMLElement;\n    private registry: {[key: string]: {userName: UserModel.Username, pointerEl: HTMLElement, pointerIcon: HTMLElement, color: Color, scale: number, translate: GraphPoint, lastKnownAbsolutePoint: GraphPoint}} = {};\n    private translateGraphPoint: (point: GraphPoint) => GraphPoint;\n    private graph: any;\n    private userJoinedListeners: UserJoinedListener[];\n    private userLeftListeners: UserLeftListener[];\n    private observedUser: UserModel.UserId | null;\n    private observingFrame: HTMLElement | null;\n    private lastMoveWasPanning: boolean;\n\n    private boardTimerStartedListeners: BoardTimerListener[];\n    private boardTimerPausedListeners: BoardTimerListener[];\n    private boardTimerStoppedListeners: BoardTimerListener[];\n    private activeBoardTimer: BoardTimer | undefined;\n    private isBoardTimerPaused: boolean = false;\n\n    private disconnectListener: any = null;\n    private reconnectListener: any = null;\n\n    private syncIntervalListener: any = null;\n\n    public constructor(\n        socket: ConfiguredSocket,\n        container: HTMLElement,\n        graph: any,\n        translateGraphPoint: (point: GraphPoint) => GraphPoint\n    ) {\n        this.socket = socket;\n        this.container = container;\n        this.translateGraphPoint = translateGraphPoint;\n        this.graph = graph;\n        this.userJoinedListeners = [];\n        this.userLeftListeners = [];\n        this.boardTimerStartedListeners = [];\n        this.boardTimerPausedListeners = [];\n        this.boardTimerStoppedListeners = [];\n        this.observedUser = null;\n        this.observingFrame = null;\n        this.lastMoveWasPanning = false;\n    }\n\n    public startSync(joined: UserMouseJoined) {\n        this.socket.on(MOUSE_JOINED_CHAN, (evt: UserMouseJoined) => {\n            console.log(\"[mousesync]: Start tracking of remote user: \", evt.userId);\n            this.trackMouseOfRemoteUser(evt.userId, evt.name, evt.avatar);\n        });\n\n        this.socket.on(MOUSE_LEFT_CHAN, (evt: UserMouseLeft) => {\n            console.log(\"[mousesync]: Stop tracking of remote user: \", evt.userId);\n            this.stopMouseTrackingOfUser(evt.userId);\n\n            // Verify that mouse really left chan and did not have network issues\n            this.socket.emit(\n                GET_CURRENT_MOUSES,\n                joined,\n                (evts: UserMouseJoined[]) => evts.forEach(joinedEvt => {\n                    if(!this.registry.hasOwnProperty(joinedEvt.userId)) {\n                        this.trackMouseOfRemoteUser(joinedEvt.userId, joinedEvt.name, joinedEvt.avatar)\n                    }\n                }));\n        });\n\n        this.socket.on(MOUSE_MOVE_CHAN, (move: UserMouseMove) => {\n            const {userId, point, vT, scale} = move;\n\n            if(this.registry.hasOwnProperty(userId)) {\n                const {pointerEl} = this.registry[userId];\n\n                pointerEl.style.display = 'block';\n\n                if(this.observedUser === userId) {\n                    this.graph.view.setScale(scale);\n                    this.graph.panGraph(move.vT.x, move.vT.y);\n                    this.graph.panningListeners.forEach((l: (translate: typeof move.vT) => void) => l(move.vT));\n                }\n\n                if(move.isPanning && this.observedUser === userId) {\n                    const absolutePoint = this.translateGraphPoint(point);\n                    pointerEl.style.left = absolutePoint.x + \"px\";\n                    pointerEl.style.top = absolutePoint.y + \"px\";\n                    this.registry[userId].lastKnownAbsolutePoint = absolutePoint;\n                }\n\n                if(!move.isPanning) {\n                    const absolutePoint = this.translateGraphPoint(point);\n                    pointerEl.style.left = absolutePoint.x + \"px\";\n                    pointerEl.style.top = absolutePoint.y + \"px\";\n                    this.registry[userId].lastKnownAbsolutePoint = absolutePoint;\n                }\n\n                this.registry[userId].translate = vT;\n                this.registry[userId].scale = scale;\n            }\n        });\n\n        this.socket.on(MOUSE_SCROLL_CHAN, (scroll: UserMouseScroll) => {\n            const {userId, scale, vT} = scroll;\n\n            if(this.registry.hasOwnProperty(userId)) {\n                if(this.observedUser === userId) {\n                    this.graph.view.setScale(scale);\n                    this.graph.panGraph(vT.x, vT.y);\n                    this.graph.triggerZoomListeners();\n                }\n\n                this.registry[userId].translate = vT;\n                this.registry[userId].scale = scale;\n            }\n        });\n\n        this.socket.on(GESTURE_CHANGED_CHAN, (gestureChanged: GestureChanged) => {\n            const {userId, gesture} = gestureChanged;\n\n            if(this.registry.hasOwnProperty(userId)) {\n                const {pointerIcon} = this.registry[userId];\n                pointerIcon.className = getPointerIconFromGesture(gestureChanged.gesture) + ' icon';\n            }\n        });\n\n        this.socket.on(AUTO_SCROLL_CHAN, (autoScrollEvent: AutoScrollEvent) => {\n            const {userId, translate, scale, isPanning} = autoScrollEvent;\n\n            if(this.registry.hasOwnProperty(userId)) {\n                if(this.observedUser === userId) {\n                    this.graph.view.setScale(scale);\n                    this.graph.panGraph(translate.x, translate.y);\n                }\n\n                this.registry[userId].translate = translate;\n                this.registry[userId].scale = scale;\n            }\n        });\n\n        this.socket.on(BOARD_TIMER_STARTED_CHAN, (timer: BoardTimerProps) => {\n            const boardTimer = new BoardTimer(timer);\n            console.log(\"[mousesync] Received board timer started: \", timer);\n            this.boardTimerStartedListeners.forEach(l => l(boardTimer));\n            this.activeBoardTimer = boardTimer;\n            this.isBoardTimerPaused = false;\n        })\n\n        this.socket.on(BOARD_TIMER_PAUSED_CHAN, (timer: BoardTimerProps) => {\n            const boardTimer = new BoardTimer(timer);\n            console.log(\"[mousesync] Received board timer paused: \", timer);\n            this.boardTimerPausedListeners.forEach(l => l(boardTimer));\n            this.activeBoardTimer = boardTimer;\n            this.isBoardTimerPaused = true;\n        })\n\n        this.socket.on(BOARD_TIMER_STOPPED_CHAN, (timer: BoardTimerProps) => {\n            const boardTimer = new BoardTimer(timer);\n            console.log(\"[mousesync] Received board timer stopped: \", timer);\n            this.activeBoardTimer = undefined;\n            this.isBoardTimerPaused = false;\n            this.boardTimerStoppedListeners.forEach(l => l(boardTimer));\n        })\n\n        this.disconnectListener = () => {\n            console.log(\"[mousesync] MouseSync socket disconnected\");\n            for(const uid in this.registry) {\n                if(this.registry.hasOwnProperty(uid)) {\n                    this.stopMouseTrackingOfUser(uid);\n                }\n            }\n\n        };\n\n        this.socket.on('disconnect', this.disconnectListener);\n\n        const syncWithServer = (triggerJoinedListeners: boolean) => {\n            this.socket.emit(\n              GET_CURRENT_MOUSES,\n              joined,\n              (evts: UserMouseJoined[]) => evts.forEach(joinedEvt => this.trackMouseOfRemoteUser(joinedEvt.userId, joinedEvt.name, joinedEvt.avatar)));\n\n            this.socket.emit(\n              GET_ACTIVE_BOARD_TIMER,\n              {board: joined.boardId},\n              (res: ActiveBoardTimerResponse) => {\n                  this.activeBoardTimer = res.timer? new BoardTimer(res.timer) : undefined;\n                  this.isBoardTimerPaused = res.isPaused;\n\n                  if(triggerJoinedListeners && this.boardTimerStartedListeners.length && this.activeBoardTimer) {\n                      console.log(\"[mousesync] Calling board timer started listeners with: \", res);\n                      this.boardTimerStartedListeners.forEach(l => l(this.activeBoardTimer!))\n                  }\n\n                  if(this.isBoardTimerPaused && triggerJoinedListeners && this.boardTimerPausedListeners.length && this.activeBoardTimer) {\n                      this.boardTimerPausedListeners.forEach(l => l(this.activeBoardTimer!))\n                  }\n              }\n            )\n        }\n\n        const init = (triggerJoinedListeners: boolean) => {\n            if(triggerJoinedListeners) {\n                this.userJoinedListeners.forEach(li => li(joined.userId, joined.name, joined.avatar, ownColor));\n            }\n\n            console.log(\"[mousesync]: Sending mouse joined event: \", joined);\n            this.socket.emit(MOUSE_JOINED_CHAN, joined);\n\n            syncWithServer(triggerJoinedListeners);\n        };\n\n        this.reconnectListener = () => {\n            console.log(\"[mousesync] MouseSync socket reconnected\");\n\n            if(this.activeBoardTimer && this.activeBoardTimer.moderator === joined.userId) {\n                this.startBoardTimer(this.activeBoardTimer);\n                if(this.isBoardTimerPaused) {\n                    this.pauseBoardTimer(this.activeBoardTimer);\n                }\n            }\n\n            init(false);\n        }\n\n        this.socket.io.on('reconnect', this.reconnectListener);\n\n        if(this.socket.connected) {\n            init(true);\n        } else {\n            this.socket.once('connect', () => {\n                init(true);\n            })\n        }\n\n        this.syncIntervalListener = setInterval(() => {\n            if(this.socket.connected) {\n                syncWithServer(false);\n            }\n        }, 30000);\n    }\n\n    public stopSync(left: UserMouseLeft) {\n        console.log(\"[mousesync] stop sync\");\n        this.socket.emit(MOUSE_LEFT_CHAN, left);\n        this.socket.off(MOUSE_JOINED_CHAN);\n        this.socket.off(MOUSE_MOVE_CHAN);\n        this.socket.off(MOUSE_SCROLL_CHAN);\n        this.socket.off(MOUSE_LEFT_CHAN);\n        this.socket.off(GESTURE_CHANGED_CHAN);\n        this.socket.off(AUTO_SCROLL_CHAN);\n        this.socket.off(BOARD_TIMER_STARTED_CHAN);\n        this.socket.off(BOARD_TIMER_PAUSED_CHAN);\n        this.socket.off(BOARD_TIMER_STOPPED_CHAN);\n\n        if(this.reconnectListener) {\n            this.socket.off('reconnect', this.reconnectListener);\n        }\n        if(this.disconnectListener) {\n            this.socket.off('disconnect', this.disconnectListener);\n        }\n\n        if(this.syncIntervalListener) {\n            clearInterval(this.syncIntervalListener);\n            this.syncIntervalListener = null;\n        }\n\n        this.registry = {};\n        this.observedUser = null;\n        this.lastMoveWasPanning = false;\n        this.activeBoardTimer = undefined;\n        this.isBoardTimerPaused = false;\n        this.userJoinedListeners = [];\n        this.userLeftListeners = [];\n        this.boardTimerStartedListeners = [];\n        this.boardTimerPausedListeners = [];\n        this.boardTimerStoppedListeners = [];\n        document.getElementById('topmenu')!.style.borderColor = null;\n    }\n\n    public keepMousePositionsInPlaceOnPanning(move: UserMouseMove, mouseDelta: MouseDelta): void\n    {\n        for(const userId in this.registry) {\n            if(this.registry.hasOwnProperty(userId)) {\n                const {pointerEl, lastKnownAbsolutePoint} = this.registry[userId];\n                pointerEl.style.left = lastKnownAbsolutePoint.x + Math.round(mouseDelta.dx) + 'px';\n                pointerEl.style.top = lastKnownAbsolutePoint.y + Math.round(mouseDelta.dy) + 'px';\n            }\n        }\n    }\n\n    public syncLastKnownAbsolutePointsAfterPanning(): void\n    {\n        for(const userId in this.registry) {\n            if(this.registry.hasOwnProperty(userId)) {\n                const {pointerEl} = this.registry[userId];\n\n                this.registry[userId].lastKnownAbsolutePoint = {\n                    x: parseInt(pointerEl.style.left as string, undefined),\n                    y: parseInt(pointerEl.style.top as string, undefined)\n                };\n            }\n        }\n    }\n\n    public emitUserMouseMove(move: UserMouseMove, mouseDelta?: MouseDelta): void\n    {\n        if(move.isPanning && mouseDelta) {\n            this.keepMousePositionsInPlaceOnPanning(move, mouseDelta);\n            this.lastMoveWasPanning = true;\n        } else {\n            if(this.lastMoveWasPanning) {\n                this.syncLastKnownAbsolutePointsAfterPanning();\n            }\n        }\n        this.socket.emit(MOUSE_MOVE_CHAN, move);\n    }\n\n    public emitUserMouseScroll(scroll: UserMouseScroll): void\n    {\n        this.socket.emit(MOUSE_SCROLL_CHAN, scroll);\n    }\n\n    public emitUserGestureChanged(gestureChanged: GestureChanged): void\n    {\n        this.socket.emit(GESTURE_CHANGED_CHAN, gestureChanged);\n    }\n\n    public emitUserIsAutoScrolling(autoScrollEvent: AutoScrollEvent): void\n    {\n        this.socket.emit(AUTO_SCROLL_CHAN, autoScrollEvent);\n    }\n\n    public trackMouseOfRemoteUser(userId: UserModel.UserId, userName: UserModel.Username, avatar: UserModel.AvatarUrl): void {\n        console.log(\"[mousesync] track mouse of remote user: \", userId, \" in registry \", this.registry.hasOwnProperty(userId));\n        // Return if we already know that user\n        if(this.registry.hasOwnProperty(userId)) {\n            if(this.observedUser === userId) {\n                this.observeUser(userId);\n            }\n            return;\n        }\n\n        const [pointerDiv, pointerI, color] = makeNewPointer(userName);\n        this.registry[userId] = {\n            userName,\n            pointerEl: pointerDiv,\n            pointerIcon: pointerI,\n            color,\n            scale: 0.2,\n            translate: {x: 0, y: 0},\n            lastKnownAbsolutePoint: {x: 0, y: 0}\n        };\n        this.container.appendChild(pointerDiv);\n\n        if(this.observedUser === userId) {\n            this.observeUser(userId);\n        }\n\n        this.userJoinedListeners.forEach(li => li(userId, userName, avatar, color));\n    }\n\n    public stopMouseTrackingOfUser(userId: UserModel.UserId): void {\n        console.log(\"[mousesync] stop mouse tracking of user\", userId, \"in regsitry \", this.registry.hasOwnProperty(userId));\n        if(this.registry.hasOwnProperty(userId)) {\n            const {pointerEl} = this.registry[userId];\n            this.container.removeChild(pointerEl);\n            delete this.registry[userId];\n            if(this.observedUser === userId) {\n                this.hideObservingFrame();\n            }\n            this.userLeftListeners.forEach(li => li(userId));\n        }\n    }\n\n    public observeUser(userId: UserModel.UserId): void {\n        if(this.observingFrame) {\n            this.observingFrame.remove();\n        }\n\n        console.log(\"[mousesync] observe user\", userId, \"in registry\", this.registry.hasOwnProperty(userId));\n        if(this.registry.hasOwnProperty(userId)) {\n            this.observedUser = userId;\n            const {userName, color, translate, scale} = this.registry[userId];\n\n            document.getElementById('topmenu')!.style.borderColor = color;\n            const frame = document.createElement('div');\n            frame.classList.add('observing', 'frame');\n            frame.style.borderColor = color;\n\n            const label = document.createElement('div');\n            label.classList.add('label');\n            label.innerText = 'Observing ' + userName;\n            label.style.backgroundColor = color;\n            label.style.color = '#fff';\n            frame.append(label);\n            this.graph.container.append(frame);\n            this.observingFrame = frame;\n\n            if(translate.x !== 0 && translate.y !== 0) {\n                this.graph.view.setScale(scale);\n                this.graph.panGraph(translate.x, translate.y);\n            }\n        }\n    }\n\n    public hideObservingFrame(): void {\n        if(this.observingFrame) {\n            this.observingFrame.remove();\n            this.observingFrame = null;\n            document.getElementById('topmenu')!.style.borderColor = null;\n        }\n    }\n\n    public stopObservingUser(): void {\n        console.log(\"[mousesync] stop oberving user\");\n        this.observedUser = null;\n        this.hideObservingFrame();\n    }\n\n    public onUserJoined(listener: UserJoinedListener): void {\n        console.log(\"[mousesync] attach user joined listener\");\n        this.userJoinedListeners.push(listener);\n    }\n\n    public offUserJoined(listener: UserJoinedListener): void {\n        this.userJoinedListeners = this.userJoinedListeners.filter(l => l !== listener);\n    }\n\n    public onUserLeft(listener: UserLeftListener): void {\n        console.log(\"[mousesync] attach user left listener\");\n        this.userLeftListeners.push(listener);\n    }\n\n    public offUserLeft(listener: UserLeftListener): void {\n        this.userLeftListeners = this.userLeftListeners.filter(l => l !== listener);\n    }\n\n    public onBoardTimerPaused(listener: BoardTimerListener): void {\n        this.boardTimerPausedListeners.push(listener);\n\n        if(this.activeBoardTimer && this.isBoardTimerPaused) {\n            listener(this.activeBoardTimer);\n        }\n    }\n\n    public offBoardTimerPaused(listener: BoardTimerListener) {\n        this.boardTimerPausedListeners = this.boardTimerPausedListeners.filter(l => l !== listener);\n    }\n\n    public onBoardTimerStarted(listener: BoardTimerListener): void {\n        this.boardTimerStartedListeners.push(listener);\n        if(this.activeBoardTimer) {\n            console.log(\"[mousesync] Trigger board timer started listener with active timer: \", this.activeBoardTimer.toJS())\n            listener(this.activeBoardTimer);\n        }\n    }\n\n    public offBoardTimerStarted(listener: BoardTimerListener) {\n        this.boardTimerStartedListeners = this.boardTimerStartedListeners.filter(l => l !== listener);\n    }\n\n    public onBoardTimerStopped(listener: BoardTimerListener): void {\n        this.boardTimerStoppedListeners.push(listener);\n    }\n\n    public offBoardTimerStopped(listener: BoardTimerListener) {\n        this.boardTimerStoppedListeners = this.boardTimerStoppedListeners.filter(l => l !== listener);\n    }\n\n    public pauseBoardTimer(timer: BoardTimer): void {\n        this.socket.emit(BOARD_TIMER_PAUSED_CHAN, timer.toJS());\n        this.activeBoardTimer = timer;\n        this.isBoardTimerPaused = true;\n    }\n\n    public startBoardTimer(timer: BoardTimer): void {\n        this.socket.emit(BOARD_TIMER_STARTED_CHAN, timer.toJS());\n        this.activeBoardTimer = timer;\n        this.isBoardTimerPaused = false;\n    }\n\n    public stopBoardTimer(timer: BoardTimer): void {\n        this.socket.emit(BOARD_TIMER_STOPPED_CHAN, timer.toJS());\n        this.activeBoardTimer = undefined;\n        this.isBoardTimerPaused = false;\n    }\n}\n\n\n\n","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {BoardId} from \"./Board\";\n\nexport const AGGREGATE_TYPE = 'BoardTimer';\n\nexport type BoardTimerId = string;\nexport type BoardTimerError = string;\n\nexport interface BoardTimerProps {\n    uid: BoardTimerId;\n    board: BoardId\n    aggregateType: AggregateType;\n    deadline: number;\n    duration: number;\n    moderator: UserId;\n    pausedTime?: [number, number, number];\n}\n\nexport const defaultBoardTimerProps: BoardTimerProps = {\n    uid: '',\n    board: '',\n    aggregateType: AGGREGATE_TYPE,\n    deadline: 0,\n    duration: 0,\n    moderator: '',\n    pausedTime: undefined,\n};\n\nexport const createBoardTimer = (board: BoardId, deadline: number, duration: number, moderator: UserId, pausedTime?: [number, number, number]): BoardTimer => {\n    return new BoardTimer({\n        uid: '',\n        aggregateType: AGGREGATE_TYPE,\n        board,\n        deadline,\n        duration,\n        moderator,\n        pausedTime\n    })\n}\n\nexport const createBoardTimerFromServerData = (data: any): Either<BoardTimerError, BoardTimer> => {\n    const validatedData: Either<BoardTimerError, any> = validate(data,\n        [hasKey('boardTimerId'), \"boardTimerId missing\"],\n    );\n\n    if (isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new BoardTimer({\n        ...defaultBoardTimerProps,\n        ...data,\n        uid: data.boardTimerId,\n    }));\n};\n\nexport class BoardTimer extends Record(defaultBoardTimerProps) implements BoardTimerProps, Aggregate {\n    public constructor(data: BoardTimerProps) {\n        if (data.uid === '') {\n            data.uid = uuid.v4()\n        }\n\n        super(data);\n    }\n\n    // @TODO add use case methods to change state\n}\n","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {BoardId} from \"../model/Board\";\nimport {BoardGraphElement, GraphElementType} from \"../model/BoardGraphElement\";\nimport {BoardGraphElementsState} from \"../reducers/applyBoardGraphElementActions\";\n\nexport const boardGraphElementsSelector = (state: Record<ApplicationState>, props: any): BoardGraphElementsState =>\n    state.getIn([MODULE, 'boardGraphElements']);\n\nexport const makeBoardGraphElementsSelector = (boardId: BoardId, type?: GraphElementType): (state: Record<ApplicationState>, props?: any) => List<BoardGraphElement>|null => {\n    return createSelector(\n        [boardGraphElementsSelector],\n        (boardGraphElements): List<BoardGraphElement>|null => {\n            if (!boardGraphElements.has(boardId)) {\n                return null;\n            }\n\n            const elements = List(boardGraphElements.get(boardId)!.toIndexedSeq().toArray());\n            return type ? elements.filter(element => element.type === type) : elements;\n        }\n    )\n};\n","import * as React from 'react';\nimport {useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Dropdown, DropdownProps, Modal} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\nimport {BoardId} from \"../model/Board\";\nimport {GraphElementType} from \"../model/BoardGraphElement\";\nimport {HistoryCellType} from \"../model/HistoryEntry\";\nimport {makeBoardGraphElementsSelector} from \"../selectors/boardGraphElement\";\nimport {makeGetAllBoards} from \"../selectors/boardList\";\nimport CellIcon from \"./CellIcon\";\n\n\ninterface OwnProps {\n    boardId: BoardId\n    openHandle: (handle: (open: boolean, currentLink: null|string) => void) => void;\n    onCancel: () => void;\n    onLinkChosen: (link: string) => void;\n}\n\ntype MxGraphBoardLinkProps = OwnProps & WithNamespaces;\n\nconst MxGraphBoardLink = (props: MxGraphBoardLinkProps) => {\n    const dispatch = useDispatch();\n    const [selectedBoard, setSelectedBoard] = useState('');\n    const [selectedEvent, setSelectedEvent] = useState<string|undefined>(undefined);\n    const [open, setOpen] = useState(false);\n    const boards = useSelector(makeGetAllBoards());\n    const boardGraphElements = useSelector(makeBoardGraphElementsSelector(selectedBoard, GraphElementType.event));\n    const featureToggle = false;\n\n    const boardChoices = boards.filter(board => board.uid !== props.boardId).map(board => ({\n        key: board.uid,\n        value: board.uid,\n        text: board.name,\n    })).toArray();\n    const eventChoices = boardGraphElements ? boardGraphElements.toArray().map(element => ({\n        text: element.name,\n        value: element.uid,\n        icon: <CellIcon cellType={element.type as string as HistoryCellType} />\n    })) : [];\n\n    props.openHandle((openFromHandle, currentLink) => {\n        if(currentLink) {\n            selectBoard(Routes.getBoardUidFromWorkspaceUrl(currentLink));\n        }\n        setOpen(openFromHandle);\n    });\n\n    const selectBoard = (value: string) => {\n        setSelectedBoard(value);\n        setSelectedEvent(undefined);\n\n        if (value.length === 36) {\n            // dispatch(fetchBoardGraphElements(value, GraphElementType.event));\n        }\n    };\n\n    const handleBoardChange = (e: React.SyntheticEvent, dProps: DropdownProps) => {\n        selectBoard(dProps.value as string);\n    };\n\n    const handleEventChange = (e: React.SyntheticEvent, dProps: DropdownProps) => {\n        setSelectedEvent(dProps.value as string)\n    };\n\n    const cancel = () => {\n        props.onCancel();\n        resetModal();\n    };\n\n    const resetModal = () => {\n        setSelectedBoard('');\n        setSelectedEvent(undefined);\n    };\n\n    const chooseLink = () => {\n        if(selectedBoard !== '') {\n            props.onLinkChosen(Routes.compileInspectioBoardWorkspace(selectedBoard));\n        } else {\n            props.onLinkChosen('');\n        }\n\n        resetModal();\n    };\n\n    // @ts-ignore\n    // @ts-ignore\n    return (\n        <Modal open={open} onClose={cancel} closeIcon={true}>\n            <Modal.Header>{props.t('insp.board.link.headline')}</Modal.Header>\n            <Modal.Content image={true}>\n                <Dropdown\n                    placeholder={props.t('insp.board.link.select_board') as string}\n                    fluid={true}\n                    search={true}\n                    selection={true}\n                    options={boardChoices}\n                    onChange={handleBoardChange}\n                    value={selectedBoard}\n                    clearable={true}\n                    style={{ marginRight: '10px' }}\n                />\n                {featureToggle && <Dropdown\n                    placeholder={props.t('insp.board.link.select_event') as string}\n                    fluid={true}\n                    search={true}\n                    selection={true}\n                    clearable={true}\n                    options={eventChoices}\n                    value={selectedEvent}\n                    onChange={handleEventChange}\n                    style={{ marginLeft: '10px' }}\n                />}\n\n            </Modal.Content>\n            <Modal.Actions>\n                <Button\n                    children={props.t('app.form.cancel')}\n                    onClick={cancel}\n                />\n                <Button\n                    primary={true}\n                    children={props.t('app.form.save')}\n                    onClick={chooseLink}\n                />\n            </Modal.Actions>\n        </Modal>\n    );\n};\n\nexport default withNamespaces()(MxGraphBoardLink);\n","import {readFileArrayBuffer} from \"./readFile\";\n\nexport interface Crop {\n    x: number; // Left margin; e.g. 0.1 => 10% margin from the left\n    y: number; // Top margin\n    width: number; // Image width; e.g. 0.5 => 50% of original width\n    height: number; // Image height\n}\n\n/**\n * Takes the image in the HTMLImageElement provided and maps it into a canvas according to the crop value provided.\n * The returned canvas can then be exported as needed.\n *\n * @param image\n * @param crop\n */\nconst createCropCanvas = (image: HTMLImageElement, crop: Crop): HTMLCanvasElement => {\n    const cropStartX = Math.round(crop.x * 0.01 * image.naturalWidth);\n    const cropStartY = Math.round(crop.y * 0.01 * image.naturalHeight);\n    const newWidth = Math.round(crop.width * 0.01 * image.naturalWidth);\n    const newHeight = Math.round(crop.height * 0.01 * image.naturalHeight);\n\n    const canvas = document.createElement('canvas');\n    canvas.width = newWidth;\n    canvas.height = newHeight;\n\n    const ctx = canvas.getContext('2d')!;\n    ctx.drawImage(image, cropStartX, cropStartY, newWidth, newHeight, 0, 0, newWidth, newHeight);\n\n    return canvas;\n};\n\nexport const getCroppedImageBase64 = (image: HTMLImageElement, crop: Crop, mimeType: string): string => {\n    return createCropCanvas(image, crop).toDataURL(mimeType);\n};\n\nexport const getCroppedImageArrayBuffer = (image: HTMLImageElement, crop: Crop, mimeType: string): Promise<ArrayBuffer> => {\n    return new Promise(async (resolve, reject) => {\n        createCropCanvas(image, crop).toBlob(\n            blob => {\n                if (!blob) {\n                    reject();\n                }\n\n                resolve(readFileArrayBuffer(blob as File));\n            },\n            mimeType\n        );\n    });\n};\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport Dropzone from \"react-dropzone\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport ReactCrop from \"react-image-crop\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Modal} from \"semantic-ui-react\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Api} from \"../actions\";\nimport {BoardId} from \"../model/Board\";\nimport {isStandalone} from \"../../standalone/util\";\nimport {readFile, readFileArrayBuffer, readFileBase64} from \"../../core/readFile\";\nimport {Crop, getCroppedImageArrayBuffer, getCroppedImageBase64} from \"../../core/imageCrop\";\n\nconst INITIAL_CROP = { aspect: 0, unit: '%' as '%', x: 0, y: 0, width: 100, height: 100 };\nconst ACCEPTED_IMAGE_TYPES = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/svg+xml'];\nconst CROP_IMAGE_TYPES = ['image/jpeg', 'image/png', 'image/webp'];\nconst MAX_UPLOAD_SIZE = 5 * 1024 * 1024; // 5MB\n\ninterface OwnProps {\n    boardId: BoardId;\n    openHandle: (handle: (open: boolean, imageId: string|null) => void) => void;\n    onCancel: () => void;\n    onFileUploaded: (imgName: string, imgUrl: string, width: number, height: number) => void;\n}\n\nexport interface CropData {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n}\n\ntype MxGraphImageUploadProps = OwnProps & WithNamespaces;\n\nconst MxGraphImageUpload = (props: MxGraphImageUploadProps) => {\n    const [imageId, setImageId] = useState<string|null>(null);\n    const [crop, setCrop] = useState<ReactCrop.PercentCrop>(INITIAL_CROP);\n    const [file, setFile] = useState<undefined|{ file: File, src: string }>(undefined);\n    const [image, setImage] = useState<undefined|HTMLImageElement>(undefined);\n    const [open, setOpen] = useState(false);\n    const [uploading, setUploading] = useState(false);\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        focusPasteInput();\n\n        // Make sure that the mxGraph cell does not steal the focus\n        setTimeout(focusPasteInput, 1000);\n    });\n\n    props.openHandle((openFromHandle, currentImageId) => {\n        setImageId(typeof currentImageId === 'string' ? currentImageId : null);\n        setOpen(openFromHandle);\n    });\n\n    const onFileSelected = (acceptedFiles: File[]) => {\n        if (acceptedFiles.length < 1) {\n            dispatch(NotifyAction.Command.error(\n                props.t('insp.board.upload.upload_failed_title'),\n                props.t('insp.board.upload.upload_failed_text')\n            ));\n            return;\n        }\n\n        setFile({ file: acceptedFiles[0], src: URL.createObjectURL(acceptedFiles[0]) });\n    };\n\n    const cancel = () => {\n        props.onCancel();\n        resetModal();\n    };\n\n    const resetModal = () => {\n        setFile(undefined);\n        setImage(undefined);\n        setCrop(INITIAL_CROP);\n        setUploading(false);\n    };\n\n    const upload = async () => {\n        if (!file) {\n            return;\n        }\n\n        setUploading(true);\n        const isCroppedImage = CROP_IMAGE_TYPES.includes(file.file.type);\n        const isVectorGraphic = file.file.type === 'image/svg+xml';\n        const imageWidth = image ? image.width : 0;\n        const imageHeight = image ? image.height : 0;\n\n        if (isStandalone()) {\n            // mxGraph seems to add the `;base64` internally which is why they are removed here\n            const imageDataURL = isCroppedImage\n                ? getCroppedImageBase64(image!, crop as Crop, file.file.type).replace(';base64', '')\n                : isVectorGraphic\n                    ? 'data:image/svg+xml,' + await readFile(file.file)\n                    : (await readFileBase64(file.file)).replace(';base64', '');\n\n            props.onFileUploaded(file!.file.name, imageDataURL, imageWidth, imageHeight);\n            resetModal();\n            return;\n        }\n\n        const imageData = isCroppedImage\n            ? await getCroppedImageArrayBuffer(image!, crop as Crop, file.file.type)\n            : isVectorGraphic ? await readFile(file.file) : await readFileArrayBuffer(file.file);\n\n        (imageId ? replaceImage : uploadNewImage)(imageData, file.file.type, imageWidth, imageHeight);\n    };\n\n    const uploadNewImage = (data: string|ArrayBuffer, mimeType: string, imageWidth: number, imageHeight: number) => {\n        Api.uploadBoardImage(props.boardId, data, mimeType)\n            .then((response) => {\n                props.onFileUploaded(file!.file.name, `/buckets/boards/${props.boardId}/${response.data.imageId}`, imageWidth, imageHeight);\n            })\n            .catch(imageUploadErrorHandler)\n            .finally(resetModal);\n    };\n\n    const replaceImage = (data: string|ArrayBuffer, mimeType: string, imageWidth: number, imageHeight: number) => {\n        Api.replaceBoardImage(props.boardId, imageId!, data, mimeType)\n            .then((response) => {\n                props.onFileUploaded(file!.file.name, `/buckets/boards/${props.boardId}/${imageId}`, imageWidth, imageHeight);\n            })\n            .catch(imageUploadErrorHandler)\n            .finally(resetModal);\n    };\n\n    const imageUploadErrorHandler = () => {\n        dispatch(NotifyAction.Command.error(\n            props.t('insp.board.upload.upload_failed_title'),\n            props.t('insp.board.upload.upload_failed_text')\n        ));\n        cancel();\n    };\n\n    const handlePaste = (event: React.ClipboardEvent) => {\n        event.preventDefault();\n        const items: DataTransferItemList = event.clipboardData.items;\n        let blob = null;\n\n        /* tslint:disable-next-line:prefer-for-of */\n        for (let i = 0; i < items.length; i++) {\n            const item: DataTransferItem = items[i];\n\n            if (item.type === 'image/jpeg' || item.type === 'image/png') {\n                blob = item.getAsFile();\n                break;\n            }\n        }\n\n        if (null === blob) {\n            dispatch(NotifyAction.Command.error(\n                props.t('insp.board.upload.paste_failed'),\n                props.t('insp.board.upload.invalid_file_pasted')\n            ));\n            return;\n        }\n\n        onFileSelected([blob]);\n    };\n\n    const focusPasteInput = () => {\n        const element = document.getElementById('imageUploadPasteInput');\n        if (element) {\n            element.focus();\n        }\n    };\n\n    return (\n        <Modal open={open} onClose={cancel} closeIcon={true} onClick={focusPasteInput}>\n            <Modal.Header>{props.t('insp.board.upload.select_image')}</Modal.Header>\n            <Modal.Content image={true} onPaste={handlePaste}>\n                <Dropzone onDrop={onFileSelected} disabled={!!file} accept={ACCEPTED_IMAGE_TYPES} maxFiles={1} maxSize={MAX_UPLOAD_SIZE} multiple={false}>\n                    {({getRootProps, getInputProps}) => (\n                        <section style={{ height: '410px', width: '100%' }}>\n                            <div {...getRootProps()} style={{ width: '100%', height: '100%', padding: '1px' }}>\n                                {(file && CROP_IMAGE_TYPES.includes(file.file.type)) && (\n                                    <ReactCrop\n                                        style={{ maxWidth: \"100%\", maxHeight: \"400px\" }}\n                                        imageStyle={{ maxWidth: \"100%\", maxHeight: \"400px\" }}\n                                        src={file.src as any}\n                                        crop={crop}\n                                        onChange={(newCrop: any, newPercentCrop: any) => setCrop(newPercentCrop)}\n                                        onImageLoaded={setImage}\n                                    />\n                                )}\n                                {(file && !CROP_IMAGE_TYPES.includes(file.file.type)) && (\n                                    <img src={URL.createObjectURL(file.file)} />\n                                )}\n                                {!file && (\n                                    <div>\n                                        <input id={'imageUploadPasteInput'} type={'text'} style={{ position: 'fixed', left: '-10000px' }} />\n                                        <input {...getInputProps()} />\n                                        <p>{props.t('insp.board.upload.drag_and_drop_info')}</p>\n                                    </div>\n                                )}\n                            </div>\n                        </section>\n                    )}\n                </Dropzone>\n            </Modal.Content>\n            <Modal.Actions>\n                <Button\n                    children={props.t('app.form.cancel')}\n                    onClick={cancel}\n                />\n                <Button\n                    primary={true}\n                    children={props.t('app.form.save')}\n                    onClick={upload}\n                    loading={uploading}\n                />\n            </Modal.Actions>\n        </Modal>\n    );\n};\n\nexport default withNamespaces()(MxGraphImageUpload);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button, Dropdown, Icon, Input, InputOnChangeData, Modal} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\n\ninterface OwnProps {\n    openHandle: (handle: (open: boolean, currentLink: null|string) => void) => void;\n    onCancel: () => void;\n    onLinkChosen: (link: string) => void;\n}\n\ntype MxGraphTaskLinkProps = OwnProps & WithNamespaces;\n\nconst validateUrl = (url: string): boolean => {\n    if(url === \"\") {\n        return true;\n    }\n    return url.match(/^https?:\\/\\/.+$/) !== null;\n};\n\nconst MxGraphTaskLink = (props: MxGraphTaskLinkProps) => {\n    const [open, setOpen] = useState(false);\n    const [link, setLink] = useState('');\n    const [error, setError] = useState(false);\n\n    props.openHandle((openFromHandle, currentLink) => {\n        if(currentLink) {\n            setLink(currentLink);\n        } else {\n            setLink('');\n            setError(false);\n        }\n        setOpen(openFromHandle);\n    });\n\n    const handleChange = (e: React.SyntheticEvent, dProps: InputOnChangeData) => {\n        setLink(dProps.value as string);\n        setError(!validateUrl(dProps.value as string));\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent) => {\n        if(e.keyCode === 13) {\n            chooseLink();\n        }\n    }\n\n    const cancel = () => {\n        props.onCancel();\n        resetModal();\n    };\n\n    const resetModal = () => {\n        setLink('');\n        setError(false);\n    };\n\n    const chooseLink = () => {\n        props.onLinkChosen(link);\n        resetModal();\n    }\n\n    return (\n        <Modal open={open} onClose={cancel} closeIcon={true}>\n            <Modal.Header>{props.t('insp.board.tasklink.headline')}</Modal.Header>\n            <Modal.Content>\n                <Input type=\"url\"\n                       onChange={handleChange}\n                       value={link}\n                       fluid={true}\n                       placeholder=\"https://issue.tracker.com/tasks/1234\"\n                       required={true}\n                       error={error}\n                       autoFocus={true}\n                       onKeyDown={handleKeyDown}\n                       icon={<Icon name=\"close\" link={true} onClick={resetModal} />}\n                />\n            </Modal.Content>\n            <Modal.Actions>\n                <Button\n                    children={props.t('app.form.cancel')}\n                    onClick={cancel}\n                />\n                <Button\n                    primary={true}\n                    children={props.t('app.form.save')}\n                    onClick={chooseLink}\n                    disabled={error}\n                />\n            </Modal.Actions>\n        </Modal>);\n};\n\nexport default withNamespaces()(MxGraphTaskLink);","import {Either, isFailure, isSuccess} from \"../../core/validation/either\";\nimport {Graph, makeNodeFromJs} from \"../../InspectioBoards/model/Graph\";\nimport {AddElementAtPosition, createAddElementAtPositionFromServerData} from \"../model/tasks/AddElementAtPosition\";\nimport {\n    AddElementNextToAnother,\n    createAddElementNextToAnotherFromServerData\n} from \"../model/tasks/AddElementNextToAnother\";\nimport {Task} from \"../model/tasks/Task\";\nimport {ConnectElements, createConnectElementsFromServerData} from \"../model/tasks/ConnectElements\";\nimport {createRenameElementFromServerData, RenameElement} from \"../model/tasks/RenameElement\";\nimport {createRemoveElementFromServerData, RemoveElement} from \"../model/tasks/RemoveElement\";\nimport {\n    ChangeElementDescription,\n    createChangeElementDescriptionFromServerData\n} from \"../model/tasks/ChangeElementDescription\";\nimport {ChangeElementMetadata, createChangeElementMetadataFromServerData} from \"../model/tasks/ChangeElementMetadata\";\nimport ConfiguredSocket from '../../api/ConfiguredSocket';\nimport {ChangeElementLabel, createChangeElementLabelFromServerData} from \"../model/tasks/ChangeElementLabel\";\n\ntype ConfiguredSocket = typeof ConfiguredSocket;\nconst BOARD_AGENT_TASK_SCHEDULED = 'BoardAgentTaskScheduled';\n\nfunction callTaskFactory<R>(data: any, taskFactory: (data: any) => Either<string, R>): R | undefined {\n    const result = taskFactory(data);\n\n    if(isFailure(result)) {\n        console.error(\"[BoardAgent] Failed to create task from server data.\", result.value, data, taskFactory);\n        return;\n    }\n\n    if(isSuccess(result)) {\n        return result.value;\n    }\n\n    return;\n}\n\nexport class BoardAgent {\n    private graph: Graph;\n    private socket: ConfiguredSocket;\n\n\n    constructor(graph: Graph, socket: ConfiguredSocket) {\n        this.graph = graph;\n        this.socket = socket;\n        this.handleTask = this.handleTask.bind(this);\n    }\n\n    public startWatching(): void {\n        console.log(\"[BoardAgent] Start watching for tasks\");\n        this.socket.on(BOARD_AGENT_TASK_SCHEDULED, (task: Task, ack: (success: boolean) => void) => {\n            ack(this.handleTask(task));\n        })\n    }\n\n    public handleTask(task: Task): boolean {\n        console.log(\"[BoardAgent] Going to handle task: \", task);\n        switch (task.command.name) {\n            case 'AddElementAtPosition':\n                const addElementAtPosition = callTaskFactory(task.command.payload, createAddElementAtPositionFromServerData);\n\n                if(addElementAtPosition) {\n                    return this.addElementAtPosition(addElementAtPosition);\n                }\n\n                return false;\n            case 'AddElementNextToAnother':\n                const addElementNextToAnother = callTaskFactory(task.command.payload, createAddElementNextToAnotherFromServerData);\n\n                if(addElementNextToAnother) {\n                    return this.addElementNextToAnother(addElementNextToAnother);\n                }\n\n                return false;\n            case 'RenameElement':\n                const renameElement = callTaskFactory(task.command.payload, createRenameElementFromServerData);\n\n                if(renameElement) {\n                    return this.renameElement(renameElement);\n                }\n\n                return false;\n            case 'RemoveElement':\n                const removeElement = callTaskFactory(task.command.payload, createRemoveElementFromServerData);\n\n                if(removeElement) {\n                    return this.removeElement(removeElement);\n                }\n\n                return false;\n            case 'ChangeElementDescription':\n                const changeElementDescription = callTaskFactory(task.command.payload, createChangeElementDescriptionFromServerData);\n\n                if(changeElementDescription) {\n                    return this.changeElementDescription(changeElementDescription);\n                }\n\n                return false;\n            case 'ChangeElementLabel':\n                const changeElementLabel = callTaskFactory(task.command.payload, createChangeElementLabelFromServerData);\n\n                if(changeElementLabel) {\n                    return this.changeElementLabel(changeElementLabel);\n                }\n\n                return false;\n            case 'ChangeElementMetadata':\n                const changeElementMetadata = callTaskFactory(task.command.payload, createChangeElementMetadataFromServerData);\n\n                if(changeElementMetadata) {\n                    return this.changeElementMetadata(changeElementMetadata);\n                }\n\n                return false;\n            case 'ConnectElements':\n                const connectElements = callTaskFactory(task.command.payload, createConnectElementsFromServerData);\n\n                if(connectElements) {\n                    return this.connectElements(connectElements);\n                }\n\n                return false;\n            default:\n                console.warn(\"[BoardAgent] Unknown task received for board agent. Task was: \" + task.command.name);\n                return false;\n        }\n    }\n\n    public destroy() {\n        console.log(\"[BoardAgent] Stop watching for Tasks\");\n        this.socket.off(BOARD_AGENT_TASK_SCHEDULED);\n    }\n\n    private addElementAtPosition(task: AddElementAtPosition): boolean {\n        try {\n            const node = makeNodeFromJs({\n                id: task.elementId,\n                name: task.name,\n                type: task.type,\n                description: task.content,\n                geometry: task.position,\n                parent: task.parent? this.graph.getNode(task.parent) : null,\n                metadata: task.metadata || '',\n                size: task.size,\n            })\n\n            this.graph.addNode(node);\n\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to add element at position.\", e, task);\n        }\n\n        return false;\n    }\n\n    private addElementNextToAnother(task: AddElementNextToAnother): boolean {\n        const otherElement = this.graph.getNode(task.nextToElementId);\n\n        if(!otherElement) {\n            console.warn(\"[BoardAgent] Skipping task. Next to element cannot be found!\", task);\n            return true;\n        }\n\n        const margin = task.margin || 20;\n\n        try {\n            const node = makeNodeFromJs({\n                id: task.elementId,\n                name: task.name,\n                type: task.type,\n                description: task.content,\n                geometry: {x: 0, y: 0},\n                parent: task.parent? this.graph.getNode(task.parent) : null,\n                metadata: task.metadata || '',\n                size: task.size,\n            })\n\n            this.graph.addNodeNextToAnother(node, otherElement, task.position, margin, task.center);\n\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to add element next to another.\", e, task);\n        }\n\n        return false;\n    }\n\n\n    private connectElements(connectElements: ConnectElements): boolean {\n        const source = this.graph.getNode(connectElements.source);\n\n        if(!source) {\n            console.warn(\"[BoardAgent] Cannot connect elements. Source not found.\", connectElements);\n            // return success, because won't make sense here\n            return true;\n        }\n\n        const target = this.graph.getNode(connectElements.target);\n\n        if(!target) {\n            console.warn(\"[BoardAgent] Cannot connect elements. Target not found.\", connectElements);\n            // return success, because won't make sense here\n            return true;\n        }\n\n        try {\n            this.graph.connectNodes(source, target, connectElements.connectionLabel);\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to connect elements.\", e, connectElements);\n        }\n\n\n        return false;\n    }\n\n    private renameElement(renameElement: RenameElement): boolean {\n        const ele = this.graph.getNode(renameElement.elementId);\n\n        if(!ele) {\n            console.warn(`[BoardAgent] Cannot rename element. No element found with id ${renameElement.elementId}`);\n            return true;\n        }\n\n        try {\n            this.graph.changeNodeName(ele, renameElement.name);\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to rename element.\", e, renameElement);\n        }\n\n        return false;\n    }\n\n    private changeElementLabel(changeElementLabel: ChangeElementLabel): boolean {\n        const ele = this.graph.getNode(changeElementLabel.elementId);\n\n        if (!ele) {\n            console.warn(`[BoardAgent] Cannot change element label. No element found with id ${changeElementLabel.elementId}`);\n            return true;\n        }\n\n        try {\n            this.graph.changeNodeLabel(ele, changeElementLabel.label);\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to change element label.\", e, changeElementLabel);\n        }\n\n        return false;\n    }\n\n    private removeElement(removeElement: RemoveElement) {\n        const ele = this.graph.getNode(removeElement.elementId);\n\n        if(!ele) {\n            console.warn(`[BoardAgent] Cannot remove element. No element found with id ${removeElement.elementId}`);\n            return true;\n        }\n\n        try {\n            this.graph.deleteNode(ele);\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to remove element.\", e, removeElement);\n        }\n\n        return false;\n    }\n\n    private changeElementDescription(changeElementDescription: ChangeElementDescription) {\n        const ele = this.graph.getNode(changeElementDescription.elementId);\n\n        if(!ele) {\n            console.warn(`[BoardAgent] Cannot change element description. No element found with id ${changeElementDescription.elementId}`);\n            return true;\n        }\n\n        try {\n            this.graph.changeNodeDescription(ele, changeElementDescription.content);\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to change element description.\", e, changeElementDescription)\n        }\n\n        return false;\n    }\n\n    private changeElementMetadata(changeElementMetadata: ChangeElementMetadata) {\n        const ele = this.graph.getNode(changeElementMetadata.elementId);\n\n        if(!ele) {\n            console.warn(`[BoardAgent] Cannot change element metadata. No element found with id ${changeElementMetadata.elementId}`);\n            return true;\n        }\n\n        try {\n            this.graph.changeNodeMetadata(ele, changeElementMetadata.metadata);\n            return true;\n        } catch (e) {\n            console.error(\"[BoardAgent] Failed to change element metadata.\", e, changeElementMetadata)\n        }\n\n        return false;\n    }\n}\n","\n// Taken from: https://github.com/dariusk/pos-js\nimport {\n  BrillPOSTaggedWord,\n  BrillPOSTagger,\n  Lexicon,\n  NounInflector,\n  PorterStemmer,\n  PresentVerbInflector,\n  RuleSet,\n  Stemmer\n} from \"natural\";\n\nconst COORD_CONJUNCN = 'CC';        // and,but,or\nconst CARDINAL_NUMBER = 'CD';       // one,two\nconst DETERMINER = 'DT';            // the,some\nconst EXISTENTIAL_THERE = 'EX';     // there\nconst FOREIGN_WORD = 'FW';          // mon,dieu\nconst PREPOSTION = 'IN';            // of,in,by\nconst ADJECTIVE = 'JJ';             // big\nconst ADJECTIVE_COMARATIVE = 'JJR'; // bigger\nconst ADJECTIVE_SUPERLATIVE = 'JJS' // biggest\nconst LIST_ITEM_MARKER = 'LS';      // 1,One\nconst MODAL = 'MD';                 // can,should\nconst NOUN_SINGULAR = 'NN';         // dog\nconst NOUN_PLURAL = 'NNS';          // dogs\nconst PROPER_NOUN_SINGULAR = 'NNP'; // Edingburgh\nconst PROPER_NOUN_PLURAL = 'NNPS';  // Smiths\nconst POSSESSIVE_ENDING = 'POS';    // 's\nconst PREDETERMINER = 'PDT';        // all,both\nconst POSSESSIVE_PRONOUN = 'PRP$';  // my,one's\nconst PERSONAL_PRONOUN = 'PRP';     // I,you,she\nconst ADVERB = 'RB';                // quickly\nconst ADVERB_COMPARSTIVE = 'RBR';   // faster\nconst ADVERB_SUPERLATIVE = 'RBS';   // fastest\nconst PARTICLE = 'RP';              // up,off\nconst SYMBOL = 'SYM';               // +,%,&\nconst TO = 'TO';                    // to\nconst INTERJECTION = 'UH';          // oh, oops\nconst VERB_BASE_FORM = 'VB';        // eat\nconst VERB_PAST_TENSE = 'VBD';      // ate\nconst VERB_GERUND = 'VBG';          // eating\nconst VERB_PAST_PART = 'VBN';       // eaten\nconst VERB_PRESENT = 'VBP';         // eat\nconst VERB_PRESENT_SINGULAR = 'VBZ';// eats\nconst WH_DETERMINER = 'WDT';        // which,that\nconst WH_PRONOUN = 'WP';            // who,what\nconst WH_POSSESSIVE = 'WP$';        // whose\nconst WH_ADVERB = 'WRB';            // whose\nconst COMMA = ',';                  // ,\nconst SENT_FINAL_PUNCT = '.';       // . ! ?\nconst MID_SENT_PUNCT = ':';         // : ; \nconst DOLLAR_SIGN = '$';            // $\nconst POUND_SIGN = '#';             // #\nconst QUOTE = '\"';                  // \"\nconst LEFT_PAREN = '(';             // (\nconst RIGHT_PAREN = ')';            // )\n\nconst VERB_TAGS = [VERB_BASE_FORM, VERB_PRESENT, VERB_PAST_TENSE, VERB_GERUND, VERB_PAST_PART, VERB_PRESENT_SINGULAR];\nconst NOUN_TAGS = [NOUN_SINGULAR, NOUN_PLURAL, PROPER_NOUN_SINGULAR, PROPER_NOUN_PLURAL];\nconst ADJECTIVE_TAGS = [ADJECTIVE, ADJECTIVE_COMARATIVE, ADJECTIVE_SUPERLATIVE];\nconst ADVERB_TAGS = [ADVERB, ADVERB_COMPARSTIVE, ADVERB_SUPERLATIVE];\n\nlet tagger: BrillPOSTagger;\nlet nounInflector: NounInflector;\nlet presentVerbInflector: PresentVerbInflector;\n// tslint:disable-next-line:no-var-requires\nconst verbutils = require('verbutils')();\n\nexport const getConfiguredTagger = (): BrillPOSTagger => {\n  if(!tagger) {\n    const lexicon = new Lexicon(\"EN\", \"N\", \"NNP\");\n\n    const ruleSet = new RuleSet(\"EN\");\n\n    tagger = new BrillPOSTagger(lexicon, ruleSet);\n  }\n\n  return tagger;\n}\n\nexport const getConfiguredNounInflector = (): NounInflector => {\n  if(!nounInflector) {\n    nounInflector = new NounInflector();\n  }\n\n  return nounInflector;\n}\n\nexport const getConfiguredPresentVerbInflector = (): PresentVerbInflector => {\n  if(!presentVerbInflector) {\n    presentVerbInflector = new PresentVerbInflector();\n  }\n\n  return presentVerbInflector;\n}\n\nlet stemmer: Stemmer;\n\nexport const getConfiguredStemmer = (): Stemmer => {\n  if(!stemmer) {\n    stemmer = PorterStemmer;\n  }\n\n  return stemmer;\n}\n\nexport const tagSentence = (sentence: string): BrillPOSTaggedWord[] => {\n  return getConfiguredTagger().tag(sentence.split(\" \")).taggedWords;\n}\n\nexport const stemWord = (word: BrillPOSTaggedWord): string => {\n  return PorterStemmer.stem(word.token);\n}\n\nexport const isVerb = (word: BrillPOSTaggedWord): boolean => {\n  return VERB_TAGS.includes(word.tag);\n}\n\nexport const isNoun = (word: BrillPOSTaggedWord): boolean => {\n  return NOUN_TAGS.includes(word.tag);\n}\n\nexport const isAdjective = (word: BrillPOSTaggedWord): boolean => {\n  return ADJECTIVE_TAGS.includes(word.tag);\n}\n\nexport const isAdverb = (word: BrillPOSTaggedWord): boolean => {\n  return ADVERB_TAGS.includes(word.tag);\n}\n\nexport const ensureSingularNoun = (word: BrillPOSTaggedWord): string => {\n  if(!isNoun(word)) {\n    return '';\n  }\n\n  return getConfiguredNounInflector().singularize(word.token);\n}\n\nexport const ensurePluralNoun = (word: BrillPOSTaggedWord): string => {\n  if(!isNoun(word)) {\n    return '';\n  }\n\n  return getConfiguredNounInflector().pluralize(word.token);\n}\n\n\n\nexport const ensurePresentTense = (verb: BrillPOSTaggedWord): string => {\n  if(!isVerb(verb)) {\n    return '';\n  }\n\n  const baseForm = verbutils.toBaseForm(verb.token);\n\n  // For verbs ending on \"e\" (like: change -> changed) base form conversion does not work, but we can test if base form is a known verb\n  // and if not double-check that gerund form works (changing), to be more safe that we can add an \"e\" to the end\n  if(!isPresentTenseVerb(baseForm) && testStemToGerund(baseForm)) {\n    return baseForm + \"e\";\n  }\n\n  return baseForm;\n}\n\nconst testStemToGerund = (verbStem: string): boolean => {\n  const testSentence = `She is ${verbStem.toLowerCase()}ing a thing.`;\n\n  console.log(\"[CodyWizard] tagged test sentence (stemmed): \", tagSentence(testSentence));\n\n  return tagSentence(testSentence)[2].tag === VERB_GERUND;\n}\n\nconst isPresentTenseVerb = (verb: string): boolean => {\n  // Create a test sentence to see if verb is tagged correctly\n  const singularizedVerb = getConfiguredPresentVerbInflector().singularize(verb);\n\n  const testSentence = `She ${singularizedVerb.toLowerCase()} a thing.`;\n\n  const sentence = tagSentence(testSentence);\n\n  console.log(\"[CodyWizard] tagged test sentence: \", sentence);\n\n  // Verbs like \"tests\" are incorrectly flagged as plural nouns :(, so we perform a second test against the stem\n  return isVerb(sentence[1]) || (sentence[1] && sentence[1].tag === NOUN_PLURAL && testStemToGerund(verb));\n}\n\nconst pastTenseExceptions: Record<string, string> = {\n  \"are\": \"were\",\n  \"eat\": \"ate\",\n  \"go\": \"went\",\n  \"have\": \"had\",\n  \"inherit\": \"inherited\",\n  \"is\": \"was\",\n  \"run\": \"ran\",\n  \"sit\": \"sat\",\n  \"visit\": \"visited\"\n};\n\n/* Taken from https://gist.github.com/letsgetrandy/1e05a68ea74ba6736eb5 */\nexport const toPastTense = (verb: BrillPOSTaggedWord): string => {\n  if(!isVerb(verb)) {\n    return '';\n  }\n\n  const verbStr = verb.token;\n\n\n  if (pastTenseExceptions[verbStr]) {\n    return pastTenseExceptions[verbStr];\n  }\n  if ((/e$/i).test(verbStr)) {\n    return verbStr + 'd';\n  }\n  if ((/[aeiou]c/i).test(verbStr)) {\n    return verbStr + 'ked';\n  }\n  // for american english only\n  if ((/el$/i).test(verbStr)) {\n    return verbStr + 'ed';\n  }\n  if ((/[aeio][aeiou][dlmnprst]$/).test(verbStr)) {\n    return verbStr + 'ed';\n  }\n  if ((/[aeiou][bdglmprst]$/i).test(verbStr)) {\n    return verbStr.replace(/(.+[aeiou])([bdglmnprst])/, '$1$2$2ed');\n  }\n  return verbStr + 'ed';\n}\n","import {Map, Record} from \"immutable\";\nimport {Reducer} from \"redux\";\nimport {\n    SET_CODY_CONSOLE_HEIGHT,\n    SET_RIGHT_SIDEBAR_WIDTH,\n    SET_SIDEBAR_WIDTH,\n    SET_SIDEBYSIDE_CELL,\n    SET_SIDEBYSIDE_WIDTH,\n    TOGGLE_SIDEBAR_COLLAPSED,\n    TOGGLE_SIDEBAR_DIVIDER,\n    TOGGLE_SIDEBAR_EDITOR\n} from \"../actions/constants\";\nimport {InspectioLayoutAction} from \"./index\";\n\n\nexport interface SidebarStateProps {\n    collapsed: boolean;\n    width: number;\n    rightSidebarWidth: number;\n    sideBySideWidth: number;\n    sideBySideCell: string | null;\n    codyConsoleHeight: number;\n    dividers: Map<string, boolean>;\n    editors: Map<string, Record<{expanded: boolean, double: boolean}>>\n}\n\nexport const defaultSidebarStateProps: SidebarStateProps = {\n    collapsed: false,\n    width: 250,\n    rightSidebarWidth: 450,\n    sideBySideWidth: 450,\n    sideBySideCell: null,\n    codyConsoleHeight: 200,\n    dividers: Map(),\n    editors: Map(),\n};\n\nexport class SidebarState extends Record(defaultSidebarStateProps) implements SidebarStateProps {\n\n}\n\nexport const initialState: SidebarState = new SidebarState();\n\nconst reducer: Reducer<SidebarState, InspectioLayoutAction> = (state: SidebarState = initialState, action: InspectioLayoutAction): SidebarState => {\n    switch (action.type) {\n        case TOGGLE_SIDEBAR_COLLAPSED:\n            return state.set('collapsed', action.payload.collapsed);\n        case SET_SIDEBAR_WIDTH:\n            return state.set('width', action.payload.width);\n        case SET_RIGHT_SIDEBAR_WIDTH:\n            return state.set('rightSidebarWidth', action.payload.width);\n        case SET_SIDEBYSIDE_WIDTH:\n            return state.set('sideBySideWidth', action.payload.width);\n        case SET_SIDEBYSIDE_CELL:\n            return state.set('sideBySideCell', action.payload.cell);\n        case SET_CODY_CONSOLE_HEIGHT:\n            return state.set('codyConsoleHeight', action.payload.height);\n        case TOGGLE_SIDEBAR_DIVIDER:\n            return state.set(`dividers`, state.get('dividers').set(action.payload.divider, action.payload.collapsed));\n        case TOGGLE_SIDEBAR_EDITOR:\n            return state.set('editors', state.get('editors').set(action.payload.editor, (Record({expanded: action.payload.expanded, double: action.payload.double}))()));\n        default:\n            return state;\n    }\n};\n\nexport {reducer as sidebarReducer}\n","import {Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {SidebarState} from \"../reducers/applySidebarActions\";\n\nexport const sidebarSelector = (state: Record<ApplicationState>, props: any): SidebarState =>\n    state.getIn(['inspectioSidebar', 'sidebar']) || new SidebarState();\n\nexport const makeGetSidebarSelector = (): (state: Record<ApplicationState>, props?: any) => SidebarState => {\n    return createSelector(\n        [sidebarSelector],\n        (sidebar): SidebarState => sidebar\n    )\n}","import {Node} from \"../../../model/Graph\";\nimport {Rule} from \"../rule-engine/configuration\";\n\nexport interface AggregateMetadata {\n  rules?: Rule[]\n}\n\nexport const getAggregateMetadata = (aggregate: Node): AggregateMetadata => {\n  return aggregate.getParsedMetadata();\n}\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Dropdown, FormField} from \"semantic-ui-react\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Schema} from \"../../../../service/cody-wizard/schema/schema\";\n\ninterface OwnProps {\n  identifier: string;\n  schema: Schema;\n  onIdentifierChanged: (identifier: string) => void;\n  disabled?: boolean;\n  identifierCandidates: string[];\n}\n\ntype IdentifierSelectProps = OwnProps & WithNamespaces;\n\nconst IdentifierSelect = (props: IdentifierSelectProps) => {\n\n  const options = props.identifierCandidates.map(c => ({key: c, text: c, value: c}));\n\n  options.push({key: \"- none -\", text: \"- none -\", value: \"\"});\n\n  return <FormField>\n    <Dropdown inline={true}\n              placeholder={props.t('insp.cody_wizard.identifier_select.placeholder') as string}\n              value={props.identifier}\n              options={options}\n              disabled={options.length === 0 || props.disabled}\n              onChange={(e, data) => props.onIdentifierChanged(data.value as string)}\n              className={'cody-wizard-inline-select'}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(IdentifierSelect);\n\n\nexport const getIdentifierCandidatesFromSchema = (schema: Schema, elementsTree?: ElementsTree): string[] => {\n  const candidates: string[] = [];\n\n  if(schema.isList()) {\n    schema = schema.getListItemsSchema(new Schema({}));\n\n    if(schema.isRef() && elementsTree) {\n      schema = schema.resolveRef(elementsTree);\n    }\n  }\n\n  // tslint:disable-next-line:forin\n  for (const schemaKey of schema.getObjectProperties()) {\n    const propSchema = schema.getObjectPropertySchema(schemaKey, Schema.fromString(''));\n\n   if(propSchema.isString('uuid')) {\n     candidates.push(schemaKey);\n   }\n  }\n\n  return candidates;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\n\nexport const getConnectedEventIfPossible = (vo: Node): Node | undefined => {\n  const sources = vo.getSources();\n\n  if(sources.count() === 1) {\n    const source = sources.first(undefined);\n\n    if(source && source.getType() === NodeType.event) {\n      return source;\n    }\n  }\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\n\nexport const getConnectedValueObjectSourceIfPossible = (vo: Node): Node | undefined => {\n  const sources = vo.getSources();\n\n  if(sources.count() === 1) {\n    const source = sources.first(undefined);\n\n    if(source && source.getType() === NodeType.document) {\n      return source;\n    }\n  }\n}\n","import { ValueObjectMetadata } from \"./get-vo-metadata\";\n\nexport const isVoStoredInDb = (metadata: ValueObjectMetadata): boolean => {\n    return typeof metadata.collection === \"undefined\" || !!metadata.collection;\n}","import {getIdentifierCandidatesFromSchema} from \"../../../components/CodyEngineWizard/Step/StateVO/IdentifierSelect\";\nimport {Node} from \"../../../model/Graph\";\nimport {isAggregateEvent} from \"../event/is-aggregate-event\";\nimport {getConnectedEventIfPossible} from \"./get-connected-event-if-possible\";\nimport {getConnectedValueObjectSourceIfPossible} from \"./get-connected-value-object-source-if-possible\";\nimport {getVoMetadata} from \"./get-vo-metadata\";\nimport {isListVo} from \"./is-list-vo\";\nimport {isStateVo} from \"./is-state-vo\";\nimport { isVoStoredInDb } from \"./is-vo-stored-in-db\";\nimport {getConnectedUiTargetIfPossible} from \"./get-connected-ui-target-if-possible\";\n\nexport const isStateVoCandidate = (node: Node): boolean => {\n  if(isStateVo(node)) {\n    return true;\n  }\n\n  if(isListVo(node)) {\n    return false;\n  }\n\n  const source = getConnectedValueObjectSourceIfPossible(node);\n\n  if(source) {\n    return false;\n  }\n\n  const meta = getVoMetadata(node);\n\n  if(!isVoStoredInDb(meta)) {\n    return false;\n  }\n\n  const event = getConnectedEventIfPossible(node);\n\n  if(event) {\n    if(!isAggregateEvent(event)) {\n      return false;\n    }\n  }\n\n  const ui = getConnectedUiTargetIfPossible(node);\n\n  // Information connected to UI is not a state VO candidate by default\n  if(ui) {\n    return false;\n  }\n\n  return !meta.schema || !!getIdentifierCandidatesFromSchema(meta.schema).length;\n}\n\n","import {Node, NodeType} from \"../../../model/Graph\";\n\nexport const getConnectedUiTargetIfPossible = (vo: Node): Node | undefined => {\n  const targets = vo.getTargets();\n\n  if(targets.count() === 1) {\n    const target = targets.first(undefined);\n\n    if(target && target.getType() === NodeType.ui) {\n      return target;\n    }\n  }\n}\n","import {Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\nimport {BoardModel} from \"../model\";\nimport {ElementsTree} from \"../model/ElementsTree\";\n\nconst getElementsTreeByBoardId = (state: Record<ApplicationState>, boardId: BoardModel.BoardId): ElementsTree => state.getIn(['inspectioBoards', 'elementsTree', boardId]) || new ElementsTree();\n\nexport const makeElementsTreeByBoardIdSelector = (boardId: BoardModel.BoardId): (state: Record<ApplicationState>) => ElementsTree => (state: Record<ApplicationState>) => getElementsTreeByBoardId(state, boardId);","import {useSelector} from \"react-redux\";\nimport {BoardId} from \"../model/Board\";\nimport {ElementsTree} from \"../model/ElementsTree\";\nimport {makeElementsTreeByBoardIdSelector} from \"../selectors/elementsTree\";\n\nexport const useElementsTree = (boardId: BoardId): ElementsTree => {\n  const selector = makeElementsTreeByBoardIdSelector(boardId);\n\n  return useSelector(selector);\n}\n","import {cloneDeep} from \"lodash\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {fqcn} from \"../node/fqcn\";\nimport {names} from \"../node/names\";\nimport {RulesDependenciesMetadata} from \"../rule-engine/types\";\n\nexport const suggestDependenciesForNode = (node: Node, existingDependencies?: RulesDependenciesMetadata, includeEvents = true): RulesDependenciesMetadata => {\n  const deps = node.getSources().filter(s => s.getType() === NodeType.document || s.getType() === NodeType.externalSystem || (includeEvents && s.getType() === NodeType.event));\n\n  const existingDeps = existingDependencies ? cloneDeep(existingDependencies) : {};\n\n  deps.forEach(dep => {\n    switch (dep.getType()) {\n      case NodeType.document:\n        const queryName = fqcn(dep, true);\n\n        if(!existingDeps[queryName]) {\n          existingDeps[queryName] = {\n            type: \"query\",\n            alias: names(dep.getName()).propertyName\n          }\n        }\n        break;\n      case NodeType.externalSystem:\n        const serviceName = names(dep.getName()).className;\n\n        if(!existingDeps[serviceName]) {\n          existingDeps[serviceName] = {\n            type: \"service\",\n            alias: names(dep.getName()).propertyName\n          }\n        }\n        break;\n      case NodeType.event:\n        const eventsDep = existingDeps.events || {type: \"events\"};\n        const options = eventsDep.options || {};\n        const match = options.match || {};\n        let eventNameMatch: string = match.$eventName || '[]';\n\n        if(eventNameMatch.search(']') === -1) {\n          eventNameMatch = `[${eventNameMatch}]`;\n        }\n\n        const eventFQCN = fqcn(dep);\n\n        if(eventNameMatch.search(eventFQCN) === -1) {\n          eventNameMatch = eventNameMatch.replace(\"]\", `, '${eventFQCN}']`)\n            .replace(\"[, \", \"[\"); // If event was added to empty array [], the trailing comma can be removed\n        }\n\n        match.$eventName = eventNameMatch;\n        options.match = match;\n        eventsDep.options = options;\n        existingDeps.events = eventsDep;\n        break;\n    }\n  })\n\n  return existingDeps;\n}\n","import {Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\n\nexport class EditorState extends Record({expanded: false, double: false}) {\n\n}\n\nconst getEditorStateByName = (state: Record<ApplicationState>, editor: string): EditorState => state.getIn(['inspectioSidebar', 'sidebar', 'editors', editor]) || new EditorState();\n\nexport const makeEditorStateByNameSelector = (editor: string): (state: Record<ApplicationState>) => EditorState => (state: Record<ApplicationState>) => getEditorStateByName(state, editor);\n","import {ElementsTree} from \"../../../model/ElementsTree\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {Schema} from \"../schema/schema\";\nimport {isPropertyRef} from \"../schema/shorthand\";\nimport {getSchemaRefName} from \"./get-schema-ref-name\";\nimport {getVoMetadata} from \"./get-vo-metadata\";\n\nexport const getRefVo = (refSchema: Schema, elementsTree: ElementsTree): Node | undefined => {\n  if(!refSchema.isRef()) {\n    return;\n  }\n\n  const vos = elementsTree.getFilteredElementsByType(NodeType.document, false);\n\n  for (const vo of vos.toArray()) {\n    const voMeta = getVoMetadata(vo);\n\n    const voRefName = getSchemaRefName(vo, voMeta, isPropertyRef(refSchema.getRef('')));\n\n    if(voRefName === refSchema.getRef()) {\n      return vo;\n    }\n  }\n}\n","import * as React from 'react';\nimport {Icon} from \"semantic-ui-react\";\nimport {useDispatch} from \"react-redux\";\n\ninterface OwnProps {\n  expanded: boolean;\n  double?: boolean;\n  onExpandChanged: (expand: boolean, double?: boolean) => void;\n}\n\ntype ExpandButtonProps = OwnProps;\n\nconst ExpandButton = (props: ExpandButtonProps) => {\n  const handleClick = (e: React.MouseEvent) => {\n    if(e.ctrlKey) {\n      props.onExpandChanged(true, !props.double);\n    } else {\n      props.onExpandChanged(!props.expanded, false);\n    }\n\n    e.preventDefault();\n  }\n\n  return <div style={{display: \"flex\", marginBottom: \"10px\"}}>\n    <button className=\"ui basic compact button noborder\" style={{marginLeft: \"auto\", padding: 0}} onClick={handleClick} title=\"Expand the editor. Ctrl+Click doubles the expanded height.\">\n      <Icon name=\"expand\" style={{margin: 0, color: props.expanded? '#2185d0' : 'inherit', opacity: 1}} />\n    </button>\n  </div>\n};\n\nexport default ExpandButton;\n","import {JSONSchema7} from \"json-schema\";\n\nexport const makeShorthandSchemaValidationSchema = (possibleRefs: string[]): string => {\n  const ShorthandSchema: JSONSchema7 = {\n    $ref: \"#/definitions/shorthand_object\",\n    definitions: {\n      \"shorthand_both\": {\n        oneOf: [\n          {\n            $ref: '#/definitions/shorthand_string'\n          },\n          {\n            $ref: '#/definitions/shorthand_object'\n          }\n        ]\n      },\n      \"shorthand_string\": {\n        anyOf: [\n          {\n            type: \"string\"\n          },\n          {\n            type: \"string\",\n            enum: [...[\n              \"string\",\n              \"string|format:uuid\",\n              \"string|format:email\",\n              \"string|format:\",\n              \"string|format:color\",\n              \"string|format:date\",\n              \"string|format:date|formatMinimum:\",\n              \"string|format:date|$formatMinimum:\",\n              \"string|format:date|formatExclusiveMinimum:\",\n              \"string|format:date|$formatExclusiveMinimum:\",\n              \"string|format:date|formatMaximum:\",\n              \"string|format:date|$formatMaximum:\",\n              \"string|format:date|formatExclusiveMaximum:\",\n              \"string|format:date|$formatExclusiveMaximum:\",\n              \"string|format:date-time\",\n              \"string|format:time\",\n              \"string|format:uri\",\n              \"string|format:uri-reference\",\n              \"string|minLength:\",\n              \"string|maxLength:\",\n              \"string|title:\",\n              \"integer\",\n              \"integer|minimum:\",\n              \"integer|exclusiveMinimum:\",\n              \"integer|maximum:\",\n              \"integer|exclusiveMaximum:\",\n              \"integer|multipleOf:\",\n              \"number\",\n              \"number|minimum:\",\n              \"number|exclusiveMinimum:\",\n              \"number|maximum:\",\n              \"number|exclusiveMaximum:\",\n              \"number|multipleOf:\",\n              \"number|title\",\n              \"boolean\",\n              \"enum:\"\n            ], ...possibleRefs]\n          }\n        ]\n      },\n      \"shorthand_object\": {\n        type: \"object\",\n        patternProperties: {\n          '^[a-zA-Z]{1,}[a-zA-Z0-9]{0,}[?]{0,1}$': {\n            $ref: \"#/definitions/shorthand_both\"\n          },\n          '^\\\\$title$': {\n            type: \"string\"\n          },\n          '\\\\$ref$': {\n            type: \"string\",\n            enum: possibleRefs,\n          },\n          '\\\\$items': {\n            $ref: \"#/definitions/shorthand_both\"\n          }\n        },\n        additionalProperties: false\n      }\n    }\n  }\n\n  // return JSON.stringify({\n  //   type: \"object\",\n  //   properties: {\n  //     test: {\n  //       $ref: \"#/definitions/test_string\"\n  //     }\n  //   },\n  //   definitions: {\n  //     \"test_string\": {\n  //       type: \"string\",\n  //       minLength: 3\n  //     }\n  //   }\n  // });\n  return JSON.stringify(ShorthandSchema);\n}\n\n\n","import * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Icon, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {setSideBySideCell, toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {NodeType} from \"../../../model/Graph\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {getRefVo} from \"../../../service/cody-wizard/vo/get-ref-vo\";\nimport {getSchemaRefName} from \"../../../service/cody-wizard/vo/get-schema-ref-name\";\nimport {getVoMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {parse} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {makeShorthandSchemaValidationSchema} from \"./Validation/shorthand-schema\";\n\n\ninterface OwnProps {\n  boardId: BoardId;\n  schema: Schema;\n  onSchemaChanged: (schema: Schema | undefined) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype SchemaEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\nlet isRefOpening = false;\n\nconst SchemaEditor = (props: SchemaEditorProps) => {\n  const dispatch = useDispatch();\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('schema'));\n\n  let value = props.schema.toString();\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-schema.json`,\n      language: \"json\",\n      value,\n      schema: props.schema.isShorthand()? makeShorthandSchemaValidationSchema(getPossibleRefs(elementsTree)) : undefined,\n    });\n\n\n    setInvalidJson(isInvalidJson);\n  }, [value]);\n\n  useEffect(() => {\n    // This is needed to prevent wrong schemaChanged events due to onBlur firing when ref is loaded\n    if(isRefOpening) {\n      window.setTimeout(() => {\n        isRefOpening = false;\n      }, 500);\n    }\n  }, [props.sessionId]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(isRefOpening) {\n      return true;\n    }\n    if(editorStr === '') {\n      props.onSchemaChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedSchema = parse(editorStr);\n      props.onSchemaChanged(new Schema(changedSchema));\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true\n    } catch (e) {\n      console.error(\"[CodyWizard] Schema Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  const handleOpenInformationReference = (ref: string) => {\n    const refVo = getRefVo(Schema.fromString(ref), elementsTree);\n\n    if(refVo) {\n      isRefOpening = true;\n      dispatch(setSideBySideCell(refVo.getId()));\n    }\n  }\n\n  return <FormField>\n    {invalidJson &&\n        <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string}\n                 icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('schema', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-schema-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      onOpenInformationReference={handleOpenInformationReference}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if (codeEditorRef.current) {\n          const changedSchemaStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedSchemaStr);\n\n          setEditorHasFocus(false);\n\n          if (!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedSchemaStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(SchemaEditor);\n\nexport const getPossibleRefs = (elementsTree: ElementsTree, noListSyntax?: boolean): string[] => {\n  const possibleRefs: string[] = [];\n\n  elementsTree.getFilteredElementsByType(NodeType.document).forEach(ele => {\n    const voMeta = getVoMetadata(ele);\n\n    const possibleRef = getSchemaRefName(ele, voMeta);\n\n    if (!possibleRefs.includes(possibleRef)) {\n      possibleRefs.push(possibleRef);\n    }\n\n    if (voMeta.schema && !voMeta.schema.isList() && !noListSyntax) {\n      const possibleRefAsList = possibleRef + '[]';\n      if (!possibleRefs.includes(possibleRefAsList)) {\n        possibleRefs.push(possibleRefAsList);\n      }\n    }\n  });\n\n  return possibleRefs;\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const JEXL_WIKI_MARKDOWN = \"[Jexl Expression](https://wiki.prooph-board.com/board_workspace/Expressions.html)\";\nexport const makeJexlExpression = (markdownDescription?: string, suggestions?: string[]): JSONSchemaWithMarkdown => {\n  const jexlExpr = {\n    type: \"string\",\n    default: \"$> \",\n    pattern: \"^\\\\$> .+$\",\n    markdownDescription,\n  };\n\n  if(suggestions) {\n    return {\n      anyOf: [\n        {\n          enum: suggestions.map(s => `$> ${s}`),\n        },\n        jexlExpr,\n      ]\n    } as JSONSchemaWithMarkdown\n  }\n\n  return {\n    type: \"string\",\n    default: \"$> \",\n    pattern: \"^\\\\$> .+$\",\n    markdownDescription,\n  }\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\nimport {Definitions} from \"../rule-engine-definitions\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./jexl-expressions\";\n\nexport const withSuggestionPropMapping = (definitions: Definitions, possibleProps: string[], fullMergeSuggestions: string[], mappingSuggestions: string[]): Definitions => {\n  return {\n    ...definitions,\n    ...makeRuleThenPropMapping(possibleProps, fullMergeSuggestions, mappingSuggestions),\n  }\n}\nexport const makeRuleThenPropMapping = (possibleProps?: string[], fullMergeSuggestions?: string[], mappingSuggestions?: string[]): {\n  rule_then_prop_mapping: JSONSchemaWithMarkdown\n} => {\n\n\n  let suggestions: string[] | undefined = [...(fullMergeSuggestions || []), ...(mappingSuggestions || [])];\n\n  if(suggestions.length === 0) {\n    suggestions = undefined;\n  }\n\n  const mergeSchema: JSONSchemaWithMarkdown = {\n    oneOf: [\n      makeJexlExpression(`Provide data to be merged into source object.\\n\\nType: ${JEXL_WIKI_MARKDOWN}`, suggestions),\n      {\n        type: \"array\",\n        markdownDescription: \"List of data to be merged into source object.\",\n        items: makeJexlExpression(`Provide data to be merged.\\n\\nType: ${JEXL_WIKI_MARKDOWN}`, suggestions)\n      }\n    ]\n  }\n\n  return {\n    rule_then_prop_mapping: {\n      markdownDescription: `**Property Mapping**\\n\\nSet complex data structures using Jexl-flavoured JSON.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#property-mapping)`,\n      oneOf: [\n        makeJexlExpression(`Provide data to be merged into source object.\\n\\nType: ${JEXL_WIKI_MARKDOWN}`, suggestions),\n        {\n          type: \"object\",\n          patternProperties: {\n            \"^\\$merge$\": mergeSchema,\n            \"^\\$not$\": {type: \"string\", markdownDescription: `Removes the property.`},\n            \"^[^\\$]+$\": {\n              $ref: \"#/definitions/rule_then_prop_mapping\"\n            }\n          }\n        },\n        {\n          type: \"array\",\n          items: {\n            $ref: \"#/definitions/rule_then_prop_mapping\"\n          }\n        }\n      ]\n    }\n  }\n}\n","import {JSONSchema7, JSONSchema7Definition} from \"json-schema\";\nimport {JSONSchemaWithMarkdown} from \"../Suggestion/markdown-description\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./rule-engine/jexl-expressions\";\nimport {makeRuleThenPropMapping} from \"./rule-engine/prop-mapping\";\n\nexport interface Definitions {[key: string]: JSONSchema7Definition}\n\nexport const makeDefinitions = (...rest: Array<Record<string, JSONSchema7>>): Definitions => {\n  const schema: JSONSchemaWithMarkdown = {\n    definitions: {\n      rule_definition: {\n        markdownDescription: `**Cody Engine Rule**\\n\\nCan be always executed or if a condition is (not) met \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html)`,\n        oneOf: [\n          {\n            type: \"object\",\n            default: {\n              rule: \"always\",\n              then: {}\n            },\n            properties: {\n              rule: {\n                type: \"string\",\n                enum: [\"always\"],\n                markdownDescription: `This rule is always executed.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#always-vs-condition)`,\n              },\n              then: {\n                $ref: \"#/definitions/rule_then\"\n              }\n            },\n            required: [\"rule\", \"then\"],\n            additionalProperties: false\n          },\n          {\n            type: \"object\",\n            default: {\n              rule: \"condition\",\n              if: \"$> \",\n              then: {}\n            },\n            properties: {\n              rule: {\n                type: \"string\",\n                enum: [\"condition\"],\n                markdownDescription: `This rule is executed **if** condition is met.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#always-vs-condition)`,\n              },\n              then: {\n                $ref: \"#/definitions/rule_then\"\n              },\n              if: makeJexlExpression(`Define condition as a ${JEXL_WIKI_MARKDOWN}`),\n              else: {\n                $ref: \"#/definitions/rule_then\",\n                markdownDescription: `Alternative [rule](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#then), that is executed if condition is not met.`,\n              },\n              stop: {\n                type: \"boolean\",\n                markdownDescription: `Stop rule execution if condition is not met.`,\n              }\n            },\n            required: [\"rule\", \"then\", \"if\"],\n            additionalProperties: false\n          },\n          {\n            type: \"object\",\n            default: {\n              rule: \"condition\",\n              if_not: \"$> \",\n              then: {}\n            },\n            properties: {\n              rule: {\n                type: \"string\",\n                enum: [\"condition\"],\n                markdownDescription: `This rule is executed **if** condition is **not** met.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#always-vs-condition)`,\n              },\n              then: {\n                $ref: \"#/definitions/rule_then\"\n              },\n              if_not: makeJexlExpression(`Define condition as a ${JEXL_WIKI_MARKDOWN}`),\n              else: {\n                $ref: \"#/definitions/rule_then\",\n                markdownDescription: `Alternative [rule](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#then), that is executed if condition is met.`,\n              },\n              stop: {\n                type: \"boolean\",\n                markdownDescription: `Stop rule execution if condition is met.`,\n              }\n            },\n            required: [\"rule\", \"then\", \"if_not\"],\n            additionalProperties: false\n          }\n        ]\n      },\n      rule_then: {\n        markdownDescription: `Execute a [rule](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#then)`,\n        oneOf: []\n      },\n      ...makeRuleThenPropMapping()\n    }\n  }\n\n  rest.forEach(rec => {\n    // tslint:disable-next-line:forin\n    for (const recKey in rec) {\n      schema.definitions![recKey] = rec[recKey];\n      (schema.definitions!.rule_then as JSONSchema7).oneOf!.push({$ref: `#/definitions/${recKey}`})\n    }\n  })\n\n  return schema.definitions!;\n}\n\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeAssignVariable = (fixedVariableName?: string): { rule_then_assign_variable: JSONSchemaWithMarkdown } => {\n  const variableDesc = `Name of the variable`;\n\n  return {\n    rule_then_assign_variable: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"assign\"],\n      properties: {\n        assign: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Assign Variable**\\n\\nSet a new or override an existing variable in the rule execution context.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#assign-variable)`,\n          required: [\"variable\", \"value\"],\n          properties: {\n            \"variable\": (fixedVariableName ? {const: fixedVariableName, markdownDescription: variableDesc} : {type: \"string\", minLength: 1, markdownDescription: variableDesc} as JSONSchemaWithMarkdown),\n            \"value\": {$ref: \"#/definitions/rule_then_prop_mapping\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown\n  }\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeCallService = (possibleServices: string[]): { rule_then_call_service: JSONSchemaWithMarkdown } => {\n  return {\n    rule_then_call_service: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"call\"],\n      properties: {\n        call: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Call Service**\\n\\nInvoke a custom function or method.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#call-service)`,\n          required: [\"service\"],\n          default: {\n            \"service\": \"\"\n          },\n          properties: {\n            service: {type: \"string\", enum: possibleServices, markdownDescription: `Name of the service dependency`,},\n            arguments: {$ref: \"#/definitions/rule_then_prop_mapping\", markdownDescription: `Arguments passed to the service function.\\n\\n`, default: []},\n            method: {type: \"string\", minLength: 1},\n            async: {type: \"boolean\", default: true},\n            result: {\n              type: \"object\",\n              additionalProperties: false,\n              required: [\"variable\"],\n              markdownDescription: `Save the result in a context variable`,\n              default: {\n                variable: \"\"\n              },\n              properties: {\n                variable: {type: \"string\", minLength: 1, markdownDescription: `Name of the context variable`,},\n                mapping: {$ref: \"#/definitions/rule_then_prop_mapping\"}\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\nimport {Definitions} from \"../rule-engine-definitions\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./jexl-expressions\";\n\n// Resolve filters are used in Resolver Config \"where\" rules\nexport const makeResolveFiltersDefinition = (possibleProperties?: string[], expressionSuggests?: string[]) => {\n  return makeFiltersDefinition('resolve', possibleProperties, expressionSuggests);\n}\n\n// Find filters are used in \"Find * Information\" rules\nexport const makeFindFiltersDefinition = (possibleProperties?: string[], expressionSuggests?: string[]) => {\n  return makeFiltersDefinition('find', possibleProperties, expressionSuggests);\n}\n\nexport const withResolveFilterTypes = (definitions: Definitions): Definitions => {\n  return {\n    ...definitions,\n    ...makeResolveFiltersDefinition()\n  }\n}\n\nexport const withFindFilterTypes = (definitions: Definitions): Definitions => {\n  return {\n    ...definitions,\n    ...makeFindFiltersDefinition()\n  }\n}\n\ntype FilterPrefix = \"resolve\" | \"find\";\n\nexport const makeFiltersDefinition = (prefix: FilterPrefix, possibleProperties?: string[], expressionSuggests?: string[]) => {\n  const propertySchema = possibleProperties\n    ? {type: \"string\", enum: possibleProperties, markdownDescription: `Name of the property`,}\n    : {type: \"string\", minLength: 1, markdownDescription: `Name of the property`,};\n\n  const definitions: Record<string, JSONSchemaWithMarkdown> = {};\n\n  definitions[`${prefix}_order_by`] = {\n    markdownDescription: `Order the result set by property values.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#sort-order)`,\n    oneOf: [\n      {\n        $ref: `#/definitions/${prefix}_order_by_item`\n      },\n      {\n        type: \"array\",\n        items: {\n          $ref: `#/definitions/${prefix}_order_by_item`\n        }\n      }\n    ]\n  };\n\n  definitions[`${prefix}_order_by_item`] = {\n    type: \"object\",\n    additionalProperties: false,\n    required: [\"prop\", \"sort\"],\n    properties: {\n      prop: propertySchema,\n      sort: {type: \"string\", enum: [\"asc\", \"desc\"]}\n    }\n  } as JSONSchemaWithMarkdown;\n\n  definitions[`${prefix}_filter`] = {\n    type: \"object\",\n    additionalProperties: false,\n    required: [\"filter\"],\n   properties: {\n      filter: {\n        $ref: `#/definitions/${prefix}_filter_types`\n      }\n    }\n  };\n\n  definitions[`${prefix}_filter_types`] = {\n    markdownDescription: `Filter the result set.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#filter)`,\n    oneOf: [\n      {$ref: `#/definitions/${prefix}_filter_and`},\n      {$ref: `#/definitions/${prefix}_filter_or`},\n      {$ref: `#/definitions/${prefix}_filter_not`},\n      {$ref: `#/definitions/${prefix}_filter_any`},\n      {$ref: `#/definitions/${prefix}_filter_any_of_doc_id`},\n      {$ref: `#/definitions/${prefix}_filter_any_of`},\n      {$ref: `#/definitions/${prefix}_filter_doc_id`},\n      {$ref: `#/definitions/${prefix}_filter_eq`},\n      {$ref: `#/definitions/${prefix}_filter_exists`},\n      {$ref: `#/definitions/${prefix}_filter_gte`},\n      {$ref: `#/definitions/${prefix}_filter_gt`},\n      {$ref: `#/definitions/${prefix}_filter_in_array`},\n      {$ref: `#/definitions/${prefix}_filter_like`},\n      {$ref: `#/definitions/${prefix}_filter_lte`},\n      {$ref: `#/definitions/${prefix}_filter_lt`},\n    ]\n  };\n\n\n\n    definitions[`${prefix}_filter_expr`] = makeJexlExpression(`Provide filter value as a ${JEXL_WIKI_MARKDOWN}`, expressionSuggests),\n    definitions[`${prefix}_filter_and`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"and\"],\n      properties: {\n        and: {\n          markdownDescription: `**And Filter**\\n\\nFind information where two or more filters match. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#and-filter)`,\n          type: \"array\",\n          items: {$ref: `#/definitions/${prefix}_filter_types`},\n          minItems: 2\n        }\n      }\n    };\n\n    definitions[`${prefix}_filter_or`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"or\"],\n      properties: {\n        or: {\n          markdownDescription: `**Or Filter**\\n\\nFind information where any of the given filters match. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#or-filter)`,\n          type: \"array\",\n          items: {$ref: `#/definitions/${prefix}_filter_types`},\n          minItems: 2\n        }\n      }\n    };\n\n    definitions[`${prefix}_filter_not`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"not\"],\n      properties: {\n        not: {\n          markdownDescription: `**Not Filter**\\n\\nFind information where a given filter does not match. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#not-filter)`,\n          $ref: `#/definitions/${prefix}_filter_types`\n        }\n      }\n    };\n\n    definitions[`${prefix}_filter_any`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"any\"],\n      properties: {\n        any: {\n          markdownDescription: `**Any Filter**\\n\\nFind information without a specific filter. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#any-filter)`,\n          type: \"boolean\",\n          default: true\n        }\n      }\n    };\n\n    definitions[`${prefix}_filter_any_of_doc_id`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"anyOfDocId\"],\n      properties: {\n        anyOfDocId: {\n          markdownDescription: `**Any Of DocId Filter**\\n\\nFilter information by a list of document ids. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#any-of-docid-filter)`,\n          $ref: `#/definitions/${prefix}_filter_expr`\n        }\n      }\n    };\n\n    definitions[`${prefix}_filter_any_of`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"anyOf\"],\n      properties: {\n        anyOf: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Any Of Filter**\\n\\nFind information by comparing the value of a property against a list of possible values. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#any-of-filter)`,\n          required: [\"prop\", \"valueList\"],\n          properties: {\n            prop: propertySchema,\n            valueList: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_doc_id`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"docId\"],\n      properties: {\n        docId: {\n          $ref: `#/definitions/${prefix}_filter_expr`,\n          markdownDescription: `**DocId Filter**\\n\\nFind information by its document id. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#docid-filter)`\n        }\n      }\n    };\n\n    definitions[`${prefix}_filter_eq`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"eq\"],\n      properties: {\n        eq: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Equal Filter**\\n\\nCheck that a property equals a specific value. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#equal-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_exists`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"exists\"],\n      properties: {\n        exists: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Exists Filter**\\n\\nCheck that a specific property exists. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#exists-filter)`,\n          required: [\"prop\"],\n          properties: {\n            prop: propertySchema,\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_gte`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"gte\"],\n      properties: {\n        gte: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Greater Than or Equal Filter**\\n\\nCheck that a property is greater than or equal to value. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#greater-than-or-equal-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_gt`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"gt\"],\n      properties: {\n        gt: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Greater Than Filter**\\n\\nCheck that a property is greater than value. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#greater-than-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_in_array`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"inArray\"],\n      properties: {\n        inArray: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**InArray Filter**\\n\\nIf property is of type array, check that given value is one of the items. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#inarray-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_like`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"like\"],\n      properties: {\n        like: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Like Filter**\\n\\nMatch a string property against a value string that contains a wildcard: % at the start and/or end. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#like-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_lte`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"lte\"],\n      properties: {\n        lte: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Lower Than or Equal Filter**\\n\\nCheck that a property is lower than or equal to a value. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#lower-than-or-equal-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    definitions[`${prefix}_filter_lt`] = {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"lt\"],\n      properties: {\n        lt: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Lower Than Filter**\\n\\nCheck that a property is lower than a value. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#lower-than-filter)`,\n          required: [\"prop\", \"value\"],\n          properties: {\n            prop: propertySchema,\n            value: {$ref: `#/definitions/${prefix}_filter_expr`}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown;\n\n    return definitions;\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./jexl-expressions\";\n\nexport const makeFindInformation = (possibleInformation: string[], expSuggests: string[]) => {\n\n  const information: JSONSchemaWithMarkdown = {\n    type: \"string\",\n    enum: possibleInformation,\n    markdownDescription: `Data Reference of the information`,\n  }\n\n  return {\n    then_find_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"find\"],\n      properties: {\n        find: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Find Information**\\n\\nFind a list of stored information using a Filter. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#find-information)`,\n          required: [\"information\", \"filter\"],\n          properties: {\n            information,\n            filter: {$ref: \"#/definitions/find_filter_types\"},\n            skip: {type: \"integer\", markdownDescription: `Select a subset of the result set skipping the given number of results`,},\n            limit: {type: \"integer\", markdownDescription: `Select a subset of the result set limited by the given number`,},\n            orderBy: {$ref: \"#/definitions/find_order_by\"},\n            variable: {type: \"string\", minLength: 1, markdownDescription: `Defines the context name where the result is stored.`, default: \"information\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n    then_find_one_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"findOne\"],\n      properties: {\n        findOne: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Find One Information**\\n\\nFind one information by using a Filter. If filter matches more than one information, the first match is used. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#find-one-information)`,\n          required: [\"information\", \"filter\"],\n          properties: {\n            information,\n            filter: {$ref: \"#/definitions/find_filter\"},\n            variable: {type: \"string\", minLength: 1, markdownDescription: `Defines the context name where the result is stored.`, default: \"information\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n    then_find_information_by_id: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"findById\"],\n      properties: {\n        findById: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Find Information By Id**\\n\\nFind one information by its id. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#find-information-by-id)`,\n          required: [\"information\", \"id\"],\n          properties: {\n            information,\n            id: makeJexlExpression(`Id filter defined as a ${JEXL_WIKI_MARKDOWN}`, expSuggests),\n            variable: {type: \"string\", minLength: 1, markdownDescription: `Defines the context name where the result is stored.`, default: \"information\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n    then_find_partial_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"findPartial\"],\n      properties: {\n        findPartial: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Find Partial Information**\\n\\nFind a list of information by using a Filter and Select a subset of the information. Partial queries also support Lookup of additional information aka. joining related information. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#find-partial-information)`,\n          required: [\"information\", \"select\", \"filter\"],\n          properties: {\n            information,\n            filter: {$ref: \"#/definitions/find_filter_types\"},\n            select: {$ref: \"#/definitions/find_partial_select\"},\n            skip: {type: \"integer\", markdownDescription: `Select a subset of the result set skipping the given number of results`,},\n            limit: {type: \"integer\", markdownDescription: `Select a subset of the result set limited by the given number`,},\n            orderBy: {$ref: \"#/definitions/find_order_by\"},\n            variable: {type: \"string\", minLength: 1, markdownDescription: `Defines the context name where the result is stored.`, default: \"information\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n    then_find_one_partial_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"findOnePartial\"],\n      properties: {\n        findOnePartial: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Find One Partial Information**\\n\\nFind one information by using a Filter and Select a subset of the information. Partial queries also support Lookup of additional information aka. joining related information. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#find-one-partial-information)`,\n          required: [\"information\",\"select\", \"filter\"],\n          properties: {\n            information,\n            select: {$ref: \"#/definitions/find_partial_select\"},\n            filter: {$ref: \"#/definitions/find_filter\"},\n            variable: {type: \"string\", minLength: 1, markdownDescription: `Defines the context name where the result is stored.`, default: \"information\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n    then_find_partial_information_by_id: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"findPartialById\"],\n      properties: {\n        findPartialById: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Find Partial Information By Id**\\n\\nFind one information by id and Select a subset of the information. Partial queries also support Lookup of additional information aka. joining related information. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#find-partial-information-by-id)`,\n          required: [\"information\", \"select\", \"id\"],\n          properties: {\n            information,\n            select: {$ref: \"#/definitions/find_partial_select\"},\n            id: makeJexlExpression(`Id filter defined as a ${JEXL_WIKI_MARKDOWN}`, expSuggests),\n            variable: {type: \"string\", minLength: 1, markdownDescription: `Defines the context name where the result is stored.`, default: \"information\"}\n          }\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n    then_lookup_user: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"lookup\"],\n      properties: {\n        lookup: {\n          oneOf: [\n            {\n              type: \"object\",\n              additionalProperties: false,\n              required: [\"user\"],\n              properties: {\n                user: {\n\n                }\n              }\n            },\n            {\n              type: \"object\",\n              additionalProperties: false,\n              required: [\"users\"],\n              properties: {\n                users: {\n\n                }\n              }\n            }\n          ]\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n  }\n}\n\nexport const makePartialSelectDefinition = (possibleInformation: string[]) => {\n  const information: JSONSchemaWithMarkdown = {\n    type: \"string\",\n    enum: possibleInformation,\n    markdownDescription: `Data Reference of the information to be looked up.`,\n  }\n\n  return {\n    find_partial_select: {\n      type: \"array\",\n      markdownDescription: `**Partial Select**\\n\\nDefine the list of properties to be included in the result. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#partial-select)`,\n      items: {\n        oneOf: [\n          {\n            type: \"string\",\n            minLength: 1,\n          },\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"field\", \"alias\"],\n            properties: {\n              field: {type: \"string\", minLength: 1, markdownDescription: `Name of the property in the database.\\n\\nCan be nested.`,},\n              alias: {type: \"string\", minLength: 1, markdownDescription: `Name of the property in the result set.\\n\\nCan be nested.`,}\n            }\n          },\n          {\n            $ref: \"#/definitions/find_partial_select_lookup\"\n          }\n        ]\n      }\n    } as JSONSchemaWithMarkdown,\n    find_partial_select_lookup: {\n      type: \"object\",\n      additionalProperties: false,\n      markdownDescription: `**Lookup**\\n\\nLookup additional information and include it in the main Select. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#lookup)`,\n      required: [\"lookup\", \"on\"],\n      properties: {\n        lookup: information,\n        alias: {type: \"string\", minLength: 1, markdownDescription: `Lookup name, that can be referenced in further lookups`,},\n        using: {type: \"string\", minLength: 1, markdownDescription: `Defines the lookup to be used as the local basis.`,},\n        optional: {type: \"boolean\", default: false, markdownDescription: `Defines if the lookup is optional.`,},\n        on: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `Defines the matching condition for the lookup.`,\n          required: [\"localKey\"],\n          properties: {\n            localKey: {type: \"string\", minLength: 1, markdownDescription: `Local property used to lookup foreign information`,},\n            foreignKey: {type: \"string\", minLength: 1, markdownDescription: `Compare local key against this property in the foreign information.\\n\\n*If not set, localKey is matched against the document id of foreign information.*`,},\n            and: {$ref: \"#/definitions/find_filter_types\"}\n          }\n        },\n        select: {\n          markdownDescription: `Defines which properties of the looked up information should be included in the result`,\n          oneOf: [\n            {\n              type: \"string\",\n              minLength: 1,\n            },\n            {\n              type: \"object\",\n              additionalProperties: false,\n              required: [\"field\", \"alias\"],\n              properties: {\n                field: {type: \"string\", minLength: 1, markdownDescription: `Name of the property in the database.\\n\\nCan be nested.`,},\n                alias: {type: \"string\", minLength: 1, markdownDescription: `Name of the property in the result set.\\n\\nCan be nested.`,}\n              }\n            }\n          ]\n        }\n      }\n    } as JSONSchemaWithMarkdown,\n  }\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./jexl-expressions\";\n\nexport const makeLogMessage = (): { then_log_msg: JSONSchemaWithMarkdown } => {\n\n  const msgDesc = `Provide log message via ${JEXL_WIKI_MARKDOWN}`;\n\n  return {\n    then_log_msg: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"log\"],\n      properties: {\n        log: {\n          type: \"object\",\n          additionalProperties: false,\n          markdownDescription: `**Log Message**\\n\\nLog a message to console to provide debugging information. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#log-msg)`,\n          properties: {\n            msg: {\n              oneOf: [\n                makeJexlExpression(msgDesc),\n                {\n                  type: \"array\",\n                  items: makeJexlExpression(msgDesc)\n                }\n              ]\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./jexl-expressions\";\nimport {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeThenThrowError = (): { rule_then_throw_error: JSONSchemaWithMarkdown } => {\n  return {\n    rule_then_throw_error: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"throw\"],\n      properties: {\n        throw: {\n          type: \"object\",\n          markdownDescription: `**Throw Error**\\n\\nStop the entire execution flow and throw an error. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#throw-error)`,\n          additionalProperties: false,\n          required: [\"error\"],\n          properties: {\n            \"error\": makeJexlExpression(`Provide the error message via ${JEXL_WIKI_MARKDOWN}`),\n          }\n        }\n      }\n    }\n  }\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {\n  makeDefinitions\n} from \"./rule-engine-definitions\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\nimport {makeCallService} from \"./rule-engine/call-service\";\nimport {makeExecuteRules} from \"./rule-engine/execute-rules\";\nimport {makeFindFiltersDefinition, withFindFilterTypes} from \"./rule-engine/filters\";\nimport {makeFindInformation, makePartialSelectDefinition} from \"./rule-engine/find-information-rules\";\nimport {makeForEach} from \"./rule-engine/foreach\";\nimport {makeLogMessage} from \"./rule-engine/log-message\";\nimport {makeThenRecordEvent} from \"./rule-engine/record-event\";\nimport {makeThenThrowError} from \"./rule-engine/throw-error\";\n\nexport const makeBusinessRulesSchema = (possibleEvents: string[], possibleServices: string[], possibleRefs: string[], expSuggests: string[]): string => {\n  const BusinessRulesSchema: JSONSchema7 = {\n    type: \"array\",\n    items: {\n      $ref: \"#/definitions/rule_definition\"\n    },\n    definitions: {\n      ...makeFindFiltersDefinition(undefined, expSuggests),\n      ...makePartialSelectDefinition(possibleRefs),\n    }\n  }\n\n  BusinessRulesSchema.definitions = {\n    ...BusinessRulesSchema.definitions,\n    ...makeDefinitions(\n      makeThenRecordEvent(possibleEvents),\n      makeThenThrowError(),\n      makeAssignVariable(),\n      makeCallService(possibleServices),\n      makeForEach(),\n      makeExecuteRules(),\n      makeLogMessage(),\n      makeFindInformation(possibleRefs, expSuggests)\n    )\n  }\n\n\n  return JSON.stringify(BusinessRulesSchema);\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeThenRecordEvent = (availableEvents: string[]): { rule_then_record_event: JSONSchemaWithMarkdown } => {\n  return {\n    rule_then_record_event: {\n      type: \"object\",\n      properties: {\n        record: {\n          type: \"object\",\n          markdownDescription: `**Record Event**\\n\\nRecord an event in the event store. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#record-event)`,\n          properties: {\n            event: {\n              type: \"string\",\n              enum: availableEvents\n            },\n            mapping: {\n              $ref: \"#/definitions/rule_then_prop_mapping\",\n              markdownDescription: `Data of the event`,\n            },\n            meta: {\n              $ref: \"#/definitions/rule_then_prop_mapping\",\n              markdownDescription: `Metadata of the event`,\n            }\n          },\n          additionalProperties: false,\n          required: [\"event\", \"mapping\"]\n        }\n      },\n      additionalProperties: false,\n      required: [\"record\"]\n    }\n  }\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeForEach = (): { rule_then_for_each: JSONSchemaWithMarkdown } => {\n  return {\n    rule_then_for_each: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"forEach\"],\n      properties: {\n        forEach: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"variable\", \"then\"],\n          markdownDescription: `**For Each**\\n\\nExecute a rule for each *item* of an array. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#foreach)`,\n          properties: {\n            variable: {type: \"string\", minLength: 1},\n            then: {$ref: \"#/definitions/rule_then\"}\n          }\n        }\n      }\n    }\n  }\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeExecuteRules = (): { rule_then_execute_rules: JSONSchemaWithMarkdown } => {\n  return {\n    rule_then_execute_rules: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"execute\"],\n      properties: {\n        execute: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"rules\"],\n          markdownDescription: `**Execute Rules**\\n\\nExecute a list of additional rules. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#execute-rules)`,\n          default: {\n            rules: []\n          },\n          properties: {\n            rules: {type: \"array\", items: {$ref: \"#/definitions/rule_definition\"}, minItems: 1, default: []}\n          }\n        }\n      }\n    }\n  }\n}\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {setSideBySideCell, toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {Node} from \"../../../model/Graph\";\nimport {Rule} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {RulesDependencyMetadata} from \"../../../service/cody-wizard/rule-engine/types\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {getRefVo} from \"../../../service/cody-wizard/vo/get-ref-vo\";\nimport {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {getPossibleRefs} from \"./SchemaEditor\";\nimport {makeBusinessRulesSchema} from \"./Validation/business-rules-schema\";\n\n\ninterface OwnProps {\n  boardId: string;\n  elementId: string;\n  commandSchema: Schema;\n  rules: Rule[];\n  onRulesChanged: (rules: Rule[] | undefined) => void;\n  autofocus?: boolean;\n  possibleEvents: List<Node>;\n  dependencies: Record<string, RulesDependencyMetadata>;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype BusinessRulesEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\nlet isRefOpening = false;\n\nconst BusinessRulesEditor = (props: BusinessRulesEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('business-rules'));\n  const dispatch = useDispatch();\n\n  const possibleServices: string[] = [];\n\n  for (const dependenciesKey in props.dependencies) {\n    if(props.dependencies[dependenciesKey].type === \"service\") {\n      possibleServices.push(props.dependencies[dependenciesKey].alias || dependenciesKey);\n    }\n  }\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let value = stringify(props.rules, null, 2);\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-business-rules.json`,\n      language: \"json\",\n      value,\n      schema: makeBusinessRulesSchema(\n        props.possibleEvents.map(e => e.getTechnicalName()).toArray(),\n        possibleServices,\n        getPossibleRefs(elementsTree, true),\n        getExprSuggests(props.commandSchema)\n      ),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.elementId, props.dependencies, props.commandSchema.toString()]);\n\n  useEffect(() => {\n    // This is needed to prevent wrong schemaChanged events due to onBlur firing when ref is loaded\n    if(isRefOpening) {\n      window.setTimeout(() => {\n        isRefOpening = false;\n      }, 500);\n    }\n  }, [props.sessionId]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n\n    if(editorStr === '') {\n      props.onRulesChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedRules = parse(editorStr);\n      props.onRulesChanged(changedRules);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true\n    } catch (e) {\n      console.error(\"[CodyWizard] Business Rules Editor invalid JSON: \", e);\n\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  const handleOpenInformationReference = (ref: string) => {\n    const refVo = getRefVo(Schema.fromString(ref), elementsTree);\n\n    if(refVo) {\n      isRefOpening = true;\n      dispatch(setSideBySideCell(refVo.getId()));\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('business-rules', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-business-rules-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      onOpenInformationReference={handleOpenInformationReference}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        automaticLayout: true,\n        mouseWheelZoom: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedRulesStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedRulesStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedRulesStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(BusinessRulesEditor);\n\nconst getExprSuggests = (commandSchema: Schema): string[] => {\n  const suggests: string[] = commandSchema.getObjectProperties().map(prop => `command.${prop}`);\n\n  suggests.push('meta.user.userId');\n\n  return suggests;\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Node, NodeType} from \"../../../../model/Graph\";\nimport {RulesDependency, RulesDependencyMetadata} from \"../../../../service/cody-wizard/rule-engine/types\";\nimport {Schema} from \"../../../../service/cody-wizard/schema/schema\";\nimport {getVoMetadata} from \"../../../../service/cody-wizard/vo/get-vo-metadata\";\n\nexport const makeDependenciesSchema = (dependencies: Record<string, RulesDependencyMetadata>, messageSchema: Schema, elementsTree: ElementsTree): string => {\n\n  const properties: Record<string, JSONSchema7> = {};\n\n  Object.keys(dependencies).forEach(depName => {\n    const dep = dependencies[depName];\n\n    properties[depName] = makeDependencySchema(dep, messageSchema, elementsTree);\n  })\n\n  const schema: JSONSchema7 = {\n    type: \"object\",\n    additionalProperties: true,\n    required: Object.keys(dependencies),\n    properties,\n  }\n\n  return JSON.stringify(schema);\n}\n\nconst makeDependencySchema = (dep: RulesDependencyMetadata, messageSchema: Schema, elementsTree: ElementsTree): JSONSchema7 => {\n  return {\n    type: \"object\",\n    additionalProperties: false,\n    properties: {\n      alias: {type: \"string\"},\n      type: {type: \"string\", enum: [\"query\", \"service\", \"events\"]},\n      options: dep.type === \"query\"\n        ? {type: \"object\"} /* @TODO: fix dep is no longer a Node {\n          type: \"object\",\n          additionalProperties: false,\n          properties: {\n            mapping: makeMappingSchema(dep, messageSchema, elementsTree),\n            query: makeMappingSchema(dep, messageSchema, elementsTree)\n          }\n        } */\n        : {type: \"object\"}\n    }\n  }\n}\n\nconst makeMappingSchema = (node: Node, messageSchema: Schema, elementsTree: ElementsTree): JSONSchema7 => {\n  if(node.getType() === NodeType.document) {\n    const voMeta = getVoMetadata(node);\n    let querySchema = voMeta.querySchema || new Schema({});\n\n    if(querySchema.isRef()) {\n      querySchema = querySchema.resolveRef(elementsTree);\n    }\n\n    if(!querySchema.isObject()) {\n      return {type: \"object\"};\n    }\n\n    const mappingSchema: JSONSchema7 = {\n      type: \"string\",\n      enum: messageSchema.getObjectProperties()\n    }\n\n    const properties: Record<string, JSONSchema7> = {};\n\n    querySchema.getObjectProperties().forEach(prop => {\n      properties[prop] = mappingSchema;\n    })\n\n    properties.$not = {type: \"string\", enum: querySchema.getObjectProperties()};\n\n    return {\n      type: \"object\",\n      additionalProperties: false,\n      properties,\n    }\n  }\n\n  return {type: \"object\"}\n}\n","import * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {RulesDependency, RulesDependencyMetadata} from \"../../../service/cody-wizard/rule-engine/types\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {makeDependenciesSchema} from \"./Validation/dependencies-schema\";\n\ninterface OwnProps {\n  boardId: BoardId;\n  dependencies: Record<string, RulesDependencyMetadata>;\n  messageSchema: Schema;\n  onDependenciesChanged: (dependencies: Record<string, RulesDependencyMetadata> | undefined) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype DependenciesEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst DependenciesEditor = (props: DependenciesEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('dependencies'));\n  const dispatch = useDispatch();\n\n  let value = props.dependencies ? dependenciesToString(props.dependencies) : '';\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-dependencies-schema.json`,\n      language: \"json\",\n      value,\n      schema: props.dependencies ? makeDependenciesSchema(props.dependencies, props.messageSchema, elementsTree) : undefined,\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.sessionId, value]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onDependenciesChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedDependenciesConfig = parse(editorStr);\n      props.onDependenciesChanged(changedDependenciesConfig);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Dependencies Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.query_schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('dependencies', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-dependencies-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedDependenciesStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedDependenciesStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedDependenciesStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(DependenciesEditor);\n\ntype DependencyConfig = Record<string, {alias?: string, options?: Record<string, any>}>;\n\nconst dependenciesToString = (dependencies: Record<string, RulesDependencyMetadata>): string => {\n  return stringify(dependencies, null, 2);\n}\n","import * as React from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Divider, Icon, Popup} from \"semantic-ui-react\";\nimport {toggleSidebarDivider} from \"../../../../Layout/actions/commands\";\nimport {makeDividerCollapsedByNameSelector} from \"../../../../Layout/selectors/sidebar-divider\";\n\ninterface OwnProps {\n  label: string;\n  content: React.ReactNode;\n  popupContent?: React.ReactNode;\n}\n\ntype EditorDividerProps = OwnProps;\n\nconst EditorDivider = (props: EditorDividerProps) => {\n  const selector = makeDividerCollapsedByNameSelector(props.label);\n  const collapsed = useSelector(selector);\n  const showContent = !collapsed;\n  const dispatch = useDispatch();\n\n  const style = showContent ? {cursor: 'pointer'} : {cursor: 'pointer', textDecoration: 'line-through'};\n\n  const handleClick = () => dispatch(toggleSidebarDivider(props.label, !collapsed));\n\n  return <>{\n    props.popupContent\n      ? <Divider horizontal={true} section={true} style={style} onClick={handleClick}>{props.label}&nbsp;&nbsp;<Popup\n        trigger={<Icon name=\"question circle outline\"/>} hoverable={true}>{props.popupContent}</Popup></Divider>\n      : <Divider horizontal={true} content={props.label} section={true} style={style} onClick={handleClick}/>\n  }\n    {showContent && props.content}\n  </>\n};\n\nexport default EditorDivider;\n","import {Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\n\nconst getDividerCollapsedByName = (state: Record<ApplicationState>, divider: string): boolean => !!state.getIn(['inspectioSidebar', 'sidebar', 'dividers', divider]);\n\nexport const makeDividerCollapsedByNameSelector = (divider: string): (state: Record<ApplicationState>) => boolean => (state: Record<ApplicationState>) => getDividerCollapsedByName(state, divider);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n  label: string;\n  isAggregate: boolean;\n}\n\ntype BusinessRulesEditorDividerProps = OwnProps & WithNamespaces;\n\nconst BusinessRulesEditorDivider = (props: BusinessRulesEditorDividerProps) => {\n  return <EditorDivider label={props.label} content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.businessRules.help1')}</p>\n    <p>{props.t('insp.cody_wizard.editor.businessRules.help2')}</p>\n    <p>{props.t('insp.cody_wizard.editor.contextVariables')}</p>\n    <ul>\n      <li>command: command data</li>\n      <li>meta: command metadata</li>\n      {props.isAggregate && <li>information: aggregate state</li>}\n      <li>Command Dependencies</li>\n    </ul>\n    <p>{props.t('insp.cody_wizard.editor.autocomplete')}</p>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#business-rules\"\n          onClick={e => e.stopPropagation()}\n          target=\"_blank\"\n          rel=\"nofollow\">{props.t('app.learnMore')}</a></p>\n  </>}/>\n};\n\nexport default withNamespaces()(BusinessRulesEditorDivider);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n  label: string;\n  messageType: \"command\" | \"event\" | \"query\";\n}\n\ntype DependenciesEditorDividerProps = OwnProps & WithNamespaces;\n\nconst DependenciesEditorDivider = (props: DependenciesEditorDividerProps) => {\n  return <EditorDivider label={props.label} content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.dependencies.help1')}</p>\n    <p>{props.t('insp.cody_wizard.editor.dependencies.help2')}</p>\n    <p>{props.t('insp.cody_wizard.editor.contextVariables')}</p>\n    <ul>\n      <li>{props.messageType}: {props.messageType} data</li>\n      <li>meta: {props.messageType} metadata</li>\n      <li>Loaded Query Dependencies</li>\n    </ul>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#dependencies\"\n          onClick={e => e.stopPropagation()}\n          target=\"_blank\"\n          rel=\"nofollow\">{props.t('app.learnMore')}</a></p>\n  </>}/>\n};\n\nexport default withNamespaces()(DependenciesEditorDivider);\n","import * as React from 'react';\nimport {Button} from \"semantic-ui-react\";\n\ninterface OwnProps {\n  hasSuggestions: boolean;\n  onSuggest: () => void;\n}\n\ntype CodySuggestButtonProps = OwnProps;\n\nconst CodySuggestButton = (props: CodySuggestButtonProps) => {\n  return <Button basic={true}\n                 compact={true}\n                 icon=\"arrow alternate circle up\"\n                 className=\"noborder\"\n                 content={'Cody Suggest'} disabled={!props.hasSuggestions} onClick={() => props.onSuggest()} />\n};\n\nexport default CodySuggestButton;\n","import * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {\n  Graph,\n  makeNodeFromJs,\n  Node,\n  NodeType\n} from \"../../../model/Graph\";\nimport {AggregateMetadata, getAggregateMetadata} from \"../../../service/cody-wizard/aggregate/get-aggregate-metadata\";\nimport {getCommandMetadata} from \"../../../service/cody-wizard/command/get-command-metadata\";\nimport {ImmutableDDDWizardContext} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {suggestDependenciesForNode} from \"../../../service/cody-wizard/dependencies/suggest-dependencies-for-node\";\nimport {names} from \"../../../service/cody-wizard/node/names\";\nimport {Rule} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {RulesDependencyMetadata} from \"../../../service/cody-wizard/rule-engine/types\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {ensureSingularNoun, isAdjective, isNoun, tagSentence} from \"../../../service/cody-wizard/tagger\";\nimport {stringify} from \"../../../service/json/json-comment-wrapper\";\nimport BusinessRulesEditor from \"../Editor/BusinessRulesEditor\";\nimport DependenciesEditor from \"../Editor/DependenciesEditor\";\nimport BusinessRulesEditorDivider from \"../Editor/Divider/BusinessRulesEditorDivider\";\nimport DependenciesEditorDivider from \"../Editor/Divider/DependenciesEditorDivider\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport {WithWizardStepProps} from \"../WizardModal\";\n\ninterface OwnProps {\n\n}\n\ntype AggregateProps = OwnProps & WithWizardStepProps<ImmutableDDDWizardContext> & WithNamespaces;\n\nlet lastAggregateId: string = '';\n\nconst Aggregate = (props: AggregateProps) => {\n  const aggregate = props.ctx.aggregate;\n  const version = props.ctx.aggregate ? props.ctx.aggregate.getVersion() : 0;\n  const aggregateId = props.ctx.aggregate ? props.ctx.aggregate.getId() : '';\n\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedAggregate, setSelectedAggregate] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<AggregateMetadata>({});\n  const [autoFocusBusinessRules, setAutoFocusBusinessRules] = useState(false);\n  const [dependencies, setDependencies] = useState<Record<string, RulesDependencyMetadata>>({});\n  const [showDependencies, setShowDependencies] = useState(false);\n\n  const updateMetadata = (meta: AggregateMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    setMetadata(meta);\n  }\n\n  const updateDependencies = (deps: Record<string, RulesDependencyMetadata>) => {\n    if(props.mode === \"sidebar\" && selectedAggregate) {\n      if(props.ctx.command) {\n        const cmdMeta = getCommandMetadata(props.ctx.command);\n        const currentCmdDeps = stringify(cmdMeta.dependencies || {});\n\n        if(currentCmdDeps !== stringify(deps)) {\n          cmdMeta.dependencies = deps;\n          graph.changeNodeMetadata(props.ctx.command, stringify(cmdMeta, null, 2));\n        }\n      }\n    }\n\n    props.onCtxChanged({...props.ctx, commandDependencies: deps});\n\n    setDependencies(deps);\n  }\n\n  useEffect(() => {\n    if(lastAggregateId !== aggregateId) {\n      resetForm();\n    }\n\n\n    if(aggregate) {\n      setSelectedAggregate(aggregate);\n      const meta = getAggregateMetadata(aggregate);\n      setMetadata(meta);\n    }\n\n    if(lastAggregateId !== aggregateId && Object.keys(props.ctx.commandDependencies).length) {\n      setShowDependencies(true);\n      setDependencies(props.ctx.commandDependencies);\n    }\n\n    lastAggregateId = aggregateId;\n  }, [aggregateId, version]);\n\n  useEffect(() => {\n    setDependencies(props.ctx.commandDependencies || {});\n  }, [props.ctx.commandDependencies]);\n\n  const resetForm = () => {\n    setSelectedAggregate(null);\n    setMetadata({});\n    setAutoFocusBusinessRules(false);\n    setDependencies({});\n    setShowDependencies(false);\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleRulesChanged = (newRuleSet: Rule[] | undefined) => {\n    if(!newRuleSet) {\n      newRuleSet = [];\n    }\n\n    props.onCtxChanged({...props.ctx, commandHandler: newRuleSet});\n    updateMetadata({...metadata, rules: newRuleSet});\n  }\n\n  const handleDependenciesConfigChanged = (changedDependencies: Record<string, RulesDependencyMetadata> | undefined) => {\n    updateDependencies(changedDependencies || {});\n  }\n\n  const handleSuggestDependencies = () => {\n    if(!selectedAggregate) {\n      return;\n    }\n\n    const newDeps = suggestDependenciesForNode(selectedAggregate, dependencies);\n\n    if(stringify(newDeps) !== stringify(dependencies)) {\n      handleDependenciesConfigChanged(newDeps);\n    }\n  }\n\n  const cmdSchema = props.ctx.command ? getCommandMetadata(props.ctx.command).schema || new Schema({}) : new Schema({});\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <div className={'field'}>\n      {<Button basic={true} icon={showDependencies? 'minus' : 'add'} labelPosition=\"left\" size=\"mini\"\n               content={props.t('insp.cody_wizard.step_aggregate.manage_dependencies') + ` (${Object.keys(dependencies).length})`} color=\"blue\" className=\"text\"\n               onClick={() => setShowDependencies(!showDependencies)}\n               disabled={!selectedAggregate || !selectedAggregate.isEnabled()}/>}\n    </div>\n    <div className={(showDependencies? 'slidedown' : 'slideup') + ' smooth'} >\n      <DependenciesEditorDivider messageType=\"command\" label={props.t('insp.cody_wizard.step_aggregate.dependencies_label') as string}\n                     content={<>\n                       <DependenciesEditor boardId={props.ctx.board.uid}\n                                           dependencies={dependencies}\n                                           messageSchema={cmdSchema}\n                                           autofocus={false}\n                                           onDependenciesChanged={handleDependenciesConfigChanged}\n                                           readonly={!selectedAggregate || !selectedAggregate.isEnabled()}\n                                           sessionId={selectedAggregate ? selectedAggregate.getId() : undefined }\n                       />\n                       <CodySuggestButton hasSuggestions={!!(selectedAggregate && selectedAggregate.getSources().filter(s => [NodeType.document, NodeType.externalSystem, NodeType.event].includes(s.getType())).count() > 0)}\n                                          onSuggest={handleSuggestDependencies}\n                       />\n                     </>} />\n\n    </div>\n    <BusinessRulesEditorDivider isAggregate={true} label={props.t('insp.cody_wizard.step_aggregate.rules_label') as string} content={<>\n      <BusinessRulesEditor rules={metadata.rules || suggestEventRecordingRules(props.ctx)}\n                           boardId={props.ctx.board.uid}\n                           elementId={selectedAggregate ? selectedAggregate.getId() : '' }\n                           sessionId={selectedAggregate ? selectedAggregate.getId() : undefined }\n                           commandSchema={cmdSchema}\n                           dependencies={dependencies}\n                           onRulesChanged={handleRulesChanged}\n                           autofocus={autoFocusBusinessRules}\n                           possibleEvents={props.ctx.events}\n                           readonly={!selectedAggregate || !selectedAggregate.isEnabled()}\n      />\n    </>}/>\n\n    <div style={{marginTop: '100px'}} />\n  </form>\n\n};\n\nexport default withNamespaces()(Aggregate);\n\nexport const suggestEventRecordingRules = (ctx: ImmutableDDDWizardContext): Rule[] => {\n  const rules: Rule[] = [];\n\n  ctx.events.forEach(evt => {\n    rules.push({\n      rule: \"always\",\n      then: {\n        record: {\n          event: evt.getTechnicalName(),\n          mapping: \"$> command\"\n        }\n      }\n    })\n  })\n\n  return rules;\n}\n\nexport const suggestAggregateName = (ctx: ImmutableDDDWizardContext, graph: Graph): string | undefined => {\n  let name = '';\n\n  if(ctx.state) {\n    return ctx.state.getTechnicalName();\n  } else if(ctx.command) {\n    name = ctx.command.getTechnicalName();\n  } else if(ctx.events.count()) {\n    name = ctx.events.first(makeNodeFromJs({})).getTechnicalName();\n  }\n\n  if(name === '') {\n    return;\n  }\n\n  const nodeNames = names(name);\n\n  const words = tagSentence(nodeNames.title);\n\n  console.log(\"[CodyWizard] tagged words: \", words);\n\n  return words.filter(word => isNoun(word) || isAdjective(word)).map(word =>  isNoun(word) ? ensureSingularNoun(word) : word.token).join(\" \");\n}\n","import {JSONSchema7TypeName} from \"json-schema\";\nimport {names} from \"../node/names\";\nimport {Schema} from \"./schema\";\nimport {isShorthand} from \"./shorthand\";\n\nconst removeOneNestingLevel = (lines: string[]): string[] => {\n  const modifiedLines: string[] = [];\n\n  lines.forEach(line => {\n    if(line.charAt(0) !== \"-\") {\n      line = line.slice(1);\n    }\n\n    if(line.charAt(0) !== \"-\") {\n      line = line.slice(1);\n    }\n\n    modifiedLines.push(line);\n  })\n\n  return modifiedLines;\n}\n\ninterface Line {\n  isSchemaLine: boolean;\n  isSubSchema: boolean;\n  type: JSONSchema7TypeName;\n  propName: string;\n  raw: string;\n}\n\nconst INVALID_LINE: Line = {\n  isSchemaLine: false,\n  isSubSchema: false,\n  type: \"null\",\n  propName: '',\n  raw: ''\n};\n\nexport class SchemaFromNodeDescriptionParser {\n  private lines: string[];\n  private currentLine = 0;\n  private schema: Schema;\n\n  constructor(desc: string) {\n    this.lines = desc.split(\"\\n\");\n    this.schema = new Schema({});\n\n    console.log(this.lines);\n  }\n\n  public parse(): Schema {\n    let line = this.parseNextLine();\n    console.log(\"next line\", line);\n\n    while (line.isSchemaLine) {\n      if(line.type === \"object\") {\n        const subSchemaLines = this.parseAllSubSchemaLines();\n        const subSchema = (new SchemaFromNodeDescriptionParser(removeOneNestingLevel(subSchemaLines).join(\"\\n\"))).parse();\n        this.schema.setObjectProperty(line.propName, subSchema);\n      } else {\n        this.schema.setObjectProperty(line.propName, new Schema(line.type));\n      }\n\n      line = this.parseNextLine();\n      console.log(\"next line\", line)\n    }\n\n    return this.schema;\n  }\n\n  private parseAllSubSchemaLines(): string[] {\n    let currentLine = this.currentLine;\n\n    let line = this.parseNextLine();\n\n    const subSchemaLines: string[] = [];\n\n    while (line.isSubSchema) {\n      subSchemaLines.push(line.raw);\n\n      currentLine = this.currentLine;\n      line = this.parseNextLine();\n    }\n\n    // Jump one position back\n    this.currentLine = currentLine;\n\n    return subSchemaLines;\n  }\n\n  private parseNextLine(): Line {\n    const lineStr = this.getNextLine();\n\n    console.log(lineStr);\n\n    if(!lineStr) {\n      return INVALID_LINE;\n    }\n\n    if(lineStr.trimLeft().charAt(0) !== \"-\") {\n      return INVALID_LINE;\n    }\n\n    const [prop, type] = lineStr.split(\":\");\n\n    console.log(\"line split\", prop, typeof type, prop.charAt(0) !== \"-\");\n\n    const isSubSchema = prop.charAt(0) !== \"-\";\n    const propName = names(prop.trim().slice(1).trimLeft()).propertyName;\n    let schemaType: JSONSchema7TypeName = propName.toLowerCase().match(/id$/) ? \"string|format:uuid\" as JSONSchema7TypeName : \"string\";\n\n    if(typeof type === \"string\") {\n      if(type.trim() === \"\") {\n        schemaType = \"object\";\n      } else if (isShorthand(type.trim())) {\n        schemaType = type.trim() as JSONSchema7TypeName;\n      }\n    }\n\n    return {\n      isSchemaLine: true,\n      isSubSchema,\n      propName,\n      type: schemaType,\n      raw: lineStr,\n    }\n  }\n\n  private getNextLine(): string | undefined {\n    const line = this.lines[this.currentLine];\n    this.currentLine++;\n    return line;\n  }\n}\n","import {Node} from \"../../../model/Graph\";\nimport {Schema} from \"./schema\";\nimport {SchemaFromNodeDescriptionParser} from \"./schema-from-node-description-parser\";\n\nexport const getSchemaFromNodeDescription = (node: Node): Schema => {\n  const desc = node.getDescription();\n\n  if(desc === '') {\n    return new Schema({});\n  }\n\n  const parser = new SchemaFromNodeDescriptionParser(desc);\n\n  return parser.parse();\n}\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n}\n\ntype SchemaEditorDividerProps = OwnProps & WithNamespaces;\n\nconst SchemaEditorDivider = (props: SchemaEditorDividerProps) => {\n  return <EditorDivider label=\"Schema\" content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.schema.help1')}</p>\n    <p>{props.t('insp.cody_wizard.editor.schema.help2')}</p>\n    <p>{props.t('insp.cody_wizard.editor.autocomplete')}</p>\n    <p>{props.t('insp.cody_wizard.editor.schema.help3')}</p>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/Schema.html\"\n          onClick={e => e.stopPropagation()}\n          target=\"_blank\"\n          rel=\"nofollow\">{props.t('app.learnMore')}</a></p>\n  </>} />\n};\n\nexport default withNamespaces()(SchemaEditorDivider);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n  type: \"command\" | \"state\" | \"table\";\n}\n\ntype UiSchemaEditorDividerProps = OwnProps & WithNamespaces;\n\nconst UiSchemaEditorDivider = (props: UiSchemaEditorDividerProps) => {\n  return <EditorDivider label=\"UI Schema\" content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.uiSchema.help1' + props.type)}</p>\n    <p>{props.t('insp.cody_wizard.editor.autocomplete')}</p>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/UI-Schema.html\" target=\"_blank\"\n          rel=\"nofollow\" onClick={e => e.stopPropagation()}>{props.t('app.learnMore')}</a></p>\n  </>}/>\n};\n\nexport default withNamespaces()(UiSchemaEditorDivider);\n","import * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {BoardId} from \"../../../model/Board\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\n\ninterface OwnProps {\n  boardId: BoardId;\n  streamId: string;\n  onStreamIdChanged: (streamId: string) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n  ctx: WizardContext;\n}\n\ntype StreamIdEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst StreamIdEditor = (props: StreamIdEditorProps) => {\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('stream-id'));\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n\n    let value = stringify({\"streamId\": props.streamId}, null, 2);\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-stream-id.json`,\n      language: \"json\",\n      value,\n      schema: JSON.stringify({\n        \"type\": \"object\",\n        \"additionalProperties\": false,\n        \"required\": [\"streamId\"],\n        \"properties\": {\n          \"streamId\": {\n            \"type\": \"string\",\n            \"markdownDescription\": \"No two commands can record events with the same streamId at the same time.\\n\\n**Optimistic Locking** is used to block concurrent writes.\\n\\n**Jexl Expression**\\n\\nScope:\\n\\n- **command**\\n- **meta**\"\n          }\n        }\n      }),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.streamId]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onStreamIdChanged('');\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedConfig = parse(editorStr);\n      props.onStreamIdChanged(changedConfig.streamId || '');\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] UI Config Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('stream-id', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-stream-id-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(StreamIdEditor);\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {getVoMetadata} from \"./get-vo-metadata\";\nimport {isListVo} from \"./is-list-vo\";\nimport {isQueryableVo} from \"./is-queryable-vo\";\n\nexport const isQueryableItemVo = (node: Node): boolean => {\n  if(node.getType() !== NodeType.document) {\n    return false;\n  }\n\n  if(isListVo(node)) {\n    return false;\n  }\n\n  const meta = getVoMetadata(node);\n\n  return isQueryableVo(node);\n}\n","import {Node} from \"../../../model/Graph\";\nimport {getVoMetadata} from \"./get-vo-metadata\";\n\nexport const isQueryableVo = (vo: Node): boolean => {\n  const voMeta = getVoMetadata(vo);\n  return !!voMeta.querySchema;\n}\n","import {ServiceName} from \"../../../../model/Board\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {NodeType} from \"../../../../model/Graph\";\nimport {fqcn} from \"../../../../service/cody-wizard/node/fqcn\";\nimport {names} from \"../../../../service/cody-wizard/node/names\";\nimport {Schema} from \"../../../../service/cody-wizard/schema/schema\";\nimport {getSchemaRefName} from \"../../../../service/cody-wizard/vo/get-schema-ref-name\";\nimport {getVoMetadata} from \"../../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {isListVo} from \"../../../../service/cody-wizard/vo/is-list-vo\";\nimport {isQueryableItemVo} from \"../../../../service/cody-wizard/vo/is-queryable-item-vo\";\nimport {isStateVo} from \"../../../../service/cody-wizard/vo/is-state-vo\";\n\nexport const getPossibleStateRefs = (elementsTree: ElementsTree): string[] => {\n  return elementsTree.getFilteredElementsByType(NodeType.document)\n    .filter(vo => isStateVo(vo))\n    .map(vo => {\n      const voMeta = getVoMetadata(vo);\n      return getSchemaRefName(vo, voMeta);\n    })\n    .toArray()\n}\n\nexport const getPossibleQueryableItemRefs = (elementsTree: ElementsTree): string[] => {\n  return elementsTree.getFilteredElementsByType(NodeType.document)\n    .filter(vo => isQueryableItemVo(vo))\n    .map(vo => {\n      const voMeta = getVoMetadata(vo);\n      return getSchemaRefName(vo, voMeta);\n    })\n    .toArray()\n}\n\nexport const getPossibleListVOs = (elementsTree: ElementsTree): string[] => {\n  const possibleRefs: string[] = [];\n\n  elementsTree.getFilteredElementsByType(NodeType.document).forEach(ele => {\n    const voMeta = getVoMetadata(ele);\n\n    if(!voMeta.querySchema) {\n      return;\n    }\n\n    if(!isListVo(ele)) {\n      return;\n    }\n\n    const possibleRef = getSchemaRefName(ele, voMeta);\n\n    if(!possibleRefs.includes(possibleRef)) {\n      possibleRefs.push(possibleRef);\n    }\n  });\n\n  return possibleRefs;\n}\n\nexport const getPossibleQueryableVORefsWithoutQueryParams = (elementsTree: ElementsTree): string[] => {\n  const possibleRefs: string[] = [];\n\n  elementsTree.getFilteredElementsByType(NodeType.document).forEach(ele => {\n    const voMeta = getVoMetadata(ele);\n\n    if(!voMeta.querySchema) {\n      return;\n    }\n\n    if(!voMeta.querySchema.isEmpty()) {\n      return;\n    }\n\n    const possibleRef = getSchemaRefName(ele, voMeta);\n\n    if(!possibleRefs.includes(possibleRef)) {\n      possibleRefs.push(possibleRef);\n    }\n  });\n\n  return possibleRefs;\n}\n\nexport const getItemProperties = (nodeSchema: Schema, elementsTree: ElementsTree): string[] => {\n  if(!nodeSchema.isList()) {\n    return [];\n  }\n\n  let listItemSchema = nodeSchema.getListItemsSchema(new Schema({}));\n\n  if(listItemSchema.isRef()) {\n    listItemSchema =  listItemSchema.resolveRef(elementsTree);\n  }\n\n  return listItemSchema.getObjectProperties();\n}\n\nexport const getPossiblePages = (elementsTree: ElementsTree): string[] => {\n  return elementsTree.getFilteredElementsByType(NodeType.ui).map(ui => names(ui.getTechnicalName()).className).toArray();\n}\n\nexport const getPossibleCommands = (elementsTree: ElementsTree): string[] => {\n  return elementsTree.getFilteredElementsByType(NodeType.command).map(cmd => names(cmd.getTechnicalName()).className).toArray();\n}\n\nexport const getPossibleViews = (elementsTree: ElementsTree): string[] => {\n  return elementsTree.getFilteredElementsByType(NodeType.document).map(view => names(view.getTechnicalName()).className).toArray();\n}\n\nexport const getPossibleForms = (elementsTree: ElementsTree): string[] => {\n  return elementsTree.getFilteredElementsByType(NodeType.document).map(view => getSchemaRefName(view, getVoMetadata(view), false, true)).toArray()\n}\n","// originally taken from: https://github.com/rcorp/css-schema/blob/master/cssschema.json\n\nimport {JSONSchema7} from \"json-schema\";\n\nexport const makeCssSchemaDefinitions = (): {\"mui-container\": JSONSchema7, sx: JSONSchema7, sx_breakpoints: JSONSchema7, css: JSONSchema7} => {\n  return {\n    \"mui-container\": {\n      anyOf: [\n        {$ref: \"#/definitions/sx_breakpoints\"},\n        {\n          type: \"object\",\n          additionalProperties: true,\n          properties: {\n            \"sx\": {$ref: \"#/definitions/sx\"},\n            \"className\": {type: \"string\"},\n            \"spacing\": {\n              oneOf: [\n                {type: \"integer\", default: 2},\n                {$ref: \"#/definitions/sx_breakpoints\"}\n              ]\n            },\n            \"rowSpacing\": {\n              oneOf: [\n                {type: \"integer\", default: 2},\n                {$ref: \"#/definitions/sx_breakpoints\"}\n              ]\n            },\n            \"columnSpacing\": {\n              oneOf: [\n                {type: \"integer\", default: 2},\n                {$ref: \"#/definitions/sx_breakpoints\"}\n              ]\n            },\n            \"columns\": {\n              oneOf: [\n                {type: \"integer\", default: 2},\n                {$ref: \"#/definitions/sx_breakpoints\"}\n              ]\n            },\n            \"xsOffset\": {\n              oneOf: [\n                {type: \"integer\", default: 1},\n                {const: \"auto\"}\n              ]\n            },\n            \"smOffset\": {\n              oneOf: [\n                {type: \"integer\", default: 1},\n                {const: \"auto\"}\n              ]\n            },\n            \"mdOffset\": {\n              oneOf: [\n                {type: \"integer\", default: 1},\n                {const: \"auto\"}\n              ]\n            },\n            \"lgOffset\": {\n              oneOf: [\n                {type: \"integer\", default: 1},\n                {const: \"auto\"}\n              ]\n            },\n            \"xlOffset\": {\n              oneOf: [\n                {type: \"integer\", default: 1},\n                {const: \"auto\"}\n              ]\n            }\n          }\n        }\n      ]\n    },\n    sx: {\n      anyOf: [\n        {$ref: \"#/definitions/css\"},\n        {\n          patternProperties: {\n            \"^&\": {$ref: \"#/definitions/sx\"}\n          }\n        },\n        {\n          type: \"object\",\n          additionalProperties: true\n        }\n      ]\n    } as JSONSchema7,\n    sx_breakpoints: {\n      type: \"object\",\n      additionalProperties: true,\n      properties: {\n        \"xs\": { oneOf: [{type: \"integer\", default: 12}, {type: \"boolean\", default: true}, {const: \"auto\"}]},\n        \"sm\": { oneOf: [{type: \"integer\", default: 12}, {type: \"boolean\", default: true}, {const: \"auto\"}]},\n        \"md\": { oneOf: [{type: \"integer\", default: 12}, {type: \"boolean\", default: true}, {const: \"auto\"}]},\n        \"lg\": { oneOf: [{type: \"integer\", default: 12}, {type: \"boolean\", default: true}, {const: \"auto\"}]},\n        \"xl\": { oneOf: [{type: \"integer\", default: 12}, {type: \"boolean\", default: true}, {const: \"auto\"}]},\n      }\n    },\n    css: {\n      ...makeCssSchema(),\n      \"length\": {\n        \"type\": \"string\",\n      },\n      \"time\": {\n        \"type\": \"string\",\n      },\n      \"overflow\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"visible\",\n          \"scroll\",\n          \"hidden\",\n          \"auto\"\n        ],\n      }\n    } as JSONSchema7\n  }\n}\n\nexport const makeCssSchema = (): JSONSchema7 => {\n  return {\n    \"type\": \"object\",\n    \"properties\": {\n      \"display\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"inline\",\n          \"table-row-group\",\n          \"table-row\",\n          \"table-header-group\",\n          \"table-footer-group\",\n          \"table-column-group\",\n          \"table-column\",\n          \"table-cell\",\n          \"table-caption\",\n          \"table\",\n          \"run-in\",\n          \"none\",\n          \"list-item\",\n          \"inline-table\",\n          \"inline-flex\",\n          \"inline-block\",\n          \"flex\",\n          \"compact\",\n          \"block\"\n        ],\n\n      },\n      \"position\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"static\",\n          \"sticky\",\n          \"relative\",\n          \"page\",\n          \"fixed\",\n          \"center\",\n          \"absolute\"\n        ],\n\n      },\n      \"color\": {\n        \"type\": \"string\",\n        \"format\": \"color\",\n        \"title\": \"color\",\n        \"default\": \"#ffa500\"\n      },\n      \"background\": {\n        \"type\": \"string\"\n      },\n      \"backgroundColor\": {\n        \"type\": \"string\",\n        \"format\": \"color\",\n        \"title\": \"background-color\",\n        \"default\": \"#ffa500\"\n      },\n      \"fontFamily\": {\n        \"type\": \"string\",\n        \"title\": \"font-family\"\n      },\n      \"float\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"right\",\n          \"left\"\n        ],\n\n      },\n      \"all\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"initial\",\n          \"unset\",\n          \"inherit\"\n        ],\n\n      },\n      \"animationDirection\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"reverse\",\n          \"alternate-reverse\",\n          \"alternate\"\n        ],\n\n      },\n      \"animationFillMode\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"forwards\",\n          \"both\",\n          \"backwards\"\n        ],\n\n      },\n      \"animationPlayMode\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"running\",\n          \"paused\"\n        ],\n\n      },\n      \"visibility\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"visible\",\n          \"hidden\",\n          \"collapse\"\n        ],\n\n      },\n      \"backfaceVisibility\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"visible\",\n          \"hidden\"\n        ],\n\n      },\n      \"backgroundAttachment\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"scroll\",\n          \"local\",\n          \"fixed\"\n        ],\n\n      },\n      \"backgroundClip\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"border-box\",\n          \"padding-box\",\n          \"content-box\"\n        ],\n\n      },\n      \"backgroundOrigin\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"padding-box\",\n          \"content-box\",\n          \"border-box\"\n        ],\n\n      },\n      \"backgroundRepeat\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"repeat\",\n          \"space\",\n          \"round\",\n          \"repeat-y\",\n          \"repeat-x\",\n          \"repeat no-repeat\",\n          \"no-repeat\"\n        ],\n\n      },\n      \"border\": {\n        type: \"string\"\n      },\n      \"borderRadius\": {\n        type: \"string\"\n      },\n      \"borderCollapse\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"separate\",\n          \"collapse\"\n        ],\n\n      },\n      \"borderImageRepeat\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"stretch\",\n          \"space\",\n          \"round\",\n          \"repeat\"\n        ],\n\n      },\n      \"boxDecorationBreak\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"slice\",\n          \"clone\"\n        ],\n\n      },\n      \"boxSizing\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"content-box\",\n          \"padding-box\",\n          \"border-box\"\n        ],\n\n      },\n      \"breakBefore\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"right\",\n          \"page\",\n          \"left\",\n          \"column\",\n          \"avoid-page\",\n          \"avoid-column\",\n          \"avoid\",\n          \"always\"\n        ],\n\n      },\n      \"breakAfter\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"right\",\n          \"page\",\n          \"left\",\n          \"column\",\n          \"avoid-page\",\n          \"avoid-column\",\n          \"avoid\",\n          \"always\"\n        ],\n\n      },\n      \"breakInside\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"avoid-page\",\n          \"avoid-column\",\n          \"avoid\"\n        ],\n\n      },\n      \"captionSide\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"top\",\n          \"bottom\"\n        ],\n\n      },\n      \"clear\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"right\",\n          \"left\",\n          \"both\"\n        ],\n\n      },\n      \"clearAfter\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"top\",\n          \"start\",\n          \"right\",\n          \"outside\",\n          \"left\",\n          \"inside\",\n          \"end\",\n          \"descendants\",\n          \"bottom\",\n          \"both\"\n        ],\n\n\n      },\n      \"columnFill\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"balance\",\n          \"auto\"\n        ],\n\n\n      },\n      \"columnSpan\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"all\"\n        ],\n\n\n      },\n      \"columnRuleStyle\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"solid\",\n          \"ridge\",\n          \"outset\",\n          \"inset\",\n          \"hidden\",\n          \"groove\",\n          \"double\",\n          \"dotted\",\n          \"dashed\"\n        ],\n\n\n      },\n      \"emptyCells\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"show\",\n          \"hide\"\n        ],\n\n\n      },\n      \"flexDirection\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"row\",\n          \"row-reverse\",\n          \"column-reverse\",\n          \"column\"\n        ],\n      },\n      \"flexWrap\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"nowrap\",\n          \"wrap-reverse\",\n          \"wrap\"\n        ],\n      },\n      \"justifyContent\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"flex-start\",\n          \"space-between\",\n          \"space-around\",\n          \"flex-end\",\n          \"center\"\n        ],\n\n\n      },\n      \"alignItems\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"stretch\",\n          \"flex-start\",\n          \"flex-end\",\n          \"center\",\n          \"baseline\"\n        ],\n\n\n      },\n      \"alignSelf\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"stretch\",\n          \"flex-start\",\n          \"flex-end\",\n          \"center\",\n          \"baseline\"\n        ],\n\n\n      },\n      \"alignContent\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"stretch\",\n          \"space-between\",\n          \"space-around\",\n          \"flex-start\",\n          \"flex-end\",\n          \"center\"\n        ],\n\n\n      },\n      \"fontStretch\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"ultra-expanded\",\n          \"ultra-condensed\",\n          \"semi-expanded\",\n          \"semi-condensed\",\n          \"extra-expanded\",\n          \"extra-condensed\",\n          \"expanded\",\n          \"condensed\"\n        ],\n\n\n      },\n      \"fontSynthesis\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"weight style\",\n          \"weight\",\n          \"style\",\n          \"none\"\n        ],\n\n\n      },\n      \"fontKerning\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"normal\",\n          \"none\"\n        ],\n\n\n      },\n\n      \"fontVariant\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"unicase\",\n          \"titling-caps\",\n          \"small-caps\",\n          \"petite-caps\",\n          \"all-small-caps\",\n          \"all-petite-caps\"\n        ],\n\n\n      },\n      \"fontVariantCaps\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"unicase\",\n          \"titling-caps\",\n          \"small-caps\",\n          \"petite-caps\",\n          \"all-small-caps\",\n          \"all-petite-caps\"\n        ],\n\n\n      },\n      \"fontStyle\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"oblique\",\n          \"italic\"\n        ],\n\n      },\n      \"fontWeight\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"lighter\",\n          \"bolder\",\n          \"bold\",\n          \"900\",\n          \"800\",\n          \"700\",\n          \"600\",\n          \"500\",\n          \"400\",\n          \"300\",\n          \"200\",\n          \"100\"\n        ],\n\n      },\n      \"hangingPunctuation\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"last force-end\",\n          \"last allow-end\",\n          \"last\",\n          \"force-end\",\n          \"first force-end\",\n          \"first allow-end\",\n          \"first\",\n          \"allow-end\"\n        ],\n\n      },\n      \"hyphens\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"manual\",\n          \"none\",\n          \"auto\"\n        ],\n\n      },\n      \"imageResolution\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"1dppx\",\n          \"from-image\"\n        ],\n\n      },\n      \"lineBreak\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"strict\",\n          \"normal\",\n          \"loose\"\n        ],\n\n      },\n      \"listStylePosition\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"outside\",\n          \"inside\"\n        ],\n\n      },\n      \"listStyleType\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"disc\",\n          \"upper-roman\",\n          \"upper-latin\",\n          \"upper-alpha\",\n          \"square\",\n          \"none\",\n          \"lower-roman\",\n          \"lower-latin\",\n          \"lower-greek\",\n          \"lower-alpha\",\n          \"georgian\",\n          \"decimal-leading-zero\",\n          \"decimal\",\n          \"circle\",\n          \"armenian\"\n        ],\n\n      },\n      \"objectFit\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"fill\",\n          \"scale-down\",\n          \"none\",\n          \"cover\",\n          \"contain\"\n        ],\n\n      },\n      \"outlineStyle\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"solid\",\n          \"ridge\",\n          \"outset\",\n          \"inset\",\n          \"groove\",\n          \"double\",\n          \"dotted\",\n          \"dashed\",\n          \"auto\"\n        ],\n\n      },\n\n      \"overflowWrap\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"break-word\"\n        ],\n\n      },\n      \"pageBreakAfter\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"right\",\n          \"left\",\n          \"avoid\",\n          \"always\"\n        ],\n\n      },\n      \"pageBreakBefore\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"right\",\n          \"left\",\n          \"avoid\",\n          \"always\"\n        ],\n\n      },\n      \"pageBreakInside\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"avoid\"\n        ],\n\n      },\n      \"pointerEvents\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"none\"\n        ],\n\n      },\n      \"resize\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"vertical\",\n          \"horizontal\",\n          \"alwbothays\"\n        ],\n\n      },\n      \"tableLayout\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"fixed\"\n        ],\n\n      },\n      \"textAlignLast\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"start\",\n          \"right\",\n          \"left\",\n          \"justify\",\n          \"end\",\n          \"center\"\n        ],\n\n      },\n      \"textDecorationLine\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"underline\",\n          \"overline\",\n          \"line-through\",\n          \"blink\"\n        ],\n\n      },\n      \"textDecorationSkip\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"spaces\",\n          \"objects\",\n          \"ink\",\n          \"edges\",\n          \"box-decoration\"\n        ],\n\n      },\n      \"textDecorationPosition\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"under right\",\n          \"under left\",\n          \"under\",\n          \"right\",\n          \"left\"\n        ],\n\n      },\n      \"textDecorationStyle\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"solid\",\n          \"wavy\",\n          \"double\",\n          \"dotted\",\n          \"dashed\"\n        ],\n\n      },\n      \"textEmphasisPosition\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"over right\",\n          \"over left\",\n          \"below right\",\n          \"below left\"\n        ],\n\n      },\n      \"textJustify\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"auto\",\n          \"none\",\n          \"inter-word\",\n          \"distribute\"\n        ],\n\n      },\n      \"textOrientation\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"mixed\",\n          \"use-glyph-orientation\",\n          \"upright\",\n          \"sideways-right\",\n          \"sideways-left\",\n          \"sideways\"\n        ],\n\n\n      },\n      \"transformStyle\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"flat\",\n          \"preserve-3d\"\n        ],\n\n\n      },\n      \"textTransform\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"none\",\n          \"uppercase\",\n          \"lowercase\",\n          \"full-width\",\n          \"capitalize\"\n        ],\n\n\n      },\n      \"unicodeBidi\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"embed\",\n          \"bidi-override\"\n        ],\n\n\n      },\n      \"whiteSpace\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"pre-wrap\",\n          \"pre-line\",\n          \"pre\",\n          \"nowrap\"\n        ],\n\n\n      },\n      \"wordBreak\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"keep-all\",\n          \"break-all\"\n        ],\n\n\n      },\n      \"wordWrap\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"normal\",\n          \"break-word\"\n        ],\n\n\n      },\n      \"writingWode\": {\n        \"type\": \"string\",\n        \"enum\": [\n          \"horizontal-tb\",\n          \"vertical-rl\",\n          \"vertical-lr\"\n        ],\n\n\n      },\n      \"top\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"left\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"right\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"bottom\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"margin\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"marginLeft\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"marginRight\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"marginTop\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"marginBottom\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"padding\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"paddingRight\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"paddingLeft\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"paddingTop\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"paddingBottom\": {\n        \"$ref\": \"#/definitions/css/length\"\n      },\n      \"animationDelay\": {\n        \"$ref\": \"#/definitions/css/time\"\n      },\n      \"animationDuration\": {\n        \"$ref\": \"#/definitions/css/time\"\n      },\n      \"overflowX\": {\n        \"$ref\": \"#/definitions/css/overflow\"\n      },\n      \"overflowY\": {\n        \"$ref\": \"#/definitions/css/overflow\"\n      }\n\n    }\n  }\n}\n","import axios from \"axios\";\nimport {JSONSchema7} from \"json-schema\";\nimport {JSONSchemaWithMarkdown} from \"../Suggestion/markdown-description\";\nimport {makeCssSchemaDefinitions} from \"./css-schema\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./rule-engine/jexl-expressions\";\nimport {makeRuleThenPropMapping} from \"./rule-engine/prop-mapping\";\n\nconst iconNameCache: string[] = [];\nlet iconsFetched: boolean = false;\nconst installedMdiVersion = '7.7.0';\n\nif(!iconsFetched) {\n  const fetch = axios.create();\n\n  fetch.get('https://raw.githubusercontent.com/Templarian/MaterialDesign/master/meta.json').then(res => {\n    if(res.status === 200) {\n      res.data.forEach((icon: {name: string, version: string}) => {\n        if (icon.version <= installedMdiVersion) {\n          iconNameCache.push(icon.name);\n        }\n      })\n    }\n  }).catch(e => {\n    console.error(\"[CodyWizard] Could not fetch MDI icon meta.json\", e);\n  })\n\n  iconsFetched = true;\n}\n\nexport const makeUiSchema = (additions: Record<string, JSONSchema7>, possibleRefs: string[], possibleCommands: string[], possiblePages: string[], possibleListVOs: string[], possibleForms: string[], optionsAdditions?: Record<string, any>): JSONSchema7 => {\n  const assignValue = makeAssignVariable('value');\n\n  const uiSchema: JSONSchema7 = {\n    type: \"object\",\n    properties: {\n      \"ui:title\": {\"oneOf\": [{type: \"string\"}, {type: \"boolean\"}]},\n      \"ui:hidden\": {type: [\"string\", \"boolean\"]},\n      \"ui:description\": {type: \"string\"},\n      \"ui:disabled\": {type: \"boolean\"},\n      \"ui:options\": {\n        type: \"object\",\n        additionalProperties: true,\n        properties: {\n          ...optionsAdditions\n        }\n      },\n      ...additions\n    },\n    definitions: {\n      \"ui_schema\": {\n        type: \"object\",\n        properties: {\n          \"ui:title\": {\"oneOf\": [{type: \"string\"}, {type: \"boolean\"}]},\n          \"ui:hidden\": {type: \"string\"},\n          \"ui:description\": {type: \"string\"},\n          \"ui:disabled\": {type: \"boolean\"},\n          \"ui:widget\": {\n            anyOf: [\n              {type: \"string\"},\n              {const: \"DataSelect\"},\n              {const: \"color\"},\n              {const: \"hidden\"},\n              {const: \"password\"},\n              {const: \"radio\"},\n              {const: \"range\"},\n              {const: \"select\"},\n              {const: \"textarea\"}\n            ]\n          },\n          \"ui:options\": {\n            type: \"object\",\n            additionalProperties: true,\n            properties: {\n              data: {type: \"string\", enum: possibleRefs},\n              text: {type: \"string\", minLength: 1},\n              value: {type: \"string\", minLength: 1},\n              addItemCommand: {type: \"string\", enum: possibleCommands},\n              ...optionsAdditions\n            }\n          }\n        }\n      },\n      ...assignValue,\n      ...makeRuleThenPropMapping(),\n      ...makeCssSchemaDefinitions()\n    }\n  }\n\n  return uiSchema;\n}\n\nexport const makeCommandComponents = (possibleCommands: string[], possiblePages: string[], possibleListVOs: string[], possibleForms: string[]): JSONSchemaWithMarkdown => {\n  const actionType = makeActionsUiSchema(possibleCommands, possiblePages, possibleListVOs, possibleForms).actions.items;\n  return {\n    type: \"array\",\n    items: {\n      oneOf: [\n        {type: \"string\", enum: possibleCommands, markdownDescription: \"Name of the command\"},\n        actionType as JSONSchemaWithMarkdown\n      ]\n    },\n    markdownDescription: \"List of Command Buttons.\\n\\nAvailable in the **Action Bar** of the page. Each item can be either the name of a command or a command/action configuration object.\"\n  }\n}\n\nexport const makeActionsUiSchema = (possibleCommands: string[], possiblePages: string[], possibleListVOs: string[], possibleForms: string[]): {\"actions\": JSONSchemaWithMarkdown} => {\n  return {\n    \"actions\": {\n      type: \"array\",\n      items: {\n        oneOf: [\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"button\", \"type\", \"command\"],\n            properties: {\n              type: {const: \"command\"},\n              command: {type: \"string\", enum: possibleCommands},\n              connectTo: {type: \"string\", enum: possibleForms, markdownDescription: \"Connect the command button to a form on the page.\"},\n              directSubmit: {type: \"boolean\", markdownDescription: \"Directly submit the command on button click with the data provided via **data** config.\"},\n              forceSchema: {type: \"boolean\", default: false, markdownDescription: \"When submitting a connected form, force the form to use the command schema for validation.\\n\\n_Useful, when multiple commands submit the same form e.g. interim save with optional properties vs. final save with required properties._\"},\n              uiSchema: {type: \"object\"},\n              data: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n              button: makeCommandButtonUiSchema()['ui:button'],\n              position: {type: \"string\", enum: [\"top-right\", \"bottom-left\", \"bottom-center\", \"bottom-right\"]}\n            },\n            if: {\n              oneOf: [\n                {\n                  required: [\"connectTo\"]\n                },\n                {\n                  required: [\"directSubmit\"]\n                }\n              ]\n            },\n            then: {\n              properties: {\n                uiSchema: {\n                  ...makeUiSchema({...makeCommandFormUiSchema(possiblePages), ...makeCommandButtonUiSchema()}, possibleListVOs, possibleCommands, possiblePages, possibleListVOs, possibleForms, {container: {$ref: \"#/definitions/mui-container\"},}),\n                  markdownDescription: \"Override or add uiSchema properties of the command\"\n                }\n              }\n            },\n            else: {\n              properties: {\n                uiSchema: {\n                  ...makeUiSchema({...makeCommandButtonUiSchema()}, possibleListVOs, possibleCommands, possiblePages, possibleListVOs, possibleForms, {container: {$ref: \"#/definitions/mui-container\"},}),\n                  markdownDescription: \"Override or add uiSchema properties of the command\"\n                }\n              }\n            },\n            markdownDescription: \"Command configuration\"\n          } as JSONSchema7,\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"button\", \"type\", \"href\"],\n            properties: {\n              type: {const: \"link\"},\n              href: {type: \"string\", format: \"uri\"},\n              button: makeCommandButtonUiSchema()['ui:button'],\n              position: {type: \"string\", enum: [\"top-right\", \"bottom-left\", \"bottom-center\", \"bottom-right\"]}\n            }\n          },\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"button\", \"type\", \"pageLink\"],\n            properties: {\n              type: {const: \"link\"},\n              pageLink: {\n                oneOf: [\n                  {type: \"string\", enum: possiblePages},\n                  {\n                    type: \"object\",\n                    additionalProperties: false,\n                    required: [\"page\"],\n                    properties: {\n                      page: {type: \"string\", enum: possiblePages},\n                      mapping: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n                    }\n                  }\n                ]\n              },\n              button: makeCommandButtonUiSchema()['ui:button'],\n              position: {type: \"string\", enum: [\"top-right\", \"bottom-left\", \"bottom-center\", \"bottom-right\"]}\n            }\n          }\n        ]\n      }\n    }\n  }\n}\n\nexport const makeCommandButtonUiSchema = (): { \"ui:button\": JSONSchema7 } => {\n  return {\n    \"ui:button\": {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        variant: {type: \"string\", enum: [\"text\", \"outlined\", \"contained\"]},\n        'variant:expr': makeJexlExpression(),\n        color: {type: \"string\", enum: [\"primary\", \"secondary\", \"success\", \"error\", \"info\", \"warning\"]},\n        'color:expr': makeJexlExpression(),\n        style: {type: \"object\"},\n        'style:expr': makeJexlExpression(),\n        label: {type: \"string\"},\n        'label:expr': makeJexlExpression(),\n        disabled: {\n          oneOf: [\n            {type: \"boolean\"},\n            makeJexlExpression()\n          ]\n        },\n        'disabled:expr': makeJexlExpression(),\n        hidden: {\n          oneOf: [\n            {type: \"boolean\"},\n            makeJexlExpression()\n          ]\n        },\n        'hidden:expr': makeJexlExpression(),\n        icon: iconNameEnum(),\n        'icon:expr': makeJexlExpression(),\n        endIcon: iconNameEnum(),\n        'endIcon:expr': makeJexlExpression()\n      }\n    }\n  }\n}\n\nexport const makeCommandFormUiSchema = (possiblePages: string[]): {\"ui:form\": JSONSchemaWithMarkdown} => {\n  return {\n    \"ui:form\": {\n      type: \"object\",\n      additionalProperties: false,\n      markdownDescription: \"Configure behavior of the command form\",\n      properties: {\n        data: {\n          $ref: \"#/definitions/rule_then_prop_mapping\",\n          markdownDescription: \"Set the initial data of the form\"\n        },\n        successRedirect: {\n          markdownDescription: \"Redirect the user to another page when the command was successful\",\n          oneOf: [\n            {type: \"string\", enum: possiblePages},\n            {\n              type: \"object\",\n              additionalProperties: false,\n              required: [\"page\", \"mapping\"],\n              properties: {\n                page: {type: \"string\", enum: possiblePages},\n                mapping: {$ref: \"#/definitions/rule_then_prop_mapping\"}\n              }\n            }\n          ]\n        },\n        \"successRedirect:expr\": makeJexlExpression(`Define success redirect as a ${JEXL_WIKI_MARKDOWN}`)\n      }\n    }\n  }\n}\n\nexport const makeTableUiSchema = (itemProperties: string[], possiblePages: string[], possibleListRefs: string[]): {\"ui:table\": JSONSchema7} => {\n  return {\n    \"ui:table\": {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        columns: {\n          type: \"array\",\n          items: {\n            oneOf: [\n              {type: \"string\", enum: itemProperties},\n              {\n                type: \"object\",\n                additionalProperties: false,\n                properties: {\n                  \"field\": {type: \"string\", enum: itemProperties},\n                  \"headerName\": {type: \"string\"},\n                  \"value\": {\n                    oneOf: [\n                      {type: \"string\"},\n                      {\n                        type: \"array\",\n                        items: {$ref: \"#/definitions/rule_then_assign_variable\"},\n                        minItems: 1\n                      }\n                    ]\n                  },\n                  \"flex\": {type: \"number\"},\n                  \"width\": {type: \"string\"},\n                  \"ref\": {\n                    type: \"object\",\n                    additionalProperties: false,\n                    required: [\"data\", \"value\"],\n                    properties: {\n                      data: {type: \"string\", enum: possibleListRefs},\n                      value: {\n                        oneOf: [\n                          {type: \"string\"},\n                          {\n                            type: \"array\",\n                            items: {$ref: \"#/definitions/rule_then_assign_variable\"},\n                            minItems: 1\n                          }\n                        ]\n                      },\n                      \"itemIdentifier\": {\n                        type: \"string\"\n                      }\n                    }\n                  },\n                  \"pageLink\": {\n                    oneOf: [\n                      {type: \"string\", enum: possiblePages},\n                      {\n                        type: \"object\",\n                        additionalProperties: false,\n                        required: [\"page\", \"mapping\"],\n                        properties: {\n                          page: {type: \"string\", enum: possiblePages},\n                          mapping: {type: \"object\"}\n                        }\n                      }\n                    ]\n                  }\n                }\n              }\n            ]\n          }\n        },\n        density: {type: \"string\", enum: [\"compact\", \"standard\", \"comfortable\"]},\n        hideToolbar: {type: \"boolean\"},\n        checkboxSelection: {type: \"boolean\"},\n        pageSize: {type: \"number\", minimum: 1},\n        pageSizeOptions: {type: \"array\", items: {type: \"number\"}}\n      }\n    }\n  }\n}\n\n\nexport const iconNameEnum = (): JSONSchema7 => {\n  return {\n    type: \"string\",\n    enum: iconNameCache,\n  }\n}\n\nexport const makeSidebarSchema = (possibleQueryableRefs: string[]): JSONSchema7 => {\n  return {\n    type: \"object\",\n    additionalProperties: false,\n    properties: {\n      label: {type: \"string\", minLength: 1},\n      icon: iconNameEnum(),\n      hidden: {\n        oneOf: [\n          {type: \"boolean\"},\n          {type: \"string\", minLength: 1}\n        ]\n      },\n      'hidden:expr': {type: \"string\", minLength: 1},\n      position: {type: \"integer\"},\n      group: {\n        oneOf: [\n          {type: \"string\", minLength: 1},\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"label\"],\n            properties: {\n              \"label\": {type: \"string\", minLength: 1},\n              \"icon\": iconNameEnum()\n            }\n          }\n        ]\n      },\n      dynamic: {\n        type: \"object\",\n        additionalProperties: false,\n        required: [\"data\"],\n        properties: {\n          data: {type: \"string\", enum: possibleQueryableRefs},\n          label: {type: \"string\", default: \"''\"},\n          icon: {type: \"string\", default: \"''\"},\n          hidden: {type: \"string\", default: \"''\"}\n        }\n      }\n    }\n  }\n}\n\nexport const makeTabSchema = (): JSONSchema7 => {\n  return {\n    type: \"object\",\n    additionalProperties: false,\n    required: [\"group\", \"label\"],\n    properties: {\n      group: {type: \"string\", minLength: 1},\n      label: {type: \"string\", minLength: 1},\n      icon: iconNameEnum(),\n      style: {type: \"object\", additionalProperties: true},\n      'style:expr': {type: \"string\", minLength: 1},\n      hidden: {\n        oneOf: [\n          {type: \"boolean\"},\n          {type: \"string\", minLength: 1}\n        ]\n      },\n      'hidden:expr': {type: \"string\", minLength: 1},\n      disabled: {\n        oneOf: [\n          {type: \"boolean\"},\n          {type: \"string\", minLength: 1}\n        ]\n      },\n      'disabled:expr': {type: \"string\", minLength: 1}\n    }\n  }\n}\n","import {JSONSchema7} from \"json-schema\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId, BoardName, ServiceName} from \"../../../model/Board\";\nimport {makeBoardByIdSelector} from \"../../../selectors/board\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {UiSchema} from \"../../../service/cody-wizard/ui/ui-schema\";\nimport {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {\n  getItemProperties,\n  getPossibleCommands, getPossibleForms,\n  getPossibleListVOs,\n  getPossiblePages\n} from \"./Typeahead/elements-tree-lookup\";\nimport {\n  makeActionsUiSchema,\n  makeCommandButtonUiSchema,\n  makeCommandFormUiSchema,\n  makeTableUiSchema,\n  makeUiSchema\n} from \"./Validation/ui-schema\";\n\n\ninterface OwnProps {\n  boardId: BoardId;\n  nodeSchema: Schema;\n  schema: UiSchema;\n  onSchemaChanged: (schema: UiSchema | undefined) => void;\n  autofocus?: boolean;\n  buttonSchema?: boolean;\n  formSchema?: boolean;\n  tableSchema?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype UiSchemaEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst UiSchemaEditor = (props: UiSchemaEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const board = useSelector(makeBoardByIdSelector(props.boardId));\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('ui-schema'));\n  const dispatch = useDispatch();\n\n  let value = stringify(props.schema, null, 2) || '{\\n  \\n}\\n';\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    const possibleListVOs = getPossibleListVOs(elementsTree);\n    const possibleCommands = getPossibleCommands(elementsTree);\n    const possiblePages = getPossiblePages(elementsTree);\n    const possibleForms = getPossibleForms(elementsTree);\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-ui-schema.json`,\n      language: \"json\",\n      value,\n      schema: JSON.stringify(makeUiSchema({\n        ...getPropertiesUiSchema(props.nodeSchema),\n        ...(props.formSchema? makeCommandFormUiSchema(possiblePages) : {}),\n        ...(props.buttonSchema? makeCommandButtonUiSchema() : {}),\n        ...(props.tableSchema? makeTableUiSchema(getItemProperties(props.nodeSchema, elementsTree), possiblePages, possibleListVOs) : {}),\n      }, possibleListVOs, possibleCommands, possiblePages, possibleListVOs, possibleForms, {...makeActionsUiSchema(possibleCommands, possiblePages, possibleListVOs, possibleForms)})),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [value, props.nodeSchema.toString(), board.name]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onSchemaChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedSchema = parse(editorStr);\n\n      props.onSchemaChanged(changedSchema);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] UI Schema Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.ui_schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('ui-schema', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-ui-schema-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedSchemaStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedSchemaStr || \"{}\");\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedSchemaStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(UiSchemaEditor);\n\nconst getPropertiesUiSchema = (nodeSchema: Schema): Record<string, JSONSchema7> => {\n  const props = nodeSchema.getObjectProperties();\n\n  const propsSchema: Record<string, JSONSchema7> = {};\n\n  props.forEach(prop => {\n\n    const propSchema = nodeSchema.getObjectPropertySchema(prop, undefined);\n\n    if(propSchema && propSchema.isObject()) {\n      const propPropertiesUiSchema = getPropertiesUiSchema(propSchema);\n      propsSchema[prop] = {\n        oneOf: [\n          {\n            $ref: \"#/definitions/ui_schema\"\n          },\n          {\n            type: \"object\",\n            properties: {\n              ...propPropertiesUiSchema\n            }\n          }\n        ]\n      }\n    } else {\n      propsSchema[prop] = {\n        $ref: \"#/definitions/ui_schema\"\n      }\n    }\n  })\n\n  return propsSchema;\n}\n\n\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button} from \"semantic-ui-react\";\n\ninterface OwnProps {\n  showAdvancedSettings: boolean;\n  onShowChanged: (showAdvancedSettings: boolean) => void;\n  disabled?: boolean;\n}\n\ntype AdvancedButtonProps = OwnProps & WithNamespaces;\n\nconst AdvancedButton = (props: AdvancedButtonProps) => {\n  return <div className={'field'} style={{marginTop: '30px'}}>\n    {<Button basic={true} icon={props.showAdvancedSettings? 'minus' : 'add'} labelPosition=\"left\" size=\"medium\"\n             content={props.t('insp.cody_wizard.advanced_settings.button_label')} color=\"blue\" className=\"text\"\n             onClick={() => props.onShowChanged(!props.showAdvancedSettings)}\n             disabled={props.disabled}/>}\n  </div>\n};\n\nexport default withNamespaces()(AdvancedButton);\n","import * as React from 'react';\nimport {Checkbox, FormField} from \"semantic-ui-react\";\nimport {Node} from \"../../../../model/Graph\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\n\ninterface OwnProps {\n  command: Node | null;\n  aggregateCommand: boolean;\n  ctx: WizardContext;\n  onAggregateCommandChanged: (aggregateCommand: boolean) => void;\n  disabled?: boolean;\n}\n\ntype AggregateCommandToggleProps = OwnProps;\n\nconst AggregateCommandToggle = (props: AggregateCommandToggleProps) => {\n  const disabled = !props.command || props.disabled;\n\n  return <FormField disabled={disabled} inline={true}>\n    <Checkbox value={1}\n              checked={props.aggregateCommand}\n              disabled={disabled}\n              toggle={true}\n              onChange={() => props.onAggregateCommandChanged(!props.aggregateCommand)}\n              label={'Aggregate Command'} />\n  </FormField>\n};\n\nexport default AggregateCommandToggle;\n","import * as React from 'react';\nimport {Node} from \"../../../../model/Graph\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Checkbox, FormField, Message} from \"semantic-ui-react\";\n\ninterface OwnProps {\n  command: Node | null;\n  deleteState: boolean | undefined;\n  deleteHistory: boolean | undefined;\n  onDeleteHistoryChanged: (deleteHistory: boolean) => void;\n  disabled?: boolean;\n}\n\ntype DeleteHistoryToggleProps = OwnProps & WithNamespaces;\n\nconst DeleteHistoryToggle = (props: DeleteHistoryToggleProps) => {\n  const disabled = !props.command || !props.deleteState;\n  return <FormField disabled={disabled} inline={true} className={disabled? 'fadeout' : 'fadein'}>\n    <Checkbox value={1}\n              checked={props.deleteHistory}\n              disabled={props.disabled || disabled}\n              toggle={true}\n              onChange={() => props.onDeleteHistoryChanged(!props.deleteHistory)}\n              label={props.t('insp.cody_wizard.step_command.delete_history_label') as string} />\n    <Message size=\"small\" warning={true}\n             icon=\"eraser\"\n             content={props.t('insp.cody_wizard.step_command.delete_history_warning')}\n             style={{display: props.deleteHistory? 'flex' : 'none'}}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(DeleteHistoryToggle);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Checkbox, FormField} from \"semantic-ui-react\";\nimport {Node} from \"../../../../model/Graph\";\n\ninterface OwnProps {\n  command: Node | null;\n  deleteState: boolean | undefined;\n  newAggregate: boolean | undefined;\n  onDeleteStateChanged: (deleteState: boolean) => void;\n  disabled?: boolean;\n}\n\ntype DeleteStateToggleProps = OwnProps & WithNamespaces;\n\nconst DeleteStateToggle = (props: DeleteStateToggleProps) => {\n  const disabled = !props.command || props.newAggregate;\n  return <FormField disabled={disabled} inline={true} className={disabled? 'fadeout' : 'fadein'}>\n    <Checkbox value={1}\n              checked={props.deleteState}\n              disabled={props.disabled || disabled}\n              toggle={true}\n              onChange={() => props.onDeleteStateChanged(!props.deleteState)}\n              label={props.t('insp.cody_wizard.step_command.delete_state_label') as string} />\n  </FormField>\n};\n\nexport default withNamespaces()(DeleteStateToggle);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Checkbox, Dropdown, DropdownItemProps, FormField} from \"semantic-ui-react\";\nimport {Node} from \"../../../../model/Graph\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\n\ninterface OwnProps {\n  command: Node | null;\n  newAggregate: boolean | undefined;\n  deleteState: boolean | undefined;\n  ctx: WizardContext;\n  onNewAggregateChanged: (newAggregate: boolean) => void;\n  disabled?: boolean;\n}\n\ntype NewAggregateSelectProps = OwnProps & WithNamespaces;\n\nconst NewAggregateToggle = (props: NewAggregateSelectProps) => {\n  const disabled = !props.command || props.deleteState;\n\n  return <FormField disabled={disabled} inline={true} className={disabled? 'fadeout' : 'fadein'}>\n    <Checkbox value={1}\n              checked={props.newAggregate}\n              disabled={props.disabled || disabled}\n              toggle={true}\n              onChange={() => props.onNewAggregateChanged(!props.newAggregate)}\n              label={props.t('insp.cody_wizard.step_command.new_aggregate_select_label') as string} />\n  </FormField>\n};\n\nexport default withNamespaces()(NewAggregateToggle);\n","import * as React from 'react';\nimport {Checkbox, FormField} from \"semantic-ui-react\";\nimport {Node} from \"../../../../model/Graph\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\n\ninterface OwnProps {\n  command: Node | null;\n  aggregateCommand: boolean;\n  streamLocking: boolean;\n  ctx: WizardContext;\n  onStreamLockingChanged: (enabled: boolean) => void;\n  disabled?: boolean;\n}\n\ntype StreamLockingToggleProps = OwnProps;\n\nconst StreamLockingToggle = (props: StreamLockingToggleProps) => {\n  const disabled = props.aggregateCommand;\n\n  return <FormField disabled={props.disabled || disabled} inline={true}>\n    <Checkbox value={1}\n              checked={props.streamLocking || props.aggregateCommand}\n              disabled={props.disabled || disabled}\n              toggle={true}\n              onChange={() => props.onStreamLockingChanged(!props.streamLocking)}\n              label={'Optimistic Stream Locking'} />\n  </FormField>\n};\n\nexport default StreamLockingToggle;\n","import {Node, NodeName, NodeType} from \"../../../model/Graph\";\nimport {Rule} from \"../rule-engine/configuration\";\nimport {UiSchema} from \"./ui-schema\";\n\nexport interface DynamicBreadcrumbMetadata {\n  data: string;\n  label: Rule[] | string;\n}\n\nexport interface DynamicSidebarMetadata {\n  data: string;\n  label?: string;\n  icon?: string;\n  hidden?: string;\n}\n\nexport type ViewComponentType = 'auto' | 'state' | 'form' | 'table';\n\nexport type ViewComponent = string | { view: string, hidden: boolean, uiSchema?: UiSchema, type?: ViewComponentType}\n\nexport interface UiMetadata {\n  $nodeName?: NodeName;\n  $nodeType?: NodeType;\n  service?: string;\n  route?: string;\n  parent?: string;\n  routeParams?: string[];\n  sidebar?: {label?: string ; icon?: string; hidden?: boolean; \"hidden:expr\"?: string; dynamic?: DynamicSidebarMetadata};\n  breadcrumb?: string | DynamicBreadcrumbMetadata;\n  tab?: {label?: string, group?: string, icon?: string};\n  commands: string[];\n  views: ViewComponent[];\n}\n\nexport const getUiMetadata = (ui: Node): UiMetadata => {\n  const uiMeta = ui.getParsedMetadata() as Record<string, any>;\n\n  if(!uiMeta.commands) {\n    uiMeta.commands = [];\n  }\n\n  if(!uiMeta.views) {\n    uiMeta.views = [];\n  }\n\n  return uiMeta as UiMetadata;\n}\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n  label: string;\n}\n\ntype ProjectionEditorDividerProps = OwnProps & WithNamespaces;\n\nconst ProjectionEditorDivider = (props: ProjectionEditorDividerProps) => {\n  return <EditorDivider label={props.label} content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.projector.help1')}</p>\n    <p>{props.t('insp.cody_wizard.editor.projector.help2')}</p>\n    <p>{props.t('insp.cody_wizard.editor.projector.help3')}</p>\n    <p>{props.t('insp.cody_wizard.editor.contextVariables')}</p>\n    <ul>\n      <li>event: event data</li>\n      <li>meta: event metadata</li>\n    </ul>\n    <p>{props.t('insp.cody_wizard.editor.autocomplete')}</p>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#projector-rules\"\n          onClick={e => e.stopPropagation()}\n          target=\"_blank\"\n          rel=\"nofollow\">{props.t('app.learnMore')}</a></p>\n  </>}/>\n};\n\nexport default withNamespaces()(ProjectionEditorDivider);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n  label: string;\n}\n\ntype ResolverEditorDividerProps = OwnProps & WithNamespaces;\n\nconst ResolverEditorDivider = (props: ResolverEditorDividerProps) => {\n  return <EditorDivider label={props.label} content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.resolver.help1')}</p>\n    <p>{props.t('insp.cody_wizard.editor.resolver.help2')}</p>\n    <p>{props.t('insp.cody_wizard.editor.contextVariables')}</p>\n    <ul>\n      <li>query: query data</li>\n      <li>meta: query metadata</li>\n      <li>Query Dependencies</li>\n    </ul>\n    <p>{props.t('insp.cody_wizard.editor.autocomplete')}</p>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules\"\n          onClick={e => e.stopPropagation()}\n          target=\"_blank\"\n          rel=\"nofollow\">{props.t('app.learnMore')}</a></p>\n  </>}/>\n};\n\nexport default withNamespaces()(ResolverEditorDivider);\n","import {JSONSchema7} from \"json-schema\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\nimport {Schema} from \"../../../../service/cody-wizard/schema/schema\";\nimport {makeDefinitions} from \"./rule-engine-definitions\";\nimport {withSuggestionPropMapping} from \"./rule-engine/prop-mapping\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\n\nexport const makeInitializeRulesSchema = (dataSchema: Schema, ctx: WizardContext): string => {\n  const schema: JSONSchema7 = {\n    type: \"array\",\n    items: {\n      $ref: \"#/definitions/rule_definition\"\n    },\n    definitions: withSuggestionPropMapping(\n      makeDefinitions(\n        makeAssignVariable('data')\n      ),\n      dataSchema.getObjectProperties(),\n      ['data'],\n      mappingSuggestions(dataSchema)\n    )\n  }\n\n  return JSON.stringify(schema);\n}\n\nconst mappingSuggestions = (dataSchema: Schema): string[] => {\n  const suggestions: string[] = ['meta.user.userId'];\n\n  dataSchema.getObjectProperties().forEach(prop => {\n    suggestions.push(`data.${prop}`);\n  })\n\n  return suggestions;\n}\n","import {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {ApplyEventRule} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {Rule} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport ExpandButton from \"./ExpandButton\";\nimport {makeInitializeRulesSchema} from \"./Validation/initialize-rules-schema\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\n\ninterface OwnProps {\n  elementId: string;\n  initializeRules: Rule[];\n  dataSchema: Schema;\n  ctx: WizardContext;\n  onRulesChanged: (rules: ApplyEventRule[] | undefined) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype InitializeRulesEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst InitializeRulesEditor = (props: InitializeRulesEditorProps) => {\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('initialize-rules'));\n  const dispatch = useDispatch();\n\n  let value = stringify(props.initializeRules, null, 2);\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.elementId}-initialize-rules.json`,\n      language: \"json\",\n      value,\n      schema: makeInitializeRulesSchema(props.dataSchema, props.ctx),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.elementId, value, props.dataSchema.toString()]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onRulesChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedRules = parse(editorStr);\n      props.onRulesChanged(changedRules);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Initialize Rules Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('initialize-rules', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-event-apply-rules-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedRulesStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedRulesStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedRulesStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(InitializeRulesEditor);\n","import {JSONSchema7} from \"json-schema\";\nimport {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\nimport {Definitions} from \"../rule-engine-definitions\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./jexl-expressions\";\n\nexport const makeThenChangeInformation = (possibleStateRefs: string[]): {\n  rule_then_insert_information: JSONSchema7,\n  rule_then_upsert_information: JSONSchema7,\n  rule_then_update_information: JSONSchema7,\n  rule_then_replace_information: JSONSchema7,\n  rule_then_delete_information: JSONSchema7,\n} => {\n  return {\n    rule_then_insert_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"insert\"],\n      properties: {\n        insert: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"information\", \"id\", \"set\"],\n          properties: {\n            information: {\n              type: \"string\",\n              enum: possibleStateRefs\n            },\n            id: {type: \"string\", minLength: 1},\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"}\n          }\n        }\n      }\n    },\n    rule_then_upsert_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"upsert\"],\n      properties: {\n        upsert: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"information\", \"id\", \"set\"],\n          properties: {\n            information: {\n              type: \"string\",\n              enum: possibleStateRefs\n            },\n            id: {type: \"string\", minLength: 1},\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"}\n          }\n        }\n      }\n    },\n    rule_then_update_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"update\"],\n      properties: {\n        update: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"information\", \"filter\", \"set\"],\n          properties: {\n            information: {\n              type: \"string\",\n              enum: possibleStateRefs\n            },\n            filter: {$ref: \"#/definitions/resolve_filter_types\"},\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"}\n          }\n        }\n      }\n    },\n    rule_then_replace_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"replace\"],\n      properties: {\n        replace: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"information\", \"filter\", \"set\"],\n          properties: {\n            information: {\n              type: \"string\",\n              enum: possibleStateRefs\n            },\n            filter: {$ref: \"#/definitions/resolve_filter_types\"},\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"}\n          }\n        }\n      }\n    },\n    rule_then_delete_information: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"delete\"],\n      properties: {\n        delete: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"information\", \"filter\"],\n          properties: {\n            information: {\n              type: \"string\",\n              enum: possibleStateRefs\n            },\n            filter: {$ref: \"#/definitions/resolve_filter_types\"}\n          }\n        }\n      }\n    }\n  }\n}\nexport const makeThenProjectionOperations = (): {\n  rule_then_insert_projection: JSONSchemaWithMarkdown,\n  rule_then_upsert_projection: JSONSchemaWithMarkdown,\n  rule_then_update_projection: JSONSchemaWithMarkdown,\n  rule_then_replace_projection: JSONSchemaWithMarkdown,\n  rule_then_delete_projection: JSONSchemaWithMarkdown,\n} => {\n  return {\n    rule_then_insert_projection: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"insert\"],\n      properties: {\n        insert: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"id\", \"set\"],\n          markdownDescription: \"Add new information to the collection.\\n\\n[Learn More](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#insert-information)\",\n          properties: {\n            id: makeJexlExpression(`Set the id of new information.\\n\\nType: ${JEXL_WIKI_MARKDOWN}`),\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"}\n          }\n        }\n      }\n    },\n    rule_then_upsert_projection: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"upsert\"],\n      properties: {\n        upsert: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"id\", \"set\"],\n          properties: {\n            id: makeJexlExpression(`Set the id of information.\\n\\nType: ${JEXL_WIKI_MARKDOWN}`),\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"}\n          }\n        }\n      }\n    },\n    rule_then_update_projection: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"update\"],\n      properties: {\n        update: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"filter\", \"set\"],\n          properties: {\n            filter: {$ref: \"#/definitions/resolve_filter_types\"},\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"},\n            loadDocIntoVariable: {type: \"string\"}\n          }\n        }\n      }\n    },\n    rule_then_replace_projection: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"replace\"],\n      properties: {\n        replace: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"filter\", \"set\"],\n          properties: {\n            filter: {$ref: \"#/definitions/resolve_filter_types\"},\n            set: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            meta: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            version: {type: \"number\"},\n            loadDocIntoVariable: {type: \"string\"}\n          }\n        }\n      }\n    },\n    rule_then_delete_projection: {\n      type: \"object\",\n      additionalProperties: false,\n      required: [\"delete\"],\n      properties: {\n        delete: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"filter\"],\n          properties: {\n            filter: {$ref: \"#/definitions/resolve_filter_types\"}\n          }\n        }\n      }\n    }\n  }\n}\n\nexport const withProjectionOperations = (definitions: Definitions): Definitions => {\n  return {\n    ...definitions,\n    ...makeThenProjectionOperations()\n  }\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {ImmutableDDDWizardContext} from \"../../../../service/cody-wizard/context/ddd-action\";\nimport {ImmutableInformationContext} from \"../../../../service/cody-wizard/context/information-context\";\nimport {\n  makeDefinitions\n} from \"./rule-engine-definitions\";\nimport {makeThenThrowError} from \"./rule-engine/throw-error\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\nimport {makeCallService} from \"./rule-engine/call-service\";\nimport {makeForEach} from \"./rule-engine/foreach\";\nimport {makeExecuteRules} from \"./rule-engine/execute-rules\";\nimport {makeLogMessage} from \"./rule-engine/log-message\";\nimport {withResolveFilterTypes} from \"./rule-engine/filters\";\nimport {withProjectionOperations} from \"./rule-engine/change-information-rules\";\n\nexport const makeProjectionSchema = (possibleEvents: string[], possibleServices: string[], ctx: ImmutableDDDWizardContext | ImmutableInformationContext): string => {\n  const schema: JSONSchema7 = {\n    type: \"object\",\n    additionalProperties: false,\n    required: [\"cases\"],\n    properties: {\n      name: {\n        type: \"string\"\n      },\n      live: {\n        type: \"boolean\",\n        default: true\n      },\n      cases: {\n        type: \"array\",\n        items: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"when\", \"then\"],\n          properties: {\n            given: {\n              type: \"array\",\n              items: {\n                $ref: \"#/definitions/rule_definition\"\n              }\n            },\n            when: {\n              type: \"string\",\n              enum: possibleEvents\n            },\n            then: {\n              oneOf: [\n                {\n                  $ref: \"#/definitions/rule_then_insert_projection\"\n                },\n                {\n                  $ref: \"#/definitions/rule_then_upsert_projection\"\n                },\n                {\n                  $ref: \"#/definitions/rule_then_update_projection\"\n                },\n                {\n                  $ref: \"#/definitions/rule_then_replace_projection\"\n                },\n                {\n                  $ref: \"#/definitions/rule_then_delete_projection\"\n                }\n              ]\n            }\n          }\n        }\n      }\n    },\n    definitions: withProjectionOperations(withResolveFilterTypes(makeDefinitions(\n      makeThenThrowError(),\n      makeAssignVariable(),\n      makeCallService(possibleServices),\n      makeForEach(),\n      makeExecuteRules(),\n      makeLogMessage(),\n    )))\n  }\n\n  return JSON.stringify(schema);\n}\n","import {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport {List} from \"immutable\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {Node} from \"../../../model/Graph\";\nimport {ImmutableDDDWizardContext} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {ImmutableInformationContext} from \"../../../service/cody-wizard/context/information-context\";\nimport {fqcn} from \"../../../service/cody-wizard/node/fqcn\";\nimport {ProjectionConfig} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport ExpandButton from \"./ExpandButton\";\nimport {makeProjectionSchema} from \"./Validation/projection-schema\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\n\ninterface OwnProps {\n  projection: ProjectionConfig;\n  possibleEvents: List<Node>;\n  possibleServices: List<Node>;\n  ctx: ImmutableDDDWizardContext | ImmutableInformationContext;\n  onProjectionChanged: (projection: ProjectionConfig | undefined) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype ProjectionEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst ProjectionEditor = (props: ProjectionEditorProps) => {\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('projection'));\n  const dispatch = useDispatch();\n\n  let value = stringify(props.projection, null, 2);\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    const possibleServices = [\"AuthService\"];\n\n    props.possibleServices.forEach(n => {\n      const name = fqcn(n);\n\n      if(!possibleServices.includes(name)) {\n        possibleServices.push(name);\n      }\n    })\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-projection.json`,\n      language: \"json\",\n      value,\n      schema: makeProjectionSchema(\n        props.possibleEvents.map(e => e.getTechnicalName()).toArray(),\n        possibleServices,\n        props.ctx\n      ),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [\n    props.sessionId,\n    value\n  ]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onProjectionChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedProjection = parse(editorStr);\n      props.onProjectionChanged(changedProjection);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Projection Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('projection', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-projection-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedProjectionStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedProjectionStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedProjectionStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(ProjectionEditor);\n","import {parse} from \"../../../service/json/json-comment-wrapper\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport ExpandButton from \"./ExpandButton\";\nimport {getPossibleRefs} from \"./SchemaEditor\";\nimport {makeShorthandSchemaValidationSchema} from \"./Validation/shorthand-schema\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\n\n\ninterface OwnProps {\n  boardId: BoardId;\n  schema?: Schema;\n  onSchemaChanged: (schema: Schema) => void;\n  autofocus?: boolean;\n  onSchemaRemoved?: () => void;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype QuerySchemaEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst QuerySchemaEditor = (props: QuerySchemaEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('query-schema'));\n  const dispatch = useDispatch();\n\n  let value = props.schema ? props.schema.toString() : '';\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-query-schema.json`,\n      language: \"json\",\n      value,\n      schema: (props.schema && props.schema.isShorthand())? makeShorthandSchemaValidationSchema(getPossibleRefs(elementsTree)) : undefined,\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.sessionId, value]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '' && props.onSchemaRemoved) {\n      props.onSchemaRemoved();\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    }\n\n    try {\n      const changedSchema = parse(editorStr);\n      props.onSchemaChanged(new Schema(changedSchema));\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Query Schema Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.query_schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('query-schema', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-query-schema-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedSchemaStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedSchemaStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedSchemaStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(QuerySchemaEditor);\n","import {JSONSchemaWithMarkdown} from \"../Suggestion/markdown-description\";\nimport {makeDefinitions} from \"./rule-engine-definitions\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\nimport {makeExecuteRules} from \"./rule-engine/execute-rules\";\nimport {makeFindFiltersDefinition, makeResolveFiltersDefinition} from \"./rule-engine/filters\";\nimport {makeFindInformation, makePartialSelectDefinition} from \"./rule-engine/find-information-rules\";\nimport {makeForEach} from \"./rule-engine/foreach\";\nimport {makeLogMessage} from \"./rule-engine/log-message\";\nimport {makeRuleThenPropMapping} from \"./rule-engine/prop-mapping\";\nimport {makeThenThrowError} from \"./rule-engine/throw-error\";\n\nexport const makeResolveSchema = (possibleProperties: string[], expressionSuggests: string[], possibleRefs: string[]): string => {\n  const resolve: JSONSchemaWithMarkdown = {\n    type: \"object\",\n    additionalProperties: false,\n    properties: {\n      rules: {\n        type: \"array\",\n        markdownDescription: `Execute rules **before** the main **where** query is performed or provide the query resolver result via **information** context variable. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n        items: {\n          $ref: \"#/definitions/rule_definition\"\n        }\n      },\n      where: {\n        $ref: \"#/definitions/resolve_where_rule_definition\",\n        markdownDescription: `Main query resolver rule. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n      },\n      orderBy: {\n        markdownDescription: `Order the main query result. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n        oneOf: [\n          {$ref: \"#/definitions/resolve_order_by\"},\n          {type: \"array\", items: {$ref: \"#/definitions/resolve_order_by\"}}\n        ]\n      }\n    },\n    definitions: {\n      resolve_where_rule_definition: {\n        oneOf: [\n          {\n            type: \"object\",\n            properties: {\n              rule: {\n                type: \"string\",\n                enum: [\"always\"],\n                markdownDescription: `This rule is always executed.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              },\n              then: {\n                $ref: \"#/definitions/resolve_filter\",\n                markdownDescription: `Defines the resolve filter. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              }\n            },\n            required: [\"rule\", \"then\"],\n            additionalProperties: false\n          },\n          {\n            type: \"object\",\n            properties: {\n              rule: {\n                type: \"string\",\n                enum: [\"condition\"],\n                markdownDescription: `This rule is executed **if** condition is met.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              },\n              then: {\n                $ref: \"#/definitions/resolve_filter\",\n                markdownDescription: `Defines the resolve filter. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              },\n              if: {$ref: \"#/definitions/resolve_filter_expr\"},\n              else: {\n                $ref: \"#/definitions/resolve_filter_else\",\n                markdownDescription: `Alternative resolve filter, that is used if condition is not met. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              }\n            },\n            required: [\"rule\", \"then\", \"if\"],\n            additionalProperties: false\n          },\n          {\n            type: \"object\",\n            properties: {\n              rule: {\n                type: \"string\",\n                enum: [\"condition\"]\n              },\n              then: {\n                $ref: \"#/definitions/resolve_filter\",\n                markdownDescription: `Defines the resolve filter. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              },\n              if_not: {\n                $ref: \"#/definitions/resolve_filter_expr\",\n                markdownDescription: `This rule is executed **if** condition is **not** met.\\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              },\n              else: {\n                $ref: \"#/definitions/resolve_filter_else\",\n                markdownDescription: `Alternative resolve filter, that is used if condition is met. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n              }\n            },\n            required: [\"rule\", \"then\", \"if_not\"],\n            additionalProperties: false\n          }\n        ]\n      },\n      ...makeRuleThenPropMapping(),\n      ...makeResolveFiltersDefinition(possibleProperties, expressionSuggests),\n      ...makeFindFiltersDefinition(undefined, expressionSuggests),\n      ...makePartialSelectDefinition(possibleRefs),\n      resolve_filter_else: {\n        oneOf: [\n          {$ref: \"#/definitions/resolve_filter\"},\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"execute\"],\n            properties: {\n              execute: {\n                type: \"object\",\n                additionalProperties: false,\n                required: [\"rules\"],\n                markdownDescription: `Execute a rule instead of performing a resolve query.`,\n                properties: {\n                  rules: {\n                    type: \"array\",\n                    items: {$ref: \"#/definitions/rule_definition\"},\n                    minItems: 1,\n                    maxItems: 1,\n                    markdownDescription: `You can only run one rule e.g. to throw an error or log a message.\\n\\nIf you need more flexibility use the top level **rules** definition instead. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#resolver-rules)`,\n                  }\n                }\n              }\n            }\n          }\n        ]\n      },\n    }\n  }  as JSONSchemaWithMarkdown;\n\n  resolve.definitions = {...resolve.definitions, ...makeDefinitions(\n    makeThenThrowError(),\n    makeAssignVariable(),\n    makeForEach(),\n    makeExecuteRules(),\n    makeLogMessage(),\n    makeFindInformation(possibleRefs, expressionSuggests)\n  )}\n\n  return JSON.stringify(resolve);\n}\n","import * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {setSideBySideCell, toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {getRefVo} from \"../../../service/cody-wizard/vo/get-ref-vo\";\nimport {ResolveConfig} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {getPossibleRefs} from \"./SchemaEditor\";\nimport {makeResolveSchema} from \"./Validation/resolve-schema\";\n\ninterface OwnProps {\n  boardId: BoardId;\n  nodeSchema: Schema;\n  querySchema: Schema;\n  resolve?: ResolveConfig;\n  onResolveChanged: (resolve?: ResolveConfig) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype ResolveEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\nlet isRefOpening = false;\n\nconst ResolveEditor = (props: ResolveEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('resolve'));\n  const dispatch = useDispatch();\n\n  let value = props.resolve ? stringify(props.resolve, null, 2) : '';\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-resolve-config.json`,\n      language: \"json\",\n      value,\n      schema: makeResolveSchema(getDocProperties(props.nodeSchema, elementsTree), getExprSuggests(props.querySchema), getPossibleRefs(elementsTree, true)),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.sessionId, value, props.nodeSchema.toString(), props.querySchema.toString()]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus]);\n\n  useEffect(() => {\n    // This is needed to prevent wrong schemaChanged events due to onBlur firing when ref is loaded\n    if(isRefOpening) {\n      window.setTimeout(() => {\n        isRefOpening = false;\n      }, 500);\n    }\n  }, [props.sessionId]);\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n\n    if(editorStr === '') {\n      props.onResolveChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedConfig = parse(editorStr);\n      props.onResolveChanged(changedConfig);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Resolve Config Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  const handleOpenInformationReference = (ref: string) => {\n    const refVo = getRefVo(Schema.fromString(ref), elementsTree);\n\n    if(refVo) {\n      isRefOpening = true;\n      dispatch(setSideBySideCell(refVo.getId()));\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('resolve', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-resolve-config-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      onOpenInformationReference={handleOpenInformationReference}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedResolveConfigsStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedResolveConfigsStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedResolveConfigsStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(ResolveEditor);\n\nconst getDocProperties = (nodeSchema: Schema, elementsTree: ElementsTree): string[] => {\n  if(nodeSchema.isRef()) {\n    return getDocProperties(nodeSchema.resolveRef(elementsTree), elementsTree);\n  }\n\n  if(nodeSchema.isObject()) {\n    return nodeSchema.getObjectProperties();\n  }\n\n  if(!nodeSchema.isList()) {\n    return [];\n  }\n\n  let listItemSchema = nodeSchema.getListItemsSchema(new Schema({}));\n\n  if(listItemSchema.isRef()) {\n    listItemSchema =  listItemSchema.resolveRef(elementsTree);\n  }\n\n  return listItemSchema.getObjectProperties();\n}\n\nconst getExprSuggests = (querySchema: Schema): string[] => {\n  const suggests: string[] = querySchema.getObjectProperties().map(prop => `query.${prop}`);\n\n  suggests.push('meta.user.userId');\n\n  return suggests;\n}\n","import * as React from 'react';\nimport {FormField, Input} from \"semantic-ui-react\";\nimport EditableTextline from \"../../../../../core/components/EditableTextline\";\nimport {ADDITIONAL_CHAR_PADDING, CHAR_SIZE_UNIT, INPUT_CHAR_SIZE} from \"../../WizardModal\";\n\ninterface OwnProps {\n  collection: string;\n  onCollectionChanged: (collection: string) => void;\n  disabled?: boolean;\n}\n\ntype CollectionInputProps = OwnProps;\n\nconst CollectionInput = (props: CollectionInputProps) => {\n  const style = props.collection === '' ? {color: 'rgba(51, 51, 51, 0.6)'} : undefined;\n\n  return <FormField>\n    <EditableTextline\n      required={true}\n      text={props.collection}\n      minWidth={20}\n      charSize={INPUT_CHAR_SIZE}\n      widthUnit={CHAR_SIZE_UNIT}\n      padding={ADDITIONAL_CHAR_PADDING}\n      placeholder='my_collection'\n      textStyle={style}\n      disabled={props.disabled}\n      onTextChanged={props.onCollectionChanged} />\n  </FormField>\n};\n\nexport default CollectionInput;\n","import * as React from 'react';\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {Checkbox, FormField} from \"semantic-ui-react\";\nimport {Node} from \"../../../../model/Graph\";\n\ninterface OwnProps {\n  vo: Node | null;\n  isEntity: boolean;\n  onIsEntityChanged: (isEntity: boolean) => void;\n  disabled?: boolean;\n}\n\ntype EntityVoToggleProps = OwnProps & WithNamespaces;\n\nconst EntityVoToggle = (props: EntityVoToggleProps) => {\n  const disabled = props.disabled || !props.vo;\n\n  return <FormField disabled={disabled} inline={true}>\n    <Checkbox value={1}\n              checked={props.isEntity}\n              disabled={disabled}\n              toggle={true}\n              onChange={() => props.onIsEntityChanged(!props.isEntity)}\n              label={props.t('insp.cody_wizard.step_any_vo.is_entity_label') as string} />\n  </FormField>\n};\n\nexport default withNamespaces()(EntityVoToggle);\n","import * as React from 'react';\nimport {Node} from \"../../../../model/Graph\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Checkbox, FormField} from \"semantic-ui-react\";\n\ninterface OwnProps {\n  vo: Node | null;\n  isProjection: boolean;\n  onProjectionChanged: (isProjection: boolean) => void;\n  ctx: WizardContext;\n  disabled?: boolean;\n}\n\ntype ProjectionToggleProps = OwnProps & WithNamespaces;\n\nconst ProjectionToggle = (props: ProjectionToggleProps) => {\n  const disabled = props.disabled || !props.vo;\n\n  return <FormField disabled={disabled} inline={true}>\n    <Checkbox value={1}\n              checked={props.isProjection}\n              disabled={disabled}\n              toggle={true}\n              onChange={() => props.onProjectionChanged(!props.isProjection)}\n              label={props.t('insp.cody_wizard.step_any_vo.is_projection_label') as string} />\n  </FormField>\n};\n\nexport default withNamespaces()(ProjectionToggle);\n","import * as React from 'react';\nimport {Node} from \"../../../../model/Graph\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Checkbox, FormField} from \"semantic-ui-react\";\n\ninterface OwnProps {\n  vo: Node | null;\n  isQueryable: boolean;\n  onQueryableChanged: (isQuyable: boolean) => void;\n  ctx: WizardContext;\n  disabled?: boolean;\n}\n\ntype QueryableToggleProps = OwnProps & WithNamespaces;\n\nconst QueryableToggle = (props: QueryableToggleProps) => {\n  const disabled = props.disabled || !props.vo;\n\n  return <FormField disabled={disabled} inline={true}>\n    <Checkbox value={1}\n              checked={props.isQueryable}\n              disabled={disabled}\n              toggle={true}\n              onChange={() => props.onQueryableChanged(!props.isQueryable)}\n              label={props.t('insp.cody_wizard.step_any_vo.is_queryable_label') as string} />\n  </FormField>\n};\n\nexport default withNamespaces()(QueryableToggle);\n","import * as React from 'react';\nimport { WithNamespaces, withNamespaces } from \"react-i18next\";\nimport { Node } from \"../../../../model/Graph\";\nimport { WizardContext } from \"../../../../service/cody-wizard/context/wizard-context\";\nimport { Checkbox, FormField } from \"semantic-ui-react\";\n\ninterface OwnProps {\n    vo: Node | null;\n    isStored: boolean;\n    onStoredStateChanged: (isStored: boolean) => void;\n    ctx: WizardContext;\n    disabled?: boolean;\n}\n\ntype StoredVoToggleProps = OwnProps & WithNamespaces;\n\nconst StoredVoToggle = (props: StoredVoToggleProps) => {\n    const disabled = props.disabled || !props.vo;\n\n    return <FormField disabled={disabled} inline={true}>\n        <Checkbox value={1}\n              checked={props.isStored}\n              disabled={disabled}\n              toggle={true}\n              onChange={() => props.onStoredStateChanged(!props.isStored)}\n              label={props.t('insp.cody_wizard.step_any_vo.is_stored_in_db_label') as string} />\n  </FormField>\n}\n\nexport default withNamespaces()(StoredVoToggle);","import * as React from 'react';\nimport {FormField, Label} from \"semantic-ui-react\";\nimport EditableTextline from \"../../../../../core/components/EditableTextline\";\nimport {ADDITIONAL_CHAR_PADDING, CHAR_SIZE_UNIT, INPUT_CHAR_SIZE} from \"../../WizardModal\";\n\ninterface OwnProps {\n  ns: string;\n  onNsChanged: (ns: string) => void;\n  disabled?: boolean;\n}\n\ntype NamespaceInputProps = OwnProps;\n\nconst NamespaceInput = (props: NamespaceInputProps) => {\n\n  const handleTextChanged = (text: string) => {\n    if(text[0] !== '/') {\n      text = '/' + text;\n    }\n\n    props.onNsChanged(text);\n  }\n\n  const style = props.ns === '' ? {color: 'rgba(51, 51, 51, 0.6)'} : undefined;\n\n  return <FormField>\n    <EditableTextline\n      required={true}\n      text={props.ns}\n      minWidth={20}\n      charSize={INPUT_CHAR_SIZE}\n      widthUnit={CHAR_SIZE_UNIT}\n      padding={ADDITIONAL_CHAR_PADDING}\n      placeholder='/Namespace'\n      textStyle={style}\n      disabled={props.disabled}\n      onTextChanged={handleTextChanged} />\n  </FormField>\n};\n\nexport default NamespaceInput;\n","import {List} from 'immutable';\nimport * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button, ButtonGroup} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {getCommandMetadata} from \"../../../service/cody-wizard/command/get-command-metadata\";\nimport {ImmutableDDDWizardContext, isDDDAction} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {ImmutableInformationContext} from \"../../../service/cody-wizard/context/information-context\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {suggestDependenciesForNode} from \"../../../service/cody-wizard/dependencies/suggest-dependencies-for-node\";\nimport {getEventMetadata} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {isAggregateEvent} from \"../../../service/cody-wizard/event/is-aggregate-event\";\nimport {getSourcesOfType, getTargetsOfType} from \"../../../service/cody-wizard/node/get-single-node-of-type\";\nimport {names} from \"../../../service/cody-wizard/node/names\";\nimport {Rule} from '../../../service/cody-wizard/rule-engine/configuration';\nimport {RulesDependencyMetadata} from '../../../service/cody-wizard/rule-engine/types';\nimport {getSchemaFromNodeDescription} from \"../../../service/cody-wizard/schema/get-schema-from-node-description\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {isPropertyRef, splitPropertyRef} from \"../../../service/cody-wizard/schema/shorthand\";\nimport {getUiMetadata} from \"../../../service/cody-wizard/ui/get-ui-metadata\";\nimport {TableColumn, UiSchema} from \"../../../service/cody-wizard/ui/ui-schema\";\nimport {getConnectedEventIfPossible} from \"../../../service/cody-wizard/vo/get-connected-event-if-possible\";\nimport {\n  getConnectedValueObjectSourceIfPossible\n} from \"../../../service/cody-wizard/vo/get-connected-value-object-source-if-possible\";\nimport {getRefVo} from \"../../../service/cody-wizard/vo/get-ref-vo\";\nimport {getSchemaRefName} from \"../../../service/cody-wizard/vo/get-schema-ref-name\";\nimport {\n  getVoMetadata,\n  ProjectionConfig,\n  ProjectionConfigCase,\n  ResolveConfig,\n  ValueObjectMetadata\n} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {isEntityCollection as entityCollectionCheck} from \"../../../service/cody-wizard/vo/is-entity-collection\";\nimport {isListVo} from \"../../../service/cody-wizard/vo/is-list-vo\";\nimport {isVoStoredInDb} from '../../../service/cody-wizard/vo/is-vo-stored-in-db';\nimport {cloneDeepJSON, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport DependenciesEditor from '../Editor/DependenciesEditor';\nimport DependenciesEditorDivider from \"../Editor/Divider/DependenciesEditorDivider\";\nimport ProjectionEditorDivider from \"../Editor/Divider/ProjectionEditorDivider\";\nimport ResolverEditorDivider from \"../Editor/Divider/ResolverEditorDivider\";\nimport SchemaEditorDivider from \"../Editor/Divider/SchemaEditorDivider\";\nimport UiSchemaEditorDivider from \"../Editor/Divider/UiSchemaEditorDivider\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport InitializeRulesEditor from '../Editor/InitializeRulesEditor';\nimport ProjectionEditor from \"../Editor/ProjectionEditor\";\nimport QuerySchemaEditor from \"../Editor/QuerySchemaEditor\";\nimport ResolveEditor from \"../Editor/ResolveEditor\";\nimport SchemaEditor from \"../Editor/SchemaEditor\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport UiSchemaEditor from \"../Editor/UiSchemaEditor\";\nimport {WithWizardStepProps} from \"../WizardModal\";\nimport AdvancedButton from './AdvancedButton';\nimport CollectionInput from \"./AnyVO/CollectionInput\";\nimport EntityVoToggle from \"./AnyVO/EntityVoToggle\";\nimport ProjectionToggle from \"./AnyVO/ProjectionToggle\";\nimport QueryableToggle from \"./AnyVO/QueryableToggle\";\nimport StoredVoToggle from './AnyVO/StoredVoToggle';\nimport IdentifierSelect, {getIdentifierCandidatesFromSchema} from \"./StateVO/IdentifierSelect\";\nimport NamespaceInput from \"./StateVO/NamespaceInput\";\nimport {cloneDeep} from \"lodash\";\n\ninterface OwnProps {\n\n}\n\ntype AnyVoProps = OwnProps & WithWizardStepProps<ImmutableInformationContext> & WithNamespaces;\n\nlet lastVoId: string = '';\n\nconst AnyVo = (props: AnyVoProps) => {\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [metadata, setMetadata] = useState<ValueObjectMetadata>({});\n  const [autoFocusSchema, setAutoFocusSchema] = useState(false);\n  const [voSchema, setVoSchema] = useState(new Schema({}));\n  const [querySchema, setQuerySchema] = useState(new Schema({}));\n  const [showAdvancedSettings, setShowAdvancedSettings] = useState(false);\n  const [dependencies, setDependencies] = useState<Record<string, RulesDependencyMetadata>>({});\n  const [showDependencies, setShowDependencies] = useState(false);\n  const [projection, setProjection] = useState<ProjectionConfig>({cases: []});\n  const [isEntityCollection, setIsEntityCollection] = useState(false);\n  const [isQueryable, setIsQueryable] = useState(false);\n  const [isProjection, setIsProjection] = useState(false);\n\n  const updateMetadata = (meta: ValueObjectMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    if(meta.schema && stringify(meta.schema) !== stringify(voSchema)) {\n      setVoSchema(meta.schema);\n      checkIsEntityCollection(meta.schema);\n    }\n\n    if(meta.querySchema && stringify(meta.querySchema) !== stringify(querySchema)) {\n      setQuerySchema(meta.querySchema);\n    }\n\n    if(meta.projection && stringify(meta.projection) !== stringify(projection)) {\n      setProjection(meta.projection);\n    }\n\n    setMetadata(meta);\n  }\n\n  const updateDependencies = (deps: Record<string, RulesDependencyMetadata>) => {\n    setDependencies(deps);\n  }\n\n  const checkIsEntityCollection = (schema: Schema) => {\n    if(!isEntityCollection && entityCollectionCheck(schema, elementsTree)) {\n      setIsEntityCollection(true);\n    }\n  }\n\n  const version = props.ctx.vo ? props.ctx.vo.getVersion() : 0;\n  const voId = props.ctx.vo ? props.ctx.vo.getId() : '';\n\n  useEffect(() => {\n    if(lastVoId !== voId) {\n      resetForm();\n    }\n\n\n    if(props.ctx.vo) {\n      const stateMeta = getVoMetadata(props.ctx.vo);\n      let shouldUpdateMetadata = false;\n\n      if(stateMeta.schema && !stateMeta.schema.isEmpty()) {\n        setVoSchema(stateMeta.schema);\n        checkIsEntityCollection(stateMeta.schema);\n      } else {\n        stateMeta.schema = suggestVoSchema(props.ctx.vo);\n        shouldUpdateMetadata = true;\n\n        // New VO, so check if queryable and projection\n        const events = getSourcesOfType(props.ctx.vo, NodeType.event);\n\n        if(events.length > 0) {\n          setIsQueryable(true);\n\n          if(!stateMeta.querySchema) {\n            stateMeta.querySchema = suggestQuery(props.ctx.vo, stateMeta) || new Schema({});\n          }\n\n          if(!stateMeta.resolve) {\n            stateMeta.resolve = getDefaultResolveConfigFromQuery(stateMeta.querySchema || new Schema({}));\n          }\n        }\n      }\n\n      if(lastVoId !== voId && Object.keys(props.ctx.queryDependencies).length) {\n        setShowDependencies(true);\n\n        if(!stateMeta.queryDependencies || stateMeta.queryDependencies !== props.ctx.queryDependencies) {\n          stateMeta.queryDependencies = props.ctx.queryDependencies;\n          shouldUpdateMetadata = true;\n        }\n      }\n\n      setDependencies(props.ctx.queryDependencies);\n\n      if(!stateMeta.uiSchema)  {\n        const suggestedUiSchema = suggestUiSchema(stateMeta.schema || new Schema({}), stateMeta.uiSchema, elementsTree, props.ctx);\n\n        if(suggestedUiSchema) {\n          shouldUpdateMetadata = true;\n          stateMeta.uiSchema = suggestedUiSchema;\n        }\n      }\n\n      if(stateMeta.querySchema) {\n        setQuerySchema(stateMeta.querySchema);\n        setIsQueryable(true);\n      }\n\n      if(!stateMeta.ns || stateMeta.ns === \"/\") {\n        stateMeta.ns = suggestVoNamespace(props.ctx.vo);\n        shouldUpdateMetadata = true;\n      }\n\n      if(typeof stateMeta.collection === \"undefined\" || stateMeta.collection === \"_collection\") {\n        stateMeta.collection = suggestCollection(props.ctx.vo, stateMeta, elementsTree);\n        shouldUpdateMetadata = true;\n      }\n\n      if(stateMeta.projection) {\n        setProjection(stateMeta.projection);\n        setIsProjection(true);\n      }\n\n      if(shouldUpdateMetadata) {\n        const sourceVo = getConnectedValueObjectSourceIfPossible(props.ctx.vo);\n\n        if(sourceVo) {\n          if(!stateMeta.querySchema) {\n            stateMeta.querySchema = new Schema({});\n          }\n\n          if(!stateMeta.resolve) {\n            stateMeta.resolve = getDefaultResolveConfigFromQuery(stateMeta.querySchema);\n          }\n        }\n\n        updateMetadata(stateMeta);\n        return;\n      }\n\n      setMetadata(stateMeta);\n    }\n\n    lastVoId = voId;\n  }, [voId, version])\n\n  const resetForm = () => {\n    setMetadata({});\n    setAutoFocusSchema(false);\n    setVoSchema(new Schema({}));\n    setQuerySchema(new Schema({}));\n    setDependencies({});\n    setShowDependencies(false);\n    setProjection({cases: []});\n    setIsQueryable(false);\n    setIsProjection(false);\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleNsChanged = (newNs: string) => {\n    updateMetadata({...metadata, ns: newNs});\n  }\n\n  const handleIdentifierChanged = (newIdentifier: string) => {\n    const newMetadata = {...metadata};\n\n    if (newIdentifier === \"\") {\n      delete newMetadata.identifier;\n    } else {\n      newMetadata.identifier = newIdentifier;\n    }\n    updateMetadata(newMetadata);\n  }\n\n  const handleSchemaChanged = (newSchema: Schema | undefined) => {\n    if(!newSchema) {\n      newSchema = new Schema({});\n    }\n\n    let entity = metadata.entity;\n\n    if(newSchema.isList()) {\n      entity = false;\n    }\n\n    updateMetadata({...metadata, schema: newSchema, entity});\n  }\n\n  const handleIsQueryableChanged = (newIsQueryable: boolean) => {\n    if(!newIsQueryable) {\n      handleQuerySchemaRemoved();\n    } else {\n      handleQuerySchemaChanged(suggestQuery(props.ctx.vo, metadata) || new Schema({}));\n    }\n\n    setIsQueryable(newIsQueryable);\n  }\n\n  const handleQuerySchemaChanged = (newQuerySchema: Schema) => {\n    const resolve = metadata.resolve || getDefaultResolveConfigFromQuery(newQuerySchema);\n    updateMetadata({...metadata, querySchema: newQuerySchema, resolve});\n  }\n\n  const handleQuerySchemaRemoved = () => {\n    updateMetadata({...metadata, querySchema: undefined, resolve: undefined});\n  }\n\n  const handleDependenciesConfigChanged = (changedDependencies: Record<string, RulesDependencyMetadata> | undefined) => {\n    if(!changedDependencies) {\n      changedDependencies = {};\n    }\n\n    updateMetadata({...metadata, queryDependencies: changedDependencies});\n    window.setTimeout(() => {\n      updateDependencies(changedDependencies!);\n    },100);\n  }\n\n  const handleSuggestDependencies = () => {\n    if(!props.ctx.vo) {\n      return;\n    }\n\n    const newDeps = suggestDependenciesForNode(props.ctx.vo, dependencies, false);\n\n    if(stringify(newDeps) !== stringify(dependencies)) {\n      handleDependenciesConfigChanged(newDeps);\n    }\n  }\n\n  const handleResolveChanged = (resolve?: ResolveConfig) => {\n    updateMetadata({...metadata, resolve, querySchema});\n  }\n\n  const handleUiSchemaChanged = (newUiSchema: UiSchema | undefined) => {\n    if(!newUiSchema) {\n      const clonedMeta = {...metadata};\n      delete clonedMeta.uiSchema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, uiSchema: newUiSchema});\n  }\n\n  const handleIsProjectionChanged = (newIsProjection: boolean) => {\n    handleProjectionChanged(newIsProjection ? suggestProjection(props.ctx.vo, metadata, props.ctx, elementsTree) : undefined);\n    setIsProjection(newIsProjection);\n  }\n\n  const handleProjectionChanged = (newProjection: ProjectionConfig | undefined) => {\n    if(!newProjection) {\n      const clonedMeta = {...metadata};\n      delete clonedMeta.projection;\n      updateMetadata(clonedMeta);\n      return;\n    }\n    updateMetadata({...metadata, projection: newProjection});\n  }\n\n  const handleStoredInDbChanged = (isStoredInDb: boolean) => {\n    const newMeta = {...metadata};\n\n    if(isStoredInDb) {\n      newMeta.collection = suggestCollection(props.ctx.vo, metadata, elementsTree);\n      updateMetadata(newMeta);\n    } else {\n      newMeta.collection = false;\n      if(newMeta.projection) {\n        delete newMeta.projection;\n      }\n      updateMetadata(newMeta);\n    }\n  }\n\n  const handleIsEntityChanged = (isEntity: boolean) => {\n    updateMetadata({...metadata, entity: isEntity});\n  }\n\n  const handleCollectionChanged = (newCollection: string) => {\n    updateMetadata({...metadata, collection: newCollection})\n  }\n\n  const handleInitializeRulesChanged = (rules: Rule[] | undefined) => {\n    if(!rules) {\n      const clonedMeta = {...metadata};\n      delete clonedMeta.initialize;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, initialize: rules});\n  }\n\n  const handleSuggestSchema = () => {\n    const newSchema = suggestVoSchema(props.ctx.vo);\n\n    if(!newSchema.isEmpty()) {\n      handleSchemaChanged(newSchema);\n    }\n  }\n\n  const handleSuggestQuerySchema = () => {\n    const newQuerySchema = suggestQuery(props.ctx.vo, metadata);\n\n    if(newQuerySchema) {\n      handleQuerySchemaChanged(newQuerySchema);\n    }\n  }\n\n  const handleSuggestResolve = () => {\n    const existingQuerySchema = metadata.querySchema || new Schema({});\n    const newResolve = getDefaultResolveConfigFromQuery(existingQuerySchema);\n\n    updateMetadata({...metadata, resolve: newResolve, querySchema: existingQuerySchema});\n  }\n\n  const handleSuggestUiSchema = () => {\n    const newUiSchema = suggestUiSchema(\n      metadata.schema || new Schema({}),\n      metadata.uiSchema,\n      elementsTree,\n      props.ctx,\n      false\n    )\n\n    if(newUiSchema) {\n      handleUiSchemaChanged(newUiSchema);\n    }\n  }\n\n  const handleSuggestProjection = () => {\n    const newProjection = suggestProjection(props.ctx.vo, metadata, props.ctx, elementsTree);\n\n    if(stringify(metadata.projection) !== stringify(newProjection)) {\n      handleProjectionChanged(newProjection);\n    }\n  }\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <EditorDivider label=\"Namespace\" content={<>\n      <NamespaceInput ns={metadata.ns || ''} onNsChanged={handleNsChanged} disabled={!props.ctx.vo.isEnabled()}/>\n    </>}/>\n\n    <EditorDivider label={metadata.schema && metadata.schema.isList() ? \"Item Identifier\" : \"Identifier\"} content={<>\n      <IdentifierSelect identifier={metadata.identifier || ''}\n                        schema={metadata.schema || new Schema({})}\n                        disabled={!props.ctx.vo || !props.ctx.vo.isEnabled()}\n                        onIdentifierChanged={handleIdentifierChanged}\n                        identifierCandidates={getIdentifierCandidatesFromSchema(metadata.schema || new Schema({}), elementsTree)}\n      />\n    </>} />\n\n    <SchemaEditorDivider content={<>\n      <SchemaEditor boardId={props.ctx.board.uid}\n                    sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n                    schema={voSchema}\n                    readonly={!props.ctx.vo.isEnabled()}\n                    onSchemaChanged={handleSchemaChanged} autofocus={autoFocusSchema}\n      />\n      <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestSchema}/>\n    </>} />\n\n    <UiSchemaEditorDivider type={voSchema.isList() ? 'table' : 'state'} content={<>\n      <UiSchemaEditor boardId={props.ctx.board.uid}\n                      sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n                      nodeSchema={voSchema}\n                      schema={metadata.uiSchema || {}}\n                      readonly={!props.ctx.vo.isEnabled()}\n                      onSchemaChanged={handleUiSchemaChanged}\n                      tableSchema={isListVo(props.ctx.vo)}\n      />\n      <ButtonGroup>\n        <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestUiSchema}/>\n        <Button basic={true} compact={true} icon=\"search\" className=\"noborder\"\n                content={props.t('insp.cody_wizard.ui_schema_editor.choose_icon')} as=\"a\"\n                href=\"https://pictogrammers.com/library/mdi/\" target=\"_blank\"/>\n      </ButtonGroup>\n    </>}/>\n\n    <EditorDivider label=\"Query Schema\" content={<>\n      <QueryableToggle isQueryable={isQueryable} onQueryableChanged={handleIsQueryableChanged} vo={props.ctx.vo} ctx={props.ctx} disabled={!props.ctx.vo.isEnabled()} />\n      <div className={(isQueryable ? 'slidedown' : 'slideup') + ' smooth'}>\n        <QuerySchemaEditor boardId={props.ctx.board.uid}\n                           sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n                           schema={querySchema}\n                           readonly={!props.ctx.vo.isEnabled()}\n                           onSchemaChanged={handleQuerySchemaChanged}\n                           onSchemaRemoved={handleQuerySchemaRemoved}\n        />\n        <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestQuerySchema}/>\n        <div className={'field'}>\n          {<Button basic={true} icon={showDependencies ? 'minus' : 'add'} labelPosition=\"left\" size=\"mini\"\n                   content={props.t('insp.cody_wizard.step_policy.manage_dependencies') + ` (${Object.keys(dependencies).length})`}\n                   color=\"blue\" className=\"text\"\n                   onClick={() => setShowDependencies(!showDependencies)}\n                   disabled={!props.ctx.vo}/>}\n        </div>\n        <div className={(showDependencies ? 'slidedown' : 'slideup') + ' smooth'}>\n          <DependenciesEditorDivider messageType=\"query\" label={props.t('insp.cody_wizard.step_policy.dependencies_label') as string} content={<>\n            <DependenciesEditor boardId={props.ctx.board.uid}\n                                sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n                                dependencies={dependencies}\n                                messageSchema={querySchema}\n                                autofocus={false}\n                                readonly={!!(props.ctx.vo && !props.ctx.vo.isEnabled())}\n                                onDependenciesChanged={handleDependenciesConfigChanged}\n            />\n            <CodySuggestButton\n              hasSuggestions={!!(props.ctx.vo && props.ctx.vo.getSources().filter(s => [NodeType.document, NodeType.externalSystem].includes(s.getType())).count() > 0)}\n              onSuggest={handleSuggestDependencies}\n            />\n          </>}/>\n        </div>\n        <ResolverEditorDivider label=\"Query Resolver\" content={<>\n          <ResolveEditor boardId={props.ctx.board.uid}\n                         sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n                         nodeSchema={voSchema}\n                         querySchema={querySchema}\n                         resolve={metadata.resolve}\n                         readonly={!props.ctx.vo.isEnabled()}\n                         onResolveChanged={handleResolveChanged}\n          />\n          <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestResolve}/>\n        </>}/>\n      </div>\n    </>\n    }/>\n    <p>&nbsp;</p>\n    <ProjectionEditorDivider label=\"Projection\" content={<>\n      <ProjectionToggle isProjection={isProjection} onProjectionChanged={handleIsProjectionChanged}\n                        vo={props.ctx.vo} ctx={props.ctx} disabled={!props.ctx.vo.isEnabled()}/>\n      <div className={(isProjection ? 'slidedown' : 'slideup') + ' smooth'}>\n        <ProjectionEditor\n          projection={projection}\n          ctx={props.ctx}\n          onProjectionChanged={handleProjectionChanged}\n          possibleEvents={props.ctx.vo ? getPossibleEvents(props.ctx.vo, props.ctx, elementsTree) : List()}\n          possibleServices={elementsTree.getFilteredElementsByType(NodeType.externalSystem)}\n          sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n          readonly={!props.ctx.vo.isEnabled()}\n        />\n        <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestProjection}/>\n      </div>\n    </>}/>\n\n    <AdvancedButton showAdvancedSettings={showAdvancedSettings} onShowChanged={show => setShowAdvancedSettings(show)}\n                    disabled={!props.ctx.vo}/>\n    <div className={(showAdvancedSettings ? 'slidedown' : 'slideup') + ' smooth'}>\n      <EditorDivider label={'Classification'} content={<>\n        {voSchema.isObject() &&\n          <EntityVoToggle isEntity={!!metadata.entity} vo={props.ctx.vo} onIsEntityChanged={handleIsEntityChanged}\n                          disabled={!props.ctx.vo.isEnabled()}/>}\n        <StoredVoToggle isStored={isVoStoredInDb(metadata)} ctx={props.ctx} vo={props.ctx.vo}\n                        onStoredStateChanged={handleStoredInDbChanged} disabled={!props.ctx.vo.isEnabled()}/>\n        {props.ctx.vo && isVoStoredInDb(metadata) && <EditorDivider label={'Collection'} content={<>\n          <CollectionInput collection={metadata.collection || '_collection'}\n                           onCollectionChanged={handleCollectionChanged}\n                           disabled={!props.ctx.vo.isEnabled()}/>\n        </>} />}\n      </>}/>\n\n      <EditorDivider label=\"Initialize Rules\" content={<>\n        <InitializeRulesEditor elementId={props.ctx.vo ? props.ctx.vo.getId() : ''}\n                               sessionId={props.ctx.vo ? props.ctx.vo.getId() : undefined}\n                               initializeRules={metadata.initialize || []}\n                               dataSchema={voSchema}\n                               readonly={!!(props.ctx.vo && !props.ctx.vo.isEnabled())}\n                               ctx={props.ctx}\n                               onRulesChanged={handleInitializeRulesChanged}\n        />\n      </>}/>\n\n    </div>\n    <div style={{marginTop: '100px'}}/>\n  </form>\n};\n\nexport default withNamespaces()(AnyVo);\n\nexport const suggestCollection = (vo: Node, voMeta: ValueObjectMetadata, elementsTree: ElementsTree): string => {\n  if(voMeta.schema && voMeta.schema.getListItemsSchema(new Schema({})).isRef()) {\n    const refVo = getRefVo(voMeta.schema.getListItemsSchema(new Schema({})), elementsTree);\n    if(refVo) {\n      const refVoMeta = getVoMetadata(refVo);\n      if(refVoMeta.collection) {\n        return refVoMeta.collection;\n      }\n    }\n  }\n\n  const sources = [...getSourcesOfType(vo, NodeType.document), ...getTargetsOfType(vo, NodeType.document)];\n\n  for (const source of sources) {\n    const sourceMeta = getVoMetadata(source);\n\n    if(sourceMeta.collection) {\n      return sourceMeta.collection;\n    }\n  }\n\n  return names(vo.getTechnicalName()).constantName.toLowerCase() + '_collection';\n}\n\nconst suggestQuery = (vo: Node, voMeta: ValueObjectMetadata): Schema | undefined => {\n  if(voMeta.querySchema && !voMeta.querySchema.isEmpty()) {\n    return voMeta.querySchema;\n  }\n\n  if(voMeta.schema && (voMeta.schema.isObject() || voMeta.schema.isRef()) && voMeta.identifier) {\n    const qSchema = new Schema({});\n    qSchema.setObjectProperty(voMeta.identifier, voMeta.schema.getObjectPropertySchema(voMeta.identifier, new Schema('string|format:uuid')));\n    return qSchema;\n  }\n}\n\nconst suggestVoSchema = (vo: Node): Schema => {\n  const sourceVo = getConnectedValueObjectSourceIfPossible(vo);\n\n  if(sourceVo) {\n    const sourceMeta = getVoMetadata(sourceVo);\n\n    if(sourceMeta.schema && sourceMeta.schema.isList()) {\n      const itemSchema = sourceMeta.schema.getListItemsSchema(new Schema({}))\n      return itemSchema.isRef() ? new Schema({\"$ref\": itemSchema.getRef('')}) : itemSchema;\n    }\n\n    const sourceRefName = getSchemaRefName(sourceVo, sourceMeta);\n\n    return new Schema({$items: sourceRefName});\n  }\n\n  const event = getConnectedEventIfPossible(vo);\n\n  if(event) {\n    const evtMeta = getEventMetadata(event);\n\n    if(evtMeta.schema) {\n\n\n      return isAggregateEvent(event)? evtMeta.schema : new Schema({'$items': evtMeta.schema.toShorthand()});\n    }\n  }\n\n  const descSchema = getSchemaFromNodeDescription(vo);\n\n  if(descSchema) {\n    return descSchema;\n  }\n\n  return new Schema({});\n}\n\nexport const suggestUiSchema = (schema: Schema, uiSchema: UiSchema | undefined, elementsTree: ElementsTree, ctx: ImmutableDDDWizardContext | ImmutableInformationContext, forCommand = false): UiSchema | undefined => {\n  const suggestions: Record<string, any> = {};\n  const uiForm = (uiSchema? uiSchema['ui:form'] || {} : {}) as UiSchema;\n  let uiFormData = uiForm.data || {} as Record<string, any>;\n\n  if(!uiSchema && isDDDAction(ctx) && !forCommand && ctx.command) {\n    const commandMeta = getCommandMetadata(ctx.command);\n\n    if(commandMeta.uiSchema) {\n      uiSchema = commandMeta.uiSchema;\n      delete uiSchema['ui:form'];\n    }\n  }\n\n  if(!uiSchema && isDDDAction(ctx) && forCommand && ctx.state) {\n    const stateMeta = getVoMetadata(ctx.state);\n\n    if(stateMeta.uiSchema) {\n      uiSchema = stateMeta.uiSchema;\n    }\n  }\n\n  if(isDDDAction(ctx) && forCommand) {\n    ctx.uiViews.forEach(uiView => {\n      const viewMeta = getVoMetadata(uiView);\n\n      if(viewMeta.schema && viewMeta.schema.equals(schema)) {\n        const viewDataRef = getSchemaRefName(uiView, viewMeta);\n        uiFormData = `$> page|data('${viewDataRef}')`\n      }\n    })\n  }\n\n  if(schema.isObject()) {\n    schema.getObjectProperties().forEach(prop => {\n      const propSchema = schema.getObjectPropertySchema(prop, new Schema({}));\n\n      if(propSchema.isString('uuid')) {\n        suggestions[prop] = {\n          \"ui:widget\": \"hidden\"\n        }\n\n        if(forCommand && isDDDAction(ctx) && ctx.ui) {\n          const uiMeta = getUiMetadata(ctx.ui);\n\n          if(!uiMeta.route || !uiMeta.route.split(\"/\").includes(`:${prop}`)) {\n            if(typeof uiFormData === \"object\") {\n              uiFormData[prop] = \"$> uuid()\";\n            }\n          }\n        }\n      } else if(propSchema.isRef() && isPropertyRef(propSchema.getRef(''))) {\n        const [ref, refProp] = splitPropertyRef(propSchema.getRef(''));\n\n        const refVoSchema = propSchema.resolveRef(elementsTree);\n        const refPropSchema = refVoSchema.getObjectPropertySchema(refProp, new Schema({}));\n        let firstStringProp = refProp;\n\n        refVoSchema.getObjectProperties().forEach(oProp => {\n          const oPropSchema = refVoSchema.getObjectPropertySchema(oProp, new Schema({}));\n\n          if(oPropSchema.isString() && !oPropSchema.isString('uuid')) {\n            firstStringProp = oProp;\n          }\n        })\n\n        if(refPropSchema.isString('uuid')) {\n          let firstVoList: Node | undefined;\n          let firstVoListMeta: ValueObjectMetadata | undefined;\n          elementsTree.getFilteredElementsByType(NodeType.document).forEach(doc => {\n            if(isListVo(doc)) {\n              const listVoMeta = getVoMetadata(doc);\n              const listVoSchema = listVoMeta.schema || new Schema({});\n\n              if(listVoSchema.getListItemsSchema(new Schema({})).getRef() === ref) {\n                firstVoList = doc;\n                firstVoListMeta = listVoMeta;\n              }\n            }\n          })\n\n          if(firstVoList) {\n            suggestions[prop] = {\n              \"ui:widget\": \"DataSelect\",\n              \"ui:options\": {\n                \"data\": getSchemaRefName(firstVoList, firstVoListMeta!),\n                \"value\": `$> data.${refProp}`,\n                \"text\": `$> data.${firstStringProp}`\n              }\n            }\n          }\n        }\n      }\n    })\n\n    if(forCommand && Object.keys(uiForm) && Object.keys(uiFormData).length > 0) {\n      uiForm.data = uiFormData;\n      suggestions['ui:form'] = uiForm;\n    }\n\n    if(!Object.keys(suggestions).length) {\n      return uiSchema;\n    }\n\n    return {...suggestions, ...uiSchema};\n  }\n\n  if(schema.isList() && !schema.getListItemsSchema(new Schema({})).isEmpty()) {\n    const listItemSchema = schema.getListItemsSchema(new Schema({})).isRef()\n      ? schema.getListItemsSchema(new Schema({})).resolveRef(elementsTree)\n      : schema.getListItemsSchema(new Schema({}));\n\n    const columns: TableColumn[] = [];\n\n    if(!listItemSchema.isObject()) {\n      return uiSchema;\n    }\n\n    listItemSchema.getObjectProperties().forEach(prop => {\n      const propSchema = listItemSchema.getObjectPropertySchema(prop, new Schema({}));\n\n      if(propSchema.isPrimitive() && !propSchema.isString('uuid')) {\n        columns.push(prop);\n      }\n\n      if(propSchema.isRef()) {\n        const ref = propSchema.getRef('');\n        const [refWithoutProp, refProp] = splitPropertyRef(ref);\n\n        if(refProp) {\n          const refVoSchema = propSchema.resolveRef(elementsTree);\n          const refPropSchema = refVoSchema.getObjectPropertySchema(refProp, new Schema({}));\n          let firstStringProp = refProp;\n\n\n          refVoSchema.getObjectProperties().forEach(oProp => {\n            const oPropSchema = refVoSchema.getObjectPropertySchema(oProp, new Schema({}));\n\n            if(oPropSchema.isString() && !oPropSchema.isString('uuid')) {\n              firstStringProp = oProp;\n            }\n          })\n\n          if(refPropSchema.isString('uuid')) {\n            let firstVoList: Node | undefined;\n            let firstVoListMeta: ValueObjectMetadata | undefined;\n            elementsTree.getFilteredElementsByType(NodeType.document).forEach(doc => {\n              if (isListVo(doc)) {\n                const listVoMeta = getVoMetadata(doc);\n                const listVoSchema = listVoMeta.schema || new Schema({});\n\n                if (listVoSchema.getListItemsSchema(new Schema({})).getRef() === refWithoutProp) {\n                  firstVoList = doc;\n                  firstVoListMeta = listVoMeta;\n                }\n              }\n            })\n\n            if (firstVoList) {\n              columns.push({\n                field: prop,\n                ref: {\n                  data: getSchemaRefName(firstVoList, firstVoListMeta!),\n                  value: `$> data.${firstStringProp}`\n                }\n              })\n            }\n          }\n        }\n      }\n    })\n\n    if(!columns.length) {\n      return uiSchema;\n    }\n\n    if(!uiSchema || !uiSchema['ui:table']) {\n      return {'ui:table': {columns}, ...uiSchema};\n    }\n\n    if(uiSchema && uiSchema['ui:table']) {\n      const uiColumns = (uiSchema['ui:table'] as {columns: TableColumn[]}).columns;\n\n      columns.forEach(col => {\n        const field = typeof col === 'string'? col : col.field;\n        let fieldExists = false;\n\n        uiColumns.forEach(uiCol => {\n          const uiField = typeof uiCol === 'string' ? uiCol : uiCol.field;\n\n          if(uiField === field) {\n            fieldExists = true;\n          }\n        })\n\n        if(!fieldExists) {\n          uiColumns.push(col);\n        }\n      });\n\n      (uiSchema['ui:table'] as {columns: TableColumn[]}).columns = uiColumns;\n      return uiSchema;\n    }\n  }\n\n  return uiSchema;\n}\n\nconst suggestVoNamespace = (vo: Node): string => {\n  const sourceVo = getConnectedValueObjectSourceIfPossible(vo);\n\n  if(!sourceVo) {\n    return ispConst.DEFAULT_DOC_NS;\n  }\n\n  const sourceMeta = getVoMetadata(sourceVo);\n\n  return sourceMeta.ns || ispConst.DEFAULT_DOC_NS;\n}\n\nconst getDefaultResolveConfigFromQuery = (query: Schema): ResolveConfig => {\n  if(!query.isObject() || query.isEmpty()) {\n    return {\n      where: {\n        rule: \"always\",\n        then: {filter: {any: true}}\n      }\n    }\n  }\n\n  const firstProp = query.getObjectProperties()[0];\n\n  if(query.isRequired(firstProp)) {\n    return {\n      where: {\n        rule: \"always\",\n        then: {filter: {eq: {prop: firstProp, value: `$> query.${firstProp}`}}}\n      }\n    }\n  } else {\n    return {\n      where: {\n        rule: \"condition\",\n        if: `query.${firstProp}`,\n        then: {filter: {eq: {prop: firstProp, value: `$> query.${firstProp}`}}},\n        else: {filter: {any: true}}\n      }\n    }\n  }\n}\n\nconst suggestProjection = (vo: Node,voMeta: ValueObjectMetadata, ctx: WizardContext, elementsTree: ElementsTree): ProjectionConfig => {\n  const identifier = getIdentifier(voMeta);\n  const projection: ProjectionConfig = cloneDeepJSON((voMeta.projection || {\n    name: names(vo.getTechnicalName()).className + 'Projection',\n    live: true,\n    cases: []\n  }));\n\n  const caseEventList: string[] = projection.cases.map(c => c.when)\n    .map(eName => {const nameParts = eName.split(\".\"); return nameParts[nameParts.length - 1]})\n    .map(eName => names(eName).className);\n\n  const events = getPossibleEvents(vo, ctx, elementsTree);\n\n  events.forEach(event => {\n    const eventName = names(event.getTechnicalName()).className;\n    if(!caseEventList.includes(eventName)) {\n      const idExpr = identifier ? `$> event.${identifier}` : '$> uuid()';\n      projection.cases.push({\n        when: event.getTechnicalName(),\n        then: {\n          upsert: {\n            id: idExpr,\n            set: \"$> event\"\n          }\n        }\n      })\n    }\n  })\n\n  return projection;\n}\n\nconst getIdentifier = (voMeta: ValueObjectMetadata): string | undefined => {\n  if(voMeta.identifier) {\n    return voMeta.identifier;\n  }\n}\n\nconst getPossibleEvents = (vo: Node, ctx: WizardContext, elementsTree: ElementsTree): List<Node> => {\n  let similarNodes = elementsTree.getSimilarElements(vo)\n\n  similarNodes = similarNodes.push(vo);\n\n  const eventMap: Record<string, Node> = {};\n\n  similarNodes.forEach(s => {\n    const events = getSourcesOfType(s, NodeType.event);\n\n    events.forEach(e => eventMap[e.getTechnicalName()] = e);\n  })\n\n  return List(Object.values(eventMap));\n}\n","import {ElementsTree} from \"../../../model/ElementsTree\";\nimport {Schema} from \"../schema/schema\";\nimport {getRefVo} from \"./get-ref-vo\";\nimport {isStateVo} from \"./is-state-vo\";\n\nexport const isEntityCollection = (schema: Schema, elementsTree: ElementsTree): boolean => {\n  if(schema.isList() && schema.getListItemsSchema(new Schema({}).isRef())) {\n    const refVo = getRefVo(schema.getListItemsSchema(new Schema({})), elementsTree);\n\n    if(refVo && isStateVo(refVo)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","import {cloneDeepJSON, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button, ButtonGroup} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {makeNodeFromJs, Node, NodeType} from \"../../../model/Graph\";\nimport {CommandMetadata, getCommandMetadata} from \"../../../service/cody-wizard/command/get-command-metadata\";\nimport {ImmutableDDDWizardContext} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {suggestDependenciesForNode} from \"../../../service/cody-wizard/dependencies/suggest-dependencies-for-node\";\nimport {getEventMetadata} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {names} from \"../../../service/cody-wizard/node/names\";\nimport {Rule} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {RulesDependencyMetadata} from \"../../../service/cody-wizard/rule-engine/types\";\nimport {\n  getSchemaFromNodeDescription\n} from \"../../../service/cody-wizard/schema/get-schema-from-node-description\";\nimport { Schema } from \"../../../service/cody-wizard/schema/schema\";\nimport {\n  ensurePresentTense,\n  isVerb,\n  tagSentence\n} from \"../../../service/cody-wizard/tagger\";\nimport {UiSchema} from \"../../../service/cody-wizard/ui/ui-schema\";\nimport {getVoMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {isStateVo} from \"../../../service/cody-wizard/vo/is-state-vo\";\nimport BusinessRulesEditor from \"../Editor/BusinessRulesEditor\";\nimport DependenciesEditor from \"../Editor/DependenciesEditor\";\nimport BusinessRulesEditorDivider from \"../Editor/Divider/BusinessRulesEditorDivider\";\nimport DependenciesEditorDivider from \"../Editor/Divider/DependenciesEditorDivider\";\nimport SchemaEditorDivider from \"../Editor/Divider/SchemaEditorDivider\";\nimport UiSchemaEditorDivider from \"../Editor/Divider/UiSchemaEditorDivider\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport SchemaEditor from \"../Editor/SchemaEditor\";\nimport StreamIdEditor from \"../Editor/StreamIdEditor\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport UiSchemaEditor from \"../Editor/UiSchemaEditor\";\nimport {WithWizardStepProps} from \"../WizardModal\";\nimport AdvancedButton from \"./AdvancedButton\";\nimport {suggestEventRecordingRules} from \"./Aggregate\";\nimport AggregateCommandToggle from \"./AggregateCommand/AggregateCommandToggle\";\nimport DeleteHistoryToggle from \"./AggregateCommand/DeleteHistoryToggle\";\nimport DeleteStateToggle from \"./AggregateCommand/DeleteStateToggle\";\nimport NewAggregateToggle from \"./AggregateCommand/NewAggregateToggle\";\nimport StreamLockingToggle from \"./AggregateCommand/StreamLockingToggle\";\nimport {suggestUiSchema} from \"./AnyVo\";\n\ninterface OwnProps {}\n\ntype DddCommandProps = OwnProps & WithWizardStepProps<ImmutableDDDWizardContext> & WithNamespaces;\n\nlet lastCommandId: string  = '';\n\nconst DddCommand = (props: DddCommandProps) => {\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedCommand, setSelectedCommand] = useState<Node|null>(null);\n  const [newCommand, setNewCommand] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<CommandMetadata>({aggregateCommand: false});\n  const [autoFocusSchema, setAutoFocusSchema] = useState(false);\n  const [showDependencies, setShowDependencies] = useState(false);\n  const [dependencies, setDependencies] = useState<Record<string, RulesDependencyMetadata>>({});\n  const [showAdvancedSettings, setShowAdvancedSettings] = useState<boolean>(false);\n  const [showStreamIdEditor, setShowStreamIdEditor] = useState<boolean>(false);\n\n  const updateMetadata = (meta: CommandMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    setMetadata(meta);\n  }\n\n  const commandId = props.ctx.command ? props.ctx.command.getId() : '';\n  const version = props.ctx.command ? props.ctx.command.getVersion() : 0;\n\n  useEffect(() => {\n    if(lastCommandId !== commandId) {\n      resetForm();\n    }\n\n    if(props.ctx.command) {\n      setSelectedCommand(props.ctx.command);\n      const commandMeta = getCommandMetadata(props.ctx.command);\n      let shouldUpdateMetadata = false;\n\n      if(props.ctx.commandDependencies) {\n        commandMeta.dependencies = props.ctx.commandDependencies;\n      }\n\n      if(!commandMeta.uiSchema) {\n        const suggestedUiSchema = suggestUiSchema(commandMeta.schema || new Schema({}), undefined, elementsTree, props.ctx, true);\n\n        if(suggestedUiSchema) {\n          shouldUpdateMetadata = true;\n          commandMeta.uiSchema = suggestedUiSchema;\n        }\n      }\n\n      if (!commandMeta.aggregateCommand && props.ctx.state && isStateVo(props.ctx.state)) {\n        commandMeta.aggregateCommand = true;\n        commandMeta.newAggregate = suggestCommandCreatesNewAggregate(props.ctx, elementsTree, true);\n        shouldUpdateMetadata = true;\n      }\n\n      if((!commandMeta.rules || commandMeta.rules && commandMeta.rules.length === 0) && !props.ctx.aggregate && props.ctx.events.count() > 0) {\n        const newRules = suggestEventRecordingRules(props.ctx);\n        commandMeta.rules = newRules;\n        shouldUpdateMetadata = true;\n        props.onCtxChanged({...props.ctx, commandHandler: newRules});\n      }\n\n      if(shouldUpdateMetadata) {\n        updateMetadata(commandMeta);\n      }\n\n      if(lastCommandId !== commandId && commandMeta.streamId) {\n        setShowStreamIdEditor(true);\n      }\n\n      setMetadata(commandMeta);\n    }\n\n    if(lastCommandId !== commandId && Object.keys(props.ctx.commandDependencies).length) {\n      setShowDependencies(true);\n      setDependencies(props.ctx.commandDependencies);\n    }\n\n    lastCommandId = commandId;\n  }, [commandId, version])\n\n  useEffect(() => {\n    setDependencies(props.ctx.commandDependencies || {});\n  }, [props.ctx.commandDependencies]);\n\n  const resetForm = () => {\n    setSelectedCommand(null);\n    setNewCommand(null);\n    setMetadata({aggregateCommand: false});\n    setAutoFocusSchema(false);\n    setDependencies({});\n    setShowDependencies(false);\n    setShowStreamIdEditor(false);\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleNewAggregateChanged = (newAggregate: boolean) => {\n    updateMetadata({...metadata, newAggregate});\n  }\n\n  const handleDeleteStateChanged = (deleteState: boolean) => {\n    updateMetadata({...metadata, deleteState, deleteHistory: false});\n  }\n\n  const handleDeleteHistoryChanged = (deleteHistory: boolean) => {\n    updateMetadata({...metadata, deleteHistory});\n  }\n\n  const handleSchemaChanged = (newSchema: Schema | undefined) => {\n    if(!newSchema) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.schema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, schema: newSchema});\n  }\n\n  const handleUiSchemaChanged = (newUiSchema: UiSchema | undefined) => {\n    if(!newUiSchema) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.uiSchema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, uiSchema: newUiSchema});\n  }\n\n  const handleSuggestSchema = () => {\n    if(props.ctx.state) {\n      const stateMeta = getVoMetadata(props.ctx.state);\n\n      if(stateMeta.schema && !stateMeta.schema.isEmpty()) {\n        handleSchemaChanged(stateMeta.schema);\n        return;\n      }\n    }\n\n    const firstEvent = props.ctx.events.first(undefined);\n\n    if(firstEvent) {\n      const eventMeta = getEventMetadata(firstEvent);\n\n      if(eventMeta.schema && !eventMeta.schema.isEmpty()) {\n        handleSchemaChanged(eventMeta.schema);\n        return;\n      }\n    }\n\n    if(props.ctx.uiViews.first(undefined)) {\n      const firstView = props.ctx.uiViews.first() as Node;\n\n      const viewMeta = getVoMetadata(firstView);\n\n      if(viewMeta.schema && (viewMeta.schema.isObject() || viewMeta.schema.isRef())) {\n        handleSchemaChanged(viewMeta.schema);\n        return;\n      }\n    }\n\n    const descSchema = props.ctx.command? getSchemaFromNodeDescription(props.ctx.command) : new Schema({});\n\n    if(!descSchema.isEmpty()) {\n      handleSchemaChanged(descSchema);\n      return;\n    }\n\n    handleSchemaChanged(new Schema({}));\n  }\n\n  const handleSuggestUiSchema = () => {\n    if(props.ctx.state) {\n      const stateMeta = getVoMetadata(props.ctx.state);\n\n      if(stateMeta.uiSchema) {\n        const uiSchema = {\n          ...(metadata.uiSchema && metadata.uiSchema[\"ui:button\"]? {\"ui:button\": metadata.uiSchema[\"ui:button\"]} : {}),\n          ...stateMeta.uiSchema\n        };\n        handleUiSchemaChanged(uiSchema as UiSchema);\n        return;\n      }\n    }\n\n    const suggestedUiSchema = suggestUiSchema(metadata.schema || new Schema({}), metadata.uiSchema, elementsTree, props.ctx, true);\n\n    if(suggestedUiSchema) {\n      handleUiSchemaChanged(suggestedUiSchema);\n    }\n  }\n\n  const updateDependencies = (deps: Record<string, RulesDependencyMetadata>) => {\n    updateMetadata({...metadata, dependencies: deps});\n    props.onCtxChanged({...props.ctx, commandDependencies: deps});\n    setDependencies(deps);\n  }\n\n  const handleDependenciesConfigChanged = (changedDependencies: Record<string, RulesDependencyMetadata> | undefined) => {\n    updateDependencies(changedDependencies || {});\n  }\n\n  const handleSuggestDependencies = () => {\n    if(!props.ctx.command) {\n      return;\n    }\n\n    const newDeps = suggestDependenciesForNode(props.ctx.command, dependencies);\n\n    if(stringify(newDeps) !== stringify(dependencies)) {\n      handleDependenciesConfigChanged(newDeps);\n    }\n  }\n\n  const handleRulesChanged = (newRuleSet: Rule[] | undefined) => {\n    if(!newRuleSet) {\n      newRuleSet = [];\n    }\n\n    props.onCtxChanged({...props.ctx, commandHandler: newRuleSet});\n    updateMetadata({...metadata, rules: newRuleSet});\n  }\n\n  const handleAggregateCommandChanged = (aggregateCommand: boolean) => {\n    updateMetadata({...metadata, aggregateCommand});\n  }\n\n  const handleStreamLockingChanged = (streamLocking: boolean) => {\n    setShowStreamIdEditor(streamLocking);\n    if(!streamLocking) {\n      handleStreamIdChanged('');\n    }\n  }\n\n  const handleStreamIdChanged = (streamId: string) => {\n    if(!streamId) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.streamId;\n      updateMetadata(clonedMeta);\n    } else {\n      updateMetadata({...metadata, streamId});\n    }\n  }\n\n  const cmdSchema = metadata.schema || Schema.fromString('{}');\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    {metadata.aggregateCommand && <NewAggregateToggle command={props.ctx.command || newCommand} disabled={!!(selectedCommand && !selectedCommand.isEnabled())} ctx={props.ctx} newAggregate={metadata.newAggregate} deleteState={metadata.deleteState} onNewAggregateChanged={handleNewAggregateChanged} />}\n    {metadata.aggregateCommand && <DeleteStateToggle command={props.ctx.command || newCommand} disabled={!!(selectedCommand && !selectedCommand.isEnabled())} deleteState={metadata.deleteState} newAggregate={metadata.newAggregate} onDeleteStateChanged={handleDeleteStateChanged} />}\n    {metadata.aggregateCommand && <DeleteHistoryToggle command={props.ctx.command || newCommand} disabled={!!(selectedCommand && !selectedCommand.isEnabled())} deleteHistory={metadata.deleteHistory} deleteState={metadata.deleteState} onDeleteHistoryChanged={handleDeleteHistoryChanged} />}\n    <SchemaEditorDivider content={<>\n      <SchemaEditor boardId={props.ctx.board.uid}\n                    sessionId={props.ctx.command ? props.ctx.command.getId() : undefined}\n                    schema={cmdSchema}\n                    readonly={!!(selectedCommand && !selectedCommand.isEnabled())}\n                    onSchemaChanged={handleSchemaChanged} autofocus={autoFocusSchema}\n      />\n      <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestSchema} />\n    </>} />\n    <UiSchemaEditorDivider type=\"command\" content={<>\n      <UiSchemaEditor boardId={props.ctx.board.uid}\n                      sessionId={props.ctx.command ? props.ctx.command.getId() : undefined}\n                      nodeSchema={metadata.schema || Schema.fromString('{}')}\n                      schema={metadata.uiSchema || {}}\n                      readonly={!!(selectedCommand && !selectedCommand.isEnabled())}\n                      onSchemaChanged={handleUiSchemaChanged}\n                      buttonSchema={true}\n                      formSchema={true}\n      />\n      <ButtonGroup>\n        <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestUiSchema} />\n        <Button basic={true} compact={true} icon=\"search\" className=\"noborder\" content={props.t('insp.cody_wizard.ui_schema_editor.choose_icon')} as=\"a\" href=\"https://pictogrammers.com/library/mdi/\" target=\"_blank\" />\n      </ButtonGroup>\n    </>} />\n\n    {!props.ctx.aggregate && <>\n      <div className={'field'}>\n        <DependenciesEditorDivider messageType=\"command\" label={'Command Handler'} content={<>\n          {<Button basic={true} icon={showDependencies ? 'minus' : 'add'} labelPosition=\"left\" size=\"mini\"\n                   content={props.t('insp.cody_wizard.step_aggregate.manage_dependencies') + ` (${Object.keys(dependencies).length})`}\n                   color=\"blue\" className=\"text\"\n                   onClick={() => setShowDependencies(!showDependencies)}\n                   disabled={!selectedCommand || !selectedCommand.isEnabled()}/>}\n        </>}/>\n        <div className={(showDependencies ? 'slidedown' : 'slideup') + ' smooth'}>\n          <DependenciesEditor boardId={props.ctx.board.uid}\n                              dependencies={dependencies}\n                              messageSchema={metadata.schema || Schema.fromString('{}')}\n                              autofocus={false}\n                              onDependenciesChanged={handleDependenciesConfigChanged}\n                              readonly={!selectedCommand || !selectedCommand.isEnabled()}\n                              sessionId={props.ctx.command ? props.ctx.command.getId() : undefined}\n          />\n          <CodySuggestButton\n            hasSuggestions={!!(props.ctx.command && props.ctx.command.getSources().filter(s => [NodeType.document, NodeType.externalSystem, NodeType.event].includes(s.getType())).count() > 0)}\n            onSuggest={handleSuggestDependencies}\n          />\n        </div>\n      </div>\n\n      <BusinessRulesEditorDivider isAggregate={metadata.aggregateCommand} label={props.t('insp.cody_wizard.step_aggregate.rules_label') as string} content={<>\n        <BusinessRulesEditor rules={metadata.rules || []}\n                             boardId={props.ctx.board.uid}\n                             elementId={props.ctx.command ? props.ctx.command.getId() : ''}\n                             sessionId={props.ctx.command ? props.ctx.command.getId() : undefined}\n                             commandSchema={cmdSchema}\n                             dependencies={dependencies}\n                             onRulesChanged={handleRulesChanged}\n                             autofocus={false}\n                             possibleEvents={props.ctx.events}\n                             readonly={!selectedCommand || !selectedCommand.isEnabled()}\n        />\n      </>} />\n\n    </>}\n    <AdvancedButton showAdvancedSettings={showAdvancedSettings} onShowChanged={show => setShowAdvancedSettings(show)}\n                    disabled={!selectedCommand}/>\n    <div className={(showAdvancedSettings ? 'slidedown' : 'slideup') + ' smooth'}>\n      <EditorDivider label={'Classification'} content={<>\n        <AggregateCommandToggle command={selectedCommand} aggregateCommand={metadata.aggregateCommand} ctx={props.ctx} onAggregateCommandChanged={handleAggregateCommandChanged} />\n        <StreamLockingToggle  command={selectedCommand} aggregateCommand={metadata.aggregateCommand} streamLocking={showStreamIdEditor} ctx={props.ctx} onStreamLockingChanged={handleStreamLockingChanged} />\n        {showStreamIdEditor && <StreamIdEditor ctx={props.ctx}\n                                               streamId={metadata.streamId || ''}\n                                               sessionId={props.ctx.command ? props.ctx.command.getId() : undefined}\n                                               autofocus={showStreamIdEditor}\n                                               readonly={!selectedCommand || !selectedCommand.isEnabled()}\n                                               boardId={props.ctx.board.uid}\n                                               onStreamIdChanged={handleStreamIdChanged}\n        />}\n      </>} />\n    </div>\n    <div style={{marginTop: '100px'}}/>\n  </form>\n};\n\nexport default withNamespaces()(DddCommand);\n\nexport const suggestAggregateCommandSchema = (ctx: ImmutableDDDWizardContext, newAggregate: boolean): Schema => {\n  const firstEvent = ctx.events.first(undefined);\n  const state = ctx.state;\n  if (newAggregate && state) {\n    const stateMeta = getVoMetadata(state);\n\n    if (stateMeta.schema) {\n      return stateMeta.schema;\n    }\n  }\n\n  if (firstEvent) {\n    const evtMeta = getEventMetadata(firstEvent);\n\n    if (evtMeta.schema) {\n      return evtMeta.schema;\n    }\n  }\n\n  if (state) {\n    const stateMetaAgain = getVoMetadata(state);\n\n    if (stateMetaAgain.identifier) {\n      const rawSchema: Record<string, any> = {};\n      rawSchema[stateMetaAgain.identifier] = 'string|format:uuid';\n      return new Schema(rawSchema)\n    }\n  }\n\n  return new Schema({});\n}\n\nexport const suggestAggregateCommandUiSchema = (ctx: ImmutableDDDWizardContext): UiSchema => {\n  if (ctx.state) {\n    const stateMeta = getVoMetadata(ctx.state);\n\n    if (stateMeta.uiSchema) {\n      return stateMeta.uiSchema;\n    }\n\n    if (stateMeta.identifier) {\n      const uiSchema: Record<string, any> = {};\n      uiSchema[stateMeta.identifier] = {\n        'ui:widget': 'hidden'\n      }\n\n      return uiSchema;\n    }\n  }\n\n  return {};\n}\n\nexport const suggestNewCommandName = (ctx: ImmutableDDDWizardContext): string | undefined => {\n  const name = '';\n\n  if(ctx.events.first(undefined)) {\n    const eventName = ctx.events.first(makeNodeFromJs({})).getTechnicalName();\n    const eventNameTitle = names(eventName).title;\n\n    const words = tagSentence(eventNameTitle);\n\n    console.log(\"[CodyWizard] tagged words: \", words);\n\n    const rest = words.filter(w => !isVerb(w)).map(w => w.token);\n    const verbs = words.filter(w => isVerb(w)).map(w => ensurePresentTense(w));\n\n    return verbs.join(\" \") + \" \" + rest.join(\" \");\n  }\n\n  return name;\n\n  // @TODO check if new ar or update command, suggest name based on state/ar name + Add or Update\n}\n\nexport const suggestCommandCreatesNewAggregate = (ctx: ImmutableDDDWizardContext, elementsTree: ElementsTree, isAggregateCommand?: boolean): boolean => {\n  if(ctx.aggregate) {\n    const similarAggregates = elementsTree.getFilteredElementsByTypeAndLabel(NodeType.aggregate, ctx.aggregate.getTechnicalName())\n      .filter(ele => ele.getId() !== ctx.aggregate!.getId());\n\n    return similarAggregates.count() === 0;\n  }\n\n  if(ctx.state) {\n    const similarStates = elementsTree.getFilteredElementsByTypeAndLabel(NodeType.document, ctx.state.getTechnicalName())\n      .filter(ele => ele.getId() !== ctx.state!.getId());\n\n    return similarStates.count() === 0;\n  }\n\n  return !!isAggregateCommand;\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {ImmutableDDDWizardContext} from \"../../../../service/cody-wizard/context/ddd-action\";\nimport {Schema} from \"../../../../service/cody-wizard/schema/schema\";\nimport {makeDefinitions} from \"./rule-engine-definitions\";\nimport {withSuggestionPropMapping} from \"./rule-engine/prop-mapping\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\n\nexport const makeEventApplyRulesSchema = (eventSchema: Schema, informationSchema: Schema, ctx: ImmutableDDDWizardContext): string => {\n  const schema: JSONSchema7 = {\n    type: \"array\",\n    items: {\n      $ref: \"#/definitions/rule_definition\"\n    },\n    definitions: withSuggestionPropMapping(\n      makeDefinitions(\n        makeAssignVariable('information')\n      ),\n      informationSchema.getObjectProperties(),\n      ['information', 'event', 'meta'],\n      mappingSuggestions(eventSchema)\n    )\n  }\n\n  return JSON.stringify(schema);\n}\n\nconst mappingSuggestions = (eventSchema: Schema): string[] => {\n  const suggestions: string[] = ['meta.user.userId'];\n\n  eventSchema.getObjectProperties().forEach(prop => {\n    suggestions.push(`event.${prop}`);\n  })\n\n  return suggestions;\n}\n","import {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {ImmutableDDDWizardContext} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {ApplyEventRule} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport ExpandButton from \"./ExpandButton\";\nimport {makeEventApplyRulesSchema} from \"./Validation/event-apply-rules-schema\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\n\ninterface OwnProps {\n  elementId: string;\n  applyRules: ApplyEventRule[];\n  eventSchema: Schema;\n  informationSchema: Schema;\n  ctx: ImmutableDDDWizardContext;\n  onRulesChanged: (rules: ApplyEventRule[] | undefined) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype EventApplyRulesEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst EventApplyRulesEditor = (props: EventApplyRulesEditorProps) => {\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('event-apply-rules'));\n  const dispatch = useDispatch();\n\n  let value = stringify(props.applyRules, null, 2);\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.elementId}-event-apply-rules.json`,\n      language: \"json\",\n      value,\n      schema: makeEventApplyRulesSchema(props.eventSchema, props.informationSchema, props.ctx),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.elementId, value, props.eventSchema.toString(), props.informationSchema.toString()]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onRulesChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedRules = parse(editorStr);\n      props.onRulesChanged(changedRules);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Event Apply Rules Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('event-apply-rules', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-event-apply-rules-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedRulesStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedRulesStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedRulesStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(EventApplyRulesEditor);\n","import * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {\n  Graph,\n  Node,\n} from \"../../../model/Graph\";\nimport {getCommandMetadata} from \"../../../service/cody-wizard/command/get-command-metadata\";\nimport {ImmutableDDDWizardContext} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {\n  ApplyEventRule, EventMetadata,\n  getEventMetadata\n} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {isEntityEvent} from \"../../../service/cody-wizard/event/is-aggregate-event\";\nimport {names} from \"../../../service/cody-wizard/node/names\";\nimport {getSchemaFromNodeDescription} from \"../../../service/cody-wizard/schema/get-schema-from-node-description\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {isVerb, tagSentence, toPastTense} from \"../../../service/cody-wizard/tagger\";\nimport {getVoMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {cloneDeepJSON, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport SchemaEditorDivider from \"../Editor/Divider/SchemaEditorDivider\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport EventApplyRulesEditor from \"../Editor/EventApplyRulesEditor\";\nimport SchemaEditor from \"../Editor/SchemaEditor\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport {WithWizardStepProps} from \"../WizardModal\";\n\ninterface OwnProps {\n\n}\n\ntype DddEventProps = OwnProps & WithWizardStepProps<ImmutableDDDWizardContext> & WithNamespaces;\n\nconst DddEvent = (props: DddEventProps) => {\n  const event = props.ctx.events.first(null);\n  const version = event ? event.getVersion() : 0;\n\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedEvent, setSelectedEvent] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<EventMetadata>({});\n  const [autoFocusSchema, setAutoFocusSchema] = useState(false);\n  const [eventSchema, setEventSchema] = useState(new Schema({}));\n  const [stateSchema, setStateSchema] = useState(new Schema({}));\n\n  const updateMetadata = (meta: EventMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    if(meta.schema && stringify(meta.schema) !== stringify(eventSchema)) {\n      setEventSchema(meta.schema);\n    }\n\n    setMetadata(meta);\n  }\n\n  useEffect(() => {\n    resetForm();\n\n    if(event) {\n      setSelectedEvent(event);\n      const meta = getEventMetadata(event);\n\n      let updateMeta = false;\n\n      if(!meta.schema || meta.schema.isEmpty()) {\n        meta.schema = suggestEventSchema(props.ctx);\n        updateMeta = true;\n      }\n\n      if(isEntityEvent(event) && !meta.applyRules) {\n        meta.applyRules = [defaultApplyRule()];\n        updateMeta = true;\n      }\n\n      if(updateMeta) {\n        updateMetadata(meta);\n      } else {\n        setMetadata(meta);\n        setEventSchema(meta.schema);\n      }\n    }\n\n  }, [event, version])\n\n  useEffect(() => {\n    setStateSchema(getStateSchema(props.ctx));\n  }, [props.ctx.state]);\n\n  const resetForm = () => {\n    setSelectedEvent(null);\n    setMetadata({});\n    setAutoFocusSchema(false);\n    setEventSchema(new Schema({}));\n    setStateSchema(new Schema({}));\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n\n  const handleSchemaChanged = (newSchema: Schema | undefined) => {\n    if(!newSchema) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.schema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, schema: newSchema});\n  }\n\n  const handleSuggestSchema = () => {\n    if(props.ctx.command) {\n      const cmdMeta = getCommandMetadata(props.ctx.command);\n\n      if(cmdMeta.schema && !cmdMeta.schema.isEmpty()) {\n        handleSchemaChanged(cmdMeta.schema);\n        return;\n      }\n    }\n\n    if(props.ctx.state) {\n      const stateMeta = getVoMetadata(props.ctx.state);\n\n      if(stateMeta.schema && !stateMeta.schema.isEmpty()) {\n        handleSchemaChanged(stateMeta.schema);\n        return;\n      }\n    }\n\n    const descSchema = event? getSchemaFromNodeDescription(event) : new Schema({});\n\n    if(!descSchema.isEmpty()) {\n      handleSchemaChanged(descSchema);\n      return;\n    }\n\n    handleSchemaChanged({} as Schema);\n  }\n\n  const handleEventApplyRulesChanged = (changedRules: ApplyEventRule[] | undefined) => {\n    if(!changedRules) {\n      changedRules = [];\n    }\n\n    updateMetadata({...metadata, applyRules: changedRules});\n  }\n\n  const showApplyRules = event? isEntityEvent(event) : false;\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <SchemaEditorDivider content={<>\n      <SchemaEditor boardId={props.ctx.board.uid}\n                    sessionId={selectedEvent ? selectedEvent.getId() : undefined }\n                    schema={eventSchema}\n                    readonly={!!(selectedEvent && !selectedEvent.isEnabled())}\n                    onSchemaChanged={handleSchemaChanged} autofocus={autoFocusSchema}\n      />\n      <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestSchema} />\n    </>} />\n\n\n    {showApplyRules && <EditorDivider label=\"Information Update\" content={<>\n      <EventApplyRulesEditor elementId={selectedEvent ? selectedEvent.getId() : ''}\n                             sessionId={selectedEvent ? selectedEvent.getId() : undefined}\n                             ctx={props.ctx}\n                             applyRules={metadata.applyRules || [defaultApplyRule()]}\n                             readonly={!!(selectedEvent && !selectedEvent.isEnabled())}\n                             eventSchema={eventSchema}\n                             informationSchema={stateSchema}\n                             onRulesChanged={handleEventApplyRulesChanged}\n      />\n    </>} />}\n  </form>\n};\n\nexport default withNamespaces()(DddEvent);\n\nexport const suggestEventSchema = (ctx: ImmutableDDDWizardContext): Schema => {\n  if(ctx.command) {\n    const cmdMetadata = getCommandMetadata(ctx.command);\n\n    if(cmdMetadata.schema) {\n      return cmdMetadata.schema;\n    }\n  }\n\n  if(ctx.state) {\n    const stateMetadata = getVoMetadata(ctx.state);\n\n    if(stateMetadata.schema) {\n      return stateMetadata.schema;\n    }\n  }\n\n  return new Schema({});\n}\n\nexport const suggestAggregateEventName = (ctx: ImmutableDDDWizardContext, graph: Graph): string => {\n  // @TODO: suggest from command name or state/aggregate name + Added/Updated\n  if(ctx.state) {\n    return ctx.state.getTechnicalName() + ' Changed';\n  }\n\n  if(ctx.aggregate) {\n    return ctx.aggregate.getTechnicalName() + ' Changed';\n  }\n\n  if(ctx.command) {\n    const words = tagSentence(names(ctx.command.getTechnicalName()).title);\n    const rest = words.filter(w => !isVerb(w)).map(w => w.token);\n    const verbs = words.filter(w => isVerb(w)).map(w => toPastTense(w));\n\n    return rest.join(\" \") + \" \" + verbs.join(\" \");\n  }\n\n  return '';\n}\n\nexport const defaultApplyRule = (): ApplyEventRule => {\n  return {\n    rule: \"always\",\n    then: {\n      assign: {\n        variable: \"information\",\n        value: {\n          $merge: [\"information\", \"event\"]\n        }\n      }\n    }\n  }\n}\n\nconst getStateSchema = (ctx: ImmutableDDDWizardContext): Schema => {\n  if(!ctx.state) {\n    return new Schema({});\n  }\n\n  const meta = getVoMetadata(ctx.state);\n\n  return meta.schema || new Schema({});\n}\n","import {Node} from \"../../../model/Graph\";\nimport {Rule} from \"../rule-engine/configuration\";\nimport {RulesDependenciesMetadata} from \"../rule-engine/types\";\n\nexport interface PolicyMetadata {\n  rules?: Rule[];\n  dependencies?: RulesDependenciesMetadata;\n}\n\nexport const getPolicyMetadata = (policy: Node): PolicyMetadata => {\n  const metadata = policy.getParsedMetadata() as Record<string, any>\n\n  return metadata;\n}\n","import {Graph, Node} from \"../../../model/Graph\";\n\nexport const isConnected = (node: Node): boolean => {\n  return node.getTags().contains(ispConst.TAG_CONNECTED);\n}\n\nexport const markAsConnected = (node: Node, graph: Graph): Node => {\n  if(isConnected(node)) {\n    return node;\n  }\n\n  const changedTags = node.getTags().push(ispConst.TAG_CONNECTED);\n\n  graph.changeNodeTags(node, changedTags);\n\n  return graph.getNode(node.getId()) as Node;\n}\n\n","import {Filter} from \"../vo/query/filter-types\";\n\nexport type RuleType = 'always' | 'condition' | 'validate';\n\nexport interface Rule {\n  rule: RuleType;\n  then: ThenType;\n}\n\nexport interface AlwaysRule extends Rule {\n\n}\n\nexport type ConditionRule = IfConditionRule | IfNotConditionRule;\n\nexport interface IfConditionRule extends Rule {\n  if: string;\n  else?: ThenType;\n  stop?: boolean;\n}\n\nexport const isIfConditionRule = (rule: any): rule is IfConditionRule => {\n  return typeof rule.if !== \"undefined\";\n}\n\nexport interface IfNotConditionRule extends Rule {\n  if_not: string;\n  else?: ThenType;\n  stop?: boolean;\n}\n\nexport const isIfNotConditionRule = (rule: any): rule is IfNotConditionRule => {\n  return typeof rule.if_not !== \"undefined\";\n}\n\nexport type ThenType = ThenRecordEvent | ThenThrowError | ThenAssignVariable | ThenTriggerCommand | ThenCallService | ThenPerformQuery | ThenExecuteRules | ThenForEach | ThenFilter |\n  ThenInsertInformation | ThenUpsertInformation | ThenUpdateInformation | ThenReplaceInformation | ThenDeleteInformation;\n\nexport interface PropMapping {\n  [name: string]: string | string[]\n}\n\nexport interface ThenForEach {\n  forEach: {\n    variable: string;\n    then: ThenType;\n  }\n}\n\nexport const isForEach = (then: any): then is ThenForEach => typeof then.forEach !== 'undefined';\n\nexport interface ThenRecordEvent {\n  record: {\n    event: string;\n    mapping: string | PropMapping\n  }\n}\n\nexport const isRecordEvent = (then: any): then is ThenRecordEvent => typeof then.record !== 'undefined';\n\nexport interface ThenThrowError {\n  throw: {\n    error: string\n  }\n}\n\nexport const isThrowError = (then: any): then is ThenThrowError => typeof then.throw !== 'undefined';\n\nexport interface ThenAssignVariable {\n  assign: {\n    variable: string;\n    value: string | PropMapping;\n  }\n}\n\nexport const isAssignVariable = (then: any): then is ThenAssignVariable => typeof then.assign !== 'undefined';\n\nexport interface ThenTriggerCommand {\n  trigger: {\n    command: string;\n    mapping: string | PropMapping;\n    meta?: string | PropMapping;\n  }\n}\n\nexport const isTriggerCommand = (then: any): then is ThenTriggerCommand => typeof then.trigger !== 'undefined';\n\nexport interface ThenCallService {\n  call: {\n    service: string;\n    arguments: PropMapping;\n    method?: string;\n    result: {\n      variable: string;\n      mapping: string | PropMapping;\n    }\n  }\n}\n\nexport const isCallService = (then: any): then is ThenCallService => typeof then.call !== 'undefined';\n\nexport interface ThenPerformQuery {\n  perform: {\n    query: string;\n    mapping: string | PropMapping;\n    result: {\n      variable: string;\n      mapping: string | PropMapping;\n    }\n  }\n}\n\nexport const isPerformQuery = (then: any): then is ThenPerformQuery => typeof then.perform !== 'undefined';\n\nexport interface ThenExecuteRules {\n  execute: {\n    rules: Rule[]\n  }\n}\n\nexport interface ThenFilter {\n  filter: Filter;\n}\n\nexport const isFilter = (then: any): then is ThenFilter => typeof then.filter !== \"undefined\";\n\nexport interface ThenExecuteRules {\n  execute: {\n    rules: Rule[]\n  }\n}\n\nexport const isExecuteRules = (then: any): then is ThenExecuteRules => typeof then.execute !== 'undefined';\n\nexport interface ThenInsertInformation {\n  insert: {\n    information: string;\n    id: string;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport const isInsertInformation = (then: any): then is ThenInsertInformation => typeof then.insert !== 'undefined';\n\nexport interface ThenUpsertInformation {\n  upsert: {\n    information: string;\n    id: string;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport const isUpsertInformation = (then: any): then is ThenUpsertInformation => typeof then.upsert !== 'undefined';\n\nexport interface ThenUpdateInformation {\n  update: {\n    information: string;\n    filter: Filter;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport const isUpdateInformation = (then: any): then is ThenUpdateInformation => typeof then.update !== 'undefined';\n\nexport interface ThenReplaceInformation {\n  replace: {\n    information: string;\n    filter: Filter;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport const isReplaceInformation = (then: any): then is ThenReplaceInformation => typeof then.replace !== 'undefined';\n\nexport interface ThenDeleteInformation {\n  delete: {\n    information: string;\n    filter: Filter;\n  }\n}\n\nexport const isDeleteInformation = (then: any): then is ThenDeleteInformation => typeof then.delete !== 'undefined';\n\n\nexport interface ThenInsertProjection {\n  insert: {\n    id: string;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport interface ThenUpsertProjection {\n  upsert: {\n    id: string;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport interface ThenUpdateProjection {\n  update: {\n    filter: Filter;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport interface ThenReplaceProjection {\n  replace: {\n    filter: Filter;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport interface ThenDeleteProjection {\n  delete: {\n    filter: Filter;\n  }\n}\n\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport EditorDivider from \"../EditorDivider\";\n\ninterface OwnProps {\n  content: React.ReactNode;\n  label: string;\n}\n\ntype ProcessorEditorDividerProps = OwnProps & WithNamespaces;\n\nconst ProcessorEditorDivider = (props: ProcessorEditorDividerProps) => {\n  return <EditorDivider label={props.label} content={props.content} popupContent={<>\n    <p>{props.t('insp.cody_wizard.editor.processor.help1')}</p>\n    <p>{props.t('insp.cody_wizard.editor.processor.help2')}</p>\n    <p>{props.t('insp.cody_wizard.editor.contextVariables')}</p>\n    <ul>\n      <li>event: event data</li>\n      <li>meta: event metadata</li>\n      <li>Processor Dependencies</li>\n    </ul>\n    <p>{props.t('insp.cody_wizard.editor.autocomplete')}</p>\n    <p><a href=\"https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#processor-rules\"\n          onClick={e => e.stopPropagation()}\n          target=\"_blank\"\n          rel=\"nofollow\">{props.t('app.learnMore')}</a></p>\n  </>}/>\n};\n\nexport default withNamespaces()(ProcessorEditorDivider);\n","import {JSONSchema7} from \"json-schema\";\nimport {\n  makeDefinitions\n} from \"./rule-engine-definitions\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\nimport {makeCallService} from \"./rule-engine/call-service\";\nimport {makeThenChangeInformation} from \"./rule-engine/change-information-rules\";\nimport {makeExecuteRules} from \"./rule-engine/execute-rules\";\nimport {makeFindFiltersDefinition, withResolveFilterTypes} from \"./rule-engine/filters\";\nimport {makeFindInformation, makePartialSelectDefinition} from \"./rule-engine/find-information-rules\";\nimport {makeForEach} from \"./rule-engine/foreach\";\nimport {makeLogMessage} from \"./rule-engine/log-message\";\nimport {makeThenThrowError} from \"./rule-engine/throw-error\";\nimport {makeThenTriggerCommand} from \"./rule-engine/trigger-command\";\n\nexport const makePolicyRulesSchema = (\n  possibleCommands: string[],\n  possibleExternalSystems: string[],\n  possibleStateRefs: string[],\n  possibleInformationRefs: string[],\n  expSuggests: string[]\n): string => {\n  const PolicyRulesSchema: JSONSchema7 = {\n    type: \"array\",\n    items: {\n      $ref: \"#/definitions/rule_definition\"\n    },\n    definitions: {\n      ...makeFindFiltersDefinition(undefined, expSuggests),\n      ...makePartialSelectDefinition(possibleInformationRefs),\n    }\n  }\n\n  PolicyRulesSchema.definitions = {\n    ...PolicyRulesSchema.definitions,\n    ...withResolveFilterTypes(makeDefinitions(\n      makeThenTriggerCommand(possibleCommands),\n      makeCallService(possibleExternalSystems),\n      makeThenThrowError(),\n      makeAssignVariable(),\n      makeForEach(),\n      makeExecuteRules(),\n      makeThenChangeInformation(possibleStateRefs),\n      makeLogMessage(),\n      makeFindInformation(possibleInformationRefs, expSuggests)\n    ))\n  }\n\n  return JSON.stringify(PolicyRulesSchema);\n}\n","import {JSONSchemaWithMarkdown} from \"../../Suggestion/markdown-description\";\n\nexport const makeThenTriggerCommand = (availableCommands: string[]): { rule_then_trigger_command: JSONSchemaWithMarkdown } => {\n  return {\n    rule_then_trigger_command: {\n      type: \"object\",\n      properties: {\n        trigger: {\n          type: \"object\",\n          markdownDescription: `**Trigger Command**\\n\\nAutomatically trigger a new command without user intervention. \\n\\n[Learn more](https://wiki.prooph-board.com/board_workspace/Rule-Engine.html#trigger-command)`,\n          properties: {\n            command: {\n              type: \"string\",\n              enum: availableCommands,\n            },\n            mapping: {\n              $ref: \"#/definitions/rule_then_prop_mapping\",\n              markdownDescription: `Set command data`,\n            },\n            meta: {\n              $ref: \"#/definitions/rule_then_prop_mapping\",\n              markdownDescription: `Set command metadata`,\n            }\n          },\n          additionalProperties: false,\n          required: [\"command\", \"mapping\"]\n        }\n      },\n      additionalProperties: false,\n      required: [\"trigger\"]\n    }\n  }\n}\n","import {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport {List} from \"immutable\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {ImmutablePolicyContext} from \"../../../service/cody-wizard/context/policy-context\";\nimport {fqcn} from \"../../../service/cody-wizard/node/fqcn\";\nimport {Rule} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {RulesDependencyMetadata} from \"../../../service/cody-wizard/rule-engine/types\";\nimport ExpandButton from \"./ExpandButton\";\nimport {getPossibleStateRefs} from \"./Typeahead/elements-tree-lookup\";\nimport {makePolicyRulesSchema} from \"./Validation/policy-rules-schema\";\nimport {setSideBySideCell, toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {getPossibleRefs} from \"./SchemaEditor\";\nimport {getRefVo} from \"../../../service/cody-wizard/vo/get-ref-vo\";\n\n\ninterface OwnProps {\n  boardId: BoardId;\n  elementId: string;\n  eventSchema: Schema;\n  rules: Rule[];\n  policyTargets: List<Node>;\n  dependencies: Record<string, RulesDependencyMetadata>;\n  onRulesChanged: (rules: Rule[] | undefined) => void;\n  autofocus?: boolean;\n  ctx: ImmutablePolicyContext;\n  readonly?: boolean;\n  sessionId?: string;\n}\n\ntype PolicyRulesEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\nlet isRefOpening = false;\n\nconst PolicyRulesEditor = (props: PolicyRulesEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('policy-rules'));\n  const dispatch = useDispatch();\n\n  const possibleServices: string[] = [];\n\n  for (const dependenciesKey in props.dependencies) {\n    if(props.dependencies[dependenciesKey].type === \"service\") {\n      possibleServices.push(props.dependencies[dependenciesKey].alias || dependenciesKey);\n    }\n  }\n\n  let value = stringify(props.rules, null, 2);\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-policy-rules.json`,\n      language: \"json\",\n      value,\n      schema: makePolicyRulesSchema(\n        props.policyTargets.filter(t => t.getType() === NodeType.command).map(c => fqcn(c)).toArray(),\n        possibleServices,\n        getPossibleStateRefs(elementsTree),\n        getPossibleRefs(elementsTree),\n        getExprSuggests(props.eventSchema)\n      ),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.elementId, value, props.policyTargets, props.dependencies, props.eventSchema.toString()]);\n\n  useEffect(() => {\n    // This is needed to prevent wrong schemaChanged events due to onBlur firing when ref is loaded\n    if(isRefOpening) {\n      window.setTimeout(() => {\n        isRefOpening = false;\n      }, 500);\n    }\n  }, [props.sessionId]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onRulesChanged(undefined);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedRules = parse(editorStr);\n      props.onRulesChanged(changedRules);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] Business Rules Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  const handleOpenInformationReference = (ref: string) => {\n    const refVo = getRefVo(Schema.fromString(ref), elementsTree);\n\n    if(refVo) {\n      isRefOpening = true;\n      dispatch(setSideBySideCell(refVo.getId()));\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('policy-rules', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-policy-rules-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      onOpenInformationReference={handleOpenInformationReference}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedRulesStr = codeEditorRef.current.retrievePayload();\n\n          console.log(\"[CodyWizard] editor rules\", changedRulesStr);\n\n          const validJson = propagateChanges(changedRulesStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedRulesStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(PolicyRulesEditor);\n\n\nconst getExprSuggests = (eventSchema: Schema): string[] => {\n  const suggests: string[] = eventSchema.getObjectProperties().map(prop => `event.${prop}`);\n\n  suggests.push('meta.user.userId');\n\n  return suggests;\n}\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Dropdown} from \"semantic-ui-react\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {getVoMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport CellIcon from \"../../CellIcon\";\n\ninterface OwnProps {\n  placeholder?: string,\n  nodeOptions: List<Node>,\n  selected: Node | null,\n  onChange: (selected: Node | null) => void,\n  disabled?: boolean,\n  uniqueName?: boolean,\n  withNs?: boolean,\n}\n\ntype NodeSelectProps = OwnProps & WithNamespaces;\n\nconst NodeSelect = (props: NodeSelectProps) => {\n  const selectedId = props.selected? props.selected.getId() : '';\n\n  const handleSelectNode = (nodeId: string) => {\n    const selectedNode = props.nodeOptions.find(node => node.getId() === nodeId);\n    props.onChange(selectedNode || null);\n  }\n\n  const existingNames: string[] = [];\n  const selectedNodeName = props.selected? getNodeNameForNodeSelect(props.selected, !!props.withNs) : '';\n  // Filter + push of selected node (and similar nodes if uniqueName is true) ensures that selectedNode is always present in options list\n  const options = props.nodeOptions.filter(n => {\n    if(n.getId() === selectedId) {\n      return false;\n    }\n\n    return !(props.uniqueName && getNodeNameForNodeSelect(n, !!props.withNs) === selectedNodeName);\n  }).push(...(props.selected? [props.selected] : [])).map(node => ({\n    key: node.getId(),\n    text: getNodeNameForNodeSelect(node, !!props.withNs),\n    value: node.getId(),\n    icon: <CellIcon cellType={node.getType()} />\n  })).filter(o => {\n    if(!props.uniqueName) {\n      return true;\n    }\n\n    if(existingNames.includes(o.text)) {\n      return false;\n    }\n\n    existingNames.push(o.text);\n    return true;\n  }).toArray();\n\n  console.log(\"[CodyWizard] NodeSelect\", props.selected, options);\n\n\n  return <Dropdown\n       placeholder={props.placeholder || props.t('insp.cody_wizard.node_select.default_placeholder') as string}\n       disabled={props.disabled}\n       selection={true}\n       clearable={true}\n       options={options}\n       onChange={(evt, data) => handleSelectNode(data.value as string)}\n       value={props.selected ? props.selected.getId() : ''}\n       search={true}\n  />\n};\n\nexport default withNamespaces()(NodeSelect);\n\nexport const getNodeNameForNodeSelect = (node: Node, withNs: boolean): string => {\n  if(withNs && node.getType() === NodeType.document) {\n    const voMeta = getVoMetadata(node);\n\n    if(voMeta.ns) {\n      return node.getName() + ` (${voMeta.ns})`;\n    }\n  }\n\n  return node.getName();\n}\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Dropdown} from \"semantic-ui-react\";\nimport {Node} from \"../../../model/Graph\";\nimport CellIcon from \"../../CellIcon\";\nimport {getNodeNameForNodeSelect} from \"./NodeSelect\";\n\ninterface OwnProps {\n  placeholder?: string,\n  nodeOptions: List<Node>,\n  selected: List<Node>,\n  onChange: (selected: List<Node>) => void,\n  disabled?: boolean,\n  uniqueName?: boolean,\n  withNs?: boolean,\n}\n\ntype MultipleNodeSelectProps = OwnProps & WithNamespaces;\n\nconst MultipleNodeSelect = (props: MultipleNodeSelectProps) => {\n  const selectedIds = props.selected.map(s => s.getId()).toArray();\n\n  const handleSelectNode = (nodeIds: string[]) => {\n    const selectedNodes = props.nodeOptions.filter(node => nodeIds.includes(node.getId()));\n    props.onChange(selectedNodes);\n  }\n\n  const existingNames: string[] = [];\n  const namesOfSelectedNodes: string[] = props.selected.map(s => getNodeNameForNodeSelect(s, !!props.withNs)).toArray();\n  const options = props.nodeOptions.filter(n => {\n    // First we filter out all selected nodes\n    if(selectedIds.includes(n.getId())) {\n      return false\n    }\n\n    // If unique name is also set, we remove all similar nodes, too\n    return !(props.uniqueName && namesOfSelectedNodes.includes(getNodeNameForNodeSelect(n, !!props.withNs)));\n  }).push(...props.selected.toArray()).map(node => ({\n    key: node.getId(),\n    text: getNodeNameForNodeSelect(node, !!props.withNs),\n    value: node.getId(),\n    icon: <CellIcon cellType={node.getType()} />\n  })).filter(o => {\n    if(!props.uniqueName) {\n      return true;\n    }\n\n    if(existingNames.includes(o.text)) {\n      return false;\n    }\n\n    existingNames.push(o.text);\n    return true;\n  }).toArray();\n\n  console.log(\"[CodyWizard] NodeSelect\", props.selected, options);\n\n\n  return <Dropdown\n       placeholder={props.placeholder || props.t('insp.cody_wizard.node_select.default_placeholder') as string}\n       disabled={props.disabled}\n       selection={true}\n       fluid={true}\n       multiple={true}\n       clearable={true}\n       options={options}\n       onChange={(evt, data) => handleSelectNode(data.value as string[])}\n       value={selectedIds}\n       search={true}\n  />\n};\n\nexport default withNamespaces()(MultipleNodeSelect);\n\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {\n  Graph,\n  makeNodeFromJs,\n  NextToPosition,\n  Node,\n  NodeType\n} from \"../../../model/Graph\";\nimport {ImmutablePolicyContext, policyContextFromNode} from \"../../../service/cody-wizard/context/policy-context\";\nimport {suggestDependenciesForNode} from \"../../../service/cody-wizard/dependencies/suggest-dependencies-for-node\";\nimport {getEventMetadata} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {fqcn} from \"../../../service/cody-wizard/node/fqcn\";\nimport {markAsConnected} from \"../../../service/cody-wizard/node/mark-as-connected\";\nimport {getPolicyMetadata, PolicyMetadata} from \"../../../service/cody-wizard/policy/get-policy-metadata\";\nimport {\n  isExecuteRules,\n  isForEach,\n  isIfConditionRule,\n  isIfNotConditionRule,\n  isTriggerCommand,\n  Rule,\n  ThenType\n} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {RulesDependencyMetadata} from \"../../../service/cody-wizard/rule-engine/types\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {stringify} from \"../../../service/json/json-comment-wrapper\";\nimport DependenciesEditor from \"../Editor/DependenciesEditor\";\nimport DependenciesEditorDivider from \"../Editor/Divider/DependenciesEditorDivider\";\nimport ProcessorEditorDivider from \"../Editor/Divider/ProcessorEditorDivider\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport PolicyRulesEditor from \"../Editor/PolicyRulesEditor\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport MultipleNodeSelect from \"../Node/MultipleNodeSelect\";\nimport {\n  DEFAULT_CARD_HEIGHT,\n  DEFAULT_CONNECT_MARGIN,\n  SLICE_LANE_MARGIN,\n  WithWizardStepProps\n} from \"../WizardModal\";\nimport {repositionFeature} from \"./Feature\";\n\ninterface OwnProps {\n\n}\n\ntype PolicyProps = OwnProps & WithWizardStepProps<ImmutablePolicyContext> & WithNamespaces;\n\nlet lastPolicyId: string = '';\n\nconst Policy = (props: PolicyProps) => {\n  const policy = props.ctx.policy;\n  const version = policy ? policy.getVersion() : 0;\n  const policyId = policy ? policy.getId() : '';\n\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedPolicy, setSelectedPolicy] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<PolicyMetadata>({});\n  const [autoFocusPolicyRules, setAutoFocusPolicyRules] = useState(false);\n  const [dependencies, setDependencies] = useState<Record<string, RulesDependencyMetadata>>({});\n  const [showDependencies, setShowDependencies] = useState(false);\n  const [policyTargets, setPolicyTargets] = useState(props.ctx.policyTargets);\n\n  const updateMetadata = (meta: PolicyMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    setMetadata(meta);\n  }\n\n  const updatePolicyTargets = (targets: List<Node>) => {\n    if(props.mode === \"sidebar\" && selectedPolicy) {\n      const shouldRepositionFeature = updateTargetsOnGraph(selectedPolicy, props.ctx, targets, graph);\n      // Refresh context\n      const changedCtx = policyContextFromNode(graph.getNode(selectedPolicy.getId())!, props.ctx.board);\n\n      if(shouldRepositionFeature && props.ctx.feature) {\n        const repositionedFeature = repositionFeature(\n          props.ctx.feature,\n          policyContextFromNode(graph.getNode(selectedPolicy.getId())!, props.ctx.board),\n          graph\n        );\n\n        graph.resizeNode(repositionedFeature, repositionedFeature.getSize());\n      }\n\n      props.onCtxChanged(changedCtx);\n\n    }\n\n    setPolicyTargets(targets);\n  }\n\n  const updateDependencies = (deps: Record<string, RulesDependencyMetadata>) => {\n    setDependencies(deps);\n  }\n\n  useEffect(() => {\n    if(lastPolicyId !== policyId) {\n      resetForm();\n    }\n\n\n    if(policy) {\n      setSelectedPolicy(policy);\n      const meta = getPolicyMetadata(policy);\n      setMetadata(meta);\n    }\n\n    if(lastPolicyId !== policyId && Object.keys(props.ctx.policyDependencies).length) {\n      setShowDependencies(true);\n    }\n\n    setDependencies(props.ctx.policyDependencies);\n    setPolicyTargets(props.ctx.policyTargets);\n\n    lastPolicyId = policyId;\n  }, [policyId, version])\n\n  const resetForm = () => {\n    setSelectedPolicy(null);\n    setMetadata({});\n    setAutoFocusPolicyRules(false);\n    setDependencies({});\n    setShowDependencies(false);\n    setPolicyTargets(List([]));\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleRulesChanged = (newRuleSet: Rule[] | undefined) => {\n    if(!newRuleSet) {\n      newRuleSet = [];\n    }\n\n    updateMetadata({...metadata, rules: newRuleSet});\n  }\n\n  const handleDependenciesConfigChanged = (changedDependencies: Record<string, RulesDependencyMetadata> | undefined) => {\n    if(!changedDependencies) {\n      changedDependencies = {};\n    }\n\n    updateDependencies(changedDependencies);\n    updateMetadata({...metadata, dependencies: changedDependencies});\n  }\n\n  const handleSuggestDependencies = () => {\n    if(!selectedPolicy) {\n      return;\n    }\n\n    const newDeps = suggestDependenciesForNode(selectedPolicy, dependencies, false);\n\n    if(stringify(newDeps) !== stringify(dependencies)) {\n      handleDependenciesConfigChanged(newDeps);\n    }\n  }\n\n  const handlePolicyTargetsChanged = (changedPolicyTargets: List<Node>) => {\n    updatePolicyTargets(changedPolicyTargets);\n    handleRulesChanged(suggestTriggerRules(changedPolicyTargets, metadata, props.ctx));\n  }\n\n  const targetOptions = elementsTree.getFilteredElementsByTypes([NodeType.command, NodeType.externalSystem]);\n  const eventSchema = props.ctx.event ? getEventMetadata(props.ctx.event).schema || new Schema({}) : new Schema({});\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <div className={'field'}>\n      {<Button basic={true} icon={showDependencies? 'minus' : 'add'} labelPosition=\"left\" size=\"mini\"\n               content={props.t('insp.cody_wizard.step_policy.manage_dependencies') + ` (${Object.keys(dependencies).length})`} color=\"blue\" className=\"text\"\n               onClick={() => setShowDependencies(!showDependencies)}\n               disabled={!selectedPolicy}/>}\n    </div>\n    <div className={(showDependencies? 'slidedown' : 'slideup') + ' smooth'} >\n      <DependenciesEditorDivider messageType=\"event\" label={props.t('insp.cody_wizard.step_policy.dependencies_label') as string} content={<>\n        <DependenciesEditor boardId={props.ctx.board.uid}\n                            sessionId={selectedPolicy ? selectedPolicy.getId() : undefined }\n                            dependencies={dependencies}\n                            messageSchema={eventSchema}\n                            autofocus={false}\n                            readonly={!!(selectedPolicy && !selectedPolicy.isEnabled())}\n                            onDependenciesChanged={handleDependenciesConfigChanged}\n        />\n        <CodySuggestButton hasSuggestions={!!(selectedPolicy && selectedPolicy.getSources().filter(s => [NodeType.document, NodeType.externalSystem].includes(s.getType())).count() > 0)}\n                           onSuggest={handleSuggestDependencies}\n        />\n      </>} />\n\n    </div>\n    <ProcessorEditorDivider label={props.t('insp.cody_wizard.step_policy.rules_label') as string} content={<>\n      <MultipleNodeSelect selected={policyTargets}\n                          nodeOptions={targetOptions}\n                          placeholder={props.t('insp.cody_wizard.step_policy.targets_placeholder') as string}\n                          uniqueName={true}\n                          onChange={handlePolicyTargetsChanged}\n                          disabled={!selectedPolicy || !selectedPolicy.isEnabled()} />\n      <p>&nbsp;</p>\n      <PolicyRulesEditor rules={metadata.rules || suggestTriggerRules(policyTargets, metadata, props.ctx)}\n                         boardId={props.ctx.board.uid}\n                         elementId={selectedPolicy ? selectedPolicy.getId() : ''}\n                         sessionId={selectedPolicy ? selectedPolicy.getId() : undefined }\n                         eventSchema={eventSchema}\n                         policyTargets={policyTargets}\n                         dependencies={dependencies}\n                         onRulesChanged={handleRulesChanged}\n                         autofocus={autoFocusPolicyRules}\n                         ctx={props.ctx}\n                         readonly={!!(selectedPolicy && !selectedPolicy.isEnabled())}\n      />\n    </>} />\n    <div style={{marginTop: '100px'}} />\n  </form>\n};\n\nexport default withNamespaces()(Policy);\n\nexport const suggestPolicyName = (ctx: ImmutablePolicyContext): string => {\n  let name = 'On ';\n\n  if(ctx.event) {\n    name += ctx.event.getTechnicalName();\n  }\n\n  return name;\n}\n\n\nexport const suggestTriggerRules = (policyTargets: List<Node>, metadata: PolicyMetadata, ctx: ImmutablePolicyContext): Rule[] => {\n  const rules: Rule[] = metadata.rules ? [...metadata.rules] : [];\n\n  policyTargets.forEach(t => {\n    if(t.getType() === NodeType.command) {\n      const cmdFQCN = fqcn(t);\n      if(!hasTriggerCommandRule(cmdFQCN, rules)) {\n        rules.push({\n          rule: \"always\",\n          then: {\n            trigger: {\n              command: fqcn(t),\n              mapping: \"event\"\n            }\n          }\n        })\n      }\n    }\n  })\n\n  return rules;\n}\n\nconst hasTriggerCommandRule = (command: string, rules: Rule[]): boolean => {\n  for (const rule of rules) {\n    if(isThenTriggerCommand(command, rule.then)) {\n      return true\n    }\n\n    if(isExecuteRules(rule.then) && hasTriggerCommandRule(command, rule.then.execute.rules)) {\n      return true;\n    }\n\n    if(isIfConditionRule(rule) || isIfNotConditionRule(rule)) {\n      if(rule.else && isThenTriggerCommand(command, rule.else)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nconst isThenTriggerCommand = (command: string, then: ThenType): boolean => {\n  if(isTriggerCommand(then) && then.trigger.command === command) {\n    return true\n  }\n\n  if(isForEach(then) && isThenTriggerCommand(command, then.forEach.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nconst updateTargetsOnGraph = (policy: Node, ctx: ImmutablePolicyContext, targets: List<Node>, graph: Graph): boolean => {\n  const existingTargets = ctx.policyTargets;\n  const existingTargetIds = existingTargets.map(dep => dep.getId());\n  const changedTargetIds = targets.map(dep => dep.getId());\n\n  const targetsToDelete = existingTargets.filter(dep => !changedTargetIds.contains(dep.getId()));\n  const targetsToAdd = targets.filter(dep => !existingTargetIds.contains(dep.getId()));\n\n  targetsToDelete.forEach(t => graph.deleteNode(t));\n\n  const lastExistingTarget = existingTargets.last(undefined);\n  let anchorNode = lastExistingTarget || null;\n  let position = NextToPosition.below;\n  let margin: number | {x: number, y: number} = DEFAULT_CONNECT_MARGIN;\n\n  if(graph.isEventModelingEnabled()) {\n    position = NextToPosition.right;\n\n    if(!anchorNode) {\n      anchorNode = policy;\n      position = NextToPosition.belowRight;\n      const uiToApiMarign = ctx.sliceApiLabel\n        ? ctx.sliceApiLabel.getGeometry().y - policy.getGeometry().y - DEFAULT_CARD_HEIGHT\n        : SLICE_LANE_MARGIN;\n      margin = {x: DEFAULT_CONNECT_MARGIN, y: uiToApiMarign};\n    }\n  } else {\n    if(!anchorNode) {\n      anchorNode = policy;\n      position = NextToPosition.right;\n    }\n  }\n\n\n  targetsToAdd.forEach(t => {\n    const newTarget = makeNodeFromJs({\n      id: graph.createCellId(),\n      type: t.getType(),\n      name: t.getTechnicalName(),\n      metadata: t.getMetadata(),\n    });\n\n    graph.addNodeNextToAnother(newTarget, anchorNode as Node, position, margin);\n    graph.connectNodes(policy, newTarget);\n    markAsConnected(newTarget, graph);\n    anchorNode = graph.getNode(newTarget.getId());\n    position = NextToPosition.below;\n  })\n\n  return targetsToAdd.count() > 0 || targetsToDelete.count() > 0;\n}\n","import {\n  getAllNodesFromCtx,\n  repositionFeature,\n  suggestNewFeatureName\n} from \"../../../../components/CodyEngineWizard/Step/Feature\";\nimport {suggestPolicyName} from \"../../../../components/CodyEngineWizard/Step/Policy\";\nimport {\n  API_TO_MODULE_MARGIN,\n  DEFAULT_CARD_HEIGHT,\n  DEFAULT_CONNECT_MARGIN,\n  SLICE_LANE_HEIGHT, SLICE_LANE_MARGIN\n} from \"../../../../components/CodyEngineWizard/WizardModal\";\nimport {createTreeFromGraph} from \"../../../../model/ElementsTree\";\nimport {Graph, makeNodeFromJs, NextToPosition, Node, NodeType} from \"../../../../model/Graph\";\nimport {getPolicyMetadata} from \"../../policy/get-policy-metadata\";\nimport {ImmutablePolicyContext, policyContextFromNode} from \"../policy-context\";\nimport {stringify} from \"../../../json/json-comment-wrapper\";\n\nexport const suggestFeature = (ctx: ImmutablePolicyContext, graph: Graph): void => {\n  const featureName = suggestNewFeatureName(ctx);\n\n  let newFeature = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.feature,\n    name: featureName,\n  });\n\n  let currentContainerParent: Node | null = null;\n  const allNodes = getAllNodesFromCtx(ctx);\n  allNodes.forEach(node => {\n    const parent = node.getParent();\n    if(parent && parent.getType() === NodeType.boundedContext) {\n      currentContainerParent = parent;\n    }\n  })\n\n  if(currentContainerParent) {\n    // Ensure all nodes have the same parent\n    allNodes.forEach(node => {\n      const parent = node.getParent();\n\n      if(parent && parent.getId() !== currentContainerParent!.getId()) {\n        graph.switchParent(node, parent);\n      }\n    })\n\n    newFeature = newFeature.changeParent(currentContainerParent);\n  }\n\n  newFeature = repositionFeature(newFeature, ctx, graph);\n\n  graph.addNode(newFeature);\n\n  getAllNodesFromCtx(ctx).forEach(child => graph.switchParent(child, newFeature));\n\n  graph.selectNode(newFeature);\n}\n\nexport const suggestPolicy = (ctx: ImmutablePolicyContext, graph: Graph): void => {\n  const policyName = suggestPolicyName(ctx);\n\n  const tree = createTreeFromGraph(graph);\n\n  const similarElements = tree.getSimilarElements(makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.policy,\n    name: policyName,\n  }));\n\n  const metadata = similarElements.count() > 0\n    ? getPolicyMetadata(similarElements.first())\n    : {\n    rules: []\n  }\n\n  const newPolicy = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.policy,\n    name: policyName,\n    metadata: stringify(metadata, null, 2),\n  });\n\n  if(!ctx.event) {\n    alert(\"[CodyWizard] Unable to create policy. An event card is missing to connect the policy card to.\");\n    return;\n  }\n\n  if(graph.isEventModelingEnabled()) {\n    const eventToUIMargin = ctx.sliceApiLabel\n      ? ctx.event.getGeometry().y - ctx.sliceApiLabel.getGeometry().y - DEFAULT_CARD_HEIGHT + SLICE_LANE_HEIGHT\n      : API_TO_MODULE_MARGIN;\n\n    graph.addNodeNextToAnother(newPolicy, ctx.event, NextToPosition.aboveRight, {x: DEFAULT_CONNECT_MARGIN, y: eventToUIMargin});\n  } else {\n    graph.addNodeNextToAnother(newPolicy, ctx.event, NextToPosition.right, DEFAULT_CONNECT_MARGIN);\n  }\n  graph.connectNodes(ctx.event, newPolicy, undefined, undefined, true);\n\n  repositionFeatureIfNeeded(newPolicy, ctx, graph);\n\n  window.setTimeout(() => {\n    graph.selectNode(newPolicy);\n  }, 200);\n}\n\nexport const suggestPolicyEvent = (ctx: ImmutablePolicyContext, graph: Graph): void => {\n  const eventName = '';\n\n  const newEvent = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.event,\n    name: eventName,\n  });\n\n  if(!ctx.policy) {\n    alert(\"[CodyWizard] Unable to create event. A policy card is missing to connect the event card to.\");\n    return;\n  }\n\n  if(graph.isEventModelingEnabled()) {\n    const uiToApiMarign = ctx.sliceApiLabel\n      ? ctx.sliceApiLabel.getGeometry().y - ctx.policy.getGeometry().y\n      : SLICE_LANE_MARGIN;\n\n    graph.addNodeNextToAnother(newEvent, ctx.policy, NextToPosition.belowLeft, {x: DEFAULT_CONNECT_MARGIN, y: uiToApiMarign + SLICE_LANE_MARGIN});\n  } else {\n    graph.addNodeNextToAnother(newEvent, ctx.policy, NextToPosition.left, DEFAULT_CONNECT_MARGIN);\n  }\n  graph.connectNodes(newEvent, ctx.policy, undefined, undefined, true);\n\n  repositionFeatureIfNeeded(newEvent, ctx, graph);\n\n  window.setTimeout(() => {\n    graph.selectNode(newEvent);\n  }, 200);\n}\n\nconst repositionFeatureIfNeeded = (newNode: Node, ctx: ImmutablePolicyContext, graph: Graph): void => {\n  if(ctx.feature) {\n    const repositionedFeature = repositionFeature(\n      ctx.feature,\n      policyContextFromNode(graph.getNode(newNode.getId())!, ctx.board),\n      graph\n    )\n\n    graph.resizeNode(repositionedFeature, repositionedFeature.getSize());\n  }\n}\n","import {List} from \"immutable\";\nimport {WizardStep} from \"../../../components/CodyEngineWizard/WizardModal\";\nimport {Board} from \"../../../model/Board\";\nimport {Graph, Node, NodeType} from \"../../../model/Graph\";\nimport {getPolicyMetadata} from \"../policy/get-policy-metadata\";\nimport {RulesDependencyMetadata} from \"../rule-engine/types\";\nimport {suggestFeature, suggestPolicy, suggestPolicyEvent} from \"./policy-context/cody-suggestions\";\nimport {WizardContext} from \"./wizard-context\";\n\nexport interface WithPolicyNode {\n  feature: Node | null;\n  eventModel: Node | null;\n  event: Node | null;\n  policy: Node | null;\n  sliceApiLabel: Node | null;\n  policyDependencies: Readonly<Record<string, Readonly<RulesDependencyMetadata>>>;\n  policyTargets: List<Node>;\n}\n\nexport type ImmutablePolicyContext = Readonly<PolicyContext>;\n\ninterface PolicyContext extends WizardContext<ImmutablePolicyContext>, WithPolicyNode {}\n\n\n\nexport const policyContextFromNode = (node: Node, board: Board): ImmutablePolicyContext => {\n  switch (node.getType()) {\n    case NodeType.event:\n      return fillFromSourceEvent(node, board);\n    case NodeType.policy:\n      return fillFromPolicy(node, board);\n    case NodeType.externalSystem:\n    case NodeType.command:\n      return fillFromTarget(node, board);\n    case NodeType.feature:\n      return fillFromFeature(node, board);\n    default:\n      throw new Error(`Policy context cannot be created from this node type: ${node.getType()}. This seems to be a developer bug. Please contact the prooph board team!`);\n  }\n}\n\nexport const isPolicyContext = (ctx: WizardContext): ctx is ImmutablePolicyContext => {\n  return ctx.type === 'policy';\n}\n\nexport const isPartOfPolicyContext = (node: Node): boolean => {\n  switch (node.getType()) {\n    case NodeType.policy:\n      return true;\n    case NodeType.event:\n      return node.getTargets().filter(t => t.getType() === NodeType.policy).count() > 0;\n    case NodeType.command:\n    case NodeType.externalSystem:\n      return node.getSources().filter(s => s.getType() === NodeType.policy).count() > 0;\n    case NodeType.feature:\n      return node.children().filter(c => c.getType() === NodeType.policy).count() > 0;\n    default:\n      return false;\n  }\n}\n\nconst fillFromPolicy = (policy: Node, board: Board): ImmutablePolicyContext => {\n  const event = policy.getSources().filter(s => s.getType() === NodeType.event).first(null);\n  const policyTargets = policy.getTargets().filter(t => t.getType() === NodeType.command || t.getType() === NodeType.externalSystem);\n\n  const policyMeta = getPolicyMetadata(policy);\n\n  const tmpCtx = {\n    board,\n    type: \"policy\",\n    policy,\n    event,\n    policyDependencies: {},\n    policyTargets,\n    nextStep: determineNextStep,\n    previousStep: determinePreviousStep,\n    installCodyGraphSuggestions: installSuggestions,\n  } as WizardContext<PolicyContext>;\n\n  const eventModel = getEventModelFromNode(policy);\n  let sliceApiLabel: Node | null = null;\n\n  if(eventModel && board.eventModelingEnabled) {\n    eventModel.children().forEach(child => {\n      if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n        sliceApiLabel = child;\n      }\n    })\n  }\n\n  return {\n    board,\n    type: \"policy\",\n    feature: getFeatureFromNode(policy),\n    eventModel,\n    policy,\n    event,\n    policyDependencies: policyMeta.dependencies || {},\n    policyTargets,\n    sliceApiLabel,\n    nextStep: determineNextStep,\n    previousStep: determinePreviousStep,\n    installCodyGraphSuggestions: installSuggestions,\n  }\n}\n\nconst installSuggestions = (currentStep: WizardStep, ctx: ImmutablePolicyContext, graph: Graph): void => {\n  const prevStep = determinePreviousStep(currentStep, ctx);\n  const nextStep = determineNextStep(currentStep, ctx);\n\n  if(prevStep) {\n    installLeftSuggestions(prevStep, ctx, graph);\n  }\n\n  if(nextStep) {\n    installRightSuggestions(nextStep, ctx, graph);\n  }\n}\n\nconst installLeftSuggestions = (prevStep: WizardStep, ctx: ImmutablePolicyContext, graph: Graph): void => {\n  switch (prevStep) {\n    case \"policy\":\n      if(ctx.policy) {\n        return;\n      }\n      graph.setCodyLeftCb(() => suggestPolicy(ctx, graph));\n      break;\n    case \"policyEvent\":\n      if(ctx.event) {\n        return;\n      }\n      graph.setCodyLeftCb(() => suggestPolicyEvent(ctx, graph));\n      break;\n    case \"feature\":\n      if(ctx.feature || graph.isEventModelingEnabled()) {\n        return;\n      }\n      graph.setCodyLeftCb(() => suggestFeature(ctx, graph));\n      break;\n  }\n}\n\nconst installRightSuggestions = (nextStep: WizardStep, ctx: ImmutablePolicyContext, graph: Graph): void => {\n  switch (nextStep) {\n    case \"policy\":\n      if(ctx.policy) {\n        return;\n      }\n      graph.setCodyRightCb(() => suggestPolicy(ctx, graph));\n      break;\n  }\n}\n\nconst determinePreviousStep = (currentStep: WizardStep, ctx: ImmutablePolicyContext): WizardStep | null => {\n  switch (currentStep) {\n    case \"command\":\n    case \"externalSystem\":\n      return 'policy';\n    case \"policy\":\n      return \"policyEvent\";\n    case \"policyEvent\":\n      return \"feature\";\n    default:\n      return null;\n  }\n}\n\nconst determineNextStep = (currentStep: WizardStep, ctx: ImmutablePolicyContext): WizardStep | null => {\n  switch (currentStep) {\n    case \"feature\":\n      return \"policyEvent\";\n    case \"policyEvent\":\n      return \"policy\";\n    default:\n      return null;\n  }\n}\n\nconst fillFromSourceEvent = (event: Node, board: Board): ImmutablePolicyContext => {\n  const policy = event.getTargets().filter(t => t.getType() === NodeType.policy).first(undefined);\n\n  if(policy) {\n    return fillFromPolicy(policy, board);\n  }\n\n  const feature = getFeatureFromNode(event);\n  const eventModel = getEventModelFromNode(event);\n  let sliceApiLabel: Node | null = null;\n\n  if(eventModel && board.eventModelingEnabled) {\n    eventModel.children().forEach(child => {\n      if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n        sliceApiLabel = child;\n      }\n    })\n  }\n\n  return {\n    board,\n    type: \"policy\",\n    policy: null,\n    feature,\n    eventModel,\n    event,\n    policyDependencies: {},\n    policyTargets: List([]),\n    sliceApiLabel,\n    nextStep: determineNextStep,\n    previousStep: determinePreviousStep,\n    installCodyGraphSuggestions: installSuggestions,\n  }\n}\n\nconst fillFromTarget = (node: Node, board: Board): ImmutablePolicyContext => {\n  const policy = node.getSources().filter(s => s.getType() === NodeType.policy).first(undefined);\n\n  if(policy) {\n    return fillFromPolicy(policy, board);\n  }\n\n  throw new Error(`Cannot find policy source of ${node.getType()}: ${node.getName()}. Please connect a plicy with the card`);\n}\n\nconst fillFromFeature = (feature: Node, board: Board): ImmutablePolicyContext => {\n  const matchingNode = feature.children().filter(c => c.getType() === NodeType.policy || c.getType() === NodeType.event).first(undefined);\n\n  if(matchingNode) {\n    return policyContextFromNode(matchingNode, board);\n  }\n\n  const eventModel = getEventModelFromNode(feature);\n\n  let sliceApiLabel: Node | null = null;\n\n  if(eventModel && board.eventModelingEnabled) {\n    eventModel.children().forEach(child => {\n      if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n        sliceApiLabel = child;\n      }\n    })\n  }\n\n  return {\n    board,\n    type: \"policy\",\n    policy: null,\n    feature,\n    eventModel,\n    event: null,\n    policyDependencies: {},\n    policyTargets: List([]),\n    sliceApiLabel,\n    nextStep: determineNextStep,\n    previousStep: determinePreviousStep,\n    installCodyGraphSuggestions: installSuggestions,\n  }\n}\n\nconst getFeatureFromNode = (node: Node): Node | null => {\n  const parent = node.getParent();\n\n  if(parent && parent.getType() === NodeType.feature) {\n    return parent;\n  }\n\n  return null;\n}\n\nconst getEventModelFromNode = (node: Node): Node | null => {\n  let parent = node.getParent();\n\n  if(parent && parent.getType() === NodeType.feature) {\n    parent = parent.getParent();\n  }\n\n  if(parent && parent.getType() === NodeType.boundedContext && parent.getTags().contains(ispConst.TAG_EVENT_MODEL)) {\n    return parent;\n  }\n\n  return null;\n}\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Dropdown, FormField} from \"semantic-ui-react\";\nimport {FeatureStatus, POSSIBLE_STATUS} from \"../Feature\";\n\ninterface OwnProps {\n  status: FeatureStatus | undefined;\n  disabled?: boolean;\n  onStatusChanged: (newStatus: FeatureStatus) => void;\n}\n\ntype StatusSelectProps = OwnProps & WithNamespaces;\n\nconst StatusSelect = (props: StatusSelectProps) => {\n  const options = POSSIBLE_STATUS.map(s => ({key: s, text: s, value: s}));\n\n  return <FormField>\n    <Dropdown inline={true}\n              placeholder={props.t('insp.cody_wizard.feature_status_select.placeholder') as string}\n              value={props.status}\n              options={options}\n              disabled={props.disabled}\n              onChange={(e, data) => props.onStatusChanged(data.value as FeatureStatus)}\n              className={'cody-wizard-inline-select'}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(StatusSelect);\n","import * as React from 'react';\nimport EditableTextline from \"../../../../../core/components/EditableTextline\";\n\ninterface OwnProps {\n  link: string | null;\n  onLinkChanged: (link: string | null) => void;\n  disabled?: boolean;\n}\n\ntype TaskLinkInputProps = OwnProps;\n\nconst validateUrl = (url: string): boolean => {\n  if(url === \"\") {\n    return true;\n  }\n  return url.match(/^https?:\\/\\/.+$/) !== null;\n};\n\nconst TaskLinkInput = (props: TaskLinkInputProps) => {\n\n  const handleTextChanged = (link: string) => {\n    if(link === '') {\n      props.onLinkChanged(null);\n    } else {\n      props.onLinkChanged(link);\n    }\n  }\n\n  return <EditableTextline text={props.link || ''}\n                           placeholder={'https://issue.tracker.com/tasks/1234'}\n                           charSize={1}\n                           fixedWidth={true}\n                           widthUnit={'%'}\n                           minWidth={100}\n                           onTextChanged={handleTextChanged}\n                           disabled={props.disabled}\n                           validate={validateUrl}\n                           textStyle={props.link === null ? {color: '#909090'} : undefined}\n  />\n};\n\nexport default TaskLinkInput;\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {FormEvent, useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {\n  Graph,\n  GraphPoint,\n  Node,\n  NodeSize,\n} from \"../../../model/Graph\";\nimport {ImmutableDDDWizardContext, isDDDAction} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {ImmutableFeatureContext} from \"../../../service/cody-wizard/context/feature-context\";\nimport {ImmutablePolicyContext, isPolicyContext} from \"../../../service/cody-wizard/context/policy-context\";\nimport {updateContext, WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport {WithWizardStepProps} from \"../WizardModal\";\nimport {suggestNewCommandName} from \"./DddCommand\";\nimport StatusSelect from \"./Feature/StatusSelect\";\nimport TaskLinkInput from \"./Feature/TaskLinkInput\";\n\ninterface OwnProps {\n\n}\n\nexport type FeatureStatus = 'important' | 'planned' | 'ready' | 'deployed';\nexport const POSSIBLE_STATUS = ['important', 'planned', 'ready', 'deployed'];\n\ntype FeatureProps = OwnProps & WithWizardStepProps<ImmutableDDDWizardContext | ImmutablePolicyContext | ImmutableFeatureContext> & WithNamespaces;\n\nconst Feature = (props: FeatureProps) => {\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedFeature, setSelectedFeature] = useState<Node|null>(null);\n  const [status, setStatus] = useState<FeatureStatus | undefined>(undefined);\n  const [taskLink, setTaskLink] = useState<string | null>(null);\n  const version = props.ctx.feature ? props.ctx.feature.getVersion() : 0;\n\n  useEffect(() => {\n    resetForm();\n\n    if(props.ctx.feature) {\n      setSelectedFeature(props.ctx.feature);\n      setStatus(getStatus(props.ctx.feature));\n      setTaskLink(graph.getFeatureTaskLink(props.ctx.feature));\n    } else {\n      setStatus(undefined);\n      setTaskLink(null);\n    }\n\n  }, [props.ctx.feature, version])\n\n  const resetForm = () => {\n    setSelectedFeature(null);\n    setStatus(undefined);\n    setTaskLink(null);\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleStatusChanged = (newStatus: FeatureStatus | undefined) => {\n    setStatus(newStatus);\n\n    if(props.mode === \"sidebar\" && selectedFeature && newStatus) {\n      graph.changeFeatureStatus(selectedFeature, newStatus);\n    }\n  }\n\n  const handleTaskLinkChanged = (newLink: string | null) => {\n    setTaskLink(newLink);\n\n    if(selectedFeature) {\n      graph.setFeatureTaskLink(selectedFeature, newLink);\n    }\n  }\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <EditorDivider label=\"Status\" content={<>\n      <StatusSelect status={status} disabled={!selectedFeature || !selectedFeature.isEnabled()} onStatusChanged={handleStatusChanged} />\n    </>} />\n\n    <EditorDivider label=\"Task\" content={<>\n      <TaskLinkInput link={taskLink} onLinkChanged={handleTaskLinkChanged} disabled={!selectedFeature || !selectedFeature.isEnabled()} />\n    </>} />\n    <div style={{marginTop: '100px'}} />\n  </form>\n};\n\nexport default withNamespaces()(Feature);\n\nexport const suggestNewFeatureName = (ctx: ImmutableDDDWizardContext | ImmutablePolicyContext | ImmutableFeatureContext): string | undefined => {\n  if(isDDDAction(ctx)) {\n    if(ctx.command) {\n      return ctx.command.getTechnicalName();\n    }\n\n    return suggestNewCommandName(ctx);\n  }\n\n  if(isPolicyContext(ctx)) {\n    if(ctx.event) {\n      return `On ${ctx.event.getTechnicalName()}`;\n    }\n\n    if(ctx.policy) {\n      return ctx.policy.getTechnicalName();\n    }\n  }\n}\n\nexport const repositionFeature = (feature: Node, ctx: WizardContext, graph: Graph): Node => {\n  if(graph.isEventModelingEnabled()) {\n    return feature;\n  }\n\n  const allNodes = getAllNodesFromCtx(ctx);\n\n  if(allNodes.count() === 0) {\n    return feature;\n  }\n\n  // tslint:disable-next-line:one-variable-per-declaration\n  let mostLeft: number, mostTop: number, mostRight: number, mostBottom: number;\n\n  allNodes.forEach(node => {\n    const graphNode = graph.getNode(node.getId());\n\n    if(graphNode) {\n      node = graphNode;\n    }\n\n    let geo = node.getGeometry();\n\n    if(node.getParent() && node.getParent()!.getGeometry()) {\n      geo = {x: geo.x + node.getParent()!.getGeometry().x, y: geo.y + node.getParent()!.getGeometry().y};\n    }\n\n    const size = node.getSize();\n\n    if(geo.x < mostLeft || typeof mostLeft === 'undefined') {\n      mostLeft = geo.x;\n    }\n\n    if(geo.y < mostTop || typeof mostTop === 'undefined') {\n      mostTop = geo.y;\n    }\n\n    if(geo.x + size.width > mostRight || typeof mostRight === 'undefined') {\n      mostRight = geo.x + size.width;\n    }\n\n    if(geo.y + size.height > mostBottom || typeof mostBottom === 'undefined') {\n      mostBottom = geo.y + size.height;\n    }\n  })\n\n  const padding = 160;\n\n  const featureGeo: GraphPoint = {x: mostLeft! - padding, y: mostTop! - padding};\n  const featureSize: NodeSize = {width: Math.abs((mostRight! + padding) - (mostLeft! - padding)), height: Math.abs((mostTop! - padding) - (mostBottom! + padding))};\n\n  return feature.changeGeometry(featureGeo).changeSize(featureSize);\n}\n\nexport const getAllNodesFromCtx = (ctx: WizardContext): List<Node> => {\n  switch (ctx.type) {\n    case \"dddAction\":\n      return getAllNodesFromDDDActionCtx(ctx as ImmutableDDDWizardContext);\n    case \"policy\":\n      return getAllNodesFromPolicyCtx(ctx as ImmutablePolicyContext);\n    case \"feature\":\n      return (ctx as ImmutableFeatureContext).feature.children();\n    default:\n      return List([]);\n  }\n}\n\nconst getAllNodesFromPolicyCtx = (ctx: ImmutablePolicyContext): List<Node> => {\n  const allNodes: Node[] = [];\n\n  if(ctx.event) {\n    allNodes.push(ctx.event);\n  }\n\n  if(ctx.policy) {\n    allNodes.push(ctx.policy);\n  }\n\n  allNodes.push(...ctx.policyTargets.toArray());\n\n  return List(allNodes);\n}\n\nconst getAllNodesFromDDDActionCtx = (ctx: ImmutableDDDWizardContext): List<Node> => {\n  const allNodes: Node[] = [];\n\n  if(ctx.uiViews) {\n    allNodes.push(...ctx.uiViews.toArray());\n  }\n\n  if(ctx.parentUi) {\n    allNodes.push(ctx.parentUi);\n  }\n\n  if(ctx.ui) {\n    allNodes.push(ctx.ui);\n  }\n\n  if(ctx.command) {\n    allNodes.push(ctx.command);\n  }\n\n  if(ctx.aggregate) {\n    allNodes.push(ctx.aggregate);\n  }\n\n  allNodes.push(...ctx.events.toArray());\n\n  if(ctx.state) {\n    allNodes.push(ctx.state);\n  }\n\n  if(ctx.stateList) {\n    allNodes.push(ctx.stateList)\n  }\n\n  return List(allNodes);\n}\n\nconst getStatus = (feature: Node): FeatureStatus | undefined => {\n  const tags = feature.getTags().toArray();\n\n  for (const tag of tags) {\n    if(POSSIBLE_STATUS.includes(tag)) {\n      return tag as FeatureStatus;\n    }\n  }\n}\n\n\n","import {Node} from \"../../../model/Graph\";\nimport {names} from \"../node/names\";\nimport {Schema} from \"../schema/schema\";\nimport {UiSchema} from \"../ui/ui-schema\";\nimport {TableColumnUiSchema, TableUiSchema, ValueObjectMetadata} from \"./get-vo-metadata\";\nimport {isStateVo} from \"./is-state-vo\";\n\nexport const getDefaultUiTableSchema = (vo: Node, meta: ValueObjectMetadata): UiSchema & TableUiSchema => {\n  const uiSchema: UiSchema & TableUiSchema = {};\n\n  if(!isStateVo(vo)) {\n    return uiSchema;\n  }\n\n  const columns: TableColumnUiSchema[] = [];\n\n  meta.schema!.getObjectProperties().forEach(prop => {\n    // we don't show the identifier in a table by default\n    if(prop === meta.identifier) {\n      return;\n    }\n\n    const propSchema = meta.schema!.getObjectPropertySchema(prop, new Schema({}));\n\n    if(propSchema && propSchema.isPrimitive()) {\n      columns.push({\n        field: prop,\n        headerName: names(prop).title,\n        flex: 1\n      })\n    }\n  })\n\n  uiSchema['ui:table'] = {columns};\n\n  return uiSchema;\n}\n","import * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button, ButtonGroup} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {\n  Graph,\n  makeNodeFromJs,\n  Node,\n  NodeType\n} from \"../../../model/Graph\";\nimport {getCommandMetadata} from \"../../../service/cody-wizard/command/get-command-metadata\";\nimport {ImmutableDDDWizardContext} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {getEventMetadata} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {names} from \"../../../service/cody-wizard/node/names\";\nimport {Rule} from \"../../../service/cody-wizard/rule-engine/configuration\";\nimport {getSchemaFromNodeDescription} from \"../../../service/cody-wizard/schema/get-schema-from-node-description\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {ensureSingularNoun, isAdjective, isNoun, tagSentence} from \"../../../service/cody-wizard/tagger\";\nimport {UiSchema} from \"../../../service/cody-wizard/ui/ui-schema\";\nimport {getConnectedEventIfPossible} from \"../../../service/cody-wizard/vo/get-connected-event-if-possible\";\nimport {getDefaultUiTableSchema} from \"../../../service/cody-wizard/vo/get-default-ui-table-schema\";\nimport {getSchemaRefName} from \"../../../service/cody-wizard/vo/get-schema-ref-name\";\nimport {getVoMetadata, ValueObjectMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {isStateVo} from \"../../../service/cody-wizard/vo/is-state-vo\";\nimport { isVoStoredInDb } from \"../../../service/cody-wizard/vo/is-vo-stored-in-db\";\nimport {cloneDeepJSON, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport SchemaEditorDivider from \"../Editor/Divider/SchemaEditorDivider\";\nimport UiSchemaEditorDivider from \"../Editor/Divider/UiSchemaEditorDivider\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport InitializeRulesEditor from \"../Editor/InitializeRulesEditor\";\nimport QuerySchemaEditor from \"../Editor/QuerySchemaEditor\";\nimport SchemaEditor from \"../Editor/SchemaEditor\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport UiSchemaEditor from \"../Editor/UiSchemaEditor\";\nimport {WithWizardStepProps} from \"../WizardModal\";\nimport AdvancedButton from \"./AdvancedButton\";\nimport {suggestCollection, suggestUiSchema} from \"./AnyVo\";\nimport CollectionInput from \"./AnyVO/CollectionInput\";\nimport EntityVoToggle from \"./AnyVO/EntityVoToggle\";\nimport StoredVoToggle from \"./AnyVO/StoredVoToggle\";\nimport IdentifierSelect, {getIdentifierCandidatesFromSchema} from \"./StateVO/IdentifierSelect\";\nimport NamespaceInput from \"./StateVO/NamespaceInput\";\n\ninterface OwnProps {}\n\ntype VOProps = OwnProps & WithWizardStepProps<ImmutableDDDWizardContext> & WithNamespaces;\n\nconst StateVO = (props: VOProps) => {\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedState, setSelectedState] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<ValueObjectMetadata>({});\n  const [autoFocusSchema, setAutoFocusSchema] = useState(false);\n  const [showAdvancedSettings, setShowAdvancedSettings] = useState(false);\n  const [dataSchema, setDataSchema] = useState(new Schema({}));\n  const version = props.ctx.state ? props.ctx.state.getVersion() : 0;\n\n  const updateMetadata = (meta: ValueObjectMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    if(meta.schema && stringify(meta.schema) !== stringify(dataSchema)) {\n      setDataSchema(meta.schema);\n    }\n\n    setMetadata(meta);\n  }\n\n  useEffect(() => {\n    resetForm();\n\n    if(props.ctx.state) {\n      setSelectedState(props.ctx.state);\n      const stateMeta = getVoMetadata(props.ctx.state);\n      let shouldUpdateMetadata = false;\n\n      if(!stateMeta.schema || stateMeta.schema.isEmpty()) {\n        stateMeta.schema = suggestStateSchema(props.ctx);\n        shouldUpdateMetadata = true;\n      }\n\n      if(!stateMeta.uiSchema) {\n        const suggestedUiSchema = suggestUiSchema(stateMeta.schema || new Schema({}), stateMeta.uiSchema, elementsTree, props.ctx);\n\n        if(suggestedUiSchema) {\n          shouldUpdateMetadata = true;\n          stateMeta.uiSchema = suggestedUiSchema;\n        }\n      }\n\n      if(typeof stateMeta.collection === \"undefined\" || stateMeta.collection === \"_collection\") {\n        stateMeta.collection = suggestCollection(props.ctx.state, stateMeta, elementsTree);\n        shouldUpdateMetadata = true;\n      }\n\n      if(shouldUpdateMetadata) {\n        updateMetadata(stateMeta);\n      }\n\n      setMetadata(stateMeta);\n      setDataSchema(stateMeta.schema);\n    }\n\n  }, [props.ctx.state, version])\n\n  const resetForm = () => {\n    setSelectedState(null);\n    setMetadata({});\n    setAutoFocusSchema(false);\n    setDataSchema(new Schema({}));\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleNsChanged = (newNs: string) => {\n    updateMetadata({...metadata, ns: newNs});\n  }\n\n  const handleIdentifierChanged = (newIdentifier: string) => {\n    const newMetadata = {...metadata};\n\n    if(newIdentifier === \"\") {\n      delete newMetadata.identifier;\n    } else {\n      newMetadata.identifier = newIdentifier;\n    }\n    updateMetadata(newMetadata);\n  }\n\n  const handleSchemaChanged = (newSchema: Schema | undefined) => {\n    if(!newSchema) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.schema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    const suggestedUiSchema = suggestUiSchema(newSchema, metadata.uiSchema, elementsTree, props.ctx);\n\n    updateMetadata({...metadata, schema: newSchema, uiSchema: suggestedUiSchema});\n  }\n\n  const handleQuerySchemaChanged = (newQuerySchema: Schema) => {\n    updateMetadata({...metadata, querySchema: newQuerySchema});\n  }\n\n  const handleUiSchemaChanged = (newUiSchema: UiSchema | undefined) => {\n    if(!newUiSchema) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.uiSchema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, uiSchema: newUiSchema});\n  }\n\n  const handleSuggestSchema = () => {\n    if(selectedState) {\n      const event = getConnectedEventIfPossible(selectedState);\n\n      if(event) {\n        const evtMeta = getEventMetadata(event);\n\n        if(evtMeta.schema) {\n          handleSchemaChanged(evtMeta.schema);\n          return;\n        }\n      }\n    }\n\n    if(props.ctx.command) {\n      const commandMeta = getCommandMetadata(props.ctx.command);\n\n      if(commandMeta.schema) {\n        handleSchemaChanged(commandMeta.schema);\n        return;\n      }\n    }\n\n    if(selectedState) {\n      const descSchema = getSchemaFromNodeDescription(selectedState);\n\n      if(descSchema) {\n        handleSchemaChanged(descSchema)\n      }\n    }\n  }\n\n  const handleSuggestUiSchema = () => {\n    const newUiSchema = suggestUiSchema(\n      metadata.schema || new Schema({}),\n      metadata.uiSchema,\n      elementsTree,\n      props.ctx,\n      false\n    )\n\n    if(newUiSchema) {\n      handleUiSchemaChanged(newUiSchema);\n    }\n  }\n\n  const handleStoredInDbChanged = (isStoredInDb: boolean) => {\n    if(isStoredInDb) {\n      const newMeta = {...metadata};\n      newMeta.collection = suggestCollection(selectedState!, metadata, elementsTree);\n      updateMetadata(newMeta);\n    } else {\n      updateMetadata({...metadata, collection: false});\n    }\n  }\n\n  const handleIsEntityChanged = (isEntity: boolean) => {\n    updateMetadata({...metadata, entity: isEntity});\n  }\n\n  const handleCollectionChanged = (newCollection: string) => {\n    updateMetadata({...metadata, collection: newCollection})\n  }\n\n  const handleInitializeRulesChanged = (rules: Rule[] | undefined) => {\n    if(!rules) {\n      rules = [];\n    }\n\n    updateMetadata({...metadata, initialize: rules});\n  }\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <EditorDivider label=\"Namespace\" content={<>\n      <NamespaceInput ns={metadata.ns || ''} onNsChanged={handleNsChanged} disabled={!!(selectedState && !selectedState.isEnabled())} />\n    </>} />\n    <EditorDivider label=\"Identifier\" content={<>\n      <IdentifierSelect\n        identifier={metadata.identifier || ''}\n        schema={dataSchema}\n        disabled={!!(selectedState && !selectedState.isEnabled())}\n        onIdentifierChanged={handleIdentifierChanged}\n        identifierCandidates={getIdentifierCandidatesFromSchema(dataSchema, elementsTree)}\n      />\n    </>} />\n\n    <SchemaEditorDivider content={<>\n      <SchemaEditor boardId={props.ctx.board.uid}\n                    sessionId={selectedState ? selectedState.getId() : undefined }\n                    schema={dataSchema}\n                    readonly={!!(selectedState && !selectedState.isEnabled())}\n                    onSchemaChanged={handleSchemaChanged}\n                    autofocus={autoFocusSchema}\n      />\n      <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestSchema} />\n    </>} />\n    <EditorDivider label=\"Query Schema\" content={<>\n      <QuerySchemaEditor boardId={props.ctx.board.uid}\n                         sessionId={selectedState? selectedState.getId() : undefined }\n                         schema={metadata.querySchema || Schema.fromString('{}')}\n                         readonly={!!(selectedState && !selectedState.isEnabled())}\n                         onSchemaChanged={handleQuerySchemaChanged}\n      />\n    </>} />\n\n    <UiSchemaEditorDivider type=\"state\" content={<>\n      <UiSchemaEditor boardId={props.ctx.board.uid}\n                      sessionId={selectedState? selectedState.getId() : undefined }\n                      nodeSchema={dataSchema}\n                      schema={metadata.uiSchema || {}}\n                      readonly={!!(selectedState && !selectedState.isEnabled())}\n                      onSchemaChanged={handleUiSchemaChanged}\n      />\n      <ButtonGroup>\n        <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestUiSchema} />\n        <Button basic={true} compact={true} icon=\"search\" className=\"noborder\" content={props.t('insp.cody_wizard.ui_schema_editor.choose_icon')} as=\"a\" href=\"https://pictogrammers.com/library/mdi/\" target=\"_blank\" />\n      </ButtonGroup>\n    </>} />\n\n    <AdvancedButton showAdvancedSettings={showAdvancedSettings} onShowChanged={show => setShowAdvancedSettings(show)}  disabled={!selectedState} />\n    <div className={(showAdvancedSettings? 'slidedown' : 'slideup') + ' smooth'}>\n      <EditorDivider label={'Classification'} content={<>\n        <EntityVoToggle isEntity={!!metadata.entity} vo={selectedState} onIsEntityChanged={handleIsEntityChanged} disabled={!!(selectedState && !selectedState.isEnabled())}/>\n        <StoredVoToggle isStored={isVoStoredInDb(metadata)} ctx={props.ctx} vo={selectedState} onStoredStateChanged={handleStoredInDbChanged} disabled={!!(selectedState && !selectedState.isEnabled())} />\n        {selectedState && isVoStoredInDb(metadata) && <EditorDivider label={'Collection'} content={<>\n          <CollectionInput collection={metadata.collection || '_collection'} onCollectionChanged={handleCollectionChanged} disabled={!selectedState.isEnabled()} />\n        </>} />}\n      </>} />\n      <EditorDivider label=\"Initialize Rules\" content={<>\n        <InitializeRulesEditor elementId={selectedState ? selectedState.getId() : ''}\n                               sessionId={selectedState ? selectedState.getId() : undefined }\n                               initializeRules={metadata.initialize || []}\n                               dataSchema={dataSchema}\n                               readonly={!!(selectedState && !selectedState.isEnabled())}\n                               ctx={props.ctx}\n                               onRulesChanged={handleInitializeRulesChanged}\n        />\n      </>} />\n\n    </div>\n    <div style={{marginTop: '100px'}} />\n  </form>\n};\n\nexport default withNamespaces()(StateVO);\n\nexport const createListFromState = (state: Node, meta: ValueObjectMetadata, graph: Graph, elementsTree: ElementsTree): Node | null => {\n  if(!isStateVo(state)) {\n    return null;\n  }\n\n  const ref = getSchemaRefName(state, meta);\n\n  const similarElements = elementsTree.getSimilarElements(makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.document,\n    name: state.getTechnicalName() + ' List',\n    metadata: stringify({ns: meta.ns || ispConst.DEFAULT_DOC_NS}, null, 2)\n  }));\n\n\n  const listMeta: ValueObjectMetadata = (similarElements.count() > 0)\n    ? getVoMetadata(similarElements.first())\n    : {\n    ns: meta.ns || ispConst.DEFAULT_DOC_NS,\n    schema: new Schema({\n      $items: ref\n    }),\n    querySchema: new Schema({}),\n    uiSchema: getDefaultUiTableSchema(state, meta)\n  }\n\n  return makeNodeFromJs({\n    id: graph.createCellId(),\n    name: state.getTechnicalName() + ' List',\n    type: NodeType.document,\n    metadata: stringify(listMeta, null, 2),\n  })\n}\n\nexport const suggestStateSchema = (ctx: ImmutableDDDWizardContext): Schema => {\n  const firstEvent = ctx.events.first(undefined);\n  const command = ctx.command;\n\n  if(command) {\n    const cmdMeta = getCommandMetadata(command);\n\n    if(cmdMeta.schema) {\n      return cmdMeta.schema;\n    }\n  }\n\n  if(firstEvent) {\n    const evtMeta = getEventMetadata(firstEvent);\n\n    if(evtMeta.schema) {\n      return evtMeta.schema;\n    }\n  }\n\n  return new Schema({});\n}\n\nexport const suggestNewEntityName = (ctx: ImmutableDDDWizardContext): string | undefined => {\n  let name = '';\n\n  if(ctx.aggregate) {\n    name = ctx.aggregate.getTechnicalName();\n  } else if(ctx.command) {\n    name = ctx.command.getTechnicalName();\n  } else if(ctx.events.count()) {\n    name = ctx.events.first(makeNodeFromJs({})).getTechnicalName();\n  }\n\n  if(name === '') {\n    return;\n  }\n\n  const nodeNames = names(name);\n\n  const words = tagSentence(nodeNames.title);\n\n  console.log(\"[CodyWizard] tagged words: \", words);\n\n  return words.filter(word => isNoun(word) || isAdjective(word)).map(word =>  isNoun(word) ? ensureSingularNoun(word) : word.token).join(\" \");\n}\n\n","import {List} from \"immutable\";\nimport {WizardStep} from \"../../../components/CodyEngineWizard/WizardModal\";\nimport {Board} from \"../../../model/Board\";\nimport {Graph, Node} from \"../../../model/Graph\";\n\nexport type WizardContextType = 'dddAction' | 'crudAction' | 'policy' | 'projection' | 'apiIntegrationTest' | 'uiIntegrationTest' | 'ui' | 'empty' | 'information' | 'feature';\n\nexport interface WizardContext<T = any> {\n  board: Board;\n  type: WizardContextType;\n  previousStep: (currentStep: WizardStep, ctx: T) => WizardStep | null;\n  nextStep: (currentStep: WizardStep, ctx: T) => WizardStep | null;\n  installCodyGraphSuggestions: (currentStep: WizardStep, ctx: T, graph: Graph) => void;\n}\n\nexport const updateContext = <T extends WizardContext>(ctx: T, ctxPropsToUpdate: Partial<T>): T => {\n  return {...ctx, ...ctxPropsToUpdate};\n}\n\nexport const makeCodySession = <T extends WizardContext>(ctx: T, includedNode?: Node): T => {\n  const session: any = {};\n\n  // tslint:disable-next-line:forin\n  for (const ctxKey in ctx) {\n    if(typeof ctx[ctxKey] === 'function' || typeof ctx[ctxKey] === 'string') {\n      session[ctxKey] = ctx[ctxKey];\n      continue;\n    }\n\n    if(ctx[ctxKey] instanceof List) {\n      if(includedNode && (ctx[ctxKey] as unknown as List<Node>).find(n => n.getId() === includedNode.getId())) {\n        session[ctxKey] = List.of(includedNode);\n      } else {\n        session[ctxKey] = List();\n      }\n      continue;\n    }\n\n    if(includedNode && ctx[ctxKey] && typeof ctx[ctxKey] === \"object\" && (ctx[ctxKey] as any).getId && (ctx[ctxKey] as any).getId() === includedNode.getId()) {\n      session[ctxKey] = includedNode;\n    } else {\n      session[ctxKey] = null;\n    }\n\n  }\n\n  return session as T;\n}\n\n\n\n\n\n","import {JSONSchema7} from \"json-schema\";\nimport * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {UiMetadata} from \"../../../service/cody-wizard/ui/get-ui-metadata\";\nimport {parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {JSONSchemaWithMarkdown, MarkdownDescription} from \"./Suggestion/markdown-description\";\nimport {\n  getPossibleCommands,\n  getPossibleForms,\n  getPossibleListVOs, getPossiblePages,\n  getPossibleViews\n} from \"./Typeahead/elements-tree-lookup\";\nimport {makeRuleThenPropMapping} from \"./Validation/rule-engine/prop-mapping\";\nimport {\n  makeActionsUiSchema,\n  makeCommandButtonUiSchema, makeCommandComponents,\n  makeCommandFormUiSchema,\n  makeTableUiSchema,\n  makeUiSchema\n} from \"./Validation/ui-schema\";\nimport {makeCssSchemaDefinitions} from \"./Validation/css-schema\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./Validation/rule-engine/jexl-expressions\";\n\ninterface OwnProps {\n  boardId: BoardId;\n  uiConfig: UiMetadata;\n  onUiConfigChanged: (config: UiMetadata) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n  ctx: WizardContext;\n}\n\ntype PageContentEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst PageContentEditor = (props: PageContentEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('page-content'));\n  const dispatch = useDispatch();\n\n  const {commands, views} = props.uiConfig;\n\n  let value = stringify({commands, views}, null, 2);\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-ui-page-content.json`,\n      language: \"json\",\n      value,\n      schema: makePageContentSchema(\n        getPossibleCommands(elementsTree),\n        getPossibleViews(elementsTree),\n        getPossibleListVOs(elementsTree),\n        getPossibleForms(elementsTree),\n        getPossiblePages(elementsTree)\n      ),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [props.sessionId, value]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    if(editorStr === '') {\n      props.onUiConfigChanged({...props.uiConfig, commands: [], views: []});\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedConfig = parse(editorStr);\n      props.onUiConfigChanged({...props.uiConfig, ...changedConfig});\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] UI Config Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('page-content', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-ui-page-content-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedUiConfigsStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedUiConfigsStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedUiConfigsStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(PageContentEditor);\n\n\nconst makePageContentSchema = (possibleCommands: string[], possibleViews: string[], possibleListVOs: string[], possibleForms: string[], possiblePages: string[]): string => {\n  const viewsSchema: JSONSchemaWithMarkdown = {\n    type: \"array\",\n    markdownDescription: \"List of View Components on the page.\\n\\nEach queryable Information becomes one component on the page. If you want to load the Information but not show it (e.g. to access it in a Jexl Expression), you can use:\\n\\n```{ \\\"view\\\": \\\"MyInformation\\\", \\\"hidden\\\": true }```\",\n    items: {\n      oneOf: [\n        {type: \"string\", enum: possibleViews, markdownDescription: \"Name of the view\"} as JSONSchema7,\n        {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"view\"],\n          markdownDescription: \"View configuration\",\n          properties: {\n            view: {type: \"string\", enum: possibleViews, markdownDescription: \"Name of the view\"},\n            hidden: {type: \"boolean\", default: true, markdownDescription: \"Is the information visible on the page?\"},\n            'hidden:expr': makeJexlExpression(`Is the information visible on the page?\\n\\nType: ${JEXL_WIKI_MARKDOWN}`),\n            type: {\n              type: \"string\",\n              enum: [\"auto\", \"form\", \"state\", \"table\"],\n              default: \"auto\",\n              markdownDescription: \"Type of the view. In most cases Cody will automatically detect the correct view type, but if you want to show information in an editable form, use the 'form' type.\"\n            },\n            'type:expr': makeJexlExpression(`Dynamically set the view type via ${JEXL_WIKI_MARKDOWN}`),\n            loadState: {\n              type: \"boolean\",\n              default: true,\n              markdownDescription: \"Cody will try to load the information when the user navigates to the page. You can disable the behavior e.g. when rendering a form to create new information.\"\n            },\n            props: {\n              type: \"object\",\n              additionalProperties: true,\n              properties: {\n                container: {$ref: \"#/definitions/mui-container\"}\n              }\n            },\n            'props:expr': {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            data: {$ref: \"#/definitions/rule_then_prop_mapping\"},\n            uiSchema: {\n              type: \"object\"\n            }\n          },\n          if: {\n            properties: {\n              type: {\"const\": \"form\"},\n            },\n            required: [\"type\"]\n          },\n          then: {\n            properties: {\n              uiSchema: {\n                ...makeUiSchema({...makeCommandFormUiSchema(possiblePages)}, possibleListVOs, possibleCommands, possiblePages, possibleListVOs, possibleForms, {container: {$ref: \"#/definitions/mui-container\"}, ...makeActionsUiSchema(possibleCommands, possiblePages, possibleListVOs, possibleForms)}),\n                markdownDescription: \"Override or add uiSchema properties of the view\"\n              }\n            }\n          },\n          else: {\n            properties: {\n              uiSchema: {\n                ...makeUiSchema({}, possibleListVOs, possibleCommands, possiblePages, possibleListVOs, possibleForms, {container: {$ref: \"#/definitions/mui-container\"}, ...makeActionsUiSchema(possibleCommands, possiblePages, possibleListVOs, possibleForms)}),\n                markdownDescription: \"Override or add uiSchema properties of the view\"\n              }\n            }\n          }\n        } as JSONSchema7\n      ]\n    }\n  };\n\n  const schema: JSONSchema7 = {\n    type: \"object\",\n    additionalProperties: false,\n    required: [\"commands\", \"views\"],\n    properties: {\n      commands: makeCommandComponents(possibleCommands, possiblePages, possibleListVOs, possibleForms),\n      views: viewsSchema\n    },\n    definitions: {\n      ...makeRuleThenPropMapping(),\n      ...makeCssSchemaDefinitions()\n    }\n  }\n\n  return stringify(schema);\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {makeCssSchemaDefinitions} from \"./css-schema\";\nimport {makeAssignVariable} from \"./rule-engine/assign-variable\";\nimport {JEXL_WIKI_MARKDOWN, makeJexlExpression} from \"./rule-engine/jexl-expressions\";\nimport {makeRuleThenPropMapping} from \"./rule-engine/prop-mapping\";\nimport {makeSidebarSchema, makeTabSchema} from \"./ui-schema\";\n\nexport const makeUiConfigSchema = (possibleStateRefs: string[], possibleQueryableRefs: string[], possiblePages: string[]): string => {\n  const routeSchema: JSONSchema7 = {type: \"string\", minLength: 1, pattern: \"^/[a-z]+\"};\n\n  const uiConfig: JSONSchema7 = {\n    type: \"object\",\n    additionalProperties: false,\n    required: [\"route\"],\n    properties: {\n      route: routeSchema,\n      routeParams: {type: \"array\", items: {type: \"string\"}},\n      type: {\n        type: \"string\",\n        enum: [\"standard\", \"dialog\", \"drawer\"],\n        default: \"standard\"\n      },\n      title: {type: \"string\"},\n      'title:expr': makeJexlExpression(`Define page title via ${JEXL_WIKI_MARKDOWN}`),\n      mainPage: {type: \"string\", enum: possiblePages},\n      sidebar: makeSidebarSchema(possibleQueryableRefs),\n      tab: makeTabSchema(),\n      props: {\n        type: \"object\",\n        additionalProperties: true,\n        properties: {\n          container: {$ref: \"#/definitions/mui-container\"}\n        }\n      },\n      'props:expr': {$ref: \"#/definitions/rule_then_prop_mapping\"},\n      breadcrumb: {\n        oneOf: [\n          {type: \"string\", minLength: 1},\n          {\n            type: \"object\",\n            additionalProperties: false,\n            required: [\"data\", \"label\"],\n            properties: {\n              data: {type: \"string\", enum: possibleStateRefs},\n              label: {\n                oneOf: [\n                  {type: \"string\", minLength: 1},\n                  {$ref: \"#/definitions/rule_then_assign_variable\"}\n                ]\n              }\n            }\n          }\n        ]\n      }\n    },\n    definitions: {\n      ...makeAssignVariable('value'),\n      ...makeRuleThenPropMapping(),\n      ...makeCssSchemaDefinitions()\n    }\n  }\n\n  return JSON.stringify(uiConfig);\n}\n","import * as React from 'react';\nimport {useEffect, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {FormField, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../../core/components/CodeEditor/CodeEditor\";\nimport {toggleSidebarEditor} from \"../../../../Layout/actions/commands\";\nimport {makeEditorStateByNameSelector} from \"../../../../Layout/selectors/sidebar-editor\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../model/Board\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {UiMetadata} from \"../../../service/cody-wizard/ui/get-ui-metadata\";\nimport {cloneDeepJSON, parse, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport ExpandButton from \"./ExpandButton\";\nimport {\n  getPossiblePages,\n  getPossibleQueryableItemRefs,\n  getPossibleQueryableVORefsWithoutQueryParams,\n} from \"./Typeahead/elements-tree-lookup\";\nimport {makeUiConfigSchema} from \"./Validation/ui-config\";\n\n\ninterface OwnProps {\n  boardId: BoardId;\n  uiConfig: UiMetadata;\n  onUiConfigChanged: (config: UiMetadata) => void;\n  autofocus?: boolean;\n  readonly?: boolean;\n  sessionId?: string;\n  ctx: WizardContext;\n}\n\ntype UiConfigEditorProps = OwnProps & WithNamespaces;\n\nconst unsavedSessions: Record<string, string> = {};\n\nconst UiConfigEditor = (props: UiConfigEditorProps) => {\n  const elementsTree = useElementsTree(props.boardId);\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const [editorHasFocus, setEditorHasFocus] = useState(false);\n  const [invalidJson, setInvalidJson] = useState(false);\n  const editorState = useSelector(makeEditorStateByNameSelector('ui-config'));\n  const dispatch = useDispatch();\n\n  const config = cloneDeepJSON(props.uiConfig);\n  delete config.commands;\n  delete config.views;\n  delete config.parent;\n  delete config.$nodeName;\n  delete config.$nodeType;\n  delete config.service;\n\n  let value = stringify(config, null, 2);\n\n  useEffect(() => {\n    if (!codeEditorRef.current) {\n      return;\n    }\n\n    let isInvalidJson = false;\n\n    if(props.sessionId && typeof unsavedSessions[props.sessionId] === \"string\") {\n      value = unsavedSessions[props.sessionId];\n      isInvalidJson = true;\n    }\n\n    codeEditorRef.current!.initializeModel({\n      fileId: `${props.sessionId}-ui-config.json`,\n      language: \"json\",\n      value,\n      schema: makeUiConfigSchema(getPossibleQueryableItemRefs(elementsTree), getPossibleQueryableVORefsWithoutQueryParams(elementsTree), getPossiblePages(elementsTree)),\n    });\n\n    setInvalidJson(isInvalidJson);\n  }, [value]);\n\n  useEffect(() => {\n    if(props.autofocus && codeEditorRef.current) {\n      codeEditorRef.current.focus();\n    }\n  }, [props.autofocus])\n\n  const propagateChanges = (editorStr: string, silentError?: boolean): boolean => {\n    const notHandledUiConfig = {\n      commands: props.uiConfig.commands,\n      views: props.uiConfig.views,\n      $nodeType: props.uiConfig.$nodeType,\n      $nodeName: props.uiConfig.$nodeName,\n      service: props.uiConfig.service,\n      parent: props.uiConfig.parent,\n    };\n\n    if(editorStr === '') {\n      props.onUiConfigChanged(notHandledUiConfig);\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n      return true;\n    }\n\n    try {\n      const changedConfig = parse(editorStr);\n      props.onUiConfigChanged({...notHandledUiConfig, ...changedConfig});\n\n      if(props.sessionId && unsavedSessions[props.sessionId]) {\n        delete unsavedSessions[props.sessionId];\n      }\n\n      return true;\n    } catch (e) {\n      console.error(\"[CodyWizard] UI Config Editor invalid JSON: \", e);\n      if(!silentError) {\n        setInvalidJson(true);\n      }\n      return false;\n    }\n  }\n\n  return <FormField>\n    {invalidJson && <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string} icon=\"warning\" style={{display: 'flex'}}/>}\n\n    <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor('ui-config', expand, !!double))}/>\n    <CodeEditor\n      containerId={`cody-ui-config-editor-${props.sessionId}`}\n      ref={codeEditorRef}\n      repairJson={true}\n      options={{\n        fontSize: 12,\n        folding: true,\n        glyphMargin: false,\n        lineNumbers: true,\n        lineDecorationsWidth: 3,\n        minimap: {\n          enabled: false\n        },\n        formatOnPaste: true,\n        scrollBeyondLastLine: false,\n        mouseWheelZoom: true,\n        automaticLayout: true,\n        scrollbar: {\n          alwaysConsumeMouseWheel: false\n        },\n        readOnly: props.readonly,\n        fixedOverflowWidgets: true,\n      }}\n      className={\"code editor\" + (editorHasFocus ? ' focus' : '') + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n      onBlur={() => {\n        if(codeEditorRef.current) {\n          const changedUiConfigsStr = codeEditorRef.current.retrievePayload();\n\n          const validJson = propagateChanges(changedUiConfigsStr);\n\n          setEditorHasFocus(false);\n\n          if(!validJson && props.sessionId) {\n            unsavedSessions[props.sessionId] = changedUiConfigsStr;\n          }\n        }\n      }}\n      onFocus={() => {\n        setEditorHasFocus(true);\n      }}\n    />\n  </FormField>\n};\n\nexport default withNamespaces()(UiConfigEditor);\n\n\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Dropdown, DropdownItemProps, FormField, Icon} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../../hooks/useElementsTree\";\nimport {BoardId} from \"../../../../model/Board\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph, Node, NodeType} from \"../../../../model/Graph\";\nimport {WizardContext} from \"../../../../service/cody-wizard/context/wizard-context\";\nimport CellIcon from \"../../../CellIcon\";\n\nexport type AccessibleFrom = Node | 'sidebar' | undefined;\n\ninterface OwnProps {\n  boardId: BoardId;\n  graph: Graph;\n  ui: Node | null;\n  accessibleFrom: AccessibleFrom;\n  ctx: WizardContext;\n  onAccessibleFromChanged: (accessibleFrom: AccessibleFrom) => void;\n  disabled?: boolean;\n}\n\ntype UiAccessibleFromSelectProps = OwnProps & WithNamespaces;\n\nconst UiAccessibleFromSelect = (props: UiAccessibleFromSelectProps) => {\n\n  const elementsTree = useElementsTree(props.boardId);\n\n  const handleAccessibleFromChanged = (accessibleFromOptionValue: string | undefined) => {\n    if(!accessibleFromOptionValue) {\n      props.onAccessibleFromChanged(undefined);\n      return;\n    }\n\n    if(accessibleFromOptionValue === '$sidebar') {\n      props.onAccessibleFromChanged('sidebar');\n      return;\n    }\n\n    const selectedUI = props.graph.getNode(accessibleFromOptionValue);\n\n    if(selectedUI) {\n      props.onAccessibleFromChanged(selectedUI);\n    }\n  }\n\n  return <FormField disabled={!props.ui || props.disabled} inline={true}>\n    <label>{props.t('insp.cody_wizard.step_ui.accessible_from_select_label') as string}</label>\n    <Dropdown inline={true}\n              disabled={!props.ui || props.disabled}\n              value={getOptionValue(props.accessibleFrom)}\n              onChange={(e, data) => handleAccessibleFromChanged(data.value as string | undefined)}\n              placeholder={props.t('insp.cody_wizard.step_command.new_aggregate_select_placeholder') as string}\n              options={prepareOptions(props.ui, props.accessibleFrom, elementsTree)} />\n  </FormField>\n};\n\nexport default withNamespaces()(UiAccessibleFromSelect);\n\nconst getOptionValue = (accessibleFrom: AccessibleFrom): string | undefined => {\n  if(!accessibleFrom) {\n    return undefined;\n  }\n\n  if(typeof accessibleFrom === \"string\") {\n    return '$sidebar';\n  }\n\n  return accessibleFrom.getId();\n}\n\nconst prepareOptions = (ui: Node | null, accessibleFrom: AccessibleFrom, elementsTree: ElementsTree): DropdownItemProps[] => {\n  const options: DropdownItemProps[] = [];\n\n  options.push({\n    key: '$sidebar',\n    text: 'App Sidebar',\n    value: '$sidebar',\n    icon: <Icon name=\"sidebar\" />\n  });\n\n  const isNode = accessibleFrom && typeof accessibleFrom !== \"string\";\n  const nodeName = accessibleFrom && typeof accessibleFrom !== \"string\" ? accessibleFrom.getName() : '';\n\n  elementsTree.getFilteredElementsByType(NodeType.ui, true).forEach(ele => {\n    if(isNode && nodeName === ele.getName()) {\n      return;\n    }\n\n    if(ui && ui.getName() === ele.getName()) {\n      return;\n    }\n\n    options.push({\n      key: ele.getId(),\n      text: ele.getName(),\n      value: ele.getId(),\n      icon: <CellIcon cellType={NodeType.ui} />\n    })\n  });\n\n  if(accessibleFrom && typeof accessibleFrom !== \"string\") {\n    options.push({\n      key: accessibleFrom.getId(),\n      text: accessibleFrom.getName(),\n      value: accessibleFrom.getId(),\n      icon: <CellIcon cellType={NodeType.ui} />\n    })\n  }\n\n  return options;\n}\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {FormEvent, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button, ButtonGroup} from \"semantic-ui-react\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {ElementsTree} from \"../../../model/ElementsTree\";\nimport {\n  Graph,\n  makeNodeFromJs,\n  NextToPosition,\n  Node,\n  NodeType\n} from \"../../../model/Graph\";\nimport {getCommandMetadata} from \"../../../service/cody-wizard/command/get-command-metadata\";\nimport {\n  ImmutableDDDWizardContext,\n  isDDDAction\n} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {ImmutableUiContext, uiContextFromNode} from \"../../../service/cody-wizard/context/ui\";\nimport {updateContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {fqcn} from \"../../../service/cody-wizard/node/fqcn\";\nimport {getSourcesOfType, getTargetsOfType} from \"../../../service/cody-wizard/node/get-single-node-of-type\";\nimport {markAsConnected} from \"../../../service/cody-wizard/node/mark-as-connected\";\nimport {names} from \"../../../service/cody-wizard/node/names\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {\n  ensurePluralNoun,\n  ensureSingularNoun,\n  isAdjective,\n  isNoun,\n  tagSentence\n} from \"../../../service/cody-wizard/tagger\";\nimport {getUiMetadata, UiMetadata} from \"../../../service/cody-wizard/ui/get-ui-metadata\";\nimport {getSchemaRefName} from \"../../../service/cody-wizard/vo/get-schema-ref-name\";\nimport {getVoMetadata, PageLinkTableColumn, ValueObjectMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {isListVo} from \"../../../service/cody-wizard/vo/is-list-vo\";\nimport {cloneDeepJSON, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport EditorDivider from \"../Editor/EditorDivider\";\nimport PageContentEditor from \"../Editor/PageContentEditor\";\nimport CodySuggestButton from \"../Editor/Suggestion/CodySuggestButton\";\nimport UiConfigEditor from \"../Editor/UiConfigEditor\";\nimport {DEFAULT_CARD_HEIGHT, DEFAULT_CONNECT_MARGIN, SLICE_LANE_MARGIN, WithWizardStepProps} from \"../WizardModal\";\nimport UiAccessibleFromSelect, {AccessibleFrom} from \"./Ui/UiAccessibleFromSelect\";\n\ninterface OwnProps {\n\n}\n\ntype UiProps = OwnProps & WithWizardStepProps<ImmutableDDDWizardContext | ImmutableUiContext> & WithNamespaces;\n\nconst EmptyUiContext = {ui: null, uiViews: List([]), parentUi: null};\n\nconst Ui = (props: UiProps) => {\n  const ui = props.ctx.ui;\n  const version = ui ? ui.getVersion() : 0;\n\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedUi, setSelectedUi] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<UiMetadata>({commands: [], views: []});\n  const [autoFocusUiConfig, setAutoFocusUiConfig] = useState(false);\n  const [topLevel, setTopLevel] = useState<boolean>(true);\n  const [parentUi, setParentUi] = useState<Node | null>(null);\n  const [viewModels, setViewModels] = useState<List<Node>>(List());\n\n  const updateMetadata = (meta: UiMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    setMetadata(meta);\n  }\n\n  const updateParentUi = (changedParentUi: Node | null, newMeta: UiMetadata ) => {\n    if(parentUi && !changedParentUi) {\n      const clonedMeta = {...newMeta};\n      delete clonedMeta.parent;\n      updateMetadata(clonedMeta);\n    } else if (changedParentUi) {\n      updateMetadata({...newMeta, parent: changedParentUi.getId()});\n\n      if(isDDDAction(props.ctx) && selectedUi && props.ctx.state) {\n        linkToPageFromParentUIIfPossible(selectedUi, changedParentUi, props.ctx.state, graph, elementsTree);\n      }\n    }\n\n    setParentUi(changedParentUi);\n    props.onCtxChanged(updateContext(props.ctx, {parentUi: changedParentUi}));\n  }\n\n  useEffect(() => {\n    resetForm();\n\n    setViewModels(props.ctx.uiViews);\n\n    if(ui) {\n      setSelectedUi(ui);\n      const meta = getUiMetadata(ui);\n\n      const initialParentUi = props.ctx.parentUi || (meta.parent && graph.getNode(meta.parent)) || null;\n\n      const isTopLevel = suggestTopLevel(initialParentUi, props.ctx);\n      setTopLevel(isTopLevel);\n\n      setMetadata(meta);\n\n      if(initialParentUi) {\n        setParentUi(initialParentUi);\n      }\n    }\n  }, [ui, version])\n\n  const resetForm = () => {\n    setSelectedUi(null);\n    setMetadata({commands: [], views: []});\n    setAutoFocusUiConfig(false);\n    setTopLevel(true);\n    setParentUi(null);\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleAccessibleFromChanged = (changedAccessibleFrom: AccessibleFrom) => {\n    if(!changedAccessibleFrom) {\n      setTopLevel(false);\n      updateParentUi(null, suggestPageConfig(metadata, selectedUi!, null, false, viewModels, props.ctx));\n      return;\n    }\n\n    if(typeof changedAccessibleFrom === \"string\") {\n      setTopLevel(true);\n      updateParentUi(null, suggestPageConfig(metadata, selectedUi!, null, true, viewModels, props.ctx));\n      return;\n    }\n\n    setTopLevel(false);\n    updateParentUi(changedAccessibleFrom, suggestPageConfig(metadata, selectedUi!, changedAccessibleFrom, false, viewModels, props.ctx));\n  }\n\n  const handlePageConfigChanged = (meta: UiMetadata) => {\n    updateMetadata(meta);\n  }\n\n  const handleSuggestConfig = () => {\n    if(!selectedUi) {\n      return;\n    }\n\n    const newPageConfig = suggestPageConfig(metadata, selectedUi, parentUi, topLevel, viewModels, props.ctx, false, true);\n\n    if(stringify(newPageConfig) !== stringify(metadata)) {\n      handlePageConfigChanged(newPageConfig);\n    }\n  }\n\n  const handleSuggestContent = () => {\n    if(!selectedUi) {\n      return;\n    }\n\n    const newPageConfig = suggestPageConfig(metadata, selectedUi, parentUi, topLevel, viewModels, props.ctx, true, false);\n\n    if(stringify(newPageConfig) !== stringify(metadata)) {\n      handlePageConfigChanged(newPageConfig);\n    }\n  }\n\n  const accessibleFrom = parentUi || (topLevel ? 'sidebar' : undefined);\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <UiAccessibleFromSelect graph={graph} boardId={props.ctx.board.uid}\n                            disabled={!!(selectedUi && !selectedUi.isEnabled())} ctx={props.ctx}\n                            accessibleFrom={accessibleFrom} ui={selectedUi}\n                            onAccessibleFromChanged={handleAccessibleFromChanged}/>\n    <EditorDivider label={props.t('insp.cody_wizard.step_ui.page_config_label') as string} content={<>\n      <UiConfigEditor boardId={props.ctx.board.uid}\n                      sessionId={selectedUi ? selectedUi.getId() : undefined}\n                      uiConfig={metadata}\n                      readonly={!!(selectedUi && !selectedUi.isEnabled())}\n                      onUiConfigChanged={handlePageConfigChanged}\n                      autofocus={autoFocusUiConfig}\n                      ctx={props.ctx}\n      />\n      <ButtonGroup>\n        <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestConfig}/>\n        <Button basic={true} compact={true} icon=\"search\" className=\"noborder\"\n                content={props.t('insp.cody_wizard.ui_schema_editor.choose_icon')} as=\"a\"\n                href=\"https://pictogrammers.com/library/mdi/\" target=\"_blank\"/>\n      </ButtonGroup>\n    </>} />\n\n    <EditorDivider label={props.t('insp.cody_wizard.step_ui.page_content_label') as string} content={<>\n      <PageContentEditor boardId={props.ctx.board.uid}\n                         sessionId={selectedUi ? selectedUi.getId() : undefined}\n                         uiConfig={metadata}\n                         readonly={!!(selectedUi && !selectedUi.isEnabled())}\n                         onUiConfigChanged={handlePageConfigChanged}\n                         autofocus={autoFocusUiConfig}\n                         ctx={props.ctx}\n      />\n      <CodySuggestButton hasSuggestions={true} onSuggest={handleSuggestContent}/>\n    </>} />\n    <div style={{marginTop: '100px'}}/>\n  </form>\n\n};\n\nexport default withNamespaces()(Ui);\n\nexport const updateViewModelsOnGraph = (ui: Node, parentUi: Node | null, ctx: ImmutableDDDWizardContext | ImmutableUiContext, viewModels: List<Node>, graph: Graph): boolean => {\n  const existingViewModelIds = ctx.uiViews.map(vm => vm.getId());\n  const changedViewModelIds = viewModels.map(vm => vm.getId());\n\n  const viewModelsToDelete = ctx.uiViews.filter(vm => !changedViewModelIds.contains(vm.getId()));\n  const viewModelsToAdd = viewModels.filter(vm => !existingViewModelIds.contains(vm.getId()));\n\n  viewModelsToDelete.forEach(vm => graph.deleteNode(vm));\n\n  const lastExistingViewModel = ctx.uiViews.last(undefined);\n\n  let anchorNode = lastExistingViewModel || parentUi;\n  let position = NextToPosition.above;\n  let margin: number | {x: number, y: number} = DEFAULT_CONNECT_MARGIN;\n\n  if(graph.isEventModelingEnabled()) {\n    anchorNode = lastExistingViewModel || null;\n    position = NextToPosition.left;\n\n    if(!anchorNode) {\n      anchorNode = ui;\n      position = NextToPosition.belowLeft;\n      const uiToApiMarign = ctx.sliceApiLabel\n        ? ctx.sliceApiLabel.getGeometry().y - ui.getGeometry().y - DEFAULT_CARD_HEIGHT\n        : SLICE_LANE_MARGIN;\n      margin = {x: DEFAULT_CONNECT_MARGIN, y: uiToApiMarign}\n    }\n  } else {\n    if(!anchorNode) {\n      anchorNode = ui;\n      position = NextToPosition.left;\n    }\n  }\n\n\n\n  viewModelsToAdd.forEach(vm => {\n    const newViewModel = makeNodeFromJs({\n      id: graph.createCellId(),\n      type: vm.getType(),\n      name: vm.getTechnicalName(),\n      metadata: vm.getMetadata(),\n    });\n\n    graph.addNodeNextToAnother(newViewModel, anchorNode as Node, position, margin);\n    graph.connectNodes(newViewModel, ui, undefined, undefined, true);\n    markAsConnected(newViewModel, graph);\n    anchorNode = graph.getNode(newViewModel.getId());\n    position = NextToPosition.above;\n  })\n\n  return viewModelsToAdd.count() > 0 || viewModelsToDelete.count() > 0;\n}\n\nexport const suggestPageConfig = (currentPageConfig: UiMetadata, ui: Node, parentUi: Node | null, topLevel: boolean, viewModels: List<Node>, ctx: ImmutableDDDWizardContext | ImmutableUiContext, onlyContent = false, onlyConfig = false): UiMetadata => {\n  const meta = cloneDeepJSON(currentPageConfig);\n  const suggestedRouteParams = suggestRouteParams(viewModels);\n\n  if(!onlyContent) {\n    meta.route = suggestRoute(ui, parentUi, topLevel, suggestedRouteParams, ctx);\n\n    if(topLevel && (!meta.sidebar || !meta.sidebar.label )) {\n      meta.sidebar = {\n        label: ui.getName(),\n        icon: 'square'\n      }\n    }\n\n    if(!topLevel && meta.sidebar) {\n      delete meta.sidebar;\n    }\n\n    if(!meta.breadcrumb) {\n      meta.breadcrumb = ui.getName()\n    }\n  }\n\n  if(!onlyConfig) {\n\n    const commands = getTargetsOfType(ui, NodeType.command, true);\n\n    commands.forEach(c => {\n      const cName = fqcn(c);\n\n      if(!meta.commands.includes(cName)) {\n        meta.commands.push(cName);\n      }\n    })\n\n    const views = getSourcesOfType(ui, NodeType.document, true);\n\n    views.forEach(v => {\n      const vName = fqcn(v, false, true);\n\n      if(!meta.views.map(vc => typeof vc === \"string\" ? vc : vc.view).includes(vName)) {\n        meta.views.push(vName);\n      }\n    })\n\n  }\n\n  return meta;\n}\n\nexport const suggestUiRoutePart = (ui: Node | null, topLevel: boolean, routeParams: string[], ctx: ImmutableDDDWizardContext | ImmutableUiContext): string => {\n  if(!ui) {\n    return  \"/\";\n  }\n\n  if(topLevel) {\n    return `/${names(ui.getTechnicalName()).fileName}`\n  }\n\n  if(routeParams.length) {\n    return \"/\" + routeParams.map(param => `:${param}`).join(\"/\");\n  }\n\n  return \"/\";\n}\n\nexport const suggestTopLevel = (parentUi: Node | null, ctx: ImmutableDDDWizardContext | ImmutableUiContext): boolean => {\n  if(parentUi) {\n    return false;\n  } else if(isDDDAction(ctx) && ctx.command) {\n    const cmdMeta = getCommandMetadata(ctx.command);\n\n    if(cmdMeta.aggregateCommand && typeof cmdMeta.newAggregate !== \"undefined\") {\n      return cmdMeta.newAggregate;\n    }\n  }\n\n  return true;\n}\n\nexport const suggestUiName = (ctx: ImmutableDDDWizardContext | ImmutableUiContext, graph: Graph, topLevel: boolean): string | undefined => {\n  let name = '';\n\n  const suffix = topLevel ? '' : ' Details';\n\n  if(isDDDAction(ctx)) {\n    if(ctx.state) {\n      name = ctx.state.getTechnicalName();\n    } else if(ctx.aggregate) {\n      name = ctx.aggregate.getTechnicalName();\n    } else if(ctx.command) {\n      name = ctx.command.getTechnicalName();\n    } else if(ctx.events.count()) {\n      name = ctx.events.first(makeNodeFromJs({})).getTechnicalName();\n    }\n\n    if(name === '') {\n      return suffix;\n    }\n\n    const nodeNames = names(name);\n\n    const words = tagSentence(nodeNames.title);\n\n    console.log(\"[CodyWizard] tagged words: \", words);\n\n    return words.filter(word => isNoun(word) || isAdjective(word))\n      .map(word =>  isNoun(word) ? topLevel ? ensurePluralNoun(word) : ensureSingularNoun(word) : word.token).join(\" \") + `${suffix}`;\n  } else {\n    const firstViewModel = ctx.uiViews.first(undefined);\n\n    if(firstViewModel) {\n      return firstViewModel.getTechnicalName() + `${suffix}`;\n    }\n\n    if(ctx.parentUi) {\n      const parentUiWords = tagSentence(ctx.parentUi.getTechnicalName());\n      return parentUiWords.map(word => isNoun(word)? ensureSingularNoun(word) : word.token).join(\" \") + `${suffix}`;\n    }\n  }\n}\n\nexport const suggestRouteParams = (viewModels: List<Node>): string[] => {\n  const routeParams: string[] = [];\n\n  viewModels.forEach(m => {\n    const voMeta = getVoMetadata(m);\n\n    if(voMeta.schema && voMeta.schema.isObject() && voMeta.identifier) {\n      routeParams.push(voMeta.identifier);\n    }\n  })\n\n  return routeParams;\n}\n\nexport const suggestRoute = (ui: Node | null, parentUI: Node | null, topLevel: boolean, suggestedRouteParams: string[], ctx: ImmutableDDDWizardContext | ImmutableUiContext): string => {\n  let route = '';\n\n  if(parentUI) {\n    const parentUIMeta = getUiMetadata(parentUI);\n\n    if(parentUIMeta.route) {\n      route +=  parentUIMeta.route;\n    } else {\n      route += '/' + names(parentUI.getTechnicalName()).fileName;\n    }\n  }\n  if(ui) {\n    route += suggestUiRoutePart(ui, topLevel, suggestedRouteParams, ctx);\n  }\n\n  if(route === \"\") {\n    route = suggestUiRoutePart(ui, topLevel, suggestedRouteParams, ctx);\n  }\n\n  return route;\n}\n\nexport const suggestViewModels = (topLevel: boolean, ctx: ImmutableDDDWizardContext | ImmutableUiContext): List<Node> => {\n  if(ctx.uiViews.count() > 0) {\n    return ctx.uiViews;\n  }\n\n  if(!topLevel && isDDDAction(ctx) && ctx.state) {\n    return List.of(ctx.state);\n  }\n\n  return List();\n}\n\nexport const linkToPageFromParentUIIfPossible = (page: Node, parentUi: Node, state: Node, graph: Graph, elementsTree: ElementsTree): Node | undefined => {\n  const stateMeta = getVoMetadata(state);\n  const stateRef = getSchemaRefName(state, stateMeta);\n  const pageName = names(page.getTechnicalName()).className;\n\n  const result = findStateListViewModel(stateRef, parentUi, elementsTree);\n\n  if(!result) {\n    return;\n  }\n\n  const [stateListVO, stateListVOMeta] = result;\n\n  const uiSchema = stateListVOMeta.uiSchema || {};\n\n  if(!uiSchema.table || !uiSchema.table.columns) {\n    return;\n  }\n\n  const columns = uiSchema.table.columns;\n  let hasPageLink = false;\n  let voMetaChanged = false;\n\n  columns.forEach(c => {\n    if(c.pageLink && getPageNameFromPageLink(c.pageLink) === pageName) {\n      hasPageLink = true;\n    }\n  })\n\n  const firstColumn = columns[0];\n\n  if(!hasPageLink && firstColumn && !firstColumn.pageLink) {\n    firstColumn.pageLink = pageName;\n    voMetaChanged = true;\n  }\n\n  if(voMetaChanged) {\n    uiSchema.table.columns = columns;\n\n    graph.changeNodeMetadata(stateListVO, stringify({...stateListVOMeta, uiSchema}, null, 2));\n\n    return stateListVO;\n  }\n}\n\nconst getPageNameFromPageLink = (pageLink: string | PageLinkTableColumn): string => {\n  if(typeof pageLink === \"string\") {\n    return pageLink;\n  }\n\n  return pageLink.page;\n}\n\nconst findStateListViewModel = (stateRef: string, parentUi: Node, elementsTree: ElementsTree): [Node, ValueObjectMetadata] | null => {\n  const allCopiesOfParentUi = elementsTree.getFilteredElementsByTypeAndLabel(NodeType.ui, parentUi.getName());\n\n  const viewModels: Node[] = [];\n\n  allCopiesOfParentUi.forEach(copy => {\n    viewModels.push(...getSourcesOfType(copy, NodeType.document))\n  });\n\n  let stateListViewModel: Node | null = null;\n  let stateListViewModelMeta: ValueObjectMetadata | null = null;\n\n  viewModels.forEach(vm => {\n    if(isListVo(vm)) {\n      const listVoMeta = getVoMetadata(vm);\n      const itemsSchema = listVoMeta.schema!.getListItemsSchema(new Schema({}));\n\n      if(itemsSchema.isRef() && itemsSchema.getRef() === stateRef) {\n        stateListViewModel = vm;\n        stateListViewModelMeta = listVoMeta;\n      }\n    }\n  })\n\n  if(stateListViewModel && stateListViewModelMeta) {\n    return [stateListViewModel, stateListViewModelMeta];\n  }\n\n  return null;\n}\n","import {Graph, Node} from \"../../../model/Graph\";\n\nexport const isDisconnected = (node: Node): boolean => {\n  return node.getTags().contains(ispConst.TAG_DISCONNECTED);\n}\n\nexport const markAsDisconnected = (node: Node, graph: Graph): Node => {\n  if(isDisconnected(node)) {\n    return node;\n  }\n\n  const changedTags = node.getTags().push(ispConst.TAG_DISCONNECTED);\n\n  graph.changeNodeTags(node, changedTags);\n\n  return graph.getNode(node.getId()) as Node;\n}\n\n","import {suggestAggregateName, suggestEventRecordingRules} from \"../../../../components/CodyEngineWizard/Step/Aggregate\";\nimport {\n  suggestAggregateCommandSchema,\n  suggestAggregateCommandUiSchema,\n  suggestCommandCreatesNewAggregate,\n  suggestNewCommandName\n} from \"../../../../components/CodyEngineWizard/Step/DddCommand\";\nimport {\n  defaultApplyRule,\n  suggestAggregateEventName,\n  suggestEventSchema\n} from \"../../../../components/CodyEngineWizard/Step/DddEvent\";\nimport {\n  getAllNodesFromCtx,\n  repositionFeature,\n  suggestNewFeatureName\n} from \"../../../../components/CodyEngineWizard/Step/Feature\";\nimport {\n  createListFromState,\n  suggestNewEntityName,\n  suggestStateSchema\n} from \"../../../../components/CodyEngineWizard/Step/StateVO\";\nimport {\n  suggestPageConfig,\n  suggestTopLevel,\n  suggestUiName,\n  suggestViewModels,\n  updateViewModelsOnGraph\n} from \"../../../../components/CodyEngineWizard/Step/Ui\";\nimport {\n  API_TO_MODULE_MARGIN,\n  DEFAULT_CARD_HEIGHT,\n  DEFAULT_CONNECT_MARGIN,\n  DOUBLE_CONNECT_MARGIN, SLICE_LANE_HEIGHT\n} from \"../../../../components/CodyEngineWizard/WizardModal\";\nimport {createTreeFromGraph} from \"../../../../model/ElementsTree\";\nimport {Graph, makeNodeFromJs, NextToPosition, Node, NodeType} from \"../../../../model/Graph\";\nimport {markAsConnected} from \"../../node/mark-as-connected\";\nimport {markAsDisconnected} from \"../../node/mark-as-disconnected\";\nimport {names} from \"../../node/names\";\nimport {convertDependenciesToMetadataConfig} from \"../../rule-engine/convert-dependencies-to-metadata-config\";\nimport {Schema} from \"../../schema/schema\";\nimport {ShorthandObject} from \"../../schema/shorthand\";\nimport {getUiMetadata} from \"../../ui/get-ui-metadata\";\nimport {UiSchema} from \"../../ui/ui-schema\";\nimport {getVoMetadata} from \"../../vo/get-vo-metadata\";\nimport {dddActionFromNode, ImmutableDDDWizardContext, isDDDAction} from \"../ddd-action\";\nimport {isEventModel} from \"../feature-context\";\nimport {parse, stringify} from \"../../../json/json-comment-wrapper\";\n\nexport const suggestFeature = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const featureName = suggestNewFeatureName(ctx);\n\n  let newFeature = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.feature,\n    name: featureName,\n  });\n\n  let currentContainerParent: Node | null = null;\n  const allNodes = getAllNodesFromCtx(ctx);\n  allNodes.forEach(node => {\n    const parent = node.getParent();\n    if(parent && parent.getType() === NodeType.boundedContext) {\n      currentContainerParent = parent;\n    }\n  })\n\n  if(currentContainerParent) {\n    // Ensure all nodes have the same parent\n    allNodes.forEach(node => {\n      const parent = node.getParent();\n\n      if(parent && parent.getId() !== currentContainerParent!.getId()) {\n        graph.switchParent(node, parent);\n      }\n    })\n\n    newFeature = newFeature.changeParent(currentContainerParent);\n  }\n\n  newFeature = repositionFeature(newFeature, ctx, graph);\n\n  graph.addNode(newFeature);\n\n  getAllNodesFromCtx(ctx).forEach(child => graph.switchParent(child, newFeature));\n\n  graph.selectNode(newFeature);\n}\n\nexport const suggestDDDActionUi = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const topLevel = suggestTopLevel(ctx.parentUi, ctx);\n  const uiName = suggestUiName(ctx, graph, topLevel);\n\n  const tempUi = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.ui,\n    name: uiName,\n    metadata: JSON.stringify({}, null, 2),\n  });\n\n  const tree = createTreeFromGraph(graph);\n\n  const similarElements = tree.getSimilarElements(tempUi);\n\n  const viewModels = suggestViewModels(topLevel, ctx);\n  const metadata = similarElements.count() > 0\n    ? getUiMetadata(similarElements.first())\n    : suggestPageConfig({commands: [], views: []}, tempUi, ctx.parentUi, topLevel, viewModels, ctx);\n\n  let newUi = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.ui,\n    name: uiName,\n    metadata: stringify(metadata, null, 2),\n  });\n\n  let isAdded = false;\n  if(isDDDAction(ctx) && ctx.command) {\n    graph.addNodeNextToAnother(newUi, ctx.command, NextToPosition.above, graph.isEventModelingEnabled() ? SLICE_LANE_HEIGHT - DEFAULT_CARD_HEIGHT : DEFAULT_CONNECT_MARGIN);\n    graph.connectNodes(newUi, ctx.command);\n    isAdded = true;\n  }\n\n  if(ctx.parentUi) {\n    if(!isAdded) {\n      graph.addNodeNextToAnother(newUi, ctx.parentUi, NextToPosition.right, DEFAULT_CONNECT_MARGIN);\n      isAdded = true;\n    }\n\n    graph.connectNodes(ctx.parentUi, newUi);\n  }\n\n  if(!isAdded) {\n    alert(\"[CodyWizard] Unable to create UI. A parent UI or command card is missing to connect the UI card to.\");\n    return;\n  }\n\n  newUi = markAsConnected(newUi, graph);\n\n  updateViewModelsOnGraph(newUi, ctx.parentUi, ctx, viewModels, graph);\n\n  repositionFeatureIfNeeded(newUi, ctx, graph);\n\n  window.setTimeout(() => {\n    graph.selectNode(newUi);\n  }, 200);\n}\n\nexport const suggestCommand = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const commandName = suggestNewCommandName(ctx);\n\n  const newAggregate = suggestCommandCreatesNewAggregate(ctx, createTreeFromGraph(graph));\n\n  const metadata = {\n    aggregateCommand: newAggregate,\n    newAggregate,\n    schema: suggestAggregateCommandSchema(ctx, newAggregate),\n    uiSchema: suggestAggregateCommandUiSchema(ctx),\n    dependencies: ctx.commandDependencies,\n  }\n\n  let newCommand = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.command,\n    name: commandName,\n    metadata: stringify(metadata, null, 2),\n  });\n\n  let isAdded = false;\n\n  if(ctx.aggregate) {\n    const aggregateToApiMargin = ctx.sliceApiLabel\n      ? ctx.aggregate.getGeometry().y - ctx.sliceApiLabel.getGeometry().y - DEFAULT_CARD_HEIGHT\n      : DEFAULT_CONNECT_MARGIN\n\n    graph.addNodeNextToAnother(newCommand, ctx.aggregate, NextToPosition.above, aggregateToApiMargin);\n    graph.connectNodes(newCommand, ctx.aggregate);\n    isAdded = true\n  }\n\n  if(!isAdded && ctx.events.count()) {\n    const firstEvent = ctx.events.first(undefined);\n\n    if(firstEvent) {\n      const eventToApiMargin = ctx.sliceApiLabel\n        ? firstEvent.getGeometry().y - ctx.sliceApiLabel.getGeometry().y - DEFAULT_CARD_HEIGHT\n        : API_TO_MODULE_MARGIN;\n\n      graph.addNodeNextToAnother(newCommand, firstEvent, NextToPosition.above, eventToApiMargin);\n      graph.connectNodes(newCommand, firstEvent);\n      isAdded = true;\n    }\n  }\n\n\n  if(!isAdded) {\n    alert(\"[CodyWizard] Unable to create Command. An aggregate or event is missing to connect the command card to.\");\n    return;\n  }\n\n  newCommand = markAsConnected(newCommand, graph);\n\n  repositionFeatureIfNeeded(newCommand, ctx, graph);\n\n  window.setTimeout(() => {\n    graph.selectNode(newCommand);\n  }, 200);\n}\n\nexport const suggestAggregate = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const aggregateName = suggestAggregateName(ctx, graph) || '';\n\n  const metadata = {\n    rules: suggestEventRecordingRules(ctx)\n  }\n\n  let newAggregate = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.aggregate,\n    name: aggregateName,\n    metadata: stringify(metadata, null, 2),\n  });\n\n  let isAdded = false;\n  if(ctx.events.first(undefined)) {\n    graph.addNodeNextToAnother(newAggregate, ctx.events.first(), NextToPosition.above, DEFAULT_CONNECT_MARGIN);\n    graph.connectNodes(newAggregate, ctx.events.first());\n    isAdded = true;\n  }\n\n  if(ctx.command) {\n    if(!isAdded) {\n      graph.addNodeNextToAnother(newAggregate, ctx.command, NextToPosition.below, graph.isEventModelingEnabled() ? API_TO_MODULE_MARGIN : DEFAULT_CONNECT_MARGIN);\n      isAdded = true;\n    }\n\n    graph.connectNodes(ctx.command, newAggregate);\n  }\n\n  if(!isAdded) {\n    alert(\"[CodyWizard] Unable to create Aggregate. A command or event card is missing to connect the aggregate card to.\");\n    return;\n  }\n\n  // Explicitly mark aggregate as disconnected, since each AR card defines its own business rules\n  newAggregate = markAsDisconnected(newAggregate, graph);\n\n  repositionFeatureIfNeeded(newAggregate, ctx, graph);\n\n  window.setTimeout(() => {\n    graph.selectNode(newAggregate);\n  }, 200);\n}\n\nexport const suggestEvent = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const eventName = suggestAggregateEventName(ctx, graph);\n  const metadata = {\n    schema: suggestEventSchema(ctx),\n    applyRules: [defaultApplyRule()]\n  };\n\n  let newEvent = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.event,\n    name: eventName,\n    metadata: stringify(metadata, null, 2),\n  });\n\n  let isAdded = false;\n  if(ctx.aggregate) {\n    graph.addNodeNextToAnother(newEvent, ctx.aggregate, NextToPosition.below, DEFAULT_CONNECT_MARGIN);\n    graph.connectNodes(ctx.aggregate, newEvent);\n    isAdded = true;\n  }\n\n  if(ctx.state) {\n    if(!isAdded) {\n      if(ctx.eventModel) {\n        graph.addNodeNextToAnother(newEvent, ctx.state, NextToPosition.belowLeft, {x: DEFAULT_CONNECT_MARGIN, y: API_TO_MODULE_MARGIN});\n      } else {\n        graph.addNodeNextToAnother(newEvent, ctx.state, NextToPosition.above, DEFAULT_CONNECT_MARGIN);\n      }\n\n      isAdded = true;\n    }\n\n    graph.connectNodes(newEvent, ctx.state);\n  }\n\n  if(ctx.eventModel && ctx.command) {\n    if(!isAdded) {\n      graph.addNodeNextToAnother(newEvent, ctx.command, NextToPosition.below, API_TO_MODULE_MARGIN);\n      graph.connectNodes(ctx.command, newEvent);\n      isAdded = true;\n    }\n  }\n\n  if(!isAdded) {\n    alert(\"[CodyWizard] Unable to create Event. An aggregate or state card is missing to connect the event card to.\");\n    return;\n  }\n\n  newEvent = markAsConnected(newEvent, graph);\n\n  repositionFeatureIfNeeded(newEvent, ctx, graph);\n\n  window.setTimeout(() => {\n    graph.selectNode(newEvent);\n  }, 200);\n}\n\nexport const suggestState = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const stateName = suggestNewEntityName(ctx) || 'Information';\n  const voNames = names(stateName);\n  const rawSchema: ShorthandObject = {};\n  const rawQuerySchema: ShorthandObject = {};\n  const uiSchema: UiSchema = {};\n  const identifier = voNames.propertyName + 'Id';\n  rawSchema[identifier] = 'string|format:uuid';\n  rawQuerySchema[identifier] = 'string|format:uuid';\n  uiSchema[identifier] = {\n    \"ui:widget\": \"hidden\"\n  };\n\n  const suggestedSchema = suggestStateSchema(ctx);\n\n  const tree = createTreeFromGraph(graph);\n\n  const similarStateElements = tree.getSimilarElements(makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.document,\n    name: stateName,\n    metadata: stringify({ns: '/' + voNames.className}, null, 2)\n  }));\n\n  const metadata = (similarStateElements.count() > 0)\n    ? getVoMetadata(similarStateElements.first())\n    : {\n    ns: ispConst.DEFAULT_DOC_NS,\n    schema: !suggestedSchema.isEmpty() ? suggestedSchema : new Schema(rawSchema),\n    querySchema: new Schema(rawQuerySchema),\n    uiSchema,\n    identifier,\n  };\n\n  let node = makeNodeFromJs({\n    id: graph.createCellId(),\n    type: NodeType.document,\n    name: stateName,\n    metadata: stringify(metadata, null, 2),\n  });\n\n  const firstEvent = ctx.events.first(undefined);\n\n  if(!firstEvent) {\n    alert(\"[CodyWizard] Unable to create Data Entity. An event is missing to connect the information card to.\");\n    return;\n  }\n\n  if(graph.isEventModelingEnabled()) {\n    if(ctx.command) {\n      graph.addNodeNextToAnother(node, ctx.command, NextToPosition.right, DEFAULT_CONNECT_MARGIN);\n    } else {\n\n      const eventToApiMargin = ctx.sliceApiLabel\n        ? firstEvent.getGeometry().y - ctx.sliceApiLabel.getGeometry().y - DEFAULT_CARD_HEIGHT\n        : API_TO_MODULE_MARGIN;\n      graph.addNodeNextToAnother(node, firstEvent, NextToPosition.aboveRight, {x: DEFAULT_CONNECT_MARGIN, y: eventToApiMargin});\n    }\n  } else {\n    graph.addNodeNextToAnother(node, firstEvent, NextToPosition.below, DEFAULT_CONNECT_MARGIN);\n  }\n\n  graph.connectNodes(firstEvent, node);\n  node = markAsConnected(node, graph);\n\n  if(ctx.feature) {\n    repositionFeatureIfNeeded(node, ctx, graph);\n  }\n\n  window.setTimeout(() => {\n    graph.selectNode(node);\n  }, 200);\n}\n\nexport const suggestStateList = (ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  if(!ctx.state) {\n    alert(`Cannot suggest state list, because state is missing in DDDAction context. This seems to be a bug. Please contact the prooph board team.`);\n    return;\n  }\n\n  const state = graph.getNode(ctx.state.getId());\n\n  if(!state) {\n    alert(`Cannot suggest state list, because state is missing in DDDAction context. This seems to be a bug. Please contact the prooph board team.`);\n    return;\n  }\n\n  const stateMeta = getVoMetadata(state);\n\n  const tree = createTreeFromGraph(graph);\n\n  const listVo = createListFromState(state, stateMeta, graph, tree);\n  if(listVo) {\n    graph.addNodeNextToAnother(listVo, state, NextToPosition.right, DEFAULT_CONNECT_MARGIN);\n    graph.connectNodes(state, listVo);\n    markAsConnected(listVo, graph);\n\n    if(ctx.feature) {\n      repositionFeatureIfNeeded(state, ctx, graph);\n    }\n\n    window.setTimeout(() => {\n      graph.selectNode(listVo);\n    }, 200);\n  }\n}\n\nconst repositionFeatureIfNeeded = (newNode: Node, ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  if(ctx.feature) {\n    const repositionedFeature = repositionFeature(\n      ctx.feature,\n      dddActionFromNode(graph.getNode(newNode.getId())!, ctx.board),\n      graph\n    )\n\n    graph.resizeNode(repositionedFeature, repositionedFeature.getSize());\n  }\n}\n","import {List} from \"immutable\";\nimport {WizardStep} from \"../../../components/CodyEngineWizard/WizardModal\";\nimport {Board} from \"../../../model/Board\";\nimport {Graph, Node, NodeType} from \"../../../model/Graph\";\nimport {getAggregateMetadata} from \"../aggregate/get-aggregate-metadata\";\nimport {getCommandMetadata} from \"../command/get-command-metadata\";\nimport {\n  getSingleSourceOfType,\n  getSingleTargetOfType,\n  getSourcesOfType,\n  getTargetsOfType\n} from \"../node/get-single-node-of-type\";\nimport {Rule} from \"../rule-engine/configuration\";\nimport {RulesDependencyMetadata} from \"../rule-engine/types\";\nimport {getVoMetadata} from \"../vo/get-vo-metadata\";\nimport {isStateVoCandidate} from \"../vo/is-state-vo-candidate\";\nimport {\n  suggestAggregate,\n  suggestCommand,\n  suggestDDDActionUi,\n  suggestEvent,\n  suggestFeature,\n  suggestState,\n  suggestStateList\n} from \"./ddd-action/cody-suggestions\";\nimport {isEventModel} from \"./feature-context\";\nimport {WithUiNode} from \"./ui\";\nimport {WizardContext} from \"./wizard-context\";\n\nexport const isDDDAction = (context: WizardContext): context is ImmutableDDDWizardContext => {\n  return context.type === 'dddAction';\n}\n\ninterface DDDWizardContext extends WizardContext<ImmutableDDDWizardContext>, WithUiNode {\n  command: Node | null;\n  commandDependencies: Readonly<Record<string, Readonly<RulesDependencyMetadata>>>;\n  commandHandler: Rule[];\n  aggregate: Node | null;\n  events: List<Node>;\n  state: Node | null;\n  stateList: Node | null;\n  feature: Node | null;\n  eventModel: Node | null;\n  sliceApiLabel: Node | null;\n  previousStep: (currentStep: WizardStep, ctx: ImmutableDDDWizardContext) => WizardStep | null;\n  nextStep: (currentStep: WizardStep, ctx: ImmutableDDDWizardContext) => WizardStep | null;\n  installCodyGraphSuggestions: (currentStep: WizardStep, ctx: ImmutableDDDWizardContext, graph: Graph) => void;\n}\n\nexport type ImmutableDDDWizardContext = Readonly<DDDWizardContext>;\n\nexport const dddActionFromNode = (node: Node, board: Board): ImmutableDDDWizardContext => {\n  const ctx: DDDWizardContext = {\n    board,\n    type: \"dddAction\",\n    ui: null,\n    parentUi: null,\n    uiViews: List<Node>([]),\n    command: null,\n    commandDependencies: {},\n    commandHandler: [],\n    aggregate: null,\n    events: List<Node>([]),\n    state: null,\n    stateList: null,\n    feature: null,\n    sliceApiLabel: null,\n    eventModel: null,\n    previousStep: determinePreviousStep,\n    nextStep: determineNextStep,\n    installCodyGraphSuggestions: installSuggestions,\n  }\n\n  switch (node.getType()) {\n    case NodeType.feature:\n      const validTypes = [NodeType.ui, NodeType.command, NodeType.aggregate, NodeType.event, NodeType.externalSystem, NodeType.document];\n\n      const children = node.children().filter(c => validTypes.includes(c.getType()));\n\n      if(children.count() > 0) {\n        return dddActionFromNode(children.toArray()[0], board);\n      }\n\n      ctx.feature = node;\n      break;\n    case NodeType.ui:\n      fillFromUI(node, ctx);\n      break;\n    case NodeType.command:\n      fillFromCommand(node, ctx);\n      break;\n    case NodeType.aggregate:\n      fillFromAggregate(node, ctx);\n      break;\n    case NodeType.event:\n      fillFromEvent(node, ctx);\n      break;\n    case NodeType.externalSystem:\n      const eSaR = getSingleTargetOfType(node, NodeType.aggregate);\n\n      if(eSaR) {\n        fillFromAggregate(eSaR, ctx);\n      }\n      break;\n    case NodeType.document:\n      if(isStateVoCandidate(node)) {\n        fillFromStateVoCandidate(node, ctx);\n\n        const event = getSingleSourceOfType(node, NodeType.event, true);\n        if(event) {\n          fillFromEvent(event, ctx);\n          break;\n        }\n      }\n      const aggregate = getSingleTargetOfType(node, NodeType.aggregate);\n\n      if(aggregate) {\n        fillFromAggregate(aggregate, ctx);\n        break;\n      }\n\n      const ui = getSingleTargetOfType(node, NodeType.ui);\n\n      if(ui) {\n        fillFromUI(ui, ctx);\n      }\n\n      break;\n  }\n\n  return ctx;\n}\n\nconst determinePreviousStep = (currentStep: WizardStep, ctx: ImmutableDDDWizardContext): WizardStep | null => {\n  switch (currentStep) {\n    case \"feature\":\n      return null;\n    case \"ui\":\n      return \"feature\";\n    case \"command\":\n      return 'ui';\n    case \"aggregate\":\n      return 'command';\n    case \"dddEvent\":\n      return (ctx.eventModel)? \"command\" : \"aggregate\";\n    case \"state\":\n      return \"dddEvent\";\n    default:\n      return null;\n  }\n}\n\nconst determineNextStep = (currentStep: WizardStep, ctx: ImmutableDDDWizardContext): WizardStep | null => {\n  switch (currentStep) {\n    case \"feature\":\n      return \"ui\";\n    case \"ui\":\n      return \"command\";\n    case \"command\":\n      return (ctx.eventModel)? 'dddEvent' : 'aggregate';\n    case \"aggregate\":\n      return 'dddEvent';\n    case \"dddEvent\":\n      return \"state\";\n    case \"state\":\n      return null;\n    default:\n      return null;\n  }\n}\n\nconst installSuggestions = (currentStep: WizardStep, ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  const prevStep = determinePreviousStep(currentStep, ctx);\n  const nextStep = determineNextStep(currentStep, ctx);\n\n  if(prevStep) {\n    installUpSuggestion(prevStep, ctx, graph);\n  }\n\n  if(nextStep) {\n    installDownSuggestion(nextStep, ctx, graph);\n  } else if (currentStep === 'state') {\n    installDownSuggestion('anyVO', ctx, graph);\n  }\n}\n\nconst installUpSuggestion = (prevStep: WizardStep, ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  switch (prevStep) {\n    case \"feature\":\n      if(ctx.feature) {\n        return;\n      }\n      graph.setCodyUpCb(() => suggestFeature(ctx, graph));\n      break;\n    case \"ui\":\n      if(ctx.ui) {\n        return;\n      }\n      graph.setCodyUpCb(() => suggestDDDActionUi(ctx, graph));\n      break;\n    case \"command\":\n      if(ctx.command) {\n        return;\n      }\n      graph.setCodyUpCb(() => suggestCommand(ctx, graph));\n      break;\n    case \"aggregate\":\n      if(ctx.aggregate) {\n        return;\n      }\n      graph.setCodyUpCb(() => suggestAggregate(ctx, graph));\n      break;\n    case \"dddEvent\":\n      if(ctx.events.count() > 0) {\n        return;\n      }\n      graph.setCodyUpCb(() => suggestEvent(ctx, graph));\n      break;\n  }\n}\n\nconst installDownSuggestion = (nextStep: WizardStep, ctx: ImmutableDDDWizardContext, graph: Graph): void => {\n  switch (nextStep) {\n    case \"command\":\n      if(ctx.command) {\n        return;\n      }\n      graph.setCodyDownCb(() => suggestCommand(ctx, graph));\n      break;\n    case \"aggregate\":\n      if(ctx.aggregate) {\n        return;\n      }\n      graph.setCodyDownCb(() => suggestAggregate(ctx, graph));\n      break;\n    case \"dddEvent\":\n      if(ctx.events.count() > 0) {\n        return;\n      }\n      graph.setCodyDownCb(() => suggestEvent(ctx, graph));\n      break;\n    case \"state\":\n      if(ctx.state) {\n        return;\n      }\n      if(graph.isEventModelingEnabled()) {\n        graph.setCodyRightCb(() => suggestState(ctx, graph));\n      } else {\n        graph.setCodyDownCb(() => suggestState(ctx, graph));\n      }\n\n      break;\n    case \"anyVO\":\n      if(ctx.stateList) {\n        return;\n      }\n\n      if(graph.isEventModelingEnabled()) {\n        graph.setCodyRightCb(() => suggestStateList(ctx, graph));\n      } else {\n        graph.setCodyDownCb(() => suggestStateList(ctx, graph));\n      }\n      break;\n  }\n}\n\nconst fillFromEvent = (node: Node, ctx: DDDWizardContext) => {\n  if(ctx.events.map(e => e.getId()).includes(node.getId())) {\n    return;\n  }\n\n  ctx.events = ctx.events.push(node);\n\n  fillFeatureFromNode(node, ctx);\n  fillEventModelFromNode(node, ctx);\n\n  const aggregate = getSingleSourceOfType(node, NodeType.aggregate);\n\n  if(aggregate && !ctx.aggregate) {\n    fillFromAggregate(aggregate, ctx);\n  }\n\n  const command = getSingleSourceOfType(node, NodeType.command);\n\n  if(command && !ctx.command) {\n    fillFromCommand(command, ctx);\n  }\n\n  if(!ctx.state) {\n    const vos = getTargetsOfType(node, NodeType.document);\n\n    for (const vo of vos) {\n      if(isStateVoCandidate(vo)) {\n        fillFromStateVoCandidate(vo, ctx);\n        return;\n      }\n    }\n  }\n}\n\nconst isParentUi = (node: Node, ctx: DDDWizardContext): boolean => {\n  if(node.getType() !== NodeType.ui) {\n    return false;\n  }\n\n  const children = getTargetsOfType(node, NodeType.ui);\n\n  return children.length > 0;\n}\n\nconst fillFromUI = (node: Node, ctx: DDDWizardContext) => {\n  if(isParentUi(node, ctx)) {\n    const childUi = getTargetsOfType(node, NodeType.ui)[0];\n    if(childUi) {\n      fillFromUI(childUi, ctx);\n      return;\n    }\n  }\n\n  if(ctx.ui) {\n    return;\n  }\n\n  ctx.ui = node;\n\n  ctx.uiViews = List(getSourcesOfType(node, NodeType.document, true));\n\n  if(!ctx.command) {\n    const command = getSingleTargetOfType(node, NodeType.command, false, true);\n\n    if(command) {\n      fillFromCommand(command, ctx);\n    }\n  }\n\n  if(!ctx.parentUi) {\n    const parent = getSingleSourceOfType(node, NodeType.ui, true);\n\n    if(parent) {\n      ctx.parentUi = parent;\n    }\n  }\n\n  fillFeatureFromNode(node, ctx);\n  fillEventModelFromNode(node, ctx);\n}\n\nconst fillFromCommand = (node: Node, ctx: DDDWizardContext) => {\n  if(ctx.command) {\n    return;\n  }\n\n  ctx.command = node;\n\n  const commandMetadata = getCommandMetadata(node);\n\n  ctx.commandDependencies = commandMetadata.dependencies || {};\n  ctx.commandHandler = commandMetadata.rules || [];\n\n  fillFeatureFromNode(node, ctx);\n  fillEventModelFromNode(node, ctx);\n\n  if(!ctx.ui) {\n    const ui = getSingleSourceOfType(node, NodeType.ui);\n\n    if(ui) {\n      fillFromUI(ui, ctx);\n    }\n  }\n\n  if(commandMetadata.aggregateCommand && !ctx.aggregate) {\n    const aggregate = getSingleTargetOfType(node, NodeType.aggregate);\n\n    if(aggregate) {\n      fillFromAggregate(aggregate, ctx);\n    }\n  }\n\n  getTargetsOfType(node, NodeType.event).forEach(evt => fillFromEvent(evt, ctx));\n}\n\nconst fillFromAggregate = (node: Node, ctx: DDDWizardContext) => {\n  if(ctx.aggregate) {\n    return;\n  }\n\n  ctx.aggregate = node;\n\n  fillFeatureFromNode(node, ctx);\n  fillEventModelFromNode(node, ctx);\n\n  if(!ctx.command) {\n    const command = getSingleSourceOfType(node, NodeType.command);\n\n    if(command) {\n      fillFromCommand(command, ctx);\n    }\n  }\n\n  getTargetsOfType(node, NodeType.event).forEach(evt => fillFromEvent(evt, ctx));\n\n  const commandMeta = (ctx.command)? getCommandMetadata(ctx.command) : {dependencies: {}, rules: []};\n  const aggregateMeta = getAggregateMetadata(node);\n  ctx.commandDependencies = commandMeta.dependencies || {};\n  ctx.commandHandler = aggregateMeta.rules || commandMeta.rules || [];\n}\n\nconst fillFromStateVoCandidate = (node: Node, ctx: DDDWizardContext) => {\n  if(ctx.state) {\n    return;\n  }\n\n  ctx.state = node;\n\n  fillFeatureFromNode(node, ctx);\n  fillEventModelFromNode(node, ctx);\n\n  node.getTargets().filter(t => t.getType() === NodeType.document).forEach(t => {\n    const tMeta = getVoMetadata(t);\n\n    if(tMeta.schema && tMeta.schema.isList()) {\n      ctx.stateList = t;\n    }\n  })\n\n  getSourcesOfType(node, NodeType.event).forEach(evt => fillFromEvent(evt, ctx));\n}\n\nconst fillFeatureFromNode = (node: Node, ctx: DDDWizardContext) => {\n  if(ctx.feature) {\n    return;\n  }\n\n  const parent = node.getParent();\n\n  if(parent && parent.getType() === NodeType.feature) {\n    ctx.feature = parent;\n\n    if(ctx.board.eventModelingEnabled) {\n      ctx.feature.children().forEach(child => {\n        if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n          ctx.sliceApiLabel = child;\n        }\n      })\n    }\n  }\n}\n\nconst fillEventModelFromNode = (node: Node, ctx: DDDWizardContext) => {\n  if(ctx.eventModel) {\n    return;\n  }\n\n  let parent = node.getParent();\n  let children = List<Node>();\n\n  if(parent) {\n    children = parent.children();\n  }\n\n  if(parent && parent.getType() === NodeType.feature) {\n    parent = parent.getParent();\n  }\n\n  if(parent && parent.getType() === NodeType.boundedContext && parent.getTags().contains(ispConst.TAG_EVENT_MODEL)) {\n    ctx.eventModel = parent;\n\n    if(ctx.board.eventModelingEnabled) {\n      children.forEach(child => {\n        if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n          ctx.sliceApiLabel = child;\n        }\n      })\n    }\n  }\n}\n","import {Board} from \"../../../model/Board\";\nimport {Node} from \"../../../model/Graph\";\nimport {WizardContext} from \"./wizard-context\";\n\nexport interface WithFeatureNode {\n  feature: Node;\n}\n\nexport type ImmutableFeatureContext = Readonly<FeatureContext>;\n\ninterface FeatureContext extends WizardContext<ImmutableFeatureContext>, WithFeatureNode {\n\n}\n\nexport const featureContextFromNode = (feature: Node, board: Board): ImmutableFeatureContext => {\n  const ctx: FeatureContext = {\n    board,\n    type: 'feature',\n    feature,\n    nextStep: currentStep => null,\n    previousStep: currentStep => null,\n    installCodyGraphSuggestions: () => { /* Do nothing */ },\n  }\n\n  return ctx;\n}\n\nexport const isFeatureContext = (ctx: WizardContext): ctx is ImmutableFeatureContext => {\n  return ctx.type === 'feature';\n}\n\nexport const isEventModel = (feature: Node): boolean => {\n  return feature.getTags().includes(ispConst.TAG_SLICE) || feature.getTags().includes(ispConst.TAG_EVENT_MODEL);\n}\n","import {Board} from \"../../../model/Board\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {RulesDependencyMetadata} from \"../rule-engine/types\";\nimport { getVoMetadata } from \"../vo/get-vo-metadata\";\nimport {WizardContext} from \"./wizard-context\";\n\nexport interface WithInformationNode {\n  vo: Node;\n  sliceApiLabel: Node | null;\n  queryDependencies: Readonly<Record<string, Readonly<RulesDependencyMetadata>>>;\n}\n\nexport type ImmutableInformationContext = Readonly<InformationContext>;\n\ninterface InformationContext extends WizardContext<ImmutableInformationContext>, WithInformationNode {\n\n}\n\nexport const informationContextFromNode = (vo: Node, board: Board): ImmutableInformationContext => {\n  const metadata = getVoMetadata(vo);\n\n  const feature = getFeatureFromNode(vo);\n  let sliceApiLabel: Node | null = null;\n\n  if(feature && board.eventModelingEnabled) {\n    feature.children().forEach(child => {\n      if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n        sliceApiLabel = child;\n      }\n    })\n  }\n\n  const ctx: InformationContext = {\n    board,\n    type: \"information\",\n    vo,\n    sliceApiLabel,\n    queryDependencies: metadata.queryDependencies || {},\n    nextStep: currentStep => null,\n    previousStep: currentStep => null,\n    installCodyGraphSuggestions: () => { /* Do nothing */ },\n  }\n\n  return ctx;\n}\n\nexport const isInformationContext = (ctx: WizardContext): ctx is ImmutableInformationContext => {\n  return ctx.type === 'information';\n}\n\n\nconst getFeatureFromNode = (node: Node): Node | null => {\n  const parent = node.getParent();\n\n  if(parent && parent.getType() === NodeType.feature) {\n    return parent;\n  }\n\n  return null;\n}\n","import {List} from \"immutable\";\nimport {Board} from \"../../../model/Board\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {getSingleSourceOfType, getSourcesOfType} from \"../node/get-single-node-of-type\";\nimport {WizardContext} from \"./wizard-context\";\n\nexport interface WithUiNode {\n  ui: Node | null;\n  parentUi: Node | null;\n  uiViews: List<Node>;\n  sliceApiLabel: Node | null;\n}\n\nexport type ImmutableUiContext = Readonly<UiContext>;\n\ninterface UiContext extends WizardContext<ImmutableUiContext>, WithUiNode {\n\n}\n\nexport const uiContextFromNode = (ui: Node, board: Board): ImmutableUiContext => {\n  const ctx: UiContext = {\n    board,\n    type: \"ui\",\n    ui,\n    parentUi: getParentUi(ui),\n    uiViews: List(getUiViews(ui)),\n    sliceApiLabel: getSliceApiLabelFromNode(ui),\n    nextStep: currentStep => null,\n    previousStep: currentStep => null,\n    installCodyGraphSuggestions: () => { /* Do nothing */ },\n  };\n\n  return ctx;\n}\n\nexport const isUiContext = (ctx: WizardContext): ctx is ImmutableUiContext => {\n  return ctx.type === 'ui';\n}\n\nconst getParentUi = (ui: Node): Node | null => {\n  return getSingleSourceOfType(ui, NodeType.ui, true);\n}\n\nconst getUiViews = (ui: Node): Node[] => {\n  return getSourcesOfType(ui, NodeType.document, true);\n}\n\nconst getSliceApiLabelFromNode = (node: Node): Node | null => {\n  const parent = node.getParent();\n\n  let sliceApiLabel: Node | null = null;\n\n  if(parent && (parent.getType() === NodeType.feature || parent.getType() === NodeType.boundedContext)) {\n    parent.children().forEach(child => {\n      if(child.getTags().contains(ispConst.TAG_SLICE_API_LABEL)) {\n        sliceApiLabel = child;\n      }\n    })\n  }\n\n  return sliceApiLabel;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {getSingleTargetOfType} from \"../node/get-single-node-of-type\";\n\nexport const isDddActionUi = (ui: Node): boolean => {\n  return !!getSingleTargetOfType(ui, NodeType.command);\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\nimport {isPartOfPolicyContext} from \"../context/policy-context\";\nimport {isDddActionUi} from \"../ui/is-ddd-action-ui\";\n\nexport const isDddActionOrPolicyFeature = (feature: Node): boolean => {\n  let atLeastOneChildIsPartOfDDDActionOrPolicy = false;\n\n  feature.children().forEach(child => {\n    if(isPartOfPolicyContext(child)) {\n      atLeastOneChildIsPartOfDDDActionOrPolicy = true;\n    }\n\n    switch (child.getType()) {\n      case NodeType.ui:\n        if(isDddActionUi(child)) {\n          atLeastOneChildIsPartOfDDDActionOrPolicy = true;\n        }\n        break;\n      case NodeType.command:\n      case NodeType.aggregate:\n      case NodeType.event:\n        atLeastOneChildIsPartOfDDDActionOrPolicy = true;\n        break;\n    }\n  })\n\n  return atLeastOneChildIsPartOfDDDActionOrPolicy;\n}\n","import {Node, NodeType} from \"../../../model/Graph\";\n\nexport const isValid = (node: Node): boolean => {\n  switch (node.getType()) {\n    case NodeType.event:\n      return isValidEvent(node);\n    default:\n      return true;\n  }\n}\n\nconst isValidEvent = (node: Node): boolean => {\n  const sources = node.getSources();\n\n  if(sources.count() === 0) {\n    return true;\n  }\n\n  if(sources.count() !== 1) {\n    return false;\n  }\n\n  const source = sources.toArray()[0];\n\n  return source.getType() === NodeType.aggregate || source.getType() === NodeType.command;\n}\n","import {isSelectContextStep, WizardStep} from \"../../../components/CodyEngineWizard/WizardModal\";\nimport {names} from \"../node/names\";\n\nexport const stepHeader = (step: WizardStep, t: (k: string) => string): string => {\n  switch (step) {\n    case \"state\":\n      return 'Information';\n    case \"dddEvent\":\n      return 'Domain Event';\n    case \"publicEvent\":\n      return 'Public Domain Event';\n    case \"policyEvent\":\n      return 'Domain Event';\n    case \"anyVO\":\n      return 'Information';\n    case \"runCody\":\n      return 'Run Cody';\n    default:\n      if(isSelectContextStep(step)) {\n        return t('insp.cody_wizard.step_header');\n      }\n\n      return names(step).className;\n  }\n}\n","import {Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {RunCodyOption} from \"../reducers/RunCodyOn\";\n\nexport const makeRunCodyOnSelector = (): (state: Record<ApplicationState>) => RunCodyOption => (state) => state.getIn([MODULE, 'runCodyOn']);\n","import * as React from 'react';\nimport {CSSProperties} from \"react\";\n// tslint:disable-next-line:no-var-requires\nconst codyEmoji = require('../../../theme/img/cody.svg');\n\ninterface OwnProps {\n    width?: number;\n    style?: CSSProperties;\n}\n\ntype CodyEmojiProps = OwnProps;\n\nconst CodyEmoji = (props: CodyEmojiProps) => {\n    const width = props.width || 30;\n\n    return <object className=\"console-avatar\" data={codyEmoji} type=\"image/svg+xml\" style={{width: width+'px', ...props.style}}/>;\n};\n\nexport default CodyEmoji;\n","import * as React from 'react';\nimport {CSSProperties, ReactElement, useState} from 'react';\nimport {Icon} from \"semantic-ui-react\";\nimport {camelize} from \"tslint/lib/utils\";\nimport {CodyResponse, CodyResponseType} from \"../../service/Cody\";\nimport CodyEmoji from \"./CodyEmoji\";\nimport {DEFAULT_COLOR, ERROR_COLOR, INFO_COLOR} from \"./definitions\";\n\ninterface OwnProps {\n    codyResponse: CodyResponse,\n    codyName: string,\n}\n\ntype CodyMessageProps = OwnProps;\n\nconst CodyMessage = (props: CodyMessageProps) => {\n\n    const [showDetails, setShowDetails] = useState(false);\n\n    let msgColor = DEFAULT_COLOR;\n    let detailsColor = DEFAULT_COLOR;\n    let fontWeight: 'normal' | 'bold' = 'normal';\n    let detailsFontWeight: 'normal' | 'bold' = 'normal';\n    let backgroundColor = 'white';\n\n    if(props.codyResponse.type === CodyResponseType.Error) {\n        msgColor = ERROR_COLOR;\n        detailsColor = ERROR_COLOR;\n        fontWeight = 'bold';\n        detailsFontWeight = 'bold';\n        backgroundColor = '#f1bec5';\n    }\n\n    if(props.codyResponse.type === CodyResponseType.Warning\n        || props.codyResponse.type === CodyResponseType.Question\n        || props.codyResponse.type === CodyResponseType.SyncRequired)\n    {\n        msgColor = '#653a12';\n        detailsColor = '#653a12';\n        fontWeight = 'bold';\n        backgroundColor = '#fdd299';\n    }\n\n    if(!props.codyResponse.type || props.codyResponse.type === CodyResponseType.Info) {\n        msgColor = INFO_COLOR;\n        fontWeight = 'bold';\n    }\n\n    const msg = (!Array.isArray(props.codyResponse.cody))? [props.codyResponse.cody] : props.codyResponse.cody;\n    let details;\n\n    if(props.codyResponse.details) {\n        details = props.codyResponse.details;\n\n        if(!Array.isArray(details)) {\n            details = [details];\n        }\n    }\n\n    const toggleShowDetails = (e: React.MouseEvent) => {\n        e.preventDefault();\n\n        setShowDetails(!showDetails);\n    }\n\n    const defaultStyle = {color: msgColor, fontWeight};\n    const detailsStyle = {color: detailsColor, fontWeight: detailsFontWeight};\n    const showDetailsIcon = showDetails? <Icon name=\"caret down\" size=\"large\" /> : <Icon name=\"caret right\" size=\"large\" />;\n\n    return <>\n        <div className=\"console-message\" style={{backgroundColor}}>\n            <CodyEmoji />\n            <div className=\"console-text\">\n                {applyMessageStyle(msg, defaultStyle, props.codyName)}\n                {details && <a href=\"#\" onClick={toggleShowDetails}>{showDetailsIcon}</a>}\n            </div>\n        </div>\n        {details && showDetails && <div className=\"console-message\" style={{backgroundColor}}>\n            <CodyEmoji />\n            <div className=\"console-text\">\n                {applyMessageStyle(details, detailsStyle)}\n            </div>\n        </div>}\n    </>\n};\n\nexport default CodyMessage;\n\nconst applyMessageStyle = (msgAndStyles: string[], defaultStyle: CSSProperties, codyName?: string): ReactElement[] => {\n    let msg = msgAndStyles[0] || '';\n\n    if(typeof msg !== 'string') {\n        msg = msg as any;\n        if(typeof msg.toString === 'function') {\n            msg = msg.toString();\n        } else {\n            return [];\n        }\n    }\n\n    const msgParts = msg.split('%c');\n\n    const styles = msgAndStyles.slice(1);\n\n    const spans: ReactElement[] = [];\n\n    let nextStyle: CSSProperties = defaultStyle;\n\n    let firstPart = true;\n\n    for(const partI in msgParts) {\n        if(typeof msgParts[partI] !== 'undefined') {\n            let part = msgParts[partI];\n            let firstCharIsWhitespace = false;\n            let lastCharIsWhitespace = false;\n            const length = part.length;\n\n            if(length > 0) {\n                if(part.charAt(length - 1) === ' ') {\n                    lastCharIsWhitespace = true;\n                    part = part.slice(0, length - 1)\n                }\n\n                if(part.charAt(0) === ' ') {\n                    firstCharIsWhitespace = true;\n                    part = part.slice(1);\n                }\n            }\n\n            if(length > 0) {\n                if(firstPart && codyName) {\n                    part = `[${codyName}]: ` + part;\n                    firstPart = false;\n                }\n                spans.push(<span key={spans.length + 1} style={nextStyle}>\n                    {firstCharIsWhitespace && <>&nbsp;</>}{<>{part}</>}{lastCharIsWhitespace && <>&nbsp;</>}\n                </span>);\n            }\n\n            if(styles[partI]) {\n                nextStyle = parseStyleString(styles[partI]);\n            } else {\n                nextStyle = defaultStyle;\n            }\n        }\n    }\n\n    return spans;\n}\n\nconst parseStyleString = (style: string): CSSProperties => {\n    const cssProps: {[cssProp: string]: string} = {};\n\n    const propStrs = style.split(';');\n\n    for(const propStr of propStrs) {\n        const [prop, val] = propStr.split(':');\n\n        if(typeof prop !== 'string' || typeof val !== 'string') {\n            continue;\n        }\n\n        cssProps[camelize(prop.trim())] = val;\n    }\n\n    return cssProps as CSSProperties;\n}\n","export const ERROR_COLOR = '#f31c30';\nexport const WARNING_COLOR = '#f99f4b';\nexport const SUCCESS_COLOR = '#73dd8e';\nexport const INFO_COLOR = '#32c0e7';\nexport const DEFAULT_COLOR = '#414141';\n","import * as React from 'react';\nimport {Icon} from \"semantic-ui-react\";\nimport {NodeType} from \"../../../model/Graph\";\nimport CellIcon from \"../../CellIcon\";\nimport {isSelectContextStep, WizardStep} from \"../WizardModal\";\nimport CodyEmoji from \"../../CodyConsole/CodyEmoji\";\n\ninterface OwnProps {\n  activeStep: WizardStep | null;\n}\n\ntype ActiveStepIconProps = OwnProps;\n\nconst nodeTypeFromStep = (step: WizardStep): NodeType => {\n  switch (step) {\n    case \"aggregate\":\n      return NodeType.aggregate;\n    case \"dddEvent\":\n    case \"publicEvent\":\n    case \"policyEvent\":\n      return NodeType.event;\n    case \"feature\":\n      return NodeType.feature;\n    case \"command\":\n      return NodeType.command;\n    case \"state\":\n      return NodeType.document;\n    case \"ui\":\n      return NodeType.ui;\n    case \"anyVO\":\n      return NodeType.document;\n    case \"policy\":\n      return NodeType.policy;\n    default:\n      return NodeType.freeText;\n  }\n}\n\nconst ActiveStepIcon = (props: ActiveStepIconProps) => {\n\n\n  return <>\n    {!props.activeStep && <Icon name=\"question circle outline\" />}\n    {props.activeStep && props.activeStep !== 'runCody' && !isSelectContextStep(props.activeStep) && <CellIcon cellType={nodeTypeFromStep(props.activeStep)} size=\"normal\" />}\n    {props.activeStep && isSelectContextStep(props.activeStep) && <Icon name=\"code branch\" />}\n    {props.activeStep && props.activeStep === 'runCody' && <CodyEmoji width={40} style={{top: '7px', position: 'relative', marginLeft: '5px'}} />}\n  </>\n};\n\nexport default ActiveStepIcon;\n","import * as React from 'react';\nimport {Icon, Step} from \"semantic-ui-react\";\nimport {CodyStep} from \"./RunCody\";\n\ninterface OwnProps {\n  step: CodyStep;\n  onStepClicked: () => void;\n}\n\ntype CodyStepElementProps = OwnProps;\n\nconst CodyStepElement = (props: CodyStepElementProps) => {\n  return <Step title={props.step.title}\n               description={props.step.description}\n               icon={props.step.error? <Icon name=\"x\" color=\"red\" /> : props.step.completed ? <Icon name=\"check\" color=\"green\" /> :  props.step.icon}\n               completed={!props.step.error && props.step.completed}\n               active={props.step.active}\n               id={props.step.id}\n               /* border needs to be set explicitly, otherwise out of view steps don't have a border (why ever?) */\n               style={{border: '1px solid rgba(34, 36, 38, 0.15)'}}\n               disabled={props.step.disabled}\n               link={props.step.linkable}\n               onClick={() => props.step.linkable ? props.onStepClicked() : undefined}\n               />\n};\n\nexport default CodyStepElement;\n","import axios from \"axios\";\nimport * as React from 'react';\nimport {useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Icon, Loader, Message, Segment, StepGroup} from \"semantic-ui-react\";\nimport {UserInfo} from \"../../../../User/model/UserInfo\";\nimport {makeGetCurrentUser} from \"../../../../User/selectors/currentUser\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {BoardId} from \"../../../model/Board\";\nimport {Graph, Node, NodeType} from \"../../../model/Graph\";\nimport {RunCodyOption} from \"../../../reducers/RunCodyOn\";\nimport {makeRunCodyOnSelector} from \"../../../selectors/RunCodyOn\";\nimport {CodyResponse, CodyResponseType, IIO, useIIO} from \"../../../service/Cody\";\nimport {\n  ImmutableDDDWizardContext,\n  isDDDAction\n} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {ImmutableFeatureContext, isFeatureContext} from \"../../../service/cody-wizard/context/feature-context\";\nimport {\n  ImmutableInformationContext,\n  isInformationContext\n} from \"../../../service/cody-wizard/context/information-context\";\nimport {\n  ImmutablePolicyContext,\n  isPolicyContext,\n} from \"../../../service/cody-wizard/context/policy-context\";\nimport {ImmutableUiContext, isUiContext} from \"../../../service/cody-wizard/context/ui\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport CellIcon from \"../../CellIcon\";\nimport CodyEmoji from \"../../CodyConsole/CodyEmoji\";\nimport CodyMessage from \"../../CodyConsole/CodyMessage\";\nimport ActiveStepIcon from \"../Step/ActiveStepIcon\";\nimport {WizardStep} from \"../WizardModal\";\nimport CodyStepElement from \"./CodyStepElement\";\n\nexport type CodyStepAction = 'connect' | 'generate' | 'healthcheck';\n\nexport interface CodyStep {\n  id: string;\n  action: CodyStepAction;\n  arguments: string[];\n  icon: JSX.Element;\n  title: string;\n  description: string;\n  active: boolean;\n  completed: boolean;\n  error: boolean;\n  codyResponse?: CodyResponse;\n  disabled?: boolean;\n  linkable?: boolean;\n}\n\nexport interface CodyStepGenerateNode extends CodyStep {\n  node: Node,\n  wizardStep: WizardStep;\n}\n\nexport const isGenerateNodeAction = (step: Partial<CodyStepGenerateNode>): step is CodyStepGenerateNode => {\n  return step.action === \"generate\";\n}\n\ninterface OwnProps {\n  ctx: WizardContext;\n  onBackToStepChanged: (backToStep: WizardStep) => void;\n  onCodyFinished: (success: boolean) => void;\n}\n\ntype RunCodyProps = OwnProps & WithNamespaces & RouteComponentProps<{uid: BoardId}>;\n\nconst RunCody = (props: RunCodyProps) => {\n\n  const user = useSelector(makeGetCurrentUser());\n  const [graph,] = useGraph();\n  const iio = useIIO();\n  const [steps, setSteps] = useState<CodyStep[]>([]);\n  const [leftScroll, setLeftScroll] = useState(0);\n  const [connectError, setConnectError] = useState(false);\n  const [healthcheckError, setHealthcheckError] = useState(false);\n  const runCodyOn = useSelector(makeRunCodyOnSelector());\n\n  const activeStep = steps.filter(s => s.active)[0];\n\n  useEffect(() => {\n    (async () => {\n      setSteps(await determineRunSteps(props.ctx, props.t, user, graph, props.match.params.uid, iio, runCodyOn));\n      setConnectError(false);\n      setHealthcheckError(false);\n    })().catch(e => {throw e});\n\n  }, [props.ctx]);\n\n  useEffect(() => {\n    if(activeStep) {\n      const ele = document.querySelector('#'+activeStep.id);\n      if(ele) {\n        ele.scrollIntoView({behavior: \"smooth\"});\n      }\n\n      if(!activeStep.completed && !activeStep.error) {\n        execStep(activeStep, graph, iio).then(executedStep => {\n          let updatedSteps = updateStep(executedStep, steps);\n\n          if(executedStep.error) {\n            if (isGenerateNodeAction(executedStep)) {\n              props.onBackToStepChanged(executedStep.wizardStep);\n            } else if (executedStep.action === \"connect\") {\n              setConnectError(true);\n            } else if (executedStep.action === \"healthcheck\") {\n              setHealthcheckError(true);\n            }\n\n            updatedSteps = disableAllRemainingSteps(updatedSteps);\n            props.onCodyFinished(false);\n          } else {\n            const nextStep = getNextStep(executedStep, updatedSteps);\n\n            if(nextStep) {\n              updatedSteps = markAsActive(nextStep, updatedSteps);\n            } else {\n              updatedSteps = markAllAsLinkable(updatedSteps);\n              props.onCodyFinished(true);\n            }\n          }\n\n          setSteps(updatedSteps);\n        })\n      }\n    }\n  }, [activeStep]);\n\n  const handleContainerScroll = () => {\n    const container = document.querySelector('#run-cody-step-container');\n\n    if(container) {\n      setLeftScroll(container.scrollLeft);\n    }\n  }\n\n\n  return <div id=\"run-cody-step-container\" style={{width: '100%', overflow: 'auto'}} onScroll={handleContainerScroll}>\n      <StepGroup size={\"mini\"} fluid={true} className=\"noborder\">\n        {steps.map(step => <CodyStepElement step={step} key={step.id} onStepClicked={() => setSteps(markAsActive(step, steps))} />)}\n      </StepGroup>\n      <Segment style={{minHeight: '300px', width: 'auto', padding: 0, left: leftScroll + 'px'}}>\n        {!activeStep || !activeStep.codyResponse && <Loader indeterminate={true} size=\"massive\" />}\n        {activeStep && activeStep.codyResponse && <div className=\"cody console\" style={{position: 'relative', height: '100%'}}>\n            <CodyMessage codyResponse={activeStep.codyResponse} codyName=\"Cody\" />\n        </div>}\n\n      </Segment>\n      <Message warning={true} hidden={!connectError} icon=\"exclamation\" content={<div>\n        <p>{props.t('insp.cody_wizard.step_run_cody.message_install_cody_engine')}</p>\n        <p><a href=\"https://github.com/proophboard/cody-engine#readme\">Cody Engine on Github</a></p>\n      </div>} />\n    <Message warning={true} hidden={!healthcheckError} icon=\"exclamation\" content={<div>\n      <p>{props.t('insp.cody_wizard.step_run_cody.message_restart_cody')}</p>\n      <p>{props.t('insp.cody_wizard.step_run_cody.message_perform_cody_restart')}</p>\n      <p>{props.t('insp.cody_wizard.step_run_cody.message_cody_still_failing')}</p>\n      <p><a href=\"https://github.com/proophboard/cody-engine/issues\">{props.t('insp.cody_wizard.step_run_cody.message_cody_failed_get_help')}</a></p>\n    </div>} />\n    </div>\n};\n\nexport default withNamespaces()(withRouter(RunCody));\n\nconst markAsActive = (step: CodyStep, steps: CodyStep[]): CodyStep[] => {\n  return steps.map(s => {\n    return {...s, active: s.id === step.id, disabled: false};\n  })\n}\n\nconst markAllAsLinkable = (steps: CodyStep[]): CodyStep[] => {\n  return steps.map(step => ({...step, linkable: true}));\n}\n\nconst getNextStep = (currentStep: CodyStep, steps: CodyStep[]): CodyStep | undefined => {\n  let returnNext = false;\n\n  for (const step of steps) {\n    if(returnNext) {\n      return step;\n    }\n\n    if(step.id === currentStep.id) {\n      returnNext = true;\n    }\n  }\n}\n\nconst updateStep = (step: CodyStep, steps: CodyStep[]): CodyStep[] => {\n  return steps.map(s => s.id === step.id ? step : s);\n}\n\nconst disableAllRemainingSteps = (steps: CodyStep[]): CodyStep[] => {\n  return steps.map(step => ({...step, disabled: !step.completed}));\n}\n\nconst execStep = (step: CodyStep, graph: Graph, iio: IIO): Promise<CodyStep> => {\n  const updatedStep = {...step};\n  let syncRequired = false;\n\n  const executable = (resolve: (codyStep: CodyStep | undefined) => void) => {\n    let codyServerName = 'Cody';\n\n    const timer = window.setTimeout(() => {\n      updatedStep.error = true;\n      updatedStep.completed = true;\n      updatedStep.codyResponse = {\n        cody: \"Something went wrong. I could not finish the task.\",\n        details: \"Try restarting the Cody Engine and check the logs for errors.\",\n        type: CodyResponseType.Error\n      }\n\n      dispose();\n      iio.disconnect(codyServerName);\n      resolve(updatedStep);\n    }, 10000);\n\n    const dispose = iio.attachCodyResponseListener((res: CodyResponse) => {\n      if(res.type === CodyResponseType.SyncRequired) {\n        syncRequired = true;\n        // Wait for next response or timeout\n        return;\n      }\n\n      if(res.type === CodyResponseType.Empty) {\n        // Wait for next response or timeout\n        return;\n      }\n\n      if(syncRequired && step.action !== \"connect\" && (res.type? res.type === CodyResponseType.Info : true)) {\n        // Sync finished info. Still waiting for final answer\n        syncRequired = false;\n        return;\n      }\n\n      updatedStep.error =  res.type? res.type !== CodyResponseType.Info : false;\n      updatedStep.completed = true;\n      updatedStep.codyResponse = res;\n\n      window.clearTimeout(timer);\n      dispose();\n      resolve(updatedStep);\n    });\n\n    switch (step.action) {\n      case \"connect\":\n        if(!iio.isConnected()) {\n          if(step.arguments[0] === \"play\") {\n            codyServerName = 'Cody Play';\n          }\n          iio.connect.Cody.apply(iio.connect.Cody, step.arguments as any);\n        } else {\n          iio.ping.Cody();\n        }\n        break;\n      case \"generate\":\n        if(isGenerateNodeAction(step)) {\n          graph.selectNode(step.node);\n          graph.triggerCody();\n        }\n        break;\n      case \"healthcheck\":\n        dispose();\n\n        window.clearTimeout(timer);\n        performHealthCheck(step.arguments).then(res => {\n          updatedStep.error = res.type? res.type !== CodyResponseType.Info : false;\n          updatedStep.completed = true;\n          updatedStep.codyResponse = res;\n\n          resolve(updatedStep);\n        })\n        break;\n    }\n  };\n\n  return new Promise((resolve) => {\n    // Give Cody a pause between steps\n    window.setTimeout(() => {\n      executable(resolve);\n    }, 800);\n  });\n}\n\nconst performHealthCheck = (urls: string[]): Promise<CodyResponse> => {\n  const fetch = axios.create();\n\n  const retry = async (url: string, wait: number, triesLeft: number): Promise<boolean> => {\n      return new Promise(resolve => {\n        if(triesLeft === 0) {\n          resolve(false);\n          return;\n        }\n\n        window.setTimeout(async () => {\n          fetch.get(url)\n            .then(\n              async (response) => {\n                if(response.status === 200) {\n                  resolve(true);\n                } else {\n                  console.error(\"[CodyHealthCheck] failed: \", \"ResponseStatus: \", response.status, \"message: \", response.data);\n                  resolve(await retry(url, 3000, triesLeft - 1));\n                }\n              }\n            )\n            .catch(\n              async (reason) => {\n                console.error(\"[CodyHealthCheck] \", reason);\n                resolve(await retry(url, 3000, triesLeft - 1))\n              }\n            )\n        }, wait);\n      })\n  }\n\n  return new Promise(resolve => {\n    const requests = urls.map(url => retry(url, 3000, 14));\n    const failedResponse: CodyResponse = {\n      cody: 'At least one health check failed. Try to restart the Cody Engine app and check the logs for more information.',\n      type: CodyResponseType.Error\n    };\n\n    Promise.all(requests).then(results => {\n      let allGood = true;\n      results.forEach(res => {\n        if(!res) {\n          allGood = false;\n        }\n      })\n\n      if(allGood) {\n        resolve({\n          cody: 'All good! Cody Engine is responding normally.'\n        })\n        return;\n      }\n\n      resolve(failedResponse);\n    }).catch(reason => {\n      console.error(\"[CodyHealthCheck] error: \", reason);\n      resolve(failedResponse);\n    })\n  })\n}\n\ntype Translate = (key: string) => string;\n\nconst defaultGenerateProps = (t: Translate) => {\n  return {\n    description: t('insp.cody_wizard.step_run_cody.action_generate.desc'),\n    action: 'generate' as CodyStepAction,\n    arguments: [],\n    active: false,\n    completed: false,\n    error: false,\n    disabled: true,\n  }\n}\n\nlet lastAutoRun: RunCodyOption = 'auto';\nconst determineRunSteps = async (ctx: WizardContext, t: Translate, user: UserInfo, graph: Graph, boardId: BoardId, iio: IIO, runCodyOn: RunCodyOption): Promise<CodyStep[]> => {\n  const steps: CodyStep[] = [];\n\n  if(runCodyOn === 'auto') {\n    const fetch = axios.create();\n    try {\n      const res = await fetch.post('http://localhost:3311/messages/IioSaidHello', {user: 'Connection Test'}, {timeout: 500});\n      runCodyOn = res.status === 200 ? 'engine' : 'play';\n    } catch (e) {\n      runCodyOn = 'play';\n    }\n\n    if(lastAutoRun !== runCodyOn && iio.isConnected()) {\n      iio.disconnect(lastAutoRun === 'engine'? 'Cody' : 'Cody Play');\n    }\n\n    lastAutoRun = runCodyOn;\n  }\n\n  const connectUrl = runCodyOn === 'play'? 'play' : 'http://localhost:3311';\n\n  steps.push({\n    id: 'cody-connect-step',\n    title: t('insp.cody_wizard.step_run_cody.action_connect.title'),\n    description: t('insp.cody_wizard.step_run_cody.action_connect.desc'),\n    action: 'connect',\n    arguments: [connectUrl, user.displayName, boardId],\n    active: true,\n    completed: false,\n    error: false,\n    icon: <CodyEmoji style={{position: \"relative\", marginRight: '20px'}} />\n  })\n\n  if(isDDDAction(ctx)) {\n    determineDDDActionRunSteps(ctx, steps, t, graph);\n  } else if (isInformationContext(ctx)) {\n    determineInformationContextRunSteps(ctx, steps, t, graph);\n  } else if (isPolicyContext(ctx)) {\n    determinePolicyContextRunSteps(ctx, steps, t, graph);\n  } else if (isUiContext(ctx)) {\n    determineUiContextRunSteps(ctx, steps, t, graph);\n  } else if (isFeatureContext(ctx)) {\n    determineFeatureContextRunSteps(ctx, steps, t, graph);\n  }\n\n  if(runCodyOn !== 'play') {\n    steps.push({\n      id: 'healthcheck-step',\n      title: 'Health Check',\n      description: t('insp.cody_wizard.step_run_cody.action_healthcheck.desc'),\n      action: \"healthcheck\",\n      arguments: [\"http://localhost:4200/api/health\", \"http://localhost:4200\"],\n      active: false,\n      completed: false,\n      error: false,\n      disabled: true,\n      icon: <Icon name=\"heartbeat\" color=\"red\" />\n    })\n  }\n\n  return steps;\n}\n\nconst determineInformationContextRunSteps = (ctx: ImmutableInformationContext, steps: CodyStep[], t: Translate, graph: Graph) => {\n  const defaultProps = defaultGenerateProps(t);\n\n  const vo = graph.getNode(ctx.vo.getId());\n\n  if(vo) {\n    steps.push({\n      id: 'generate-' + ctx.vo.getId(),\n      title: ctx.vo.getTechnicalName(),\n      icon: <ActiveStepIcon activeStep=\"anyVO\" />,\n      node: vo,\n      wizardStep: 'anyVO',\n      ...defaultProps\n    } as CodyStepGenerateNode)\n  }\n\n}\n\nconst determineUiContextRunSteps = (ctx: ImmutableUiContext, steps: CodyStep[], t: Translate, graph: Graph) => {\n  const defaultProps = defaultGenerateProps(t);\n\n  if(ctx.ui) {\n    const ui = graph.getNode(ctx.ui.getId());\n\n    if(ui) {\n      steps.push({\n        id: 'generate-' + ctx.ui.getId(),\n        title: ctx.ui.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"ui\" />,\n        node: ui,\n        wizardStep: 'ui',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n}\n\nconst skipTypes = [NodeType.freeText, NodeType.edge, NodeType.icon, NodeType.misc];\n\nconst determineFeatureContextRunSteps = (ctx: ImmutableFeatureContext, steps: CodyStep[], t: Translate, graph: Graph) => {\n  const defaultProps = defaultGenerateProps(t);\n\n  const pushLater: CodyStepGenerateNode[] = [];\n\n  ctx.feature.children().forEach(child => {\n\n    if (skipTypes.includes(child.getType())) {\n      return;\n    }\n\n    const refreshedChild = graph.getNode(child.getId());\n\n    if(refreshedChild) {\n      const step = {\n        id: 'generate-' + child.getId(),\n        title: child.getTechnicalName(),\n        icon: <CellIcon cellType={child.getType()} size=\"normal\"/>,\n        node: refreshedChild,\n        wizardStep: 'feature',\n        ...defaultProps\n      } as CodyStepGenerateNode;\n\n      if (child.getType() !== NodeType.document) {\n        pushLater.push(step);\n        return;\n      }\n\n      steps.push(step)\n    }\n  })\n\n  steps.push(...pushLater);\n}\n\nconst determinePolicyContextRunSteps = (ctx: ImmutablePolicyContext, steps: CodyStep[], t: Translate, graph: Graph) => {\n  const defaultProps = defaultGenerateProps(t);\n\n  if(ctx.event) {\n    const evt = graph.getNode(ctx.event.getId());\n\n    if(evt) {\n      steps.push({\n        id: 'generate-' + ctx.event.getId(),\n        title: ctx.event.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"dddEvent\" />,\n        node: evt,\n        wizardStep: 'policyEvent',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n\n  if(ctx.policy) {\n    const policy = graph.getNode(ctx.policy.getId());\n\n    if(policy) {\n      steps.push({\n        id: 'generate-' + ctx.policy.getId(),\n        title: ctx.policy.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"policy\" />,\n        node: policy,\n        wizardStep: 'policy',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n\n  determineAdditionalStepsIncludedInFeature(ctx, steps, t, graph);\n}\n\nconst determineDDDActionRunSteps = (ctx: ImmutableDDDWizardContext, steps: CodyStep[], t: Translate, graph: Graph) => {\n  const defaultProps = defaultGenerateProps(t);\n\n  if(ctx.state) {\n    const state = graph.getNode(ctx.state.getId());\n\n    if(state) {\n      steps.push({\n        id: 'generate-' + ctx.state.getId(),\n        title: ctx.state.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"state\" />,\n        node: state,\n        wizardStep: 'state',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n\n  if(ctx.command) {\n    const command = graph.getNode(ctx.command.getId());\n\n    if(command) {\n      steps.push({\n        id: 'generate-' + ctx.command.getId(),\n        title: ctx.command.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"command\" />,\n        node: command,\n        wizardStep: 'command',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n\n  if(ctx.aggregate) {\n    const aggregate = graph.getNode(ctx.aggregate.getId());\n\n    if(aggregate) {\n      steps.push({\n        id: 'generate-' + ctx.aggregate.getId(),\n        title: ctx.aggregate.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"aggregate\" />,\n        node: aggregate,\n        wizardStep: 'aggregate',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n\n  }\n\n  if(ctx.events) {\n    ctx.events.forEach(evt => {\n      const refreshedEvt = graph.getNode(evt.getId());\n      if(refreshedEvt) {\n        steps.push({\n          id: 'generate-' + evt.getId(),\n          title: evt.getTechnicalName(),\n          icon: <ActiveStepIcon activeStep=\"dddEvent\" />,\n          node: refreshedEvt,\n          wizardStep: 'dddEvent',\n          ...defaultProps\n        } as CodyStepGenerateNode)\n      }\n    })\n  }\n\n  if(ctx.ui) {\n    const ui = graph.getNode(ctx.ui.getId());\n\n    if(ui) {\n      steps.push({\n        id: 'generate-' + ctx.ui.getId(),\n        title: ctx.ui.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"ui\" />,\n        node: ui,\n        wizardStep: 'ui',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n\n  // State List is set when:\n  // - a new state vo is added in DDD action -> StateVO step also adds a corresponding state list vo\n  // - a state view UI is added in DDD action -> UI step checks parentUI, searches state list vo and adds a PageLink to first table column if not set\n  if(ctx.stateList) {\n    const stateList = graph.getNode(ctx.stateList.getId());\n\n    if(stateList) {\n      steps.push({\n        id: 'generate-' + ctx.stateList.getId(),\n        title: ctx.stateList.getTechnicalName(),\n        icon: <ActiveStepIcon activeStep=\"state\" />,\n        node: stateList,\n        wizardStep: 'state',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  }\n\n  determineAdditionalStepsIncludedInFeature(ctx, steps, t, graph);\n}\n\nconst determineAdditionalStepsIncludedInFeature = (ctx: ImmutableDDDWizardContext | ImmutablePolicyContext, steps: CodyStep[], t: Translate, graph: Graph) => {\n  if(!ctx.feature) {\n    return;\n  }\n\n  const defaultProps = defaultGenerateProps(t);\n\n  const stepsNames = steps.map(step => step.title);\n\n  ctx.feature.children().forEach(child => {\n    if(skipTypes.includes(child.getType())) {\n      return;\n    }\n\n    if(stepsNames.includes(child.getTechnicalName())) {\n      return;\n    }\n\n    stepsNames.push(child.getTechnicalName());\n\n    const refreshedChild = graph.getNode(child.getId());\n\n    if(refreshedChild) {\n      steps.splice(1, 0, {\n        id: 'generate-' + child.getId(),\n        title: child.getTechnicalName(),\n        icon: <CellIcon cellType={child.getType()} size=\"normal\" />,\n        node: refreshedChild,\n        wizardStep: 'feature',\n        ...defaultProps\n      } as CodyStepGenerateNode)\n    }\n  })\n}\n","import * as React from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Dropdown, FormField, Label} from \"semantic-ui-react\";\nimport {runCodyOnChanged} from \"../../../actions/events\";\nimport {RunCodyOption} from \"../../../reducers/RunCodyOn\";\nimport {makeRunCodyOnSelector} from \"../../../selectors/RunCodyOn\";\nimport {useIIO} from \"../../../service/Cody\";\n\ninterface OwnProps {\n\n}\n\ntype RunCodyOnSelectProps = OwnProps;\n\nconst options = [{\n  key: 'auto',\n  text: 'auto',\n  value: 'auto'\n}, {\n  key: 'play',\n  text: 'Cody Play',\n  value: 'play'\n}, {\n  key: 'engine',\n  text: 'Cody Engine',\n  value: 'engine'\n}]\n\nconst RunCodyOnSelect = (props: RunCodyOnSelectProps) => {\n  const runCodyOn = useSelector(makeRunCodyOnSelector());\n  const dispatch = useDispatch();\n  const iio = useIIO();\n\n  const handleTargetChanged = (newTarget: RunCodyOption) => {\n    if(iio.isConnected()) {\n      iio.disconnect('Cody');\n    }\n    dispatch(runCodyOnChanged(newTarget));\n  }\n\n  return <FormField inline={true}>\n    <label>run on:&nbsp;&nbsp;</label>\n    <Dropdown inline={true}\n              placeholder={'Select target'}\n              value={runCodyOn}\n              options={options}\n              onChange={(e, data) => handleTargetChanged(data.value as RunCodyOption)}\n              className={'cody-wizard-inline-select'} />\n  </FormField>\n};\n\nexport default RunCodyOnSelect;\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button} from \"semantic-ui-react\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {stepHeader} from \"../../../service/cody-wizard/step/step-header\";\nimport {WizardStep} from \"../WizardModal\";\n\ninterface OwnProps {\n  activeStep: WizardStep | null;\n  ctx: WizardContext;\n  onNextStep: (step: WizardStep) => void;\n}\n\ntype NextStepProps = OwnProps & WithNamespaces;\n\nconst NextStep = (props: NextStepProps) => {\n  const nextStep = props.activeStep ? props.ctx.nextStep(props.activeStep, props.ctx) : null;\n\n  if(!nextStep) {\n    return <></>\n  }\n\n  return <Button icon=\"right chevron\"\n                 labelPosition=\"right\"\n                 basic={true}\n                 className=\"noborder leftborder\"\n                 content={stepHeader(nextStep, props.t)}\n                 onClick={() => props.onNextStep(nextStep)}\n  />\n};\n\nexport default withNamespaces()(NextStep);\n","import * as React from 'react';\nimport {Button} from \"semantic-ui-react\";\nimport {WizardContext} from \"../../../service/cody-wizard/context/wizard-context\";\nimport {stepHeader} from \"../../../service/cody-wizard/step/step-header\";\nimport {WizardStep} from \"../WizardModal\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\n\ninterface OwnProps {\n  activeStep: WizardStep | null;\n  forcedPreviousStep?: WizardStep;\n  ctx: WizardContext;\n  onPreviousStep: (step: WizardStep) => void;\n}\n\ntype PreviousStepProps = OwnProps & WithNamespaces;\n\nlet lastActiveStep: WizardStep | null = null;\n\nconst PreviousStep = (props: PreviousStepProps) => {\n  let prevStep = props.forcedPreviousStep || (props.activeStep ? props.ctx.previousStep(props.activeStep, props.ctx) : null);\n\n  if(!prevStep && props.activeStep && props.activeStep === 'runCody' && lastActiveStep) {\n    prevStep = lastActiveStep;\n  }\n\n  if(props.activeStep !== 'runCody') {\n    lastActiveStep = props.activeStep;\n  }\n\n\n  if(!prevStep) {\n    return <></>\n  }\n\n  return <Button icon=\"left chevron\"\n                 labelPosition=\"left\"\n                 basic={true}\n                 className=\"noborder rightborder\"\n                 content={stepHeader(prevStep, props.t)}\n                 onClick={() => props.onPreviousStep(prevStep!)}\n  />\n};\n\nexport default withNamespaces()(PreviousStep);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Message} from \"semantic-ui-react\";\nimport {Node} from \"../../../model/Graph\";\n\ninterface OwnProps {\n  node: Node\n}\n\ntype UnsupportedNodeProps = OwnProps & WithNamespaces;\n\nconst UnsupportedNode = (props: UnsupportedNodeProps) => {\n  return <Message error={true}>\n    {props.t('insp.cody_wizard.unsupported_node', {name: props.node.getName(), type: props.node.getType()})}\n  </Message>\n};\n\nexport default withNamespaces()(UnsupportedNode);\n","import * as React from 'react';\nimport {useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Button, ButtonGroup, Modal} from \"semantic-ui-react\";\nimport {makeGetSidebarSelector} from \"../../../Layout/selectors/sidebar\";\nimport {useGraph} from \"../../hooks/useGraph\";\nimport {Board, BoardId, defaultBoardProps} from \"../../model/Board\";\nimport {Node, NodeType} from \"../../model/Graph\";\nimport {makeBoardByIdSelector} from \"../../selectors/board\";\nimport {dddActionFromNode, isDDDAction} from \"../../service/cody-wizard/context/ddd-action\";\nimport {featureContextFromNode, isFeatureContext} from \"../../service/cody-wizard/context/feature-context\";\nimport {informationContextFromNode, isInformationContext} from \"../../service/cody-wizard/context/information-context\";\nimport {\n  isPartOfPolicyContext,\n  isPolicyContext,\n  policyContextFromNode\n} from \"../../service/cody-wizard/context/policy-context\";\nimport {isUiContext, uiContextFromNode} from \"../../service/cody-wizard/context/ui\";\nimport {makeCodySession, WizardContext, WizardContextType} from \"../../service/cody-wizard/context/wizard-context\";\nimport {isAggregateEvent, isDddActionEvent} from \"../../service/cody-wizard/event/is-aggregate-event\";\nimport {isDddActionOrPolicyFeature} from \"../../service/cody-wizard/feature/is-ddd-action-or-policy-feature\";\nimport {isValid} from \"../../service/cody-wizard/node/is-valid\";\nimport {stepHeader} from \"../../service/cody-wizard/step/step-header\";\nimport {stepWikiLink} from \"../../service/cody-wizard/step/step-wiki-link\";\nimport {isDddActionUi} from \"../../service/cody-wizard/ui/is-ddd-action-ui\";\nimport {isStateVo} from \"../../service/cody-wizard/vo/is-state-vo\";\nimport {isStateVoCandidate} from \"../../service/cody-wizard/vo/is-state-vo-candidate\";\nimport RunCody from \"./CodyMonitor/RunCody\";\nimport RunCodyOnSelect from \"./CodyMonitor/RunCodyOnSelect\";\nimport ActiveStepIcon from \"./Step/ActiveStepIcon\";\nimport Aggregate from \"./Step/Aggregate\";\nimport AnyVo from \"./Step/AnyVo\";\nimport DddCommand from \"./Step/DddCommand\";\nimport DddEvent from \"./Step/DddEvent\";\nimport Feature from \"./Step/Feature\";\nimport NextStep from \"./Step/NextStep\";\nimport Policy from \"./Step/Policy\";\nimport PolicyEvent from \"./Step/PolicyEvent\";\nimport PreviousStep from \"./Step/PreviousStep\";\nimport SelectContext from \"./Step/SelectContext\";\nimport StateVO from \"./Step/StateVO\";\nimport Ui from \"./Step/Ui\";\nimport UnsupportedNode from \"./Unsupported/UnsupportedNode\";\n\nexport const  DEFAULT_CONNECT_MARGIN = 80;\n\nexport const DEFAULT_CARD_HEIGHT = 100;\nexport const DEFAULT_CARD_WIDTH = 160;\nexport const SLICE_LANE_HEIGHT = 300;\nexport const SLICE_LANE_MARGIN = SLICE_LANE_HEIGHT - DEFAULT_CARD_HEIGHT;\nexport const DOUBLE_CONNECT_MARGIN = DEFAULT_CONNECT_MARGIN * 2;\nexport const API_TO_MODULE_MARGIN = SLICE_LANE_HEIGHT - DEFAULT_CARD_HEIGHT;\nexport const INPUT_CHAR_SIZE = 9;\nexport const CHAR_SIZE_UNIT = 'px';\nexport const ADDITIONAL_CHAR_PADDING = 10;\n\nexport type WizardStep = 'state' | 'command' | 'aggregate' | 'dddEvent' | 'policyEvent' | 'publicEvent' | 'ui'\n  | 'feature' | 'anyVO' | 'policy' | 'externalSystem' | 'runCody' | {step: 'selectContext', contexts: WizardContextType[], node: Node};\n\nexport const isSelectContextStep = (step: WizardStep | null): step is {step: 'selectContext', contexts: WizardContextType[], node: Node} => {\n  return !!step && typeof step === 'object' && step.step === 'selectContext';\n}\n\nexport type FinishStep = () => WizardContext;\n\nexport interface WithWizardStepProps<CTX extends WizardContext>{\n  ctx: CTX;\n  mode: 'modal' | 'sidebar';\n  readonly: boolean;\n  onCtxChanged: (ctx: CTX) => void;\n  onUpdateMetadata?: (value: string, force?: boolean) => void;\n}\n\ninterface OwnProps {\n  boardId: BoardId;\n  openHandle: (handle: (open: boolean, selectedNode: Node | null, runCody?: boolean) => void) => void;\n  onClose: () => void;\n}\n\ntype WizardModalProps = OwnProps & WithNamespaces;\n\nlet currentFinishStepAction: FinishStep | null = null;\n\nexport const EMPTY_CONTEXT: WizardContext = {board: new Board(defaultBoardProps), type: \"empty\", nextStep: () => null, previousStep: () => null, installCodyGraphSuggestions: () => {/*Do Nothing*/}};\n\nconst WizardModal = (props: WizardModalProps) => {\n  const [open, setOpen] = useState(false);\n  const board = useSelector(makeBoardByIdSelector(props.boardId));\n  const sidebar = useSelector(makeGetSidebarSelector());\n  const defaultCtx = {...EMPTY_CONTEXT, board};\n  const [ctx, setCtx] = useState<WizardContext>(defaultCtx);\n  const [codySession, setCodySession] = useState<WizardContext>(defaultCtx);\n  const [codyErrored, setCodyErrored] = useState(false);\n  const [unsupportedNode, setUnsupportedNode] = useState<Node|null>(null);\n  const [activeStep, setActiveStep] = useState<WizardStep | null >(null);\n  const [forcedPreviousStep, setForcedPreviousStep] = useState<WizardStep | undefined>(undefined);\n  const [graph] = useGraph();\n  const [readonly, setReadonly] = useState(false);\n\n  const sidebarWidth = sidebar.width + 10 /* collapse handle */;\n\n  const memoizeNode = (node: Node, setWizardStep: boolean = false, currentContext?: WizardContext): WizardContext => {\n    let wizardStep: WizardStep | null = null;\n    let newCtx: WizardContext = currentContext || defaultCtx;\n\n    setReadonly(!node.isEnabled());\n\n    switch (node.getType()) {\n      case NodeType.command:\n        if(isPartOfPolicyContext(node)) {\n          newCtx = policyContextFromNode(node, board);\n          wizardStep = 'policy';\n        } else {\n          newCtx = dddActionFromNode(node, board);\n          wizardStep = 'command';\n        }\n        break;\n      case NodeType.aggregate:\n        newCtx = dddActionFromNode(node, board);\n        wizardStep = 'aggregate';\n        break;\n      case NodeType.event:\n        if(isDDDAction(newCtx)) {\n          wizardStep = 'dddEvent';\n        } else if (isDddActionEvent(node)) {\n          wizardStep = 'dddEvent';\n          newCtx = dddActionFromNode(node, board);\n        } else if (isPolicyContext(newCtx)) {\n          wizardStep = 'policyEvent';\n        } else if (isPartOfPolicyContext(node)) {\n          wizardStep = 'policyEvent';\n          newCtx = policyContextFromNode(node, board);\n        } else {\n          wizardStep = {step: \"selectContext\", contexts: ['dddAction', 'policy'], node};\n        }\n        break;\n      case NodeType.ui:\n        if(isDddActionUi(node)) {\n          newCtx = dddActionFromNode(node, board);\n        } else {\n          newCtx = uiContextFromNode(node, board);\n        }\n        wizardStep = 'ui';\n        break;\n      case NodeType.document:\n        if(isStateVoCandidate(node)) {\n          newCtx = dddActionFromNode(node, board)\n          wizardStep = 'state';\n          break;\n        }\n\n        newCtx = informationContextFromNode(node, board);\n        wizardStep = 'anyVO';\n        break;\n      case NodeType.feature:\n        if(isDddActionOrPolicyFeature(node)) {\n          newCtx = isPartOfPolicyContext(node)? policyContextFromNode(node, board) : dddActionFromNode(node, board);\n        } else {\n          newCtx = featureContextFromNode(node, board);\n        }\n        wizardStep = 'feature';\n        break;\n      case NodeType.policy:\n        newCtx = policyContextFromNode(node, board);\n        wizardStep = 'policy';\n        break;\n      case NodeType.externalSystem:\n        if(isPartOfPolicyContext(node)) {\n          newCtx = policyContextFromNode(node, board);\n          wizardStep = 'policy';\n        } else {\n          setUnsupportedNode(node);\n        }\n        break;\n      default:\n        setUnsupportedNode(node);\n    }\n\n    setCtx(newCtx);\n    setCodySession(makeCodySession(newCtx));\n\n    if(setWizardStep) {\n      setActiveStep(wizardStep);\n    }\n\n    return newCtx;\n  }\n\n  props.openHandle((openFromHandle, node, shouldRunCody) => {\n\n    setOpen(openFromHandle);\n    if(node) {\n      if(isValid(node)) {\n        const currentCtx = memoizeNode(node, !activeStep);\n\n        if(shouldRunCody) {\n          if(node.getType() === NodeType.feature) {\n            setCodySession(currentCtx);\n          } else {\n            setCodySession(makeCodySession(currentCtx, node));\n          }\n          setActiveStep('runCody');\n        }\n      } else {\n        setUnsupportedNode(node);\n        setCtx(defaultCtx);\n        setCodySession(defaultCtx);\n      }\n    }\n  });\n\n  const resetWizard = () => {\n    setCtx(defaultCtx);\n    setCodySession(defaultCtx);\n    setCodyErrored(false);\n    setUnsupportedNode(null);\n    setActiveStep(null);\n    currentFinishStepAction = null;\n  }\n\n  const handleCtxChanged = (changedCtx: WizardContext) => {\n\n    let currentSession = {...codySession};\n    for (const ctxKey in changedCtx) {\n      // @ts-ignore\n      if(ctx[ctxKey] !== changedCtx[ctxKey]) {\n        // If user visited feature step, all ctx nodes should be passed to cody\n        if(ctxKey === 'feature') {\n          currentSession = changedCtx;\n        } else {\n          // @ts-ignore\n          currentSession[ctxKey] = changedCtx[ctxKey];\n        }\n      }\n    }\n\n    setCodySession(currentSession);\n\n    if(isSelectContextStep(activeStep)) {\n      memoizeNode(activeStep.node, true, changedCtx);\n    } else {\n      setCtx(changedCtx);\n    }\n  }\n\n  const handleCodyFinished = (success: boolean) => {\n    if(!success) {\n      setCodyErrored(true);\n    }\n  }\n\n  const closeWizard = () => {\n    resetWizard();\n    props.onClose();\n  }\n\n  const saveCurrentStep = () => {\n    if(currentFinishStepAction) {\n      handleCtxChanged(currentFinishStepAction());\n    }\n    currentFinishStepAction = null;\n  }\n\n  const changeStep = (step: WizardStep) => {\n    if(activeStep === 'runCody') {\n      if(!codyErrored) {\n        setCodySession(makeCodySession(ctx));\n      }\n    } else {\n      saveCurrentStep();\n    }\n    setActiveStep(step);\n    setForcedPreviousStep(undefined);\n  }\n\n  const runCody = () => {\n    if(activeStep === 'runCody') {\n      // Copying the cody session triggers a rerun\n      setCodySession({...codySession});\n    } else {\n      saveCurrentStep();\n    }\n\n    setCodyErrored(false);\n\n    if(activeStep === 'feature') {\n      // Run Cody on Feature causes all steps (entire ctx) to be generated\n      setCodySession({...ctx})\n    }\n\n    setActiveStep('runCody');\n  }\n\n  const close = () => {\n    saveCurrentStep();\n    closeWizard();\n  }\n\n  const helpLink = stepWikiLink(activeStep);\n\n  return <Modal open={open}\n                closeIcon={true}\n                onClose={close}\n                size=\"large\"\n                style={{left: `calc(5% + ${sidebarWidth}px)`, width: `calc(90% - ${sidebarWidth}px)`, height: \"calc(80% - 64px)\"}}\n                closeOnEscape={false} >\n    <Modal.Header>\n      Cody Wizard{activeStep? ': ' + stepHeader(activeStep, props.t) : ''}&nbsp;<ActiveStepIcon activeStep={activeStep} />\n      {helpLink && <Button as={'a'} href={helpLink} target={'_blank'} floated=\"right\" circular={true} basic={true} icon=\"question\" size=\"mini\"/>}\n      <p style={{float: 'right', fontSize: '1rem'}}>\n        <RunCodyOnSelect />\n      </p>\n    </Modal.Header>\n    <Modal.Content scrolling={true} style={{height: \"calc(80vh - 10em)\"}}>\n      {unsupportedNode && <UnsupportedNode node={unsupportedNode} />}\n      {!unsupportedNode\n        && activeStep === 'runCody'\n        && <RunCody ctx={codySession} onBackToStepChanged={step => setForcedPreviousStep(step)} onCodyFinished={handleCodyFinished}/>\n      }\n    </Modal.Content>\n    <Modal.Actions>\n      <ButtonGroup floated=\"left\">\n        <PreviousStep activeStep={activeStep} ctx={ctx} forcedPreviousStep={forcedPreviousStep} onPreviousStep={step => changeStep(step)} />\n        {activeStep && <Button className='noborder' basic={true} content={stepHeader(activeStep, props.t)} style={{cursor: 'default'}} />}\n        <NextStep activeStep={activeStep} ctx={ctx} onNextStep={step => changeStep(step)} />\n      </ButtonGroup>\n      <Button basic={true} className=\"noborder\" content={props.t('app.form.close') as string} onClick={close} />\n      <Button primary={true} icon=\"play circle\" content={props.t('insp.cody_wizard.run_cody') as string} onClick={runCody} disabled={(activeStep === 'runCody' && !codyErrored) || isSelectContextStep(activeStep)} />\n    </Modal.Actions>\n  </Modal>\n};\n\nexport default withNamespaces()(WizardModal);\n","import {WizardStep} from \"../../../components/CodyEngineWizard/WizardModal\";\nimport {names} from \"../node/names\";\n\nexport const stepWikiLink = (step: WizardStep | null): string | null => {\n  switch (step) {\n    case \"command\":\n      return 'https://wiki.prooph-board.com/event_storming/basic-concepts.html#command';\n    case \"aggregate\":\n      return 'https://wiki.prooph-board.com/event_storming/basic-concepts.html#aggregate';\n    case \"state\":\n    case \"anyVO\":\n      return 'https://wiki.prooph-board.com/event_storming/basic-concepts.html#information';\n    case \"dddEvent\":\n    case \"publicEvent\":\n    case \"policyEvent\":\n      return 'https://wiki.prooph-board.com/event_storming/basic-concepts.html#domain-event';\n    default:\n      return null;\n  }\n}\n","import {EMPTY_CONTEXT, isSelectContextStep, WizardStep} from \"../../../components/CodyEngineWizard/WizardModal\";\nimport {Board} from \"../../../model/Board\";\nimport {Graph, Node, NodeType} from \"../../../model/Graph\";\nimport {dddActionFromNode} from \"../context/ddd-action\";\nimport {featureContextFromNode} from \"../context/feature-context\";\nimport {informationContextFromNode} from \"../context/information-context\";\nimport {isPartOfPolicyContext, policyContextFromNode} from \"../context/policy-context\";\nimport {uiContextFromNode} from \"../context/ui\";\nimport {WizardContext} from \"../context/wizard-context\";\nimport {isAggregateEvent, isDddActionEvent} from \"../event/is-aggregate-event\";\nimport {isDddActionOrPolicyFeature} from \"../feature/is-ddd-action-or-policy-feature\";\nimport {isDddActionUi} from \"../ui/is-ddd-action-ui\";\nimport {isStateVo} from \"../vo/is-state-vo\";\nimport {isStateVoCandidate} from \"../vo/is-state-vo-candidate\";\n\nexport const determineWizardContextAndStep = (node: Node, board: Board, graph: Graph): {ctx: WizardContext, step: WizardStep | null} => {\n  let newCtx: WizardContext = {...EMPTY_CONTEXT, board};\n  let wizardStep: WizardStep | null = null;\n\n  if(!node) {\n    return {ctx: newCtx, step: wizardStep}\n  }\n\n  switch (node.getType()) {\n    case NodeType.command:\n      newCtx = dddActionFromNode(node, board);\n      wizardStep = 'command';\n      break;\n    case NodeType.aggregate:\n      newCtx = dddActionFromNode(node, board);\n      wizardStep = 'aggregate';\n      break;\n    case NodeType.event:\n      if (isDddActionEvent(node)) {\n        wizardStep = 'dddEvent';\n        newCtx = dddActionFromNode(node, board);\n      } else if (isPartOfPolicyContext(node)) {\n        wizardStep = 'policyEvent';\n        newCtx = policyContextFromNode(node, board);\n      } else {\n        wizardStep = {step: \"selectContext\", contexts: ['dddAction', 'policy'], node};\n      }\n      break;\n    case NodeType.ui:\n      if(isDddActionUi(node)) {\n        newCtx = dddActionFromNode(node, board);\n      } else {\n        newCtx = uiContextFromNode(node, board);\n      }\n      wizardStep = 'ui';\n      break;\n    case NodeType.document:\n      if(isStateVoCandidate(node)) {\n        newCtx = dddActionFromNode(node, board)\n        wizardStep = 'state';\n        break;\n      }\n\n      newCtx = informationContextFromNode(node, board);\n      wizardStep = 'anyVO';\n      break;\n    case NodeType.feature:\n      if(isDddActionOrPolicyFeature(node)) {\n        newCtx = isPartOfPolicyContext(node)? policyContextFromNode(node, board) : dddActionFromNode(node, board);\n      } else {\n        newCtx = featureContextFromNode(node, board);\n      }\n      wizardStep = 'feature';\n      break;\n    case NodeType.policy:\n      newCtx = policyContextFromNode(node, board);\n      wizardStep = 'policy';\n      break;\n    case NodeType.externalSystem:\n      if(isPartOfPolicyContext(node)) {\n        newCtx = policyContextFromNode(node, board);\n        wizardStep = 'policy';\n      }\n      break;\n  }\n\n  return {\n    ctx: newCtx,\n    step: wizardStep,\n  }\n}\n\nexport const initializeCodyGraphSuggestions = (node: Node, board: Board, graph: Graph): {ctx: WizardContext, step: WizardStep | null} => {\n\n  resetCodySuggestCallbacks(graph);\n\n  const {ctx, step} = determineWizardContextAndStep(node, board, graph);\n  const newCtx = ctx;\n  const wizardStep = step;\n\n  if(isSelectContextStep(wizardStep)) {\n    wizardStep.contexts.forEach(ctxName => {\n      let possibleCtx: WizardContext = {...EMPTY_CONTEXT, board};\n      let possibleStep: WizardStep | null = null;\n\n      switch (ctxName) {\n        case \"dddAction\":\n          possibleCtx = dddActionFromNode(node, board);\n          // @TODO: generic solution needed!\n          possibleStep = 'dddEvent';\n          break;\n        case \"policy\":\n          possibleCtx = policyContextFromNode(node, board);\n          // @TODO: generic solution needed!\n          possibleStep = 'policyEvent';\n          break;\n      }\n\n      if(possibleStep) {\n        possibleCtx.installCodyGraphSuggestions(possibleStep, possibleCtx, graph);\n      }\n    })\n  } else {\n    if(wizardStep) {\n      newCtx.installCodyGraphSuggestions(wizardStep, newCtx, graph);\n    }\n  }\n\n  return {\n    ctx: newCtx,\n    step: wizardStep,\n  }\n}\n\nconst resetCodySuggestCallbacks = (graph: Graph): void => {\n  graph.setCodyUpCb(null);\n  graph.setCodyDownCb(null);\n  graph.setCodyLeftCb(null);\n  graph.setCodyRightCb(null);\n}\n","import copy from \"copy-to-clipboard\";\nimport {List} from \"immutable\";\nimport * as _ from 'lodash';\nimport * as mxFactory from \"mxgraph/javascript/dist/build\";\nimport React, {Component} from \"react\";\nimport {RouteComponentProps} from \"react-router\";\nimport {Dimmer, Loader} from \"semantic-ui-react\";\nimport shortUUID from \"short-uuid\";\nimport uuid from \"uuid\";\nimport {default as socket} from \"../../api/ConfiguredSocket\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Routes from \"../../routes\";\nimport {Model as SocketModel} from \"../../Socket\";\nimport {UserModel} from \"../../User\";\nimport * as Action from \"../actions\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {MouseSync, useMouseSync} from \"../hooks/useMouseSync\";\nimport {BoardModel, BoardSync} from \"../model\";\nimport {BoardChanged} from \"../model/BoardChanged\";\nimport {BoardVersion} from \"../model/BoardVersion\";\nimport {\n    deriveGraphFromMxgraph,\n    flattenNodeChildren,\n    Graph as IioGraph,\n    MxGraphElement,\n    Node,\n    NodeType\n} from \"../model/Graph\";\nimport {HistoryAction, HistoryCellType} from \"../model/HistoryEntry\";\nimport {IIO} from \"../service/Cody\";\nimport {RealtimeBoardSync} from \"../service/RealtimeBoardSync\";\nimport {Gesture, RemoteMouseSync} from \"../service/RemoteMouseSync\";\nimport {initializeGraphEditor} from \"./MxGraphBoard/initializeGraphEditor\";\nimport MxGraphBoardLink from \"./MxGraphBoardLink\";\nimport MxGraphImageUpload from \"./MxGraphImageUpload\";\nimport MxGraphTaskLink from \"./MxGraphTaskLink\";\nimport {makeGetSidebarSelector} from \"../../Layout/selectors/sidebar\";\nimport {BoardRouteMatchParams} from \"./types\";\nimport {isStandalone} from \"../../standalone/util\";\nimport {BoardAgent} from \"../../BoardAgent/services/BoardAgent\";\nimport WizardModal from \"./CodyEngineWizard/WizardModal\";\nimport {\n    initializeCodyGraphSuggestions\n} from \"../service/cody-wizard/graph-suggestions/initialize-cody-graph-suggestions\";\nimport {setSideBySideCell} from \"../../Layout/actions/commands\";\nimport {parse, stringify} from \"../service/json/json-comment-wrapper\";\n\n// Todo: Customized mxgraph js files are currently imported as scripts because they rely on globals. We need to change that!\ndeclare const inspectioUtils: {getTypeInclEdge: (cell: any) => HistoryCellType | false, getLabelText: (cell: any) => string, isContainer: (cell: any) => boolean, isSlice: (cell: any) => boolean, isEventModel: (cell: any) => boolean, getMetadata: (cell: any) => string | undefined, metadataToJSON: (metadata: string) => object, metadataJsonToString: (metadata: object) => string, getTags: (cell: any) => string[]};\ndeclare const ispConst: any;\ndeclare const EditorUi: any;\ndeclare const Editor: any;\ndeclare const RESOURCE_BASE: string;\ndeclare const STYLE_PATH: string;\ndeclare const Graph: any;\ndeclare const urlParams: any;\ndeclare const mxLanguage: string;\ndeclare const mxResources: any;\ndeclare const mxUtils: any;\ndeclare const mxGraphModel: any;\ndeclare const mxAutoSaveManager: any;\ndeclare const mxCodec: any;\ndeclare const mxUndoableEdit: any;\ndeclare const mxEventObject: any;\ndeclare const mxEvent: any;\ndeclare const MXGRAPH_ROOT_UUIDS: string[];\ndeclare const mxGeometryChange: any;\ndeclare const mxChildChange: any;\ndeclare const mxValueChange: any;\ndeclare const mxTerminalChange: any;\ndeclare const mxStyleChange: any;\ndeclare const mxRectangle: any;\ndeclare const mxPoint: any;\n\n// Separate state props + dispatch props to their own interfaces.\nexport interface PropsFromState {\n    board: BoardModel.Board,\n    user: UserModel.UserInfo,\n    socketStatus: SocketModel.StatusModel.Status,\n    liteMode: boolean,\n}\n\n// We can use `typeof` here to map our dispatch types to the props, like so.\nexport interface PropsFromDispatch {\n    fetchUserBoard: typeof Action.Query.fetchUserBoard,\n    onError: typeof NotifyAction.Command.error,\n    onInfo: typeof NotifyAction.Command.info,\n    saveBoard: typeof Action.Command.saveBoard,\n    onRemoteBoardChanged: typeof Action.Event.remoteBoardChanged,\n    onLocalBoardChanged: typeof Action.Event.localBoardChanged,\n    onBoardImported: typeof Action.Event.boardImported,\n    onBoardImportStarted: typeof Action.Event.boardImportStarted,\n    onBoardExported: typeof Action.Event.boardExported,\n    onBoardInitialized: typeof Action.Event.boardInitialized,\n    onLocalBoardUpdatedWithRemoteChange: typeof Action.Event.localBoardUpdatedWithRemoteChange,\n    onActiveGraphElementChanged: typeof Action.Event.activeGraphElementChanged,\n    onActiveGraphElementLabelChanged: typeof Action.Event.activeGraphElementLabelChanged,\n    onActiveGraphElementMetadataChanged: typeof Action.Event.activeGraphElementMetadataChanged,\n    clearBoardHistory: typeof Action.Command.clearBoardHistory,\n    filterElementsTree: typeof Action.Command.filterElementsTree,\n    toggleElementDetails: typeof Action.Command.toggleElementDetails,\n    setSideBySideCell: typeof setSideBySideCell,\n    toggleCodyConsole: typeof Action.Command.toggleCodyConsole,\n    togglePlayshotModal: typeof Action.Command.togglePlayshotModal,\n}\n\ninterface OwnProps {}\n\nexport type MxGraphBoardProps = PropsFromState & PropsFromDispatch & OwnProps & RouteComponentProps<BoardRouteMatchParams>;\n\ntype ImageUploadedListener = (imageName: string, imageUrl: string, width: number, height: number) => void;\ntype BoardLinkListener = (link: string) => void;\ntype TaskLinkListener = (link: string) => void;\n\nconst WHEEL_LISTENER = (e: WheelEvent) => {\n    if(e.ctrlKey) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n    }\n}\n\nclass MxGraphBoard extends Component<MxGraphBoardProps> {\n    private mxGraph: any;\n    private divGraph: React.RefObject<any>;\n    private divDimmer: React.RefObject<any>;\n    private editorUi: any;\n    private codec: any;\n    private initialized: boolean = false;\n    private mouseSync: RemoteMouseSync | undefined;\n    private boardSync: RealtimeBoardSync | undefined;\n    private boardAgent: BoardAgent | undefined;\n    private iioCody: IIO | undefined;\n    private lastFocusedCells: string = '';\n    private lastClicks: string|null = null;\n    private uploadOpenHandle: any;\n    private boardLinkHandle: any;\n    private taskLinkHandle: any;\n    private codyEngineWizardHandle: any;\n    private imageUploadedListener: null | ImageUploadedListener = null;\n    private boardLinkListener: null | BoardLinkListener = null;\n    private taskLinkListener: null | TaskLinkListener = null;\n    private setUsedGraph: (graph: IioGraph | undefined) => void;\n    private setUsedMouseSync: (mouseSync: MouseSync | undefined) => void;\n    private activeGraphElement: any;\n\n    // Internal copy of the Board passed via props, to modify copy when editing the board without rerendering of the component\n    private board: BoardModel.Board | undefined;\n\n    private mxGraphWrapper: IioGraph | undefined;\n\n    constructor(props: MxGraphBoardProps) {\n        super(props);\n        this.LoadGraph = this\n            .LoadGraph\n            .bind(this);\n\n        this.divGraph = React.createRef();\n        this.divDimmer = React.createRef();\n        this.codec = new mxCodec();\n        this.codec.lookup = (id: string) => {\n            const cell = this.editorUi.editor.graph.model.getCell(id);\n\n            if(!cell) {\n                return null;\n            }\n\n            return cell;\n        }\n\n        const [, setGraph] = useGraph();\n\n        this.setUsedGraph = setGraph;\n\n        const [, setMouseSync] = useMouseSync();\n\n        this.setUsedMouseSync = setMouseSync;\n    }\n\n    public componentDidMount() {\n        this.props.fetchUserBoard(this.props.match.params.uid);\n    }\n\n    public shouldComponentUpdate(nextProps: MxGraphBoardProps, nextState: any): boolean {\n        if(!this.board && nextProps.board && nextProps.user.name !== \"\") {\n            if(!nextProps.board.detailsFetched) {\n                // Fetching user board triggered in componentDidMount is not finished yet\n                return false;\n            }\n            this.initGraphBoard(nextProps);\n            return true;\n        }\n\n        if(this.board && this.board.uid !== nextProps.board.uid) {\n            // Back btn was used to navigate back to a linking board. The BoardRedirect component forces remounting of MxGraphBoard\n            nextProps.history.replace(Routes.BoardRedirect, {href: Routes.compileInspectioBoardWorkspace(nextProps.board.uid)});\n        }\n\n        if(this.editorUi && !this.board!.writeAccess && nextProps.board.writeAccess) {\n            // Disable read only mode\n            this.editorUi.editor.graph.setEnabled(true);\n        }\n\n        if(this.editorUi && this.props.liteMode !== nextProps.liteMode) {\n            this.setLiteMode(nextProps);\n        }\n\n        if(this.board && this.board.videoSessionActive !== nextProps.board.videoSessionActive) {\n            this.board = this.board.set('videoSessionActive', nextProps.board.videoSessionActive);\n            return true;\n        }\n\n        if(this.editorUi && nextProps.board.shouldImport) {\n            this.editorUi.actions.get('import').funct((graph: any) => {\n                const xml = mxUtils.getXml(this.editorUi.editor.getGraphXml());\n                this.board = this.board!.updateXml(xml, nextProps.user.uid);\n\n                nextProps.onBoardImported(nextProps.board.uid, this.board, deriveGraphFromMxgraph(this.editorUi.editor.graph, this.editorUi));\n            });\n            nextProps.onBoardImportStarted(this.board!.uid);\n        }\n\n        if(this.editorUi && nextProps.board.shouldExport) {\n            this.editorUi.actions.get('export').funct();\n            nextProps.onBoardExported(nextProps.board.uid);\n        }\n\n        if(this.editorUi) {\n            this.checkScrollToCells(nextProps);\n        }\n\n        return false;\n    }\n\n    public componentWillUnmount() {\n        if(this.editorUi) {\n            this.editorUi.destroy();\n        }\n        this.setUsedGraph(undefined);\n        this.mxGraphWrapper = undefined;\n        this.setUsedMouseSync(undefined);\n        document.body.style.overflow = 'auto';\n        document.body.classList.remove('workspace');\n        document.title = 'prooph board';\n\n        const activeUsers = document.getElementById('topmenuUsers');\n        if (activeUsers) {\n            activeUsers.innerHTML = '';\n        }\n\n        if(this.props.board) {\n            // Please note: this also resets the detailsFetched flag of the board to force the component to wait for\n            // fresh details fetched from server when user revisits the board within the same session\n            this.props.clearBoardHistory(this.props.board.uid);\n\n        }\n\n        if(this.boardSync) {\n            this.boardSync.stopSync();\n        }\n\n        if(this.mouseSync) {\n            this.mouseSync.stopSync({\n                userId: this.props.user.uid,\n                boardId: this.props.board.uid,\n            });\n        }\n\n        if(this.boardAgent) {\n            this.boardAgent.destroy();\n        }\n\n        if(this.iioCody) {\n            this.iioCody.onSyncRequired(undefined);\n            this.iioCody.disconnect();\n        }\n\n        window.removeEventListener('wheel', WHEEL_LISTENER);\n    }\n\n\n\n    public render() {\n        return (\n            <>\n                <div className=\"graph-container disable-user-select\" ref={this.divGraph} id=\"divGraph\" />\n                <div ref={this.divDimmer} >\n                    <Dimmer active={true} className=\"page\"><Loader size=\"large\">Loading Board</Loader></Dimmer>\n                </div>\n                {this.props.board && <MxGraphImageUpload boardId={this.props.board.uid}\n                                    openHandle={openHandle => this.uploadOpenHandle = openHandle}\n                                    onCancel={() => {\n                                        this.uploadOpenHandle(false);\n                                    }}\n                                    onFileUploaded={(imageName, imageUrl, width, height) => {\n                                        if(this.imageUploadedListener) {\n                                            this.imageUploadedListener(imageName, imageUrl, width, height);\n                                        }\n                                    }}\n                />}\n                {this.props.board && <MxGraphBoardLink boardId={this.props.board.uid}\n                                    openHandle={openHandle => this.boardLinkHandle = openHandle}\n                                    onCancel={() => {\n                                        this.boardLinkHandle(false);\n                                    }}\n                                    onLinkChosen={(link) => {\n                                        if(this.boardLinkListener) {\n                                            this.boardLinkListener(link);\n                                        }\n                                    }}\n                />}\n                {this.props.board && <MxGraphTaskLink\n                                   openHandle={openHandle => this.taskLinkHandle = openHandle}\n                                   onCancel={() => {\n                                       this.taskLinkHandle(false);\n                                   }}\n                                   onLinkChosen={(link) => {\n                                       if(this.taskLinkListener) {\n                                           this.taskLinkListener(link);\n                                       }\n                                   }}\n                />}\n                {this.props.board && <WizardModal\n                                    boardId={this.props.board.uid}\n                                    openHandle={openHandle => this.codyEngineWizardHandle = openHandle}\n                                    onClose={() => this.codyEngineWizardHandle(false, null)}\n                />}\n            </>\n        );\n    }\n\n    private initGraphBoard(props: MxGraphBoardProps) {\n        window.scroll(0,0);\n        document.body.style.overflow = 'hidden';\n        document.body.classList.add('workspace');\n        document.title = props.board.name + ' - prooph board';\n\n        // Override JSON handling to preserve comments\n        inspectioUtils.metadataToJSON = (metadata: string): object => {\n            if(!metadata) {\n                return {};\n            }\n\n            try {\n                return parse(metadata);\n            } catch (e) {\n                return {};\n            }\n        }\n\n        inspectioUtils.metadataJsonToString = (metadata: {[metaKey: string]: any}): string => {\n            if(!metadata) {\n                return \"{}\";\n            }\n\n            return stringify(metadata, null, 2);\n        }\n\n        this.mxGraph = mxFactory();\n        this.LoadGraph(props,{}, this.mxGraph);\n\n        this.board = props.board;\n    }\n\n    private saveBoard() {\n        if(this.board) {\n            this.props.saveBoard(this.board, deriveGraphFromMxgraph(\n                this.editorUi.editor.graph,\n                this.editorUi\n            ));\n        }\n    }\n\n    private LoadGraph(props: MxGraphBoardProps, data: any, mxGraph: any) {\n        const container = this.divGraph.current;\n\n        container.innerHTML = '';\n\n        mxUtils.alert = (e: string) => {\n            this.props.onError('Board Error', e);\n        };\n\n        // The first two cells always get the same ids, because they are internal cells (board root and model root)\n        // They are equal on all boards so that remote syncs work properly as well as imports and exports\n        let uuidPool = _.clone(MXGRAPH_ROOT_UUIDS);\n        const uuidT = shortUUID();\n\n        mxGraphModel.prototype.createId = (cell: any): string => {\n            const id = uuidPool.pop();\n\n            if(id) {\n                return id;\n            }\n\n            return uuidT.fromUUID(uuid.v4());\n        }\n\n        const editorUiInit = EditorUi.prototype.init;\n\n        EditorUi.prototype.init = function()\n        {\n            editorUiInit.apply(this, arguments);\n            this.actions.get('export').setEnabled(false);\n        };\n\n        // Adds required resources (disables loading of fallback properties, this can only\n        // be used if we know that all keys are defined in the language specific file)\n        mxResources.loadDefaultBundle = false;\n\n        const bundle = mxResources.getDefaultBundle(RESOURCE_BASE, mxLanguage) ||\n            mxResources.getSpecialBundle(RESOURCE_BASE, mxLanguage);\n\n        // Fixes possible asynchronous requests\n        mxGraph.mxUtils.getAll([bundle, STYLE_PATH + '/'+ispConst.THEME+'/style.xml'], (xhr: any) =>\n        {\n            // Adds bundle text to resources\n            mxResources.parse(xhr[0].getText());\n\n            // Configures the default graph theme\n            const themes: any = {};\n\n            themes[Graph.prototype.defaultThemeName] = xhr[1].getDocumentElement();\n\n            // Main\n            this.editorUi = new EditorUi(\n              new Editor(urlParams.chrome === '0', themes, undefined, undefined, true, props.board.eventModelingEnabled),\n              container,\n              false,\n              props.board.name,\n              'boardSidebarContainer',\n              props.board.eventModelingEnabled\n            );\n\n            initializeGraphEditor(\n                this.editorUi,\n                props.history,\n                copy,\n                Routes.makeWorkspaceDeeplinkFacory(props.board.uid),\n                (title, msg, type) => {\n                    if(type === 'info') {\n                        props.onInfo(title, msg);\n                    } else {\n                        props.onError(title, msg);\n                    }\n                }\n            );\n\n            this.attachImageUploadListener();\n            this.attachLinkBoardListener();\n            this.attachLinkTaskListener();\n            this.attachCodyEngineWizardListener();\n            this.attachImageReplaceListener();\n            this.attachCodySuggestionsListener();\n            this.attachChangeActiveGraphElementListener();\n            this.attachSyncLabelChangedListener();\n            this.attachLookupElementListener(props);\n            this.attachShowElementDetailsListener();\n            this.attachCellConnectedListener();\n            this.attachCodyListener();\n            this.initializeAutoSaveManager(props);\n            this.setLiteMode(props);\n            this.setCodySuggestEnabled(props);\n            this.setEventModelingEnabled(props);\n\n            if(props.board.xml) {\n                const graphDoc = mxUtils.parseXml(props.board.xml);\n                this.editorUi.editor.graph.model.beginUpdateWithoutChangeNotifications();\n                try {\n                    this.editorUi.editor.graph.enableLazyTextPaint();\n                    this.editorUi.editor.graph.importGraphModel(graphDoc.documentElement, undefined, undefined, undefined, false);\n                }\n                finally {\n                    this.editorUi.editor.graph.model.endUpdateWithoutChangeNotifications();\n                    this.editorUi.editor.graph.disableLazyTextPaint();\n                }\n\n                // Read only mode\n                this.editorUi.editor.graph.setEnabled(props.board.writeAccess);\n                this.editorUi.editor.graph.initContainerStyles();\n\n                this.editorUi.editor.graph.zoom(0.19, true, false, false);\n                this.editorUi.editor.graph.showAll();\n\n                if(props.location.search) {\n                    const params = new URLSearchParams(props.location.search);\n                    if(params.get('clicks')) {\n                        this.lastClicks = params.get('clicks');\n                    } else {\n                        this.lastClicks = '0';\n                    }\n                }\n\n                window.setTimeout(() => {\n                    this.initialized = true;\n\n                    this.setCodySuggestEnabled(this.props);\n                    this.setEventModelingEnabled(this.props);\n                    const cellsFocused = this.checkScrollToCells(props);\n                    this.checkPlayshotsModal(props);\n\n                    if(!cellsFocused) {\n                        this.editorUi.editor.graph.center();\n                    }\n\n                    this.divDimmer.current.innerHTML = '';\n                    this.initBoardAgent();\n\n                    this.setLiteMode(this.props);\n\n                    console.log(\"board wheel listener installed\");\n                    window.addEventListener('wheel', WHEEL_LISTENER, {passive: false});\n                }, props.location.search? 3000 : 1000);\n            } else {\n                this.initialized = true;\n                this.divDimmer.current.innerHTML = '';\n                this.initBoardAgent();\n                window.addEventListener('wheel', WHEEL_LISTENER, {passive: false});\n            }\n\n            this.editorUi.editor.graph.setDefaultParent(this.editorUi.editor.graph.model.getCell(MXGRAPH_ROOT_UUIDS[0]));\n            this.mxGraphWrapper = deriveGraphFromMxgraph(this.editorUi.editor.graph, this.editorUi);\n            this.setUsedGraph(this.mxGraphWrapper);\n\n            uuidPool = [];\n\n            if(!isStandalone()) {\n                this.initRealtimeBoardSync(props);\n            }\n\n            props.onBoardInitialized(props.board, deriveGraphFromMxgraph(\n                this.editorUi.editor.graph,\n                this.editorUi\n            ));\n\n            if(!isStandalone()) {\n                this.initMouseSync(props);\n            }\n\n            this.initCody();\n\n        })\n    }\n\n    private attachImageUploadListener (): void {\n        this.editorUi.editor.graph.onInsertImage((processImageUrl: (imgName: string, imgUrl: string, width: number, height: number) => void) => {\n            this.imageUploadedListener = (imgName: string, imgUrl: string, imgWidth: number, imgHeight: number) => {\n                processImageUrl(imgName, imgUrl, imgWidth, imgHeight);\n                this.uploadOpenHandle(false);\n                this.imageUploadedListener = null;\n            };\n            this.uploadOpenHandle(true);\n        });\n    }\n\n    private attachLinkBoardListener (): void {\n        this.editorUi.editor.graph.onLinkBoard((currentLink: null|string, processBoardLink: (boardLink: string) => void) => {\n            this.boardLinkListener = (boardLink: string) => {\n                processBoardLink(boardLink);\n                this.boardLinkHandle(false);\n                this.boardLinkListener = null;\n            };\n            this.boardLinkHandle(true, currentLink);\n        });\n    }\n\n    private attachLinkTaskListener (): void {\n        this.editorUi.editor.graph.onLinkTask((currentLink: null|string, processTaskLink: (taskLink: string) => void) => {\n            this.taskLinkListener = (taskLink: string) => {\n                processTaskLink(taskLink);\n                this.taskLinkHandle(false);\n                this.taskLinkListener = null;\n            };\n            this.taskLinkHandle(true, currentLink);\n        });\n    }\n\n    private attachCodyEngineWizardListener (): void {\n        this.editorUi.editor.graph.onCodyWizard((selectedCell: any, runCody?: boolean) => {\n            const deepLinkFactory = Routes.makeWorkspaceDeeplinkFacory(this.props.board!.uid);\n            this.codyEngineWizardHandle(\n              true,\n              new MxGraphElement(selectedCell, this.editorUi.editor.graph.getModel(), this.editorUi.editor.graph, deriveGraphFromMxgraph(this.editorUi.editor.graph, this.editorUi), false, deepLinkFactory),\n              runCody\n            );\n        });\n    }\n\n    private attachImageReplaceListener (): void {\n        this.editorUi.editor.graph.onReplaceImage((imageId: null|string, processImageUrl: (imgName: string, imgUrl: string, width: number, height: number) => void) => {\n            this.imageUploadedListener = (imgName, imgUrl: string, imgWidth, imgHeight) => {\n                processImageUrl(imgName, imgUrl, imgWidth, imgHeight);\n                this.uploadOpenHandle(false);\n                this.imageUploadedListener = null;\n            };\n            this.uploadOpenHandle(true, imageId);\n        });\n    }\n\n    private attachCodySuggestionsListener (): void {\n        this.editorUi.editor.graph.setUpdateCodySuggestionsCb((cell: any) => {\n            if(this.mxGraphWrapper) {\n                const graphNode = this.mxGraphWrapper.getNode(cell.getId());\n                if(graphNode) {\n                    initializeCodyGraphSuggestions(graphNode, this.props.board, this.mxGraphWrapper);\n                }\n            }\n        });\n    }\n\n    private attachChangeActiveGraphElementListener (): void {\n        this.editorUi.editor.graph.onChangeActiveGraphElement((\n            cell: any,\n            updateMetadata: (schema: string, force?: boolean) => void,\n            updateSimilarElements: (elementIds: string[], schema: string) => void,\n            replaceTags: (tags: string[]) => void\n        ) => {\n            if(!cell) {\n                this.activeGraphElement = undefined;\n                this.props.onActiveGraphElementChanged(this.props.board.uid, undefined);\n                return;\n            }\n\n            if(cell.isEdge()) {\n                let edgeLabel = 'Edge';\n                let edgeData;\n\n                if(cell.source && cell.target) {\n                    edgeLabel = inspectioUtils.getLabelText(cell.source) + ' -> ' + inspectioUtils.getLabelText(cell.target);\n                    edgeData = {\n                        source: cell.source.getId(),\n                        target: cell.target.getId(),\n                    };\n                }\n\n                this.props.onActiveGraphElementChanged(this.props.board.uid, {\n                    id: cell.getId(),\n                    type: NodeType.edge,\n                    label: edgeLabel,\n                    metadata: inspectioUtils.getMetadata(cell),\n                    edgeData,\n                    updateMetadata,\n                    updateSimilarElements,\n                    replaceTags,\n                    locked: !this.editorUi.editor.graph.isCellEnabled(cell)\n                });\n                return;\n            }\n\n            if(cell.isVertex()) {\n\n                this.props.onActiveGraphElementChanged(this.props.board.uid, {\n                    id: cell.getId(),\n                    type: inspectioUtils.isEventModel(cell)? HistoryCellType.swimlanes : inspectioUtils.getTypeInclEdge(cell) as NodeType,\n                    label: inspectioUtils.getLabelText(cell),\n                    metadata: inspectioUtils.getMetadata(cell),\n                    tags: inspectioUtils.getTags(cell),\n                    updateMetadata,\n                    updateSimilarElements,\n                    replaceTags,\n                    locked: !this.editorUi.editor.graph.isCellEnabled(cell)\n                });\n            }\n\n            this.clearGraphElementCache(cell.getId());\n            this.activeGraphElement = cell;\n        });\n    }\n\n    private attachSyncLabelChangedListener (): void {\n        this.editorUi.editor.graph.addListener(mxEvent.LABEL_CHANGED, (sender: any, evt: any) => {\n            const cell = evt.getProperty('cell');\n            if(cell.isVertex() && this.activeGraphElement && this.activeGraphElement.getId() === cell.getId()) {\n                this.clearGraphElementCache(cell.getId());\n                this.props.onActiveGraphElementLabelChanged(this.props.board.uid, cell.getId(), inspectioUtils.getLabelText(cell));\n            }\n        });\n    }\n\n    private syncActiveGraphElementWithRemoteChange (change: any): void {\n        if(change instanceof mxValueChange) {\n            const cell = change.cell;\n            if(cell && cell.isVertex() && this.activeGraphElement && this.activeGraphElement.getId() === cell.getId()) {\n                this.clearGraphElementCache(cell.getId());\n                this.props.onActiveGraphElementLabelChanged(this.props.board.uid, cell.getId(), inspectioUtils.getLabelText(cell));\n                this.props.onActiveGraphElementMetadataChanged(this.props.board.uid, cell.getId(), inspectioUtils.getMetadata(cell));\n            }\n        }\n    }\n\n    private attachLookupElementListener (props: MxGraphBoardProps): void {\n        this.editorUi.editor.graph.onLookupElement((elementLabel: string, elementType?: string) =>  {\n            if(elementType) {\n                elementLabel = `type:${elementType.toLowerCase()};${elementLabel}`;\n            }\n            props.filterElementsTree(props.board.uid, elementLabel, true)\n        });\n    }\n\n    private initializeAutoSaveManager (props: MxGraphBoardProps): void {\n        const mxAutoSaveGraphModelChanged = mxAutoSaveManager.prototype.graphModelChanged;\n\n        const localAutoSave = new mxAutoSaveManager(this.editorUi.editor.graph);\n\n        localAutoSave.autoSaveDelay = 1;\n        localAutoSave.autoSaveThrottle = 1;\n        localAutoSave.autoSaveThreshold = 1;\n        localAutoSave.graphModelChanged = (changes: any) => {\n            const nodes: any[] = [];\n\n\n            const sortedChanges = this.sortChanges(changes);\n\n            sortedChanges.forEach((change: any) => nodes.push(mxUtils.getXml(this.codec.encode(change))));\n\n            if(this.boardSync) {\n                this.board = this.board!.updateVersion(new BoardVersion({userId: props.user.uid, version: this.boardSync.currentVersion()}));\n            } else {\n                this.board = this.board!.updateVersion(new BoardVersion({userId: props.user.uid, version: this.board!.version.version + 1}));\n            }\n\n            const {action, type, label, cellId} = this.detectHistoryAttributesFromChanges(changes);\n\n            const boardChanged = BoardSync.localBoardChanged(\n                props.board.uid,\n                List(nodes),\n                this.boardSync? this.boardSync.currentVersion() : this.board!.version.version,\n                props.user.uid,\n                action,\n                type,\n                label,\n                cellId\n            );\n\n            if(this.boardSync) {\n                this.boardSync.publishChanges(boardChanged);\n            } else {\n                this.saveBoard();\n            }\n\n            this.syncChangesWithCody(boardChanged, changes).catch(err => console.error(err));\n\n            props.onLocalBoardChanged(boardChanged);\n\n            mxAutoSaveGraphModelChanged.call(localAutoSave, changes);\n        };\n    }\n\n    private setLiteMode (props: MxGraphBoardProps): void {\n        if(props.liteMode) {\n            this.editorUi.editor.graph.enableLiteMode();\n        } else {\n            this.editorUi.editor.graph.disableLiteMode();\n        }\n    }\n\n    private setCodySuggestEnabled (props: MxGraphBoardProps): void {\n        if(props.board) {\n            this.editorUi.editor.graph.setCodySuggestEnabled(props.board.codySuggestEnabled);\n        }\n    }\n\n    private setEventModelingEnabled (props: MxGraphBoardProps): void {\n        if(props.board) {\n            this.editorUi.editor.graph.setEventModelingEnabled(props.board.eventModelingEnabled);\n        }\n    }\n\n    private attachShowElementDetailsListener(): void {\n        this.editorUi.editor.graph.onShowMetadata((focusMetadataEditor: boolean, cell: any) => {\n            if(!this.props.board.shouldShowElementDetails || focusMetadataEditor) {\n                this.props.toggleElementDetails(this.props.board.uid, true, focusMetadataEditor);\n            } else if (cell) {\n                this.props.setSideBySideCell(cell.getId());\n            }\n\n        })\n    }\n\n    private attachCellConnectedListener(): void {\n        this.editorUi.editor.graph.addListener(mxEvent.CELL_CONNECTED, (sender: any, evt: any) => {\n            const isTarget = !evt.getProperty('source');\n            if(isTarget) {\n                window.setTimeout(() => {\n                    this.editorUi.editor.graph.setSelectionCell(evt.getProperty('terminal'));\n                }, 10);\n            }\n        });\n    }\n\n    private checkPlayshotsModal (props: MxGraphBoardProps) {\n        if(!this.initialized) {\n            return false;\n        }\n\n        if(props.board.xml && props.location.search) {\n            const params = new URLSearchParams(props.location.search);\n\n            if(params.has('playshots') && !props.board.shouldShowPlayshotModal) {\n                params.delete('playshots');\n                props.togglePlayshotModal(props.board.uid, true);\n            }\n        }\n    }\n\n    private checkScrollToCells (props: MxGraphBoardProps): boolean {\n        if(!this.initialized) {\n            return false;\n        }\n\n        let cellsFocused = false;\n\n        if(props.board.xml && props.location.search) {\n            const params = new URLSearchParams(props.location.search);\n\n            const graph = this.editorUi.editor.graph;\n            const cellsToFocus = params.get('cells');\n\n            if(cellsToFocus) {\n                if(this.lastFocusedCells === cellsToFocus && this.lastClicks === params.get('clicks')) {\n\n                    return  false;\n                }\n\n                const animateScroll = this.lastClicks !== null;\n\n                this.lastFocusedCells = cellsToFocus;\n                this.lastClicks = params.get('clicks');\n\n                const cellIds = cellsToFocus.split(\";\");\n                const cells: any[] = [];\n\n                cellIds.forEach(cellId => {\n                    const cell = graph.model.getCell(cellId);\n                    if(cell) {\n                        cells.push(cell);\n                    }\n                });\n\n                if(cells.length > 0) {\n                    graph.scrollCellsIntoView(cells, true, true, animateScroll);\n                    cellsFocused = true;\n\n                    // tslint:disable-next-line:radix\n                    if(parseInt(params.get('select') || '0') === 1) {\n                        graph.setSelectionCells(cells);\n                    }\n                }\n            }\n        }\n\n        return cellsFocused;\n    }\n\n    private attachCodySyncListener (): void {\n        if(this.iioCody) {\n            this.iioCody.onSyncRequired(async () => {\n                if(this.iioCody) {\n                    const graph = this.editorUi.editor.graph;\n                    const editorUi = this.editorUi;\n                    const cells = graph.getAllVertexElementsOfActiveLayer();\n                    let chunk: Node[] = [];\n                    const deepLinkFactory = Routes.makeWorkspaceDeeplinkFacory(this.props.board!.uid);\n\n                    if(cells && Array.isArray(cells)) {\n                        for(const cell of cells) {\n                            chunk.push(...flattenNodeChildren([new MxGraphElement(cell, graph.getModel(), graph, deriveGraphFromMxgraph(graph, editorUi), false, deepLinkFactory)]))\n                            if(chunk.length >= 10) {\n                                const syncSuccess = await this.iioCody!.syncNodes(this.props.board.uid, chunk);\n                                if(!syncSuccess) {\n                                    return;\n                                }\n\n                                chunk = [];\n                            }\n                        }\n\n                        if(chunk.length > 0) {\n                            const syncLastChunkSuccess = await this.iioCody!.syncNodes(this.props.board.uid, chunk);\n                            if(!syncLastChunkSuccess) {\n                                return false;\n                            }\n                        }\n                    }\n\n                    this.iioCody.syncFinished();\n                }\n            })\n        }\n    }\n\n    private attachCodyListener (): void {\n        const graph = this.editorUi.editor.graph;\n        graph.onTriggerCody((cells: any[]) => {\n            if(this.props.board && !this.props.board.shouldShowCodyConsole) {\n                this.props.toggleCodyConsole(this.props.board.uid, true);\n            }\n\n            if(this.iioCody) {\n                const nodes = cells.map(cell => this.makeGraphElement(cell));\n                this.iioCody.trigger.Cody(\n                  this.props.board.uid,\n                  this.props.board.name,\n                  this.props.user.uid,\n                  flattenNodeChildren(nodes).filter(node => node.getType() !== NodeType.edge)\n                );\n            }\n        })\n\n        graph.onMergeSchema((sourceCell: any, targetCell: any) => {\n            if(this.mxGraphWrapper) {\n                this.mxGraphWrapper.mergeIntoSchema(\n                  this.makeGraphElement(sourceCell),\n                  this.makeGraphElement(targetCell)\n                )\n            }\n        });\n    }\n\n    private makeGraphElement(cell: any): MxGraphElement {\n        const graph = this.editorUi.editor.graph;\n        return new MxGraphElement(cell, graph.getModel(), graph, deriveGraphFromMxgraph(graph, this.editorUi), false, Routes.makeWorkspaceDeeplinkFacory(this.props.board!.uid));\n    }\n\n    private clearGraphElementCache(cellId: string) {\n        const graph = this.editorUi.editor.graph;\n        const node = deriveGraphFromMxgraph(graph, this.editorUi).getNode(cellId);\n\n        if(node && node instanceof MxGraphElement) {\n            node.setPotentiallyStale();\n        }\n    }\n\n    private initRealtimeBoardSync(props: MxGraphBoardProps) {\n        this.boardSync = new RealtimeBoardSync(\n            socket,\n            props.board,\n            props.user.uid,\n            props.user.displayName,\n            (boardChanged, syncInitialized) => {\n                const changes: any[] = [];\n\n                if(boardChanged.action === HistoryAction.added && this.editorUi.editor.graph.model.getCell(boardChanged.cellId)) {\n                    console.log(\"[BoardSync] skipping patch, because it wants to add a cell that already exists: \", boardChanged.toJS());\n                    return;\n                }\n\n                boardChanged.changeSet.forEach(patch => {\n                    const node = mxUtils.parseXml(patch);\n                    const change = this.codec.decode(node.documentElement);\n                    change.model = this.editorUi.editor.graph.model;\n                    change.execute();\n                    changes.push(change);\n                    this.syncActiveGraphElementWithRemoteChange(change);\n                });\n\n                const edit = new mxUndoableEdit(this.editorUi.editor.graph.model, false);\n                edit.changes = changes;\n\n                edit.notify = () =>\n                {\n                    edit.source.fireEvent(new mxEventObject(mxEvent.CHANGE,\n                        'edit', edit, 'changes', edit.changes));\n\n                }\n\n                this.editorUi.editor.graph.model.fireEvent(new mxEventObject(mxEvent.CHANGE,\n                    'edit', edit, 'changes', changes));\n\n                this.syncChangesWithCody(boardChanged, changes).catch(err => console.error(err));\n\n                console.log(\"[BoardSync] Applied remote board change: \", boardChanged.toBoardVersion().version);\n\n                this.board = this.board!.updateVersion(new BoardVersion({userId: props.user.uid, version: this.boardSync!.currentVersion()}));\n\n                props.onLocalBoardUpdatedWithRemoteChange(this.board.uid, this.board, deriveGraphFromMxgraph(this.editorUi.editor.graph, this.editorUi));\n\n                if(syncInitialized) {\n                    // If sync is not initialized, the patch is not a new remote change, but only a patch newer than latest snapshot\n                    props.onRemoteBoardChanged(boardChanged);\n                }\n            },\n            () => {\n                this.board = this.board!.updateVersion(new BoardVersion({userId: props.user.uid, version: this.boardSync!.currentVersion()}));\n                this.saveBoard();\n            }\n        );\n\n        this.boardSync.startSync();\n    }\n\n    private initBoardAgent() {\n        if(!isStandalone()) {\n            console.log(\"[BoardAgent] Init board agent\")\n            this.boardAgent = new BoardAgent(deriveGraphFromMxgraph(this.editorUi.editor.graph, this.editorUi), socket);\n            this.boardAgent.startWatching();\n        }\n    }\n\n    private initCody() {\n        this.iioCody = IIO;\n        this.attachCodySyncListener();\n    }\n\n    private initMouseSync(props: MxGraphBoardProps) {\n        let topMenuHeight = 0;\n        const graph = this.editorUi.editor.graph;\n        const topMenu = document.getElementById('topmenu');\n\n        if(topMenu) {\n            topMenuHeight = topMenu.clientHeight;\n        }\n\n        this.mouseSync = new RemoteMouseSync(socket, this.divGraph.current, graph, (point) => {\n            const scale = graph.view.scale;\n            const tr = graph.view.translate;\n\n            const x = (point.x + tr.x) * scale;\n            const y = (point.y + tr.y) * scale + topMenuHeight;\n\n            return {x,y};\n        });\n\n        this.mouseSync.onUserJoined((userId, name, avatar, color) => this.addActiveUser(props, userId, name, avatar, color));\n        this.mouseSync.onUserLeft(userId => this.removeActiveUser(userId));\n\n        this.mouseSync.startSync({\n            userId: props.user.uid,\n            name: props.user.displayName,\n            avatar: props.user.avatarUrl,\n            boardId: props.board.uid,\n        });\n\n        graph.addListener(mxEvent.FIRE_MOUSE_EVENT, (sender: any, evt: any) => {\n            const evtName = evt.getProperty('eventName');\n            const me = evt.getProperty('event');\n\n            if(!me) {\n                return;\n            }\n\n            const scale = graph.view.scale;\n            const tr = graph.view.translate;\n            const x = me.getGraphX() / scale - tr.x;\n            const y = me.getGraphY() / scale - tr.y;\n\n            if(evtName === mxEvent.MOUSE_MOVE && this.mouseSync && !graph.panningHandler.isActive() && !graph.panningHandler.physicsActive) {\n                this.mouseSync.emitUserMouseMove(   {\n                    userId: props.user.uid,\n                    boardId: props.board.uid,\n                    point: {x,y},\n                    vT: tr,\n                    scale,\n                    isPanning: false,\n                })\n            }\n        });\n\n        graph.addListener(graph.EVT_USER_IS_PANNING, (sender: any, evt: any) => {\n            if(this.mouseSync) {\n                const me = evt.getProperty('me');\n                const scale = evt.getProperty('scale');\n                const tr = evt.getProperty('translate');\n                const mouseDelta = evt.getProperty('mouseDelta');\n\n                if(!me) {\n                    return;\n                }\n\n                const x = me.getGraphX() / scale - tr.x;\n                const y = me.getGraphY() / scale - tr.y;\n\n                this.mouseSync.emitUserMouseMove({\n                    userId: props.user.uid,\n                    boardId: props.board.uid,\n                    point: {x,y},\n                    vT: tr,\n                    scale,\n                    isPanning: true,\n                }, mouseDelta)\n            }\n        });\n\n        graph.addListener(graph.EVT_PANNING_PHYSICS_CLEARED, () => {\n            if(this.mouseSync) {\n                this.mouseSync.syncLastKnownAbsolutePointsAfterPanning();\n            }\n        })\n\n\n        graph.addListener(graph.EVT_USER_IS_ZOOMING, (sender: any, evt: any) => {\n            this.mouseSync!.emitUserMouseScroll({\n                userId: props.user.uid,\n                boardId: props.board.uid,\n                vT: graph.view.translate,\n                scale: graph.view.scale,\n            })\n        });\n\n        graph.addListener(graph.EVT_USER_IS_TYPING, (sender: any, evt: any) => {\n            const isTyping = evt.getProperty('typing');\n            this.mouseSync!.emitUserGestureChanged({\n                userId: props.user.uid,\n                boardId: props.board.uid,\n                gesture: isTyping? Gesture.Typing : Gesture.Default,\n            });\n        });\n\n        graph.addListener(graph.EVT_USER_IS_MOVING, (sender: any, evt: any) => {\n            const isMoving = evt.getProperty('moving');\n            this.mouseSync!.emitUserGestureChanged({\n                userId: props.user.uid,\n                boardId: props.board.uid,\n                gesture: isMoving? Gesture.Moving : Gesture.Default,\n            });\n        });\n\n        graph.addListener(graph.EVT_USER_IS_AUTO_SCROLLING, (sender: any, evt: any) => {\n           if(this.mouseSync) {\n               this.mouseSync.emitUserIsAutoScrolling({\n                   userId: props.user.uid,\n                   boardId: props.board.uid,\n                   scale: evt.getProperty('scale'),\n                   translate: evt.getProperty('translate'),\n                   isPanning: evt.getProperty('isPanning'),\n               });\n           }\n        });\n\n        this.setUsedMouseSync(this.mouseSync);\n    }\n\n    private addActiveUser(props: MxGraphBoardProps, userId: UserModel.UserId, name: UserModel.DisplayName, avatar: UserModel.AvatarUrl, color: string) {\n        if(userId === props.user.uid) {\n            return;\n        }\n\n        console.log(\"[mousesync] Adding active user to topmenu: \", userId);\n        const topMenuUsers = document.getElementById('topmenuUsers');\n\n        const item = document.createElement('div');\n        item.classList.add('item');\n\n        const obsClass = 'observable';\n\n        const label = document.createElement('div');\n        label.id = 'topmenuUsers-' + userId;\n        label.classList.add('ui', 'circular', 'label', obsClass, 'user');\n        label.style.backgroundColor = color;\n\n        label.style.backgroundSize = 'cover';\n        if(avatar !== \"\"){\n            label.style.backgroundImage = \"url('\"+avatar+\"')\";\n        } else {\n            label.innerText = name[0].toUpperCase();\n        }\n        label.setAttribute('data-tooltip', name);\n        label.setAttribute('data-position', 'bottom center');\n\n        label.addEventListener('click', e => this.toggleObserveUser(e.target!));\n\n        item.append(label);\n        topMenuUsers!.append(item);\n    }\n\n    private removeActiveUser(userId: UserModel.UserId): void {\n        console.log(\"[mousesync] Removing active user from topmenu: \", userId);\n        const label = document.getElementById('topmenuUsers-'+userId);\n\n        if(label) {\n            label.parentElement!.remove();\n        }\n    }\n\n    private toggleObserveUser(label: EventTarget) {\n        if(label instanceof HTMLElement) {\n            if(label.classList.contains('observed')) {\n                label.classList.remove('observed');\n                this.mouseSync!.stopObservingUser();\n            } else {\n                this.unsetCurrentObservedUser();\n                this.mouseSync!.stopObservingUser();\n                label.classList.add('observed');\n                this.mouseSync!.observeUser(this.getUserIdFromLabelId(label.id))\n            }\n        }\n    }\n\n    private unsetCurrentObservedUser() {\n        const topMenuUsers = document.getElementById('topmenuUsers');\n\n        topMenuUsers!.childNodes.forEach(child => {\n            if(child.firstChild instanceof HTMLElement) {\n                child.firstChild.classList.remove('observed');\n            }\n        })\n    }\n\n    private getUserIdFromLabelId(labelId: string): UserModel.UserId {\n        return labelId.replace('topmenuUsers-', '');\n    }\n\n    private syncChangesWithCody = async (transaction: BoardChanged, changes: any[]): Promise<void> => {\n        if(!this.iioCody || !this.iioCody.syncRequired()) {\n            console.log(\"Skipping sync with cody, because no server is listening for syncs at the moment\", transaction)\n            return;\n        }\n\n        console.log(\"syncing changes with cody\", transaction.toJS());\n\n        const graph = this.editorUi.editor.graph;\n        const editorUi = this.editorUi;\n        const wrapper = deriveGraphFromMxgraph(graph, editorUi);\n        const boardId = this.props.board.uid;\n        const deepLinkFactory = Routes.makeWorkspaceDeeplinkFacory(boardId);\n\n        if(transaction.action === HistoryAction.deleted) {\n            const deletedCellIds: string[] = [];\n            const deletedEdges: any[] = [];\n            for(const change of changes) {\n                const deletedCell = change.child;\n\n                if(deletedCell) {\n                    if(inspectioUtils.getTypeInclEdge(deletedCell) === HistoryCellType.edge) {\n                        deletedEdges.push(deletedCell);\n                        continue;\n                    }\n\n                    const deletedCells = graph.getVerticesTree(deletedCell);\n\n                    deletedCellIds.push(...deletedCells.map((cell: any) => cell.getId()));\n\n                    if(deletedCells.length) {\n                        await this.iioCody!.syncDeletedNodes(boardId, deletedCells.map(\n                            (cell: any) => new MxGraphElement(cell, graph.getModel(), graph, wrapper, false, deepLinkFactory)\n                            )\n                        )\n                    }\n                }\n            }\n\n            for(const deletedEdge of deletedEdges) {\n                const edgeNodes = [];\n                if(deletedEdge.source && !deletedCellIds.includes(deletedEdge.source.getId())) {\n                    edgeNodes.push(new MxGraphElement(deletedEdge.source, graph.getModel(), graph, wrapper, false, deepLinkFactory));\n                }\n                if(deletedEdge.target && !deletedCellIds.includes(deletedEdge.target.getId())) {\n                    edgeNodes.push(new MxGraphElement(deletedEdge.target, graph.getModel(), graph, wrapper, false, deepLinkFactory));\n                }\n                if(edgeNodes.length) {\n                    await this.iioCody!.syncChangedNodes(boardId, edgeNodes)\n                }\n            }\n\n            return;\n        } // End of HistoryAction.deleted\n\n        if(!transaction.cellId) {\n            console.log(\"no cellId given for transaction\")\n            return;\n        }\n\n        const transactionCellIds = transaction.cellId.split(\";\");\n        const effectedCells: Node[] = [];\n        const effectedCellIds: string[] = [];\n\n        for(const cellId of transactionCellIds) {\n            const cell = graph.model.getCell(cellId);\n\n            if(!cell) {\n                console.log(\"skipping cellId, cause not found in graph model\", cellId)\n                continue;\n            }\n\n            if(inspectioUtils.getTypeInclEdge(cell) === HistoryCellType.edge) {\n                console.log(\"change effected edge\", cell);\n                if(cell.source && !effectedCellIds.includes(cell.source.getId())) {\n                    console.log(\"adding edge source to effected cells\");\n                    effectedCellIds.push(cell.source.getId());\n                    effectedCells.push(new MxGraphElement(cell.source, graph.getModel(), graph, wrapper, false, deepLinkFactory));\n                }\n\n                if(cell.target && !effectedCellIds.includes(cell.target.getId())) {\n                    console.log(\"adding edge target to effected cells\")\n                    effectedCellIds.push(cell.target.getId());\n                    effectedCells.push(new MxGraphElement(cell.target, graph.getModel(), graph, wrapper, false, deepLinkFactory));\n                }\n\n                continue;\n            }\n\n            if(!graph.isVertex(cell)) {\n                const vertexChildren = graph.getVerticesTree(cell);\n\n                for(const vertexChild of vertexChildren) {\n                    if(!effectedCellIds.includes(vertexChild.getId())) {\n                        effectedCellIds.push(vertexChild.getId());\n                        effectedCells.push(new MxGraphElement(vertexChild, graph.getModel(), graph, wrapper, false, deepLinkFactory));\n                    }\n                }\n\n                continue;\n            }\n\n            if(!effectedCellIds.includes(cell.getId())) {\n                effectedCellIds.push(cell.getId());\n                effectedCells.push(new MxGraphElement(cell, graph.getModel(), graph, wrapper, false, deepLinkFactory));\n            }\n        }\n\n        await this.iioCody!.syncChangedNodes(boardId, effectedCells)\n    }\n\n    private sortChanges(changes: any[]): any[] {\n        if(changes.length <= 1) {\n            return changes;\n        }\n\n        const otherChanges: any[] = [];\n        const edgeChanged: any[] = [];\n\n        changes.forEach((change) => {\n            if(change instanceof mxGeometryChange) {\n                // Workaround for mxGraph bug, newly created edges have edge = true, after xml serialization it's edge = 1\n                if(change.cell.edge === 1 || change.cell.edge === true) {\n                    edgeChanged.push(change);\n                } else {\n                    otherChanges.push(change);\n                }\n            } else if(change instanceof mxChildChange) {\n                if(change.child.edge === 1 || change.child.edge === true) {\n                    edgeChanged.push(change);\n                } else {\n                    otherChanges.push(change);\n                }\n            } else {\n                otherChanges.push(change);\n            }\n        });\n\n        otherChanges.push(...edgeChanged);\n        return otherChanges;\n    }\n\n    private detectHistoryAttributesFromChanges(changes: any[]): {action: HistoryAction, type: HistoryCellType, label: string, cellId?: string} {\n        changes = this.filterOutMxStyleChange(changes);\n\n        // Sticky added via Board Agent (graph.importCells())\n        if(changes.length === 2 && changes[0] instanceof mxGeometryChange && changes[1] instanceof mxChildChange) {\n            return {\n                action: changes[1].previous === null? HistoryAction.added : HistoryAction.moved,\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[1])\n            }\n        }\n\n        // Sticky added or moved out of container\n        if(changes.length === 3 && changes[0] instanceof mxGeometryChange\n            && changes[1] instanceof mxGeometryChange && changes[2] instanceof mxChildChange) {\n            return {\n                action: changes[2].previous === null? HistoryAction.added : HistoryAction.moved,\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[2])\n            }\n        }\n\n        // Element moved\n        if(changes.length === 1 && changes[0] instanceof mxGeometryChange) {\n            return {\n                action: HistoryAction.moved,\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[0])\n            }\n        }\n\n        // Element deleted\n        if(changes.length === 1 && changes[0] instanceof mxChildChange && changes[0].parent === null) {\n            return  {\n                action: HistoryAction.deleted,\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[0])\n            }\n        }\n\n        // Element edited\n        if(changes.length === 1 && changes[0] instanceof mxValueChange) {\n            return  {\n                action: HistoryAction.edited,\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[0])\n            }\n        }\n\n        // Element edited and autosized\n        if(changes.length === 2 && changes[0] instanceof mxValueChange && changes[1] instanceof mxGeometryChange) {\n            return  {\n                action: HistoryAction.edited,\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[0])\n            }\n        }\n\n        // Edge added (source and target have different parents -> 4 changes, source and target have same parent -> 5 changes, different parents, but same grand parent -> 6 changes)\n        if((changes.length >= 4) && changes[1] instanceof mxTerminalChange && changes[2] instanceof mxTerminalChange) {\n            return  {\n                action: HistoryAction.added,\n                // First change is the new edge added to the board\n                ...this.detectHistoryCellTypeAndLabelFromChange(changes[0])\n            }\n        }\n\n        // All moved\n        let allMoved = true;\n        let cellIds: string[] = [];\n\n        changes.forEach(change => {\n            if(!(change instanceof mxGeometryChange)) {\n                allMoved = false;\n            } else {\n                cellIds.push(change.cell.id);\n            }\n        });\n\n        if(allMoved) {\n            return {\n                action: HistoryAction.moved,\n                type: HistoryCellType.multiple,\n                label: '',\n                cellId: cellIds.join(\";\")\n            }\n        }\n\n        // All deleted\n        let allDeleted = true;\n        cellIds = [];\n\n        changes.forEach(change => {\n            if(!(change instanceof mxChildChange && change.parent === null)) {\n                allDeleted = false;\n            } else {\n                cellIds.push(change.child.id);\n            }\n        });\n\n        if(allDeleted) {\n            return {\n                action: HistoryAction.deleted,\n                type: HistoryCellType.multiple,\n                label: '',\n                cellId: cellIds.join(\";\")\n            }\n        }\n\n        // All added to container\n        let allAddedToContainer = true;\n        let parent: any = null;\n\n        changes.forEach((change, i) => {\n            if(i % 2 === 0) {\n                if(!(change instanceof mxChildChange && changes[i+1] instanceof mxGeometryChange\n                    && ((parent === null || parent === change.parent) || change.child.edge === 1) // <-- Edge parent is not the container\n                    && (inspectioUtils.isContainer(change.parent) || change.child.edge === 1))) {\n                    allAddedToContainer = false;\n                } else {\n                    if(change.child.edge !== 1) {\n                        parent = change.parent;\n                    }\n                }\n            }\n        });\n\n        if(parent && allAddedToContainer) {\n            return {\n                action: HistoryAction.edited,\n                type: inspectioUtils.getTypeInclEdge(parent) || HistoryCellType.misc,\n                label: inspectioUtils.getLabelText(parent),\n                cellId: parent.id\n            }\n        }\n\n        // Container deleted that contains edges\n        if(changes[changes.length -1] instanceof mxChildChange && changes[changes.length - 1].parent === null) {\n            const deletedContainer = changes[changes.length -1].child;\n            return {\n                action: HistoryAction.deleted,\n                type: inspectioUtils.getTypeInclEdge(deletedContainer) || HistoryCellType.misc,\n                label: inspectioUtils.getLabelText(deletedContainer),\n                cellId: deletedContainer.id\n            }\n        }\n\n        // All moved out of container\n        let allMovedOutOfContainer = true;\n        cellIds = [];\n\n        changes.forEach((change, i) => {\n            if(!(change instanceof mxGeometryChange || change instanceof mxChildChange)) {\n                allMovedOutOfContainer = false;\n            } else {\n                if(change instanceof mxGeometryChange) {\n                    cellIds.push(change.cell.id);\n                }\n            }\n        });\n\n        if(allMovedOutOfContainer) {\n            return {\n                action: HistoryAction.moved,\n                type: HistoryCellType.multiple,\n                label: '',\n                cellId: cellIds.join(\";\")\n            }\n        }\n\n        // Default\n        return {\n            action: HistoryAction.edited,\n            type: HistoryCellType.misc,\n            label: '',\n        };\n    }\n\n    private detectHistoryCellTypeAndLabelFromChange(change: any): {type: HistoryCellType, label: string, cellId?: string} {\n        let type: HistoryCellType | boolean = false;\n        let label: string = '';\n        let cellId: undefined;\n\n        if(change.cell) {\n            type = inspectioUtils.getTypeInclEdge(change.cell);\n            label = inspectioUtils.getLabelText(change.cell);\n            cellId = change.cell.id;\n        } else if(change.child) {\n            type = inspectioUtils.getTypeInclEdge(change.child);\n            label = inspectioUtils.getLabelText(change.child);\n            cellId = change.child.id;\n        }\n\n        if(!type) {\n            type = HistoryCellType.misc;\n        }\n\n        return {\n            type,\n            label,\n            cellId,\n        }\n    }\n\n    private filterOutMxStyleChange(changes: any[]): any[] {\n        return changes.filter(change => !(change instanceof mxStyleChange));\n    }\n}\n\nexport default MxGraphBoard;\n","import * as H from 'history';\nimport copy from \"copy-to-clipboard\";\n\ninterface EditorUi {\n    editor: Editor;\n}\n\ninterface Editor {\n    graph: Graph;\n}\n\ninterface Graph {\n    setHistory: (history: H.History) => void;\n    enableCopyToClipboard: (copy: CopyToClipboardApi) => void;\n    setDeeplinkFactory: (factory: WorkspaceDeeplinkFactory) => void;\n    enableNotifications: (func: Notify) => void;\n}\n\ntype CopyToClipboardApi = typeof copy;\n\ntype WorkspaceDeeplinkFactory = (cellId: string) => string;\n\ntype Notify = (title: string, msg: string, type: 'info' | 'error') => void;\n\nexport const initializeGraphEditor = (\n    editorUi: EditorUi,\n    history: H.History<any>,\n    copyApi: CopyToClipboardApi,\n    deeplinkFactory: WorkspaceDeeplinkFactory,\n    notifyFunc: Notify,\n) => {\n    const graph = editorUi.editor.graph;\n\n    graph.setHistory(history);\n    graph.enableCopyToClipboard(copyApi);\n    graph.setDeeplinkFactory(deeplinkFactory);\n    graph.enableNotifications(notifyFunc);\n};\n\n\n\n\n","import {connect} from \"react-redux\";\nimport {bindActionCreators, Dispatch} from \"redux\";\nimport {setSideBySideCell} from \"../../Layout/actions/commands\";\nimport { Action as Notification } from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\nimport {default as MxGraphBoard} from \"../components/MxGraphBoard\";\nimport {BoardSelector} from \"../selectors\";\n\nconst mapStateToProps = BoardSelector.makeMapStateToPropsMxGraphBoard();\n\nconst mapDispatchToProps = (dispatch: Dispatch) => bindActionCreators(\n    {\n        fetchUserBoard: Action.Query.fetchUserBoard,\n        onError: Notification.Command.error,\n        onInfo: Notification.Command.info,\n        saveBoard: Action.Command.saveBoard,\n        clearBoardHistory: Action.Command.clearBoardHistory,\n        onBoardImportStarted: Action.Event.boardImportStarted,\n        onBoardImported: Action.Event.boardImported,\n        onBoardExported: Action.Event.boardExported,\n        onBoardInitialized: Action.Event.boardInitialized,\n        onLocalBoardChanged: Action.Event.localBoardChanged,\n        onRemoteBoardChanged: Action.Event.remoteBoardChanged,\n        onLocalBoardUpdatedWithRemoteChange: Action.Event.localBoardUpdatedWithRemoteChange,\n        filterElementsTree: Action.Command.filterElementsTree,\n        onActiveGraphElementChanged: Action.Event.activeGraphElementChanged,\n        onActiveGraphElementLabelChanged: Action.Event.activeGraphElementLabelChanged,\n        onActiveGraphElementMetadataChanged: Action.Event.activeGraphElementMetadataChanged,\n        toggleElementDetails: Action.Command.toggleElementDetails,\n        toggleCodyConsole: Action.Command.toggleCodyConsole,\n        togglePlayshotModal: Action.Command.togglePlayshotModal,\n        setSideBySideCell,\n    },\n    dispatch,\n);\n\nconst MxGraphBoardContainer = connect(mapStateToProps, mapDispatchToProps, undefined, {pure: false})(MxGraphBoard);\n\nexport default MxGraphBoardContainer;\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {BoardPermissionForTeam} from \"../model/BoardPermissionForTeam\";\nimport {makeBoardPermissionForTeamSelector} from \"../selectors/boardPermission\";\n\ntype Command = ActionType<typeof Action.Command.adminChangeTeamBoardPermissions>\n\nfunction* handleAdminChangeTeamBoardPermissions(command: Command) {\n    let boardPermission: BoardPermissionForTeam = yield select(makeBoardPermissionForTeamSelector(command.payload.boardId, command.payload.teamId));\n\n    if(boardPermission) {\n        boardPermission = boardPermission.changePermissions(command.payload.permissions);\n\n        const {response, error} = yield call(Action.Api.adminChangeTeamBoardPermissions, command.payload.boardId, command.payload.teamId, command.payload.permissions);\n\n        if(error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not change team permissions.'));\n        }\n\n        if(response) {\n            yield put(Action.Event.teamBoardPermissionsChanged(boardPermission));\n            yield put(NotifyAction.Command.info('Permissions Changed', 'Team permissions changed successfully.'));\n        }\n    }\n}\n\nexport function* adminChangeTeamBoardPermissions() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.ADMIN_CHANGE_TEAM_BOARD_PERMISSIONS\n        ]);\n\n        yield fork(handleAdminChangeTeamBoardPermissions, command);\n    }\n}","import {call, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\n\ntype FlowAction = ActionType<typeof Action.Command.changeBoardAbbreviation>\n\nexport function* changeBoardAbbreviationFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.CHANGE_BOARD_ABBREVIATION]);\n\n        const {response, error}: ResponseType = yield call(Action.Api.changeBoardAbbreviation, action.payload.board.uid, action.payload.board.nameAbbreviation);\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not change abbr.'));\n            yield put(Action.Query.fetchUserBoards());\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info('Abbreviation changed', ''));\n        }\n    }\n}\n","import { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from '../actions';\n\ntype FlowAction = ActionType<typeof Action.Command.changeBoardPermissions>;\n\nconst onChangeBoardPermissions = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(\n        Action.Api.changeBoardPermissions,\n        action.payload.boardId,\n        action.payload.userId,\n        action.payload.permissions\n    );\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Failed changing the board permissions.'));\n    }\n\n    if(response) {\n        yield put(NotifyAction.Command.info(\n            'Permissions Changed',\n            'Board permissions were changed successfully.'\n        ));\n\n        yield put(Action.Event.boardPermissionsChanged(\n            action.payload.boardId,\n            action.payload.userId,\n            action.payload.permissions)\n        );\n    }\n};\n\nexport function* changeBoardPermissionsFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.CHANGE_BOARD_PERMISSIONS\n        ]);\n\n        yield fork(onChangeBoardPermissions, action);\n    }\n}","import {call, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\n\ntype FlowAction = ActionType<typeof Action.Command.changeResponsibleTeam>\n\nexport function* changeResponsibleTeamFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.CHANGE_RESPONSIBLE_TEAM]);\n\n        const {response, error}: ResponseType = yield call(Action.Api.changeResponsibleTeam, action.payload.board.uid, action.payload.board.responsibleTeam);\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not change responsible team.'));\n            yield put(Action.Query.fetchUserBoards());\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info('Responsible team changed', ''));\n        }\n    }\n}\n","import {fromJS, List, Map} from \"immutable\";\nimport {BoardModel, BoardVersioning} from \"../InspectioBoards\";\n\nconst KEY_BOARDS = '@@Inspectio/Boards';\nconst KEY_BOARD = '@@Inspectio/Board/:id';\nconst KEY_CODY_CONSOLE_HISTORY = '@@Inspectio/CodyConsole';\nconst DEFAULT_BOARD_STATE_VERSION = 0;\nexport const CURRENT_BOARD_STATE_VERSION = 1;\n\nconst boardKey = (boardUid: string): string => {\n    return KEY_BOARD.replace(\":id\", boardUid)\n}\n\nconst loadBoardList = (): List<string> => {\n    const boardsJson = localStorage.getItem(KEY_BOARDS);\n\n    if(boardsJson === null) {\n        return List();\n    }\n\n    return fromJS(JSON.parse(boardsJson));\n}\n\nexport const loadInspectioBoards = (onErr: (err: any) => void): Map<string, BoardModel.Board> => {\n    try {\n\n        const boardsList: List<string> = loadBoardList();\n\n        let boards = Map<string, BoardModel.Board>();\n\n        boardsList.forEach(boardUid => {\n           const boardJson = localStorage.getItem(boardKey(boardUid));\n\n           if(boardJson !== null) {\n               let boardData = JSON.parse(boardJson);\n               let version = DEFAULT_BOARD_STATE_VERSION;\n\n               if(boardData.hasOwnProperty('__state')) {\n                   version = boardData.__version;\n                   boardData = boardData.__state;\n               }\n\n               boardData = migrateBoardState(boardData, version);\n\n               boards = boards.set(boardUid, new BoardModel.Board(boardData));\n           }\n        });\n\n        return boards;\n    } catch (err) {\n        onErr(err);\n    }\n\n    return Map();\n};\n\nexport const saveInspectioBoard = (board: BoardModel.Board, onErr: (err: any) => void): void => {\n    try {\n        let boardList = loadBoardList();\n\n        if(!boardList.includes(board.uid)) {\n            boardList = boardList.push(board.uid);\n\n            localStorage.setItem(KEY_BOARDS, JSON.stringify(boardList.toJSON()));\n        }\n\n        const boardDoc = {\n            __state: board.toJSON(),\n            __version: CURRENT_BOARD_STATE_VERSION,\n        }\n\n        localStorage.setItem(boardKey(board.uid), JSON.stringify(boardDoc));\n    } catch (err) {\n        onErr(err);\n    }\n};\n\nexport const deleteInspectioBoard = (boardId: string, onErr: (err: any) => void): void => {\n    try {\n        let boardList = loadBoardList();\n\n        if(boardList.includes(boardId)) {\n            boardList = boardList.delete(boardList.indexOf(boardId));\n\n            localStorage.setItem(KEY_BOARDS, JSON.stringify(boardList.toJSON()));\n            localStorage.removeItem(boardKey(boardId));\n        }\n    } catch (err) {\n        onErr(err);\n    }\n};\n\nexport const migrateBoardState = (rawBoardState: any, boardStateVersion: number): any => {\n    if(boardStateVersion === CURRENT_BOARD_STATE_VERSION) {\n        return rawBoardState;\n    }\n\n    if(boardStateVersion === 0) {\n        rawBoardState = migrateFrom0to1(rawBoardState);\n        boardStateVersion = 1;\n    }\n\n    if(boardStateVersion === CURRENT_BOARD_STATE_VERSION) {\n        return rawBoardState;\n    }\n\n    throw new Error(`Missing board state migration from version ${boardStateVersion} to  ${CURRENT_BOARD_STATE_VERSION}`);\n}\n\nconst migrateFrom0to1 = (rawBoardState: any): any => {\n    rawBoardState.version = BoardVersioning.defaultBoardVersionProps;\n    return rawBoardState;\n}\n\n// Cody Console cache\nexport const saveCodyConsoleHistory = (history: string[]): void => {\n    localStorage.setItem(KEY_CODY_CONSOLE_HISTORY, JSON.stringify(history));\n}\n\nexport const loadCodyConsoleHistory = (): string[] => {\n    const historyJson = localStorage.getItem(KEY_CODY_CONSOLE_HISTORY);\n\n    if(historyJson === null) {\n        return [];\n    }\n\n    try {\n        return JSON.parse(historyJson);\n    } catch (e) {\n        return [];\n    }\n}\n","import {call, fork, put,take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {deleteInspectioBoard} from \"../../core/localStorage\";\nimport {Action as Notify, Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\n\ntype FlowAction = ActionType<typeof Action.Command.deleteBoard>;\n\nfunction* deleteBoard(action: FlowAction) {\n    let localError = null;\n\n    deleteInspectioBoard(action.payload.boardId, (err) => {\n        localError = err;\n    })\n\n    if (localError) {\n        const errorNotification = Notify.Command.error('Failed to delete board in local storage', localError);\n        yield put(errorNotification);\n    }\n\n    const {response, error}: ResponseType = yield call(Action.Api.deleteBoard, action.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not delete board.'));\n    }\n    if (response) {\n        yield put(NotifyAction.Command.info('Board deleted', 'Board deleted'));\n    }\n}\n\nexport function* deleteBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.DELETE_BOARD\n        ]);\n\n        yield fork(deleteBoard, action);\n    }\n}\n","import { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport {execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from '../actions';\nimport {BoardClient} from \"../model/BoardClient\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchBoardClient>;\n\nconst onFetchBoardClient = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchBoardClient, action.payload.boardId);\n\n    if (error) {\n        if (error.status === 404) {\n            yield put(Action.Event.boardClientNotConfigured(action.payload.boardId));\n        } else {\n            yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board client\"));\n        }\n    }\n\n    if (response) {\n        const result = pipe(\n            response!.data,\n            execValidate([hasKey('clientId'), \"Response data does not contain key clientId\"])\n        );\n\n        if (isFailure(result)) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load board client'));\n        }\n\n        if (isSuccess(result)) {\n            yield put(Action.Event.boardClientFetched(action.payload.boardId, result.value as BoardClient));\n        }\n    }\n};\n\nconst onFetchBoardClientSecret = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchBoardClientSecret, action.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board client secret\"));\n    }\n\n    if (response) {\n        const result = pipe(\n            response!.data,\n            execValidate([hasKey('clientSecret'), \"Response data does not contain key clientSecret\"])\n        );\n\n        if (isFailure(result)) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load board client secret'));\n        }\n\n        if (isSuccess(result)) {\n            yield put(Action.Event.boardClientSecretFetched(action.payload.boardId, (result.value as any).clientSecret));\n        }\n    }\n};\n\nconst onCreateBoardClient = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.createBoardClient, action.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to create board client\"));\n    }\n\n    if (response) {\n        yield call(onFetchBoardClient, action);\n    }\n};\n\nconst onRemoveBoardClient = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.removeBoardClient, action.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to remove board client\"));\n    }\n\n    if (response) {\n        yield put(Action.Event.boardClientNotConfigured(action.payload.boardId));\n    }\n};\n\nconst onResetBoardClientSecret = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.resetBoardClientSecret, action.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to reset board client secret\"));\n    }\n\n    if (response) {\n        yield call(onFetchBoardClientSecret, action);\n    }\n};\n\nexport function* fetchBoardClientFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.FETCH_BOARD_CLIENT,\n            Action.Type.FETCH_BOARD_CLIENT_SECRET,\n            Action.Type.CREATE_BOARD_CLIENT,\n            Action.Type.REMOVE_BOARD_CLIENT,\n            Action.Type.RESET_BOARD_CLIENT_SECRET\n        ]);\n\n        if (action.type === Action.Type.FETCH_BOARD_CLIENT) {\n            yield fork(onFetchBoardClient, action);\n        } else if(action.type === Action.Type.FETCH_BOARD_CLIENT_SECRET) {\n            yield fork(onFetchBoardClientSecret, action);\n        } else if(action.type === Action.Type.CREATE_BOARD_CLIENT) {\n            yield fork(onCreateBoardClient, action);\n        } else if(action.type === Action.Type.REMOVE_BOARD_CLIENT) {\n            yield fork(onRemoveBoardClient, action);\n        } else if(action.type === Action.Type.RESET_BOARD_CLIENT_SECRET) {\n            yield fork(onResetBoardClientSecret, action);\n        }\n    }\n}","import {List} from \"immutable\";\nimport { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from '../actions';\nimport {createBoardGraphElementFromServerData} from \"../model/BoardGraphElement\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchBoardGraphElements>;\n\nconst onFetchBoardGraphElements = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(\n        Action.Api.fetchBoardGraphElements,\n        action.payload.boardId,\n        action.payload.type\n    );\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board graph elements\"));\n    }\n\n    if (response) {\n        const result = pipe(\n            response!.data,\n            execValidate([isArray(), \"Response data is no array\"]),\n            execForEach((data: any) => {\n                return createBoardGraphElementFromServerData(data);\n            }),\n        );\n\n        if (isFailure(result)) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load board graph elements'));\n        }\n\n        if (isSuccess(result)) {\n            const boardGraphElements = List(result.value);\n            yield put(Action.Event.boardGraphElementsFetched(action.payload.boardId, boardGraphElements));\n        }\n    }\n};\n\nexport function* fetchBoardGraphElementsFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take(Action.Type.FETCH_BOARD_GRAPH_ELEMENTS);\n\n        yield fork(onFetchBoardGraphElements, action);\n    }\n}","import {List} from \"immutable\";\nimport { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport { Action as TeamAction } from '../../InspectioTeams';\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from '../actions';\nimport {FETCH_BOARD_PERMISSIONS_FOR_TEAMS, FETCH_BOARD_PERMISSIONS_FOR_USERS} from \"../actions/constants\";\nimport {BoardId} from \"../model/Board\";\nimport {createBoardPermissionForTeamFromServerData} from \"../model/BoardPermissionForTeam\";\nimport {createBoardPermissionForUserFromServerData} from \"../model/BoardPermissionForUser\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchBoardPermissionsForTeams>\n    | ActionType<typeof Action.Query.fetchBoardPermissionsForUsers>\n    | ActionType<typeof TeamAction.Event.teamAccessToBoardGranted>\n    | ActionType<typeof TeamAction.Event.teamAccessToBoardRevoked>;\n\nconst onFetchBoardPermissionsForUsers = function* (boardId: BoardId) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchBoardPermissionsForUsers, boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board permissions\"));\n    }\n\n    if (response) {\n\n        const result = pipe(\n            response!.data,\n            execValidate([isArray(), \"Response data is not of type Array\"]),\n            execForEach((data: any) => {\n                return createBoardPermissionForUserFromServerData(data);\n            }),\n        );\n\n        if (isFailure(result)) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Failed to process board permissions response from server\", result.value, response.data);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load board permissions'));\n        }\n\n        if (isSuccess(result)) {\n            const boardPermissions = List(result.value);\n            yield put(Action.Event.boardPermissionsForUsersFetched(boardPermissions));\n        }\n    }\n};\n\nconst onFetchBoardPermissionsForTeams = function* (boardId: BoardId) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchBoardPermissionsForTeams, boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board permissions\"));\n    }\n\n    if (response) {\n\n        const result = pipe(\n            response!.data,\n            execValidate([isArray(), \"Response data is not of type Array\"]),\n            execForEach((data: any) => {\n                return createBoardPermissionForTeamFromServerData(data);\n            }),\n        );\n\n        if (isFailure(result)) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Failed to process board permissions response from server\", result.value, response.data);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load board permissions'));\n        }\n\n        if (isSuccess(result)) {\n            const boardPermissions = List(result.value);\n            yield put(Action.Event.boardPermissionsForTeamsFetched(boardPermissions));\n        }\n    }\n};\n\nexport function* fetchBoardPermissionsFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.FETCH_BOARD_PERMISSIONS_FOR_USERS,\n            Action.Type.FETCH_BOARD_PERMISSIONS_FOR_TEAMS,\n            TeamAction.Type.TEAM_ACCESS_TO_BOARD_GRANTED,\n            TeamAction.Type.TEAM_ACCESS_TO_BOARD_REVOKED,\n        ]);\n\n        switch (action.type) {\n            case FETCH_BOARD_PERMISSIONS_FOR_USERS:\n                yield fork(onFetchBoardPermissionsForUsers, action.payload.boardId);\n                break;\n            case FETCH_BOARD_PERMISSIONS_FOR_TEAMS:\n            case TeamAction.Type.TEAM_ACCESS_TO_BOARD_GRANTED:\n            case TeamAction.Type.TEAM_ACCESS_TO_BOARD_REVOKED:\n                yield fork(onFetchBoardPermissionsForTeams, action.payload.boardId);\n                break;\n        }\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\nimport {createStickyTemplateFromServerData} from \"../model/StickyTemplate\";\n\ntype Query = ActionType<typeof Action.Query.fetchBoardStickyTemplates>\n\nfunction* handleFetchBoardStickyTemplates(query: Query) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchBoardStickyTemplates, query.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load sticky templates\"));\n    }\n\n    if (response) {\n\n        const result = pipe(\n            response!.data,\n            execValidate([isArray(), \"Response data is not of type Array\"]),\n            execForEach((data: any) => {\n                return createStickyTemplateFromServerData(data);\n            }),\n        );\n\n        if (isFailure(result)) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Failed to process sticky templates response from server\", result.value, response.data);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load sticky templates'));\n        }\n\n        if (isSuccess(result)) {\n            const stickyTemplates = List(result.value);\n            yield put(Action.Event.boardStickyTemplatesFetched(stickyTemplates));\n        }\n    }\n}\n\nexport function* fetchBoardStickyTemplates() {\n    while (true) {\n        const query: Query = yield take([\n            Action.Type.FETCH_BOARD_STICKY_TEMPLATES\n        ]);\n\n        yield fork(handleFetchBoardStickyTemplates, query);\n    }\n}\n","import {List} from \"immutable\";\nimport { call, fork, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from '../actions';\nimport {createBoardInvitationFromServerData} from \"../model/BoardInvitation\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchOpenBoardInvitations>;\n\nconst onFetchOpenBoardInvitations = function* (action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.fetchOpenBoardInvitations, action.payload.boardId);\n\n    if (error) {\n        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load open board invitations\"));\n    }\n\n    if (response) {\n        const result = pipe(\n            response!.data,\n            execValidate([isArray(), \"Response data is not of type Array\"]),\n            execForEach((data: any) => {\n                return createBoardInvitationFromServerData(data);\n            }),\n        );\n\n        if (isFailure(result)) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Failed to process open board invitations response from server\", result.value, response.data);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load open board invitations'));\n        }\n\n        if (isSuccess(result)) {\n            const openBoardInvitations = List(result.value);\n            yield put(Action.Event.openBoardInvitationsFetched(openBoardInvitations));\n        }\n    }\n};\n\nexport function* fetchOpenBoardInvitationsFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.FETCH_OPEN_BOARD_INVITATIONS]);\n\n        yield fork(onFetchOpenBoardInvitations, action);\n    }\n}","import {Record} from 'immutable';\nimport * as uuid from \"uuid\";\nimport {Aggregate, AggregateType} from \"../../core/model/Aggregate\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\nimport {UserId} from \"../../User/model/UserInfo\";\n\nexport const AGGREGATE_TYPE = 'PlayshotSummary';\n\nexport type PlayshotId = string;\nexport type PlayshotSummaryError = string;\n\nexport interface PlayshotSummaryProps {\n  uid: PlayshotId;\n  aggregateType: AggregateType;\n  boardId: string;\n  name: string;\n  savedAt: string;\n  savedBy: UserId;\n}\n\nexport const defaultPlayshotSummaryProps: PlayshotSummaryProps = {\n  uid: '',\n  aggregateType: AGGREGATE_TYPE,\n  boardId: '',\n  name: '',\n  savedAt: '',\n  savedBy: '',\n};\n\nexport const createPlayshotSummaryFromServerData = (data: any): Either<PlayshotSummaryError, PlayshotSummary> => {\n  const validatedData: Either<PlayshotSummaryError, any> = validate(data,\n    [hasKey('playshotId'), \"playshotId missing\"],\n    [hasKey('boardId'), \"boardId missing\"],\n    [hasKey('name'), \"name missing\"],\n    [hasKey('savedAt'), \"savedAt missing\"],\n    [hasKey('savedBy'), \"savedBy missing\"],\n  );\n\n  if (isFailure(validatedData)) {\n    return validatedData;\n  }\n\n  return Success(new PlayshotSummary({\n    ...defaultPlayshotSummaryProps,\n    ...data,\n    uid: data.playshotId,\n  }));\n};\n\nexport class PlayshotSummary extends Record(defaultPlayshotSummaryProps) implements PlayshotSummaryProps, Aggregate {\n  public constructor(data: PlayshotSummaryProps) {\n    if (data.uid === '') {\n      data.uid = uuid.v4()\n    }\n\n    super(data);\n  }\n\n  // @TODO add use case methods to change state\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\nimport {createPlayshotSummaryFromServerData} from \"../model/PlayshotSummary\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchPlayshotSummaryList>;\n\nconst onFetchPlayshotSummaryList = function* (action: FlowAction) {\n  const {response, error}: ResponseType = yield call(Action.Api.fetchPlayshots, action.payload.boardId);\n\n  if (error) {\n    yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load playshots\"));\n  }\n\n  if (response) {\n    const result = pipe(\n      response!.data,\n      execValidate([isArray(), \"Response data is not of type Array\"]),\n      execForEach((data: any) => {\n        return createPlayshotSummaryFromServerData(data);\n      }),\n    );\n\n    if (isFailure(result)) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Failed to process playshot summary response from server\", result.value, response.data);\n      yield put(NotifyAction.Command.error('Request Error', 'Could not load playshots'));\n    }\n\n    if (isSuccess(result)) {\n      const summaries = List(result.value);\n      yield put(Action.Event.playshotSummaryListFetched(summaries));\n    }\n  }\n}\n\nexport function* fetchPlayshotSummaryListFlow() {\n\n  while (true) {\n    const action: FlowAction = yield take([Action.Type.FETCH_PLAYSHOT_SUMMARY_LIST]);\n\n    yield fork(onFetchPlayshotSummaryList, action);\n  }\n}\n","import {List} from \"immutable\";\nimport {call, delay, fork, put, select, take} from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport {ResponseType} from \"../../api/util\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport {UserId} from \"../../User/model/UserInfo\";\nimport * as Action from '../actions';\nimport {setBoardToSnapshot} from \"../actions/commands\";\nimport {BoardModel, BoardSnapshot, BoardSync, BoardVersioning} from '../model';\nimport {BoardId} from \"../model/Board\";\nimport {Permissions} from \"../model/BoardPermissionForUser\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchUserBoard>;\n\ninterface BoardAccessCheck {\n    access: 'allowed' | 'denied' | 'requestable';\n    permissions: {\n        permissionsId: string,\n        userId: UserId,\n        boardId: BoardId,\n        permissions: Permissions\n    };\n    denyReason: string;\n}\n\nconst retryFetchUserBoard = function* (boardId: BoardId) {\n    let retry = 0;\n\n    while(retry < 4) {\n        yield delay(1000 * retry);\n\n        const response: ResponseType = yield call(Action.Api.fetchUserBoard, boardId);\n\n        if(response.response) {\n            return response\n        }\n\n        if(retry === 3) {\n            return response;\n        }\n\n        retry++;\n    }\n}\n\nconst onFetchUserBoard = function* (action: FlowAction) {\n    const tempBoard = yield select(makeBoardByIdSelector(action.payload.boardId))\n\n    if(tempBoard && tempBoard.tempBoard) {\n        yield put(Action.Command.setBoardDetailsFetched(action.payload.boardId, false));\n        return;\n    }\n\n    const fetchUserBoardResponse: ResponseType = yield call(Action.Api.fetchUserBoard, action.payload.boardId);\n    const error = fetchUserBoardResponse.error;\n    let response = fetchUserBoardResponse.response;\n\n    if (error) {\n        const accessCheck: ResponseType = yield call(Action.Api.checkBoardAccess, action.payload.boardId);\n\n        if (accessCheck.response) {\n            const accessCheckData: BoardAccessCheck = accessCheck.response.data;\n\n            switch (accessCheckData.access) {\n                case \"allowed\":\n                    const retryResponse = yield call(retryFetchUserBoard, action.payload.boardId);\n                    if(retryResponse.response) {\n                        response = retryResponse.response;\n                    } else {\n                        yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board\"));\n                    }\n                    break;\n                case \"denied\":\n                    yield put(NotifyAction.Command.error(\"Access Error\", \"You cannot access the board. Either you do not have permissions or the organization has not enough user quota. Please contact the board owner for details.\"));\n                    break;\n                case \"requestable\":\n                    console.warn('@TODO: Implement request access to board');\n                    yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board\"));\n                    break;\n            }\n\n        } else {\n            yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board\"));\n        }\n    }\n\n    if (response) {\n        const board = new BoardModel.Board({\n            uid: response.data.boardId,\n            name: response.data.name,\n            nameAbbreviation: response.data.nameAbbreviation,\n            tags: List(response.data.tags),\n            createdAt: response.data.createdAt,\n            lastModified: response.data.lastModified,\n            version: new BoardVersioning.BoardVersion(response.data.boardVersion),\n            shared: response.data.shared,\n            sharedWith: List(response.data.sharedWith),\n            assignedTeams: List(response.data.assignedTeams),\n            responsibleTeam: response.data.responsibleTeam? response.data.responsibleTeam : undefined,\n            writeAccess: response.data.writeAccess,\n            owner: response.data.owner,\n            creator: response.data.creator,\n            organization: response.data.organization,\n            tempBoard: false,\n            orgaMemberPermissions: response.data.orgaMemberPermissions,\n            anyonePermissions: response.data.anyonePermissions,\n            codySuggestEnabled: response.data.codySuggestEnabled,\n            eventModelingEnabled: response.data.eventModelingEnabled,\n        });\n\n        let snapshot = null;\n\n        if(response.data.snapshot) {\n            snapshot = new BoardSnapshot.BoardSnapshot({\n                boardId: response.data.boardId,\n                xml: response.data.snapshot.content,\n                boardVersion: new BoardVersioning.BoardVersion(response.data.snapshot.boardVersion)\n            });\n        }\n\n        yield put(Action.Command.updateBoards([board]));\n\n        if(snapshot) {\n            yield put(setBoardToSnapshot(snapshot));\n        }\n\n        yield put(Action.Command.setBoardDetailsFetched(board.uid, board.writeAccess as boolean));\n    }\n}\n\nexport function* fetchUserBoardFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.FETCH_USER_BOARD\n        ]);\n\n        yield fork(onFetchUserBoard, action);\n    }\n}\n","import {UserId} from \"./UserInfo\";\nimport {List, Record as ImmutableRecord} from \"immutable\";\nimport {Either, isFailure, Success, validate} from \"../../core/validation/either\";\nimport {hasKey} from \"../../core/validation/predicates\";\n\nexport type UserSettingsValidationError = string;\nexport type UserSettingsValue = number|boolean;\nexport type UserSettingsValues = Record<string, UserSettingsValue>;\n\nexport interface UserSettingsProps {\n    userId: UserId,\n    values: UserSettingsValues;\n}\n\nexport const defaultUserSettingsProps: UserSettingsProps = {\n    userId: '',\n    values: {},\n};\n\nexport const createUserSettingsFromServerData = (data: any): Either<UserSettingsValidationError, UserSettings> => {\n    const validatedData: Either<string, any> = validate(data,\n        [hasKey('userId'), \"userId missing\"],\n        [hasKey('values'), \"values missing in \"+data.userId],\n    );\n\n    if(isFailure(validatedData)) {\n        return validatedData;\n    }\n\n    return Success(new UserSettings({\n        userId: data.userId,\n        values: data.values,\n    }));\n};\n\n\nexport class UserSettings extends ImmutableRecord(defaultUserSettingsProps) implements UserSettingsProps {\n\n    public constructor(data: UserSettingsProps) {\n        super(data);\n    }\n}\n","import {ResponseType} from \"../../api/util\";\nimport * as Action from \"../../User/actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport { call, put } from 'redux-saga/effects';\nimport {createUserSettingsFromServerData} from \"../model/UserSettings\";\nimport {isFailure, isSuccess} from \"../../core/validation/either\";\n\nexport function* loadUserSettings() {\n    const {response, error}: ResponseType = yield call(Action.Api.getUserSettings);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not load user settings'));\n    }\n\n    if (response) {\n        const result = createUserSettingsFromServerData(response.data);\n\n        if (isFailure(result)) {\n            // tslint:disable-next-line:no-console\n            console.error(\"Failed to process user settings response from server\", result.value, response.data);\n            yield put(NotifyAction.Command.error('Request Error', 'Could not load user settings'));\n        }\n\n        if (isSuccess(result)) {\n            yield put(Action.Event.userSettingsLoaded(result.value));\n        }\n    }\n}\n","import { AxiosResponse } from 'axios';\nimport {List} from \"immutable\";\nimport { map } from 'lodash';\nimport {call, delay, fork, put, select, take} from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport uuid from 'uuid';\nimport { ResponseType } from '../../api/util';\nimport * as Auth from '../../Auth';\nimport {loadUserTeams} from \"../../InspectioTeams/sagas/loadUserTeams\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Organization from '../../Organization';\nimport { Action as UserAction } from '../../User';\nimport * as User from '../../User';\nimport { UserSelector } from '../../User';\nimport {loadUserSettings} from \"../../User/saga/LoadUserSettingsFlow\";\nimport * as Action from '../actions';\nimport {updateBoards} from '../actions/commands';\nimport {initialBoardListLoaded} from \"../actions/events\";\nimport {fetchUserBoards} from \"../actions/queries\";\nimport { BoardModel } from '../model';\nimport { BoardVersion } from '../model/BoardVersion';\n\ntype FlowAction = ActionType<typeof Auth.Action.Event.userAuthenticated> & ActionType<typeof fetchUserBoards>;\n\nfunction* updateUserData(response: AxiosResponse ) {\n    let user = yield select(UserSelector.currentUserSelector, undefined);\n    user = user.set('quota', response.data.quota);\n    user = user.set('teamQuota', response.data.teamQuota);\n    user = user.set('signedIn', true);\n    user = user.set('activeOrganization', response.data.activeOrganization || null);\n\n    yield put(UserAction.Command.signIn(user));\n}\n\nfunction* loadUserBoards() {\n    yield put(Action.Query.startFetchUserBoards());\n\n    const {response, error}: ResponseType = yield call(Action.Api.fetchUserBoards);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not load boards'));\n    }\n\n    if(response) {\n        const boards = map(response.data as any, (data: any) => new BoardModel.Board({\n            uid: data.boardId,\n            name: data.name,\n            nameAbbreviation: data.nameAbbreviation,\n            tags: List(data.tags),\n            createdAt: data.createdAt,\n            lastModified: data.lastModified,\n            version: new BoardVersion(data.version),\n            shared: data.shared,\n            sharedWith: List(data.sharedWith),\n            assignedTeams: List(data.assignedTeams),\n            responsibleTeam: data.responsibleTeam || undefined,\n            example: data.example || false,\n            owner: data.ownerId,\n            creator: data.creatorId,\n            organization: data.organization,\n            tempBoard: false,\n            orgaMemberPermissions: data.orgaMemberPermissions,\n            anyonePermissions: data.anyonePermissions,\n            codySuggestEnabled: data.codySuggestEnabled,\n            eventModelingEnabled: data.eventModelingEnabled,\n        }));\n\n        yield put(updateBoards(boards));\n    }\n}\n\nfunction* onUserAuthenticated(action: FlowAction) {\n    const {response, error}: ResponseType = yield call(User.Action.Api.getUser, action.payload.kc.tokenParsed!.sub!);\n\n    if (error && error.status === 404) {\n        const organizationId = uuid.v4();\n        const installUserOrganization: ResponseType = yield call(Organization.Action.Api.installUserOrganization, organizationId);\n\n        if (installUserOrganization.error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not initialize organization.'));\n        }\n\n        if (installUserOrganization.response) {\n            // TODO error handling\n            const getUserReponse: ResponseType = yield call(User.Action.Api.getUser, action.payload.kc.tokenParsed!.sub!);\n            yield updateUserData(getUserReponse.response!);\n        }\n    } else {\n        yield updateUserData(response!);\n    }\n\n    yield call(loadUserSettings);\n    yield put(Organization.Action.Query.fetchUserOrganizations());\n    yield delay(500);\n    yield call(loadUserBoards);\n    yield call(loadUserTeams);\n    yield put(initialBoardListLoaded());\n}\n\nfunction* onFetchUserBoards() {\n    yield loadUserBoards();\n}\n\nexport function* fetchUserBoardsFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Auth.Action.Type.USER_AUTHENTICATED,\n            Action.Type.FETCH_USER_BOARDS,\n        ]);\n\n        switch (action.type) {\n            case Auth.Action.Type.USER_AUTHENTICATED:\n                yield fork(onUserAuthenticated, action);\n                break;\n            case Action.Type.FETCH_USER_BOARDS:\n                yield fork(onFetchUserBoards);\n                break;\n        }\n\n    }\n}\n","import {call, fork, put,select, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\nimport {makeBoardByIdSelector, makeGetBoard} from \"../selectors/board\";\n\ntype FlowAction = ActionType<typeof Action.Command.importExistingBoard>;\n\nfunction* importExistingBoard(action: FlowAction) {\n    const {board} = action.payload;\n    const oldBoard = yield select(makeBoardByIdSelector(board.uid));\n\n    yield put(Action.Command.forceUpdateBoards([board]));\n\n    const {response, error}: ResponseType = yield call(Action.Api.takeBoardSnapshot, board.uid, board.version, board.xml!);\n\n    if(error) {\n        yield put(Notify.Command.error('Server Error', 'Could not import existing board.'));\n        yield put(Action.Command.forceUpdateBoards([oldBoard]));\n        return;\n    }\n\n    if(response) {\n        yield put(Notify.Command.info('Board imported:', board.name));\n    }\n}\n\nexport function* importExistingBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.IMPORT_EXISTING_BOARD]);\n\n        yield fork(importExistingBoard, action);\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put,select, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport * as uuid from \"uuid\";\nimport {ResponseType} from \"../../api/util\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport {UserId, UserInfo} from \"../../User/model/UserInfo\";\nimport {UserSelector} from \"../../User/selectors\";\nimport * as Action from \"../actions\";\nimport {Board, deriveAbbreviationFromBoardName} from \"../model/Board\";\nimport {BoardVersion} from \"../model/BoardVersion\";\nimport {makeEmptyGraph} from \"../model/Graph\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {DEFAULT_PERMISSIONS} from \"../model/BoardPermissionForUser\";\n\ntype FlowAction = ActionType<typeof Action.Command.importNewBoard>;\n\nfunction* importNewBoard(action: FlowAction) {\n    const boardId = action.payload.boardId || uuid.v4();\n\n    const organization = yield select(makeActiveUserOrganizationInfoSelector());\n\n    if(!organization) {\n        yield put(NotifyAction.Command.error('Board Import Failed', 'No organization selected.'));\n        return;\n    }\n\n    let response: ResponseType | null = null;\n\n    if(!action.payload.importTemporary){\n        response = yield call(\n            Action.Api.installOrganizationBoard,\n            organization.organizationId,\n            boardId,\n            action.payload.boardName,\n            deriveAbbreviationFromBoardName(action.payload.boardName),\n            []\n        );\n    }\n\n    if (response && response.error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not add board.'));\n    }\n    if ((response && response.response) || action.payload.importTemporary) {\n        if(!action.payload.importTemporary) {\n            yield put(NotifyAction.Command.info('Board created', 'Board created'));\n        }\n\n\n        const getUser = UserSelector.makeGetCurrentUser();\n\n        const user: UserInfo = yield select(getUser);\n\n        const board = new Board({\n            uid: boardId,\n            name: action.payload.boardName,\n            nameAbbreviation: deriveAbbreviationFromBoardName(action.payload.boardName),\n            tags: List(),\n            createdAt: (() => new Date())().toISOString(),\n            xml: action.payload.boardXml,\n            version: new BoardVersion({\n                userId: user.uid,\n                version: 1\n            }),\n            shared: false,\n            sharedWith: List<UserId>(),\n            assignedTeams: List<TeamId>(),\n            owner: null,\n            creator: user.uid,\n            organization: organization.organizationId,\n            tempBoard: !!action.payload.importTemporary,\n            orgaMemberPermissions: DEFAULT_PERMISSIONS,\n            anyonePermissions: DEFAULT_PERMISSIONS,\n            codySuggestEnabled: true,\n            eventModelingEnabled: true,\n        });\n\n        yield put(Action.Command.updateBoards([board]));\n\n        const [graph, setGraph] = useGraph();\n\n        const emptyGraphWithXml = makeEmptyGraph(board.xml || undefined);\n\n        setGraph(emptyGraphWithXml);\n\n        yield put(Action.Command.saveBoard(board, emptyGraphWithXml));\n    }\n}\n\nexport function* importNewBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.IMPORT_NEW_BOARD]);\n\n        yield fork(importNewBoard, action);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {List} from \"immutable\";\n\ntype Command = ActionType<typeof Action.Command.importStickyTemplates>\n\nfunction* handleImportStickyTemplates(command: Command) {\n    const tpls = command.payload.stickyTemplates.toJS();\n    const importedTpls = [];\n\n    for (const tpl of tpls) {\n        const {response, error}: ResponseType = yield call(Action.Api.setStickyTemplate,\n            tpl.boardId,\n            tpl.cellType,\n            tpl.template\n        );\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not set sticky template for ' + tpl.cellType));\n            continue;\n        }\n\n        importedTpls.push(tpl);\n\n        const advancedConfigResult: ResponseType = yield call(Action.Api.updateStickyAdvancedConfig,\n            tpl.boardId,\n            tpl.cellType,\n            tpl.templateType,\n            tpl.templateSchema || undefined\n        );\n\n        if (advancedConfigResult.error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not update sticky advanced config for ' + tpl.cellType));\n        }\n    }\n\n    yield put(NotifyAction.Command.info('Card Templates imported', 'You can now use them on the board!'));\n    yield put(Action.Event.stickyTemplatesImported(List(importedTpls)));\n    command.payload.finishedCb();\n}\n\nexport function* importStickyTemplates() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.IMPORT_STICKY_TEMPLATES\n        ]);\n\n        yield fork(handleImportStickyTemplates, command);\n    }\n}\n","import {call, delay, put, select, take} from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport { ResponseType } from '../../api/util';\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport * as Routes from '../../routes';\nimport * as Action from '../actions';\nimport {BoardModel, BoardVersioning} from \"../index\";\nimport {List} from \"immutable\";\n\ntype FlowAction = ActionType<typeof Action.Command.addBoard>;\n\nexport function* installUserBoardFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.ADD_BOARD\n        ]);\n\n        const organization = yield select(makeActiveUserOrganizationInfoSelector());\n\n        console.log(\"install user board flow: \", action.payload.board.toJS());\n\n        if(organization) {\n            const {response, error}: ResponseType = yield call(\n                Action.Api.installOrganizationBoard,\n                organization.organizationId,\n                action.payload.board.uid,\n                action.payload.board.name,\n                action.payload.board.nameAbbreviation,\n                action.payload.board.tags.toJS(),\n                action.payload.board.responsibleTeam,\n                action.payload.board.codySuggestEnabled,\n                action.payload.board.eventModelingEnabled\n            );\n\n            if (error) {\n                yield put(NotifyAction.Command.error('Request Error', 'Could not add board.'));\n            }\n            if (response) {\n                // Give async BE processing a bit time\n                yield delay(300);\n\n                yield put(NotifyAction.Command.info('Board created', 'Board created'));\n\n                const boardResponse: ResponseType = yield call(Action.Api.fetchUserBoard, action.payload.board.uid);\n\n                yield call(action.payload.history.push, Routes.compileInspectioBoardWorkspace(action.payload.board.uid) as any);\n                yield delay(1000);\n\n                if (boardResponse.error) {\n                    yield put(NotifyAction.Command.error(\"Request Error\", \"Failed to load board\"));\n                }\n\n                if (boardResponse.response) {\n                    const board = new BoardModel.Board({\n                        uid: boardResponse.response.data.boardId,\n                        name: boardResponse.response.data.name,\n                        nameAbbreviation: response.data.nameAbbreviation,\n                        tags: List(boardResponse.response.data.tags),\n                        createdAt: boardResponse.response.data.createdAt,\n                        lastModified: boardResponse.response.data.lastModified,\n                        version: new BoardVersioning.BoardVersion(boardResponse.response.data.boardVersion),\n                        shared: boardResponse.response.data.shared,\n                        sharedWith: List(boardResponse.response.data.sharedWith),\n                        assignedTeams: List(boardResponse.response.data.assignedTeams),\n                        responsibleTeam: boardResponse.response.data.responsibleTeam ? boardResponse.response.data.responsibleTeam : undefined,\n                        writeAccess: boardResponse.response.data.writeAccess,\n                        owner: boardResponse.response.data.owner,\n                        creator: boardResponse.response.data.creator,\n                        organization: boardResponse.response.data.organization,\n                        tempBoard: false,\n                        orgaMemberPermissions: boardResponse.response.data.orgaMemberPermissions,\n                        anyonePermissions: boardResponse.response.data.anyonePermissions,\n                        codySuggestEnabled: boardResponse.response.data.codySuggestEnabled,\n                        eventModelingEnabled: boardResponse.response.data.eventModelingEnabled,\n                    });\n\n                    yield put(Action.Command.forceUpdateBoards([board]));\n                }\n            }\n        } else {\n            yield put(NotifyAction.Command.error('Board Installation Failed', 'No organization selected.'));\n        }\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../../InspectioBoards\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as OrgaModule from \"../../Organization\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\n\ntype Command = ActionType<typeof Action.Command.moveUserBoardToOrganization>\n\nfunction* handleMoveUserBoardToOrganization(command: Command) {\n    const {response, error} = yield call(Action.Api.moveUserBoardToOrganization, command.payload.organizationId, command.payload.boardId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not move board to organization.'));\n    }\n\n    if(response) {\n        yield put(Action.Query.fetchUserBoards());\n        yield put(OrgaModule.Action.Query.fetchUserOrganizations());\n\n        const board = yield select(makeBoardByIdSelector(command.payload.boardId));\n\n        if(board) {\n            yield put(Action.Event.userBoardMovedToOrganization(board.moveToOrganization(command.payload.organizationId)));\n        }\n\n\n        yield put(NotifyAction.Command.info('Board moved', 'The board has been moved to the organization.'));\n    }\n}\n\nexport function* moveUserBoardToOrganization() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.MOVE_USER_BOARD_TO_ORGANIZATION\n        ]);\n\n        yield fork(handleMoveUserBoardToOrganization, command);\n    }\n}\n","import { call, put, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport { ResponseType } from '../../api/util';\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from '../actions';\n\ntype FlowAction = ActionType<typeof Action.Command.renameBoard>\n\nexport function* renameBoardFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.RENAME_BOARD]);\n\n        const {response, error}: ResponseType = yield call(Action.Api.renameBoard, action.payload.board.uid, action.payload.board.name);\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not rename board.'));\n            yield put(Action.Query.fetchUserBoards());\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info('Board renamed', ''));\n        }\n    }\n}","import { call, fork, put, select, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from \"../actions\";\nimport {makeBoardInvitationSelector} from \"../selectors/boardInvitation\";\n\ntype FlowAction = ActionType<typeof Action.Command.resendBoardInvitation>;\n\nfunction* onResendBoardInvitation(action: FlowAction) {\n    const boardInvitation = yield select(makeBoardInvitationSelector(action.payload.invitationId));\n\n    if (boardInvitation) {\n        const {response, error}: ResponseType = yield call(\n            Action.Api.resendBoardInvitation,\n            action.payload.invitationId\n        );\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not resend board invitation'));\n        }\n\n        if (response) {\n            yield put(NotifyAction.Command.info(\n                'insp.board.notify.invitation_resend.success.title',\n                'insp.board.notify.invitation_resend.success.msg'\n            ));\n        }\n\n        yield put(Action.Event.boardInvitationResent(boardInvitation.resend()));\n    }\n}\n\nexport function* resendBoardInvitationFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.RESEND_BOARD_INVITATION,\n        ]);\n\n        yield fork(onResendBoardInvitation, action);\n    }\n}","import { call, fork, put, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\n\ntype FlowAction = ActionType<typeof Action.Command.revokeAccessToBoard>;\n\nfunction* onRevokeAccess(action: FlowAction) {\n    const {response, error}: ResponseType = yield call(Action.Api.revokeAccessToBoard, action.payload.boardId, action.payload.userId);\n\n    if(error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Failed to revoke access to board.'));\n    }\n\n    if(response) {\n        yield put(NotifyAction.Command.info('Access Revoked', 'Access to board revoked.'));\n\n        yield put(Action.Event.boardAccessRevoked(action.payload.boardId, action.payload.userId));\n    }\n}\n\nexport function* revokeAccessToBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.REVOKE_ACCESS_TO_BOARD]);\n\n        yield fork(onRevokeAccess, action)\n    }\n}\n\n","import { call, fork, put, select, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from \"../actions\";\nimport {makeBoardInvitationSelector} from \"../selectors/boardInvitation\";\n\ntype FlowAction = ActionType<typeof Action.Command.revokeBoardInvitation>;\n\nfunction* onRevokeBoardInvitation(action: FlowAction) {\n    const boardInvitation = yield select(makeBoardInvitationSelector(action.payload.invitationId));\n\n    if (boardInvitation) {\n        const {response, error}: ResponseType = yield call(\n            Action.Api.revokeBoardInvitation,\n            action.payload.invitationId\n        );\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not revoke board invitation'));\n        }\n\n        if (response) {\n            yield put(NotifyAction.Command.info(\n                'insp.board.notify.invitation_revoke.success.title',\n                'insp.board.notify.invitation_revoke.success.msg'\n            ));\n\n            yield put(Action.Event.boardInvitationRevoked(boardInvitation.revoke()));\n        }\n    }\n}\n\nexport function* revokeBoardInvitationFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.REVOKE_BOARD_INVITATION,\n        ]);\n\n        yield fork(onRevokeBoardInvitation, action);\n    }\n}","import {call,fork, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {default as socket} from \"../../api/ConfiguredSocket\";\nimport { ResponseType } from '../../api/util';\nimport {saveInspectioBoard} from \"../../core/localStorage\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {BoardVersion} from \"../model/BoardVersion\";\n\n\ntype FlowAction = ActionType<typeof Action.Command.saveBoard> & ActionType<typeof Action.Event.boardImported>;\n\nfunction* onSaveBoard(action: FlowAction, forceSnapshot: boolean) {\n    const [graph] = useGraph();\n\n    // console.log('saveBoardFlow');\n    //\n    // saveInspectioBoard(action.payload.board, (err) => {\n    //     console.log('saveBoardFlowErr', err);\n    //     localError = err;\n    // })\n    //\n    // if(localError) {\n    //     const errorNotification = Notify.Command.error('Failed to save board in local storage', localError);\n    //     yield put(errorNotification);\n    // }\n\n    console.log('saveBoardFlow: ', action.payload.board.version.version, action.payload.board.version.version % 20 );\n    // @TODO Check if socket connection is active, otherwise always take a snapshot\n    if(action.payload.board.tempBoard) {\n        console.log('saveBoardFlow: ', 'Skipping save of temp board');\n        return;\n    }\n\n    if(action.payload.board.version.version % 20 === 0 || action.payload.board.version.version < 5 || forceSnapshot) {\n\n        const snapshot = graph.exportXmlSnapshot();\n\n        let retry = 3;\n        do {\n            const boardVersion = new BoardVersion({userId: action.payload.board.version.userId, version: action.payload.board.version.version + (3-retry)});\n            const {error}: ResponseType = yield call(Action.Api.takeBoardSnapshot, action.payload.board.uid, boardVersion, snapshot);\n\n            if(error) {\n                retry--;\n            } else {\n                retry = 0;\n            }\n\n            if (retry === 0 && error) {\n                yield put(Notify.Command.error('Server Error', 'Could not take board snapshot.'));\n            }\n        } while (retry > 0);\n    }\n}\n\nexport function* saveBoardFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.SAVE_BOARD,\n            Action.Type.BOARD_IMPORTED\n        ]);\n\n        let forceSnapshot = false;\n\n        if(action.type === Action.Type.BOARD_IMPORTED) {\n            // Always make a snapshot on import\n            forceSnapshot = true;\n        }\n\n        yield fork(onSaveBoard, action, forceSnapshot);\n    }\n}\n","import {call, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../actions\";\n\ntype FlowAction = ActionType<typeof Action.Command.setBoardTags>\n\nexport function* setBoardTagsFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.SET_BOARD_TAGS]);\n\n        const {response, error}: ResponseType = yield call(Action.Api.setBoardTags, action.payload.board.uid, action.payload.board.tags);\n\n        if (error) {\n            yield put(NotifyAction.Command.error('Request Error', 'Could not set tags.'));\n            yield put(Action.Query.fetchUserBoards());\n        }\n\n        if(response) {\n            yield put(NotifyAction.Command.info('Tags set', ''));\n        }\n    }\n}\n","import { call, fork, put, select, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport { Action as NotifyAction } from '../../NotificationSystem';\nimport * as Action from \"../actions\";\n\ntype FlowAction = ActionType<typeof Action.Command.shareBoard>;\n\nfunction* onShareBoard(action: FlowAction) {\n    const {response, error}: ResponseType = yield call(\n        Action.Api.shareBoard,\n        action.payload.boardId,\n        action.payload.email,\n        action.payload.permissions\n    );\n\n    if (error && error.status === 404) {\n        yield put(NotifyAction.Command.error(\"User not found\", \"Please check the entered username. Also the user needs to sign in at least once before you can share your board with them.\"))\n    }\n\n    if(error) {\n        yield put(NotifyAction.Command.error(\"Action Failed\", error.data.error.message))\n    }\n\n    if(response) {\n        yield put(NotifyAction.Command.info(\"Board shared with \" + action.payload.email, ''));\n        yield put(Action.Query.fetchOpenBoardInvitations(action.payload.boardId));\n        yield put(Action.Query.fetchBoardPermissionsForUsers(action.payload.boardId));\n    }\n}\n\nexport function* shareBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.SHARE_BOARD,\n        ]);\n\n        yield fork(onShareBoard, action);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype Command = ActionType<typeof Action.Command.shareBoardWithAnyone>\n\nfunction* handleShareBoardWithAnyone(command: Command) {\n  const {response, error}: ResponseType = yield call(Action.Api.shareBoardWithAnyone, command.payload.boardId, command.payload.permissions);\n\n  if(error) {\n    yield put(NotifyAction.Command.error('Request Error', 'Failed to share board with anyone.'));\n  }\n\n  if(response) {\n    yield put(NotifyAction.Command.info('Access Granted', 'Anyone now has access to the board.'));\n\n    yield put(Action.Event.boardSharedWithAnyone(command.payload.boardId, command.payload.permissions));\n  }\n}\n\nexport function* shareBoardWithAnyoneFlow() {\n  while (true) {\n    const command: Command = yield take([\n      Action.Type.SHARE_BOARD_WITH_ANYONE\n    ]);\n\n    yield fork(handleShareBoardWithAnyone, command);\n  }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype Command = ActionType<typeof Action.Command.shareBoardWithOrganizationMembers>\n\nfunction* handleShareBoardWithOrganizationMembers(command: Command) {\n  const {response, error}: ResponseType = yield call(Action.Api.shareBoardWithOrganizationMembers, command.payload.boardId, command.payload.permissions);\n\n  if(error) {\n    yield put(NotifyAction.Command.error('Request Error', 'Failed to share board with organization members.'));\n  }\n\n  if(response) {\n    yield put(NotifyAction.Command.info('Access Granted', 'Organization members now have access to the board.'));\n\n    yield put(Action.Event.boardSharedWithOrganizationMembers(command.payload.boardId, command.payload.permissions));\n  }\n}\n\nexport function* shareBoardWithOrganizationMembersFlow() {\n  while (true) {\n    const command: Command = yield take([\n      Action.Type.SHARE_BOARD_WITH_ORGANIZATION_MEMBERS\n    ]);\n\n    yield fork(handleShareBoardWithOrganizationMembers, command);\n  }\n}\n","import {OBJECT_STORE_USER_SETTINGS} from \"../../standalone/storage/StandaloneIndexedDB\";\n\n/**\n * Specifies the current version of the insp_boards IndexedDB. This should be incremented whenever the structure of\n * the DB has changed and a migration is required. Take a look at StandaloneIndexedDB::updateDatabaseToLatestVersion.\n * Note: This must be an integer!\n */\nconst DB_VERSION: number = 1\n\nexport const OBJECT_STORE_OVERVIEW = 'overview';\n\nclass BoardsIndexedDB {\n    private initializationPromise: Promise<void>;\n    private db?: IDBDatabase;\n\n    constructor() {\n        this.initializationPromise = new Promise((resolve, reject) => {\n            const openRequest = indexedDB.open('insp_boards', DB_VERSION);\n\n            openRequest.onupgradeneeded = (event: IDBVersionChangeEvent) => {\n                this.updateDatabaseToLatestVersion(openRequest.result, event.oldVersion);\n            }\n\n            openRequest.onerror = () => {\n                reject('IndexedDB could not be initialized');\n            }\n\n            openRequest.onsuccess = () => {\n                this.db = openRequest.result;\n                resolve();\n            };\n        });\n    }\n\n    public async get(objectStore: string, key: string): Promise<any> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readonly');\n            const request = await transaction.objectStore(objectStore).get(key);\n\n            request.onsuccess = () => resolve(request.result);\n            request.onerror = () => reject();\n        });\n    }\n\n    public async getAll(objectStore: string): Promise<any[]> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readonly');\n            const request = await transaction.objectStore(objectStore).getAll();\n\n            request.onsuccess = () => resolve(request.result);\n            request.onerror = () => reject();\n        });\n    }\n\n    public async add(objectStore: string, data: object): Promise<void> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readwrite');\n            const request = transaction.objectStore(objectStore).add(data);\n\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject();\n        });\n    }\n\n    public async put(objectStore: string, data: object): Promise<void> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readwrite');\n            const request = transaction.objectStore(objectStore).put(data);\n\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject();\n        });\n    }\n\n    public async delete(objectStore: string, key: string): Promise<void> {\n        await this.assertDBInitialized();\n\n        return new Promise(async (resolve, reject) => {\n            const transaction = this.db!.transaction(objectStore, 'readwrite');\n            const request = transaction.objectStore(objectStore).delete(key);\n\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject();\n        });\n    }\n\n    public async assertDBInitialized(): Promise<void> {\n        await this.initializationPromise;\n\n        if (!this.db) {\n            throw new Error('IndexedDB is not initialized');\n        }\n    }\n\n    private updateDatabaseToLatestVersion(db: IDBDatabase, oldVersion: number): void {\n        // tslint:disable-next-line\n        console.log(`Starting upgrade for DB insp_boards from version ${oldVersion} to ${DB_VERSION}`);\n\n        /**\n         * Specify what migrations need to be done for each version to the next one. Make sure to not use any \"break\"\n         * statements since fallthrough is actually what we want here in order to handle larger version jumps.\n         */\n        switch (oldVersion) {\n            case 0: // Initialization (migration from version 0 to 1)\n                db.createObjectStore(OBJECT_STORE_OVERVIEW, { keyPath: 'key' });\n        }\n    }\n}\n\nexport default BoardsIndexedDB;\n","import BoardsIndexedDB from \"./BoardsIndexedDB\";\nimport BoardsStorageManager from \"./BoardsStorageManager\";\n\nlet manager: BoardsStorageManager;\n\nexport const useBoardsStorageManager = (): BoardsStorageManager => {\n    if(!manager) {\n        manager = new BoardsStorageManager(new BoardsIndexedDB());\n    }\n\n    return manager;\n}\n","import {SORT_OPTIONS} from \"../components/BoardOverview/Sorting\";\nimport BoardsIndexedDB, {OBJECT_STORE_OVERVIEW} from \"./BoardsIndexedDB\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\n\ninterface SortingSet {\n    key: 'sorting';\n    value: SORT_OPTIONS;\n}\n\ninterface ResponsibleTeamSet {\n    key: 'responsibleTeam';\n    value: TeamId | undefined;\n}\n\nclass BoardsStorageManager {\n    private db: BoardsIndexedDB;\n\n    constructor(db: BoardsIndexedDB) {\n        this.db = db;\n        this.getOverviewSorting = this.getOverviewSorting.bind(this);\n        this.setOverviewSorting = this.setOverviewSorting.bind(this);\n        this.getOverviewResponsibleTeam = this.getOverviewResponsibleTeam.bind(this);\n        this.setOverviewResponsibleTeam = this.setOverviewResponsibleTeam.bind(this);\n    }\n\n    public async getOverviewSorting(): Promise<SORT_OPTIONS> {\n        const sorting: SortingSet = await this.db.get(OBJECT_STORE_OVERVIEW, 'sorting') || {key: 'sorting', value: SORT_OPTIONS.LAST_MODIFIED_DESC};\n\n        return sorting.value;\n    }\n\n    public async setOverviewSorting(sort: SORT_OPTIONS): Promise<void> {\n        await this.db.put(OBJECT_STORE_OVERVIEW, {key: 'sorting', value: sort});\n    }\n\n    public async getOverviewResponsibleTeam(): Promise<TeamId | undefined> {\n        const team: ResponsibleTeamSet = await this.db.get(OBJECT_STORE_OVERVIEW, 'responsibleTeam') || {key: \"responsibleTeam\", value: undefined};\n\n        return team.value;\n    }\n\n    public async setOverviewResponsibleTeam(team: TeamId | undefined): Promise<void> {\n        await this.db.put(OBJECT_STORE_OVERVIEW, {key: \"responsibleTeam\", value: team});\n    }\n}\n\nexport default BoardsStorageManager;\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport BoardsStorageManager from \"../storage/BoardsStorageManager\";\nimport {useBoardsStorageManager} from \"../storage/useBoardsStorageManager\";\nimport {AccordionContent} from \"semantic-ui-react\";\n\ntype Command = ActionType<typeof Action.Command.sortBoardOverview> | ActionType<typeof Action.Command.filterBoardOverviewByResponsibleTeam>;\n\nfunction* handleSortBoardOverview(command: ActionType<typeof Action.Command.sortBoardOverview>, manager: BoardsStorageManager) {\n    yield manager.setOverviewSorting(command.payload.sort);\n}\n\nfunction* handleFilterByResponsbileTeam(command: ActionType<typeof Action.Command.filterBoardOverviewByResponsibleTeam>, manager: BoardsStorageManager) {\n    yield manager.setOverviewResponsibleTeam(command.payload.teamId);\n}\n\nexport function* storeOverviewSettingsFlow() {\n    const manager = useBoardsStorageManager();\n\n    const sort = yield call(manager.getOverviewSorting);\n    const team = yield call(manager.getOverviewResponsibleTeam);\n\n    yield put(Action.Command.sortBoardOverview(sort));\n    yield put(Action.Command.filterBoardOverviewByResponsibleTeam(team));\n\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.SORT_BOARD_OVERVIEW,\n            Action.Type.FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM\n        ]);\n\n        if(command.type === Action.Type.SORT_BOARD_OVERVIEW && command.payload.sort !== sort) {\n            yield fork(handleSortBoardOverview, command, manager);\n        }\n\n        if(command.type === Action.Type.FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM && command.payload.teamId !== team) {\n            yield fork(handleFilterByResponsbileTeam, command, manager);\n        }\n    }\n}\n","import {fork, put,take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport * as SidebarAction from \"../../Layout/actions\";\nimport * as Action from \"../actions\";\nimport {BoardModel} from \"../model\";\nimport {Graph, MxGraphElement} from \"../model/Graph\";\n\ntype FlowAction = ActionType<typeof Action.Command.saveBoard\n    & typeof Action.Event.localBoardUpdatedWithRemoteChange\n    & typeof Action.Event.boardImported\n    & typeof Action.Event.boardInitialized>;\n\ntype SidebarToggleAction = ActionType<typeof SidebarAction.Command.toggleSidebarCollapsed>;\n\nfunction* onSaveBoard(boardId: BoardModel.BoardId, graph: Graph) {\n    const graphRoot = graph.getRoot();\n\n    if(graphRoot instanceof MxGraphElement) {\n        console.log(\"set potentially stale\");\n        graphRoot.setPotentiallyStale();\n    }\n\n    yield put(Action.Command.updateBoardElementsTree(boardId, graphRoot.children()));\n}\n\nexport function* syncElementsTreeFlow() {\n\n    let sidebarCollapsed = false;\n    let latestGraph: Graph;\n    let  latestBoardId: BoardModel.BoardId;\n    let initialized = false;\n\n    while (true) {\n        const action: FlowAction & SidebarToggleAction = yield take([\n            Action.Type.SAVE_BOARD,\n            Action.Type.LOCAL_BOARD_UPDATED_WITH_REMOTE_CHANGE,\n            Action.Type.BOARD_IMPORTED,\n            Action.Type.BOARD_INITIALIZED,\n            SidebarAction.Type.TOGGLE_SIDEBAR_COLLAPSED,\n        ]);\n\n        if(initialized && action.type === SidebarAction.Type.TOGGLE_SIDEBAR_COLLAPSED) {\n            sidebarCollapsed = action.payload.collapsed;\n\n            if(!sidebarCollapsed && latestGraph! && latestBoardId!) {\n                yield fork(onSaveBoard, latestBoardId, latestGraph);\n            }\n        }\n\n        switch (action.type) {\n            case Action.Type.SAVE_BOARD:\n            case Action.Type.LOCAL_BOARD_UPDATED_WITH_REMOTE_CHANGE:\n            case Action.Type.BOARD_IMPORTED:\n            case Action.Type.BOARD_INITIALIZED:\n                if(initialized && latestBoardId !== action.payload.board.uid) {\n                    initialized = false;\n                }\n\n                latestGraph = action.payload.graph;\n                latestBoardId = action.payload.board.uid;\n\n                if(!sidebarCollapsed) {\n                    initialized = true;\n                    yield fork(onSaveBoard, latestBoardId, latestGraph);\n                }\n            break;\n        }\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype Command = ActionType<typeof Action.Command.toggleCodySuggestEnabled>\n\nfunction* handleToggleCodySuggestEnabled(command: Command) {\n    const {response, error}: ResponseType = yield call(Action.Api.toggleCodySuggest, command.payload.board.uid, command.payload.board.codySuggestEnabled);\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not toggle cody suggest.'));\n        yield put(Action.Query.fetchUserBoards());\n    }\n\n    if(response) {\n        yield put(NotifyAction.Command.info('Cody Suggestions ' + (command.payload.board.codySuggestEnabled ? 'enabled' : 'disabled'), ''));\n    }\n}\n\nexport function* toggleCodySuggestEnabled() {\n  while (true) {\n    const command: Command = yield take([\n      Action.Type.TOGGLE_CODY_SUGGEST_ENABLED\n    ]);\n\n    yield fork(handleToggleCodySuggestEnabled, command);\n  }\n}\n","import {call, fork, put, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {Action} from \"../index\";\n\ntype Command = ActionType<typeof Action.Command.toggleEventModelingEnabled>\n\nfunction* handleToggleEventModelingEnabled(command: Command) {\n  const {response, error}: ResponseType = yield call(Action.Api.toggleEventModeling, command.payload.board.uid, command.payload.board.eventModelingEnabled);\n\n  if (error) {\n    yield put(NotifyAction.Command.error('Request Error', 'Could not toggle event modeling.'));\n    yield put(Action.Query.fetchUserBoards());\n  }\n\n  if(response) {\n    yield put(NotifyAction.Command.info('Event Modeling ' + (command.payload.board.eventModelingEnabled ? 'enabled' : 'disabled'), ''));\n  }\n}\n\nexport function* toggleEventModelingEnabled() {\n  while (true) {\n    const command: Command = yield take([\n      Action.Type.TOGGLE_EVENT_MODELING_ENABLED\n    ]);\n\n    yield fork(handleToggleEventModelingEnabled, command);\n  }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../index\";\nimport {createStickyTemplateFromDefault, deriveStickTemplateId} from \"../model/StickyTemplate\";\nimport {makeStickyTemplateSelector} from \"../selectors/StickyTemplate\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype SetStickyCommand = ActionType<typeof Action.Command.setStickyTemplate>;\ntype UpdateStickyAdvancedConfigCommand = ActionType<typeof Action.Command.updateStickyAdvancedConfig>;\ntype Command = SetStickyCommand & UpdateStickyAdvancedConfigCommand;\n\nfunction* handleSetStickyTemplate(command: SetStickyCommand) {\n    let stickyTemplate = yield select(makeStickyTemplateSelector(deriveStickTemplateId(command.payload.boardId, command.payload.cellType)));\n\n    const {boardId, cellType, template} = command.payload;\n\n    if (!stickyTemplate) {\n        stickyTemplate = createStickyTemplateFromDefault(\n            boardId,\n            cellType,\n            template\n        )\n    }\n\n    const {response, error}: ResponseType = yield call(Action.Api.setStickyTemplate,\n        stickyTemplate.boardId,\n        stickyTemplate.cellType,\n        template\n    );\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not set sticky template.'));\n    }\n    if (response) {\n        if(!command.payload.disableNotification) {\n            yield put(NotifyAction.Command.info('Sticky Template set', 'Sticky template for ' + cellType + ' set'));\n        }\n\n        yield put(Action.Event.stickyTemplateSet(stickyTemplate.setTemplate(template)));\n    }\n}\n\nfunction* handleUpdateStickyAdvancedConfig(command: UpdateStickyAdvancedConfigCommand) {\n    let stickyTemplate = yield select(makeStickyTemplateSelector(deriveStickTemplateId(command.payload.boardId, command.payload.cellType)));\n\n    if (!stickyTemplate) {\n        stickyTemplate = createStickyTemplateFromDefault(\n            command.payload.boardId,\n            command.payload.cellType,\n            ''\n        );\n    }\n\n    const {response, error}: ResponseType = yield call(Action.Api.updateStickyAdvancedConfig,\n        stickyTemplate.boardId,\n        stickyTemplate.cellType,\n        command.payload.templateType,\n        command.payload.templateSchema || undefined\n    );\n\n    if (error) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not update sticky advanced config.'));\n    }\n    if (response) {\n        if(!command.payload.disableNotification) {\n            yield put(NotifyAction.Command.info('Advanced Sticky Config updated', 'Advanced Sticky Config for ' + stickyTemplate.cellType + ' updated'));\n        }\n        stickyTemplate = stickyTemplate.setTemplateType(command.payload.templateType);\n\n        if (command.payload.templateSchema) {\n            stickyTemplate = stickyTemplate.setTemplateSchema(command.payload.templateSchema);\n        }\n\n        yield put(Action.Event.stickyAdvancedConfigUpdated(stickyTemplate));\n    }\n}\n\nexport function* updateStickyTemplate() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.SET_STICKY_TEMPLATE,\n            Action.Type.UPDATE_STICKY_ADVANCED_CONFIG\n        ]);\n\n        if (command.type === Action.Type.SET_STICKY_TEMPLATE) {\n            yield fork(handleSetStickyTemplate, command);\n        } else {\n            yield fork(handleUpdateStickyAdvancedConfig, command);\n        }\n    }\n}\n","import {default as UserProfile} from \"../User/components/UserProfile\";\nimport * as Action from \"./actions\";\nimport {default as AddBoard} from \"./components/AddBoardModal\";\nimport {default as BoardOverview} from \"./components/BoardOverview\";\nimport {default as EditBoard} from \"./containers/EditBoardContainer\";\nimport {default as MxGraphBoard} from \"./containers/MxGraphBoardContainer\";\nimport {BoardModel, BoardVersioning} from \"./model\";\nimport * as Saga from \"./sagas\";\nimport * as Selector from \"./selectors\";\n\nexport const MODULE = 'inspectioBoards';\n\nexport {\n    MxGraphBoard,\n    BoardOverview,\n    AddBoard,\n    EditBoard,\n    Action,\n    Saga,\n    Selector,\n    BoardModel,\n    BoardVersioning,\n    UserProfile\n}\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Card, Container, Grid, Header, Icon, Menu, MenuItem, Message} from \"semantic-ui-react\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeTeamListSelector} from \"../selectors/selectTeam\";\nimport TeamTab from \"./TeamOverview/TeamTab\";\n\nenum ActivePage {\n    organization = 'organization',\n    teams = 'teams'\n}\n\ninterface OwnProps {\n\n}\n\ntype TeamOverviewProps = OwnProps & WithNamespaces;\n\nconst TeamOverview = (props: TeamOverviewProps) => {\n    const teams = useSelector(makeTeamListSelector());\n    const currentUser = useSelector(makeGetCurrentUser());\n\n\n    return <Container>\n            <Grid stackable={true} padded={true}>\n                <TeamTab teams={teams} currentUser={currentUser} />\n            </Grid>\n    </Container>;\n};\n\nexport default withNamespaces()(TeamOverview);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {Accordion, Menu} from \"semantic-ui-react\";\n\ninterface OwnProps {\n    label: string;\n    maxLength?: number;\n    onClick?: (showAll: boolean) => void;\n}\n\nconst MaxLengthLabel: React.FC<OwnProps> = (props: OwnProps) => {\n    const maxLength = props.maxLength || 50;\n\n    const [active, setActive] = useState(false);\n\n    const showFullLabel = active && !props.onClick;\n\n    const handleClick = (evt: React.MouseEvent) => {\n        evt.preventDefault();\n        if(props.onClick) {\n            props.onClick(!active);\n        }\n        setActive(!active);\n    }\n\n    if(showFullLabel || props.label.length <= maxLength) {\n        return <>{ props.label }</>\n    } else {\n        return <>{ props.label.slice(0, maxLength) + ' ' }<span onClick={handleClick}>...</span></>\n    }\n};\n\nexport default MaxLengthLabel;\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {Link} from \"react-router-dom\";\nimport {Icon, Label, List} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\nimport {Palette} from \"../../theme/palette\";\nimport {HistoryCellType, HistoryEntry} from \"../model/HistoryEntry\";\nimport CellIcon from \"./CellIcon\";\nimport MaxLengthLabel from \"./MaxLengthLabel\";\n\ninterface OwnProps {\n    entry: HistoryEntry;\n    key: number;\n    clicks: number;\n    onClick: () => void;\n}\n\nconst BoardHistoryEntry = (props: OwnProps) => {\n\n    const [showAll, setShowAll] = useState(false);\n\n    return <List.Item as={ Link }\n                      key={props.key}\n                      className=\"ui vertical segment\"\n                      style={{borderRadius:'0'}}\n                      onClick={props.onClick}\n                      to={{pathname: Routes.compileInspectioBoardWorkspace(props.entry.boardId), search: `?cells=${props.entry.cellId}&clicks=${props.clicks}`}}>\n        <CellIcon cellType={props.entry.cellType} />\n        <List.Content>\n            <List.Header><MaxLengthLabel label={props.entry.label} maxLength={24} onClick={s => setShowAll(s)} /></List.Header>\n            <List.Description>\n                {`${props.entry.action} by ${props.entry.username}`}\n            </List.Description><List.Description>\n            <span className=\"date\" style={{color:\"grey\", fontSize:\"10px\"}}>{ (new Date(props.entry.date)).toLocaleString() }</span>\n        </List.Description>\n        </List.Content>\n        {showAll && <List.List style={{padding:'0'}}><List.Item><List.Description>{ props.entry.label }</List.Description></List.Item></List.List>}\n    </List.Item>\n};\n\nexport default BoardHistoryEntry;","import * as React from 'react';\nimport {useState} from \"react\";\nimport {AccordionContent, AccordionTitle, List} from \"semantic-ui-react\";\n\ninterface OwnProps {\n    title: string;\n    index: number;\n    isActiveByDefault?: boolean;\n    entries: React.ReactNode[];\n}\n\nconst BoardHistoryGroup = (props: OwnProps) => {\n\n    const [active, setActive] = useState(props.isActiveByDefault || false);\n\n    const handleClick = () => setActive(!active);\n\n    return <>\n        <AccordionTitle content={props.title} index={props.index} active={active} onClick={handleClick} />\n        <AccordionContent active={active}>\n            <List selection={true}>\n                { props.entries }\n            </List>\n        </AccordionContent>\n    </>;\n};\n\nexport default BoardHistoryGroup;","import moment from \"moment\";\nimport * as React from 'react';\nimport {useEffect, useMemo, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Dispatch} from \"redux\";\nimport {Accordion, AccordionContent, Card, Icon, List, Loader, Message, Transition} from \"semantic-ui-react\";\nimport {loadFirstBoardHistoryChunk, loadNextBoardHistoryChunk, toggleBoardHistory} from \"../actions/commands\";\nimport {BoardId} from \"../model/Board\";\nimport {BoardVersion} from \"../model/BoardVersion\";\nimport * as HistoryModel from \"../model/HistoryEntry\";\nimport {HistoryAction} from \"../model/HistoryEntry\";\nimport {HistoryState} from \"../model/HistoryState\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport {makeBoardHistoryByIdSelector} from \"../selectors/boardHistory\";\nimport BoardHistoryEntry from \"./BoardHistoryEntry\";\nimport BoardHistoryGroup from \"./BoardHistoryGroup\";\n\ninterface GroupedBoardHistory {\n    today: React.ReactNode[],\n    yesterday: React.ReactNode[],\n    twoDaysAgo: React.ReactNode[],\n    threeDaysAgo: React.ReactNode[],\n    fourDaysAgo: React.ReactNode[],\n    fiveDaysAgo: React.ReactNode[],\n    sixDaysAgo: React.ReactNode[],\n    lastWeek: React.ReactNode[],\n    twoWeeksAgo: React.ReactNode[],\n    threeWeeksAgo: React.ReactNode[],\n    fourWeeksAgo: React.ReactNode[],\n    lastMonth: React.ReactNode[],\n    older: React.ReactNode[],\n}\n\ninterface RelativeMoments {\n    today: moment.Moment;\n    startOfWeek: moment.Moment;\n    startOfMonth: moment.Moment;\n    startOfLastMonth: moment.Moment;\n}\n\ntype GroupedBoardHistoryKey = keyof GroupedBoardHistory;\n\nconst makeEmptyGroupedBoardHistory = (): GroupedBoardHistory => {\n    return {\n        today: [],\n        yesterday: [],\n        twoDaysAgo: [],\n        threeDaysAgo: [],\n        fourDaysAgo: [],\n        fiveDaysAgo: [],\n        sixDaysAgo: [],\n        lastWeek: [],\n        twoWeeksAgo: [],\n        threeWeeksAgo: [],\n        fourWeeksAgo: [],\n        lastMonth: [],\n        older: [],\n    }\n};\n\nconst marshalFeedEvent = (entry: HistoryModel.HistoryEntry, key: number, clicks: number, handleClick: () => void): React.ReactNode => {\n\n    return  <BoardHistoryEntry entry={entry} key={key} clicks={clicks} onClick={handleClick} />;\n};\n\nexport const generateRelativeMomentsFromNow = (now: moment.Moment): RelativeMoments => {\n    const startOfWeek = moment(now).startOf('isoWeek');\n    const startOfMonth = moment(now).startOf('month');\n    const startOfLastMonth = moment(startOfMonth).subtract(1, 'days').startOf('month');\n    const today = moment(now).startOf('day');\n\n    return {today, startOfWeek, startOfMonth, startOfLastMonth}\n};\n\nexport const convertToRelativeHistoryGroup = (\n    entryDate: moment.Moment,\n    now: moment.Moment,\n    {today, startOfWeek, startOfMonth, startOfLastMonth}: RelativeMoments\n): GroupedBoardHistoryKey => {\n\n    if(entryDate.isBefore(startOfLastMonth, 'month')) {\n        return 'older';\n    }\n\n    if(entryDate.isBefore(startOfMonth)) {\n        return 'lastMonth';\n    }\n\n    if(entryDate.isBefore(startOfWeek)) {\n        const numOfWeeks = entryDate.diff(startOfWeek, 'weeks');\n\n        if(numOfWeeks === 0) {\n            return 'lastWeek';\n        }\n\n        if(numOfWeeks === -1) {\n            return 'twoWeeksAgo';\n        }\n\n        if(numOfWeeks === -2) {\n            return 'threeWeeksAgo';\n        }\n\n        return 'fourWeeksAgo';\n    }\n\n    if(entryDate.isBefore(today)) {\n        const numOfDays = entryDate.diff(today, 'days');\n\n        if(numOfDays === 0) {\n            return 'yesterday';\n        }\n\n        if(numOfDays === -1) {\n            return 'twoDaysAgo';\n        }\n\n        if(numOfDays === -2) {\n            return 'threeDaysAgo';\n        }\n\n        if(numOfDays === -3) {\n            return 'fourDaysAgo';\n        }\n\n        if(numOfDays === -4) {\n            return 'fiveDaysAgo';\n        }\n\n        return 'sixDaysAgo';\n    }\n\n    return 'today';\n}\n\nconst loadHistory = (dispatch: Dispatch, boardId: BoardId, boardVersion?: BoardVersion): void => {\n    if(boardVersion) {\n        dispatch(loadNextBoardHistoryChunk(boardId, boardVersion))\n    } else {\n        dispatch(loadFirstBoardHistoryChunk(boardId));\n    }\n}\n\ninterface BoardHistoryRouteMatchParams {\n    uid: BoardId;\n}\n\ninterface OwnProps {\n    elementId?: string;\n}\n\ntype BoardHistoryProps = OwnProps &  WithNamespaces & RouteComponentProps<BoardHistoryRouteMatchParams>;\n\nconst BoardHistory = (props: BoardHistoryProps) => {\n\n    const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.match.params.uid), []);\n    const getBoardHistoryByIdSelector = useMemo(() => makeBoardHistoryByIdSelector(props.match.params.uid), []);\n    const [clicks, setClicks] = useState(1);\n\n    const board = useSelector(getBoardByIdSelector);\n    const history: HistoryState = useSelector(getBoardHistoryByIdSelector);\n    const dispatch = useDispatch();\n    const visible =  (board && board.shouldShowHistory) || !!props.elementId;\n\n    const handleClick = () => {\n        setClicks(clicks + 1);\n    }\n\n    const feedEvents: GroupedBoardHistory = useMemo(() => {\n\n        const now = moment();\n        const relativeMoments = generateRelativeMomentsFromNow(now);\n        const groupedHistory = makeEmptyGroupedBoardHistory();\n\n        history.history.filter(entry => !props.elementId || entry.cellId === props.elementId).forEach((entry, key) => {\n            const entryDate = moment(entry.date, moment.ISO_8601);\n            const entryComponent = marshalFeedEvent(entry, key + 1, clicks, handleClick);\n            const groupKey = convertToRelativeHistoryGroup(entryDate, now, relativeMoments);\n            groupedHistory[groupKey].push(entryComponent);\n        });\n\n        return groupedHistory;\n    }, [history, clicks, props.elementId]);\n\n    const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n        const element = e.target;\n\n        if(element instanceof HTMLDivElement) {\n            if (element.scrollHeight - element.scrollTop === element.clientHeight) {\n                if(!history.loading && history.olderPatchesAvailable) {\n                    loadHistory(dispatch, props.match.params.uid, history.oldestBoardVersion);\n                }\n            }\n        }\n    }\n\n    useEffect(() => {\n        const filteredHistory = history.history.filter(entry => !props.elementId || entry.cellId === props.elementId);\n        let foundFirstElementEntry = false;\n\n        if(props.elementId) {\n            const lastHistoryEntry = filteredHistory.last(undefined);\n\n            if(lastHistoryEntry && lastHistoryEntry.action === HistoryAction.added) {\n                foundFirstElementEntry = true;\n            }\n        }\n\n        if(filteredHistory.count() < 50 && !history.loading && history.olderPatchesAvailable && !foundFirstElementEntry) {\n            loadHistory(dispatch, props.match.params.uid, history.oldestBoardVersion);\n        }\n    }, [history]);\n\n    const handleCloseHistory = useMemo(() => {\n        return () => {\n            dispatch(toggleBoardHistory(props.match.params.uid, false));\n        };\n    }, [props.match.params.uid]);\n\n    const boardHistoryGroups = [];\n    let count = 0;\n    let group: GroupedBoardHistoryKey;\n    for(group in feedEvents) {\n        if (feedEvents.hasOwnProperty(group)) {\n            if(feedEvents[group].length > 0) {\n                boardHistoryGroups.push(<BoardHistoryGroup key={group} title={props.t(`insp.history.${group}`)} index={count} entries={feedEvents[group]} isActiveByDefault={count === 0} />);\n                count++;\n            }\n        }\n    }\n\n    if(visible && history.loading) {\n        boardHistoryGroups.push(<AccordionContent active={true}>\n            <List>\n                <List.Item key=\"item-loader\" style={{paddingTop: \"10px\"}}><Loader active={true} inline='centered' /></List.Item>\n            </List>\n        </AccordionContent>)\n    }\n\n    if(visible && !history.loading && count === 0) {\n        boardHistoryGroups.push(<Message warning={true} content=\"No activity available for this element. This happens when the element was added together with other elements, e.g. by importing an entire board or pasting a group of elements. We'll remove this limitation in the future.\" />)\n    }\n\n    return <>\n        {!props.elementId && <Transition.Group animation=\"slide down\">{visible && <div className=\"touch-only-pan\" style={{position: \"absolute\", paddingTop: \"50px\", top: \"0px\", right: \"0px\", height: \"100%\", overflow: \"hidden\", borderLeft:\"5px solid #eee\", zIndex: 99}}>\n                <Card style={{height: \"100%\", borderRadius:'0'}}>\n                <Card.Content>\n                  <Card.Header><Icon name=\"close\" className=\"right floated\" onClick={handleCloseHistory} style={{cursor: \"pointer\"}} /> Activity</Card.Header>\n                </Card.Content>\n                <Card.Content onScroll={handleScroll} style={{position: \"relative\", height: \"100%\", overflowY: \"scroll\",}}>\n                    <Accordion>\n                        { boardHistoryGroups }\n                    </Accordion>\n                </Card.Content>\n                </Card>\n            </div>}\n        </Transition.Group>}\n        {!!props.elementId && <div onScroll={handleScroll}>\n            <Accordion>\n                { boardHistoryGroups }\n            </Accordion>\n        </div>}\n    </>\n};\n\nexport default withNamespaces()(withRouter(BoardHistory));\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {useEffect} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Redirect, RouteComponentProps} from \"react-router\";\nimport {Dimmer, Loader} from \"semantic-ui-react\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport * as Routes from \"../../routes\";\nimport * as UserModule from \"../../User\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {ackBoardInvitation, fetchBoardOfInvitation} from \"../actions/api\";\nimport {BoardId, BoardName} from \"../model/Board\";\n\ninterface OwnProps {\n\n}\n\ninterface RouteMatchParams {\n    invitation: string;\n}\n\ntype BoardInvitationProps = OwnProps & RouteComponentProps<RouteMatchParams> & WithNamespaces;\n\nconst BoardInvitation = (props: BoardInvitationProps) => {\n    const invitationId = props.match.params.invitation;\n\n    const currentUserSelector = makeGetCurrentUser();\n\n    const currentUser = useSelector(currentUserSelector);\n    const [doRedirect, setDoRedirect] = useState(false);\n    const [redirectPath, setRedirectPath] = useState(Routes.inspectio);\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if(currentUser.signedIn) {\n            fetchBoardOfInvitation(invitationId)\n            .then(({response, error}) => {\n                if(error) {\n                    dispatch(Notify.Command.error('Request failed', 'Failed to process board invitation'));\n                    setDoRedirect(true);\n                    return;\n                }\n\n                if(response) {\n                    const boardName: BoardName = response.data.name;\n                    const boardId: BoardId = response.data.boardId;\n                    const organizationId: OrganizationId | null = response.data.organizationId;\n\n                    let retries = 0;\n\n                    const handleAckResponse = (ackResponse: ResponseType) => {\n                        if(ackResponse.error) {\n                            // Invited user is new and username sync seems still be in progress\n                            if(retries < 2) {\n                                retries++;\n                                window.setTimeout(() => {\n                                    ackBoardInvitation(invitationId).then(handleAckResponse);\n                                }, 100);\n                                return;\n                            }\n\n                            dispatch(Notify.Command.error('Command failed', 'Failed to process board invitation'));\n                            setDoRedirect(true);\n                            return;\n                        }\n\n                        if(organizationId) {\n                            dispatch(UserModule.Action.Command.switchActiveOrganization(organizationId));\n                        }\n\n                        dispatch(Notify.Command.info(\n                            props.t('insp.board.joined.title'),\n                            props.t('insp.board.joined.details', {name: boardName}))\n                        );\n                        setRedirectPath(Routes.compileInspectioBoardWorkspace(boardId));\n                        setDoRedirect(true);\n                    };\n\n                    ackBoardInvitation(invitationId)\n                        .then(handleAckResponse);\n                }\n            });\n        }\n    }, [currentUser.signedIn]);\n\n\n    if(doRedirect) {\n        return <Redirect to={redirectPath} />\n    }\n\n    return <Dimmer active={true} className=\"page\"><Loader size=\"large\">Processing Board Invitation</Loader></Dimmer>;\n};\n\nexport default withNamespaces()(BoardInvitation);\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Redirect, RouteComponentProps} from \"react-router\";\nimport {Dimmer, Loader} from \"semantic-ui-react\";\nimport {ResponseType} from \"../../api/util\";\nimport {Action} from \"../../InspectioBoards\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport * as Routes from \"../../routes\";\nimport * as User from \"../../User\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {ackTeamInvitation, fetchTeamOfInvitation} from \"../actions/api\";\nimport {TeamName} from \"../model/Team\";\n\ninterface OwnProps {\n\n}\n\ninterface RouteMatchParams {\n    invitation: string;\n}\n\ntype TeamInvitationProps = OwnProps & RouteComponentProps<RouteMatchParams> & WithNamespaces;\n\nconst TeamInvitation = (props: TeamInvitationProps) => {\n    const invitationId = props.match.params.invitation;\n    const currentUserSelector = makeGetCurrentUser();\n\n    const currentUser = useSelector(currentUserSelector);\n    const [doRedirect, setDoRedirect] = useState(false);\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if(currentUser.signedIn) {\n            fetchTeamOfInvitation(invitationId)\n            .then(({response, error}) => {\n                if(error) {\n                    dispatch(Notify.Command.error('Request failed', 'Failed to process team invitation'));\n                    setDoRedirect(true);\n                    return;\n                }\n\n                if(response) {\n                    const teamName: TeamName = response.data.name;\n                    const organizationId: OrganizationId = response.data.organizationId || null;\n\n                    let retries = 0;\n\n                    const handleAckResponse = (ackResponse: ResponseType) => {\n                        if(ackResponse.error) {\n                            // Invited user is new and username sync seems still be in progress\n                            if(retries < 2) {\n                                retries++;\n                                window.setTimeout(() => {\n                                    ackTeamInvitation(invitationId).then(handleAckResponse);\n                                }, 100);\n                                return;\n                            }\n\n                            dispatch(Notify.Command.error('Command failed', 'Failed to process team invitation'));\n                            setDoRedirect(true);\n                            return;\n                        }\n\n                        dispatch(Notify.Command.info(\n                            props.t('insp.team.joined.title'),\n                            props.t('insp.team.joined.details', {team: teamName}))\n                        );\n\n                        if(organizationId) {\n                            dispatch(User.Action.Command.switchActiveOrganization(organizationId));\n                        }\n\n                        dispatch(Action.Query.fetchUserBoards());\n                        setDoRedirect(true);\n                    };\n\n                    ackTeamInvitation(invitationId)\n                        .then(handleAckResponse);\n                }\n            });\n        }\n    }, [currentUser.signedIn]);\n\n    if(doRedirect) {\n        return <Redirect to={Routes.inspectio} />\n    }\n\n    return <Dimmer active={true} className=\"page\"><Loader size=\"large\">Processing Team Invitation</Loader></Dimmer>;\n};\n\nexport default  withNamespaces()(TeamInvitation);\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Button, Dropdown, DropdownProps, Modal} from \"semantic-ui-react\";\nimport * as BoardModule from \"../../InspectioBoards\";\nimport {TeamId} from \"../model/Team\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\n\ninterface OwnProps {\n    teamId: TeamId;\n    open: boolean;\n    onClose: () => void;\n    onSubmit: (selectedBoard: BoardModule.BoardModel.BoardId) => void;\n}\n\ntype AddBoardToTeamModalProps = OwnProps & WithNamespaces;\n\nconst AddBoardToTeamModal = (props: AddBoardToTeamModalProps) => {\n\n    const userBoards = useSelector(BoardModule.Selector.BoardListSelector.makeGetAllBoards());\n    const [selectedBoard, setSelectedBoard] = useState('');\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n\n    const isAdmin = organization ? organization.isAdmin(currentUser.uid) : false;\n\n    const boardChoices = userBoards.filter(board => (board.organization? isAdmin : !board.shared) && !board.assignedTeams.contains(props.teamId)).map(board => ({\n        key: board.uid,\n        value: board.uid,\n        text: board.name,\n    })).toArray();\n\n    const handleChange = (e: React.SyntheticEvent, dProps: DropdownProps) => setSelectedBoard(dProps.value as string);\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n\n        props.onSubmit(selectedBoard);\n        setSelectedBoard('');\n    };\n\n    return (\n        <Modal open={props.open} closeIcon={true} onClose={props.onClose} size=\"mini\">\n            <Modal.Header>{props.t('insp.team.grant_access')}</Modal.Header>\n            <Modal.Content>\n                <form onSubmit={handleSubmit}>\n                    <Dropdown\n                        placeholder={props.t('insp.team.choose_board') as string}\n                        fluid={true}\n                        search={true}\n                        selection={true}\n                        options={boardChoices}\n                        onChange={handleChange}\n                        value={selectedBoard}\n                    />\n                    <div style={{marginTop: '10px'}}>\n                        <Button primary={true} type=\"submit\" disabled={selectedBoard === ''}>\n                            {props.t('app.form.confirm')}\n                        </Button>\n                    </div>\n                </form>\n            </Modal.Content>\n        </Modal>\n    );\n};\n\nexport default withNamespaces()(AddBoardToTeamModal);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Redirect} from \"react-router\";\nimport {Button, Confirm, Dropdown, Menu, Popup} from \"semantic-ui-react\";\nimport * as BoardModule from \"../../InspectioBoards\";\nimport * as Route from \"../../routes\";\nimport * as Action from \"../actions\";\nimport {Team} from \"../model/Team\";\n\n\ninterface OwnProps {\n    board: BoardModule.BoardModel.Board;\n    team: Team;\n    readonly?: boolean;\n}\n\ntype BoardEntryProps = OwnProps & WithNamespaces;\n\nconst BoardEntry = (props: BoardEntryProps) => {\n    const [showDropdown, setShowDropdown] = useState(false);\n    const [showRemoveBoardConfirm, setShowRemoveBoardConfirm] = useState(false);\n    const [redirectToBoard, setRedirectToBoard] = useState(false);\n    const dispatch = useDispatch();\n\n    const openPopup = () => {\n        setShowDropdown(true);\n    };\n\n    const closePopup = () => {\n        setShowDropdown(false);\n    };\n\n    const removeBoardFromTeam = () => {\n        if(!props.readonly) {\n            dispatch(Action.Command.adminRevokeTeamAccessToBoard(props.board.uid, props.team.uid));\n        }\n        setShowRemoveBoardConfirm(false);\n    };\n\n    const handleBoardClick = () => {\n        if(props.readonly) {\n            setRedirectToBoard(true);\n        }\n    };\n\n    if(redirectToBoard) {\n        return <Redirect push={true} to={Route.compileInspectioBoardWorkspace(props.board.uid)} />\n    }\n\n    return <>\n        <Popup\n            open={showDropdown}\n            onOpen={openPopup}\n            onClose={closePopup}\n            on=\"click\"\n            position=\"bottom center\"\n            disabled={props.readonly}\n            content={<Menu secondary={true} vertical={true} compact={true}>\n                <Menu.Item\n                    content={props.t('app.open') as string}\n                    onClick={() => setRedirectToBoard(true)}\n                />\n                <Menu.Item\n                    content={props.t('app.form.remove') as string}\n                    onClick={() => {\n                        setShowDropdown(false);\n                        setShowRemoveBoardConfirm(true);\n                    }}\n                />\n            </Menu>}\n            trigger={<div className=\"ui large basic orange button\" key={props.board.uid} onClick={handleBoardClick}>\n                <div>{ props.board.name }</div>\n            </div>}\n        />\n        <Confirm\n            open={showRemoveBoardConfirm}\n            header={props.t('insp.team.remove_board_confirm_title')}\n            content={props.t(\n                'insp.team.remove_board_confirm_text',\n                { board_name: props.board.name }\n            )}\n            confirmButton={props.t('insp.team.remove_board_confirm_button')}\n            cancelButton={<Button content={props.t('app.form.cancel')} className=\"basic noborder\" />}\n            onCancel={() => setShowRemoveBoardConfirm(false)}\n            onConfirm={removeBoardFromTeam}\n        />\n    </>;\n};\n\nexport default withNamespaces()(BoardEntry);","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport EditableTextline from \"../../core/components/EditableTextline\";\nimport {Action} from \"../index\";\nimport {Team} from \"../model\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\n\ninterface OwnProps {\n    team: Team.Team;\n    addTeamMode?: boolean;\n    onNameChanged?: (newName: Team.TeamName) => void;\n    onCancelName?: () => void;\n    onCancelDescription?: () => void;\n}\n\ntype EditableTeamHeaderProps = OwnProps & WithNamespaces;\n\nconst INPUT_CHAR_SIZE = 9;\nconst CHAR_SIZE_UNIT = 'px';\nconst ADDITIONAL_CHAR_PADDING = 20;\n\nconst EditableTeamHeader = (props: EditableTeamHeaderProps) => {\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n    const dispatch = useDispatch();\n\n    const handleNameChanged = (teamName: Team.TeamName) => {\n        if(props.addTeamMode) {\n            dispatch(Action.Command.addTeam(props.team.uid, teamName, activeOrganization? activeOrganization.uid : null));\n            if(props.onNameChanged) {\n                props.onNameChanged(teamName);\n            }\n        } else {\n            dispatch(Action.Command.renameTeam(props.team.uid, teamName));\n        }\n    }\n\n    const handleDescriptionChanged = (desc: Team.TeamDescription) => {\n        dispatch(Action.Command.changeTeamDescription(props.team.uid, desc));\n    }\n\n\n    return <h3 style={{margin:0, cursor:\"pointer\"}} id={props.team.uid}>\n        <EditableTextline\n            text={props.team.name}\n            charSize={INPUT_CHAR_SIZE}\n            widthUnit={CHAR_SIZE_UNIT}\n            padding={ADDITIONAL_CHAR_PADDING}\n            required={true}\n            onTextChanged={handleNameChanged}\n            focus={props.addTeamMode}\n            onCancel={props.onCancelName}\n            placeholder={props.t('insp.team.team_name') as string}\n        />\n        <span> &mdash; </span>\n        <span className=\"sub header\" style={{margin:0, cursor:\"pointer\"}}><EditableTextline\n            text={props.team.description}\n            charSize={INPUT_CHAR_SIZE}\n            widthUnit={CHAR_SIZE_UNIT}\n            padding={ADDITIONAL_CHAR_PADDING}\n            placeholder={props.t('insp.team.team_description') as string}\n            onTextChanged={handleDescriptionChanged}\n            onCancel={props.onCancelDescription}\n        /></span>\n    </h3>;\n};\n\nexport default withNamespaces()(EditableTeamHeader);\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {ButtonGroup, Grid, GridColumn, GridRow, Icon, ListItem} from \"semantic-ui-react\";\nimport SecondaryButton from \"../../core/components/SecondaryButton\";\nimport {isSuccess} from \"../../core/validation/either\";\nimport * as UserModule from \"../../User\";\nimport UserAvatar from \"../../User/components/UserAvatar\";\nimport {createAnonymous, IioUserInfo} from \"../../User/model/IioUserInfo\";\nimport * as Action from \"../actions\";\nimport {Status, TeamInvitation} from \"../model/TeamInvitation\";\nimport {makeTeamInvitationListSelector, makeTeamInvitationSelector} from \"../selectors/TeamInvitation\";\n\ninterface OwnProps {\n    teamInvitation: TeamInvitation;\n}\n\ntype OpenInvitationProps = OwnProps & WithNamespaces;\n\nconst OpenInvitation = (props: OpenInvitationProps) => {\n\n    const [userInfo, setUserInfo] = useState(createAnonymous());\n    const [isResending, setIsResending] = useState(false);\n    const [isRevoking, setIsRevoking] = useState(false);\n    const [isRevoked, setIsRevoked] = useState(false);\n    const dispatch = useDispatch();\n    const cachedInvitation = useSelector(makeTeamInvitationSelector(props.teamInvitation.uid));\n\n    useEffect(() => {\n        UserModule.Action.Api.getInspectioUserInfoByEmail(props.teamInvitation.invitedUser).then(({response, error}) => {\n            if(response) {\n                const result = UserModule.IioUserInfo.createIioUserInfoFromServerData(response.data);\n\n                if(isSuccess(result)) {\n                    setUserInfo(result.value);\n                }\n            }\n        })\n    }, [props.teamInvitation.invitedUser]);\n\n    useEffect(() => {\n        if(isResending) {\n            setIsResending(false);\n        }\n\n        if(isRevoking && cachedInvitation && cachedInvitation.status === Status.revoked) {\n            setIsRevoked(true);\n        }\n    }, [cachedInvitation]);\n\n    const handleResendClick = () => {\n        setIsResending(true);\n        dispatch(Action.Command.resendTeamInvitation(props.teamInvitation.uid));\n    };\n\n    const handleRevokeClick = () => {\n        setIsRevoking(true);\n        dispatch(Action.Command.revokeTeamInvitation(props.teamInvitation.uid));\n    }\n\n    if(isRevoked) {\n        return <></>;\n    };\n\n    return <ListItem>\n        <UserAvatar user={userInfo} size=\"mini\" />\n        <span style={{paddingLeft: \"10px\"}}>{props.teamInvitation.invitedUser}</span>\n        <ButtonGroup floated=\"right\">\n            <SecondaryButton content={props.t('app.form.resend')} icon=\"paper plane\" loading={isResending} onClick={handleResendClick} />\n            <SecondaryButton content={props.t('app.form.revoke')} icon=\"delete\" loading={isRevoking} onClick={handleRevokeClick} />\n        </ButtonGroup>\n    </ListItem>\n};\n\nexport default withNamespaces()(OpenInvitation);","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {List as SemanticList} from \"semantic-ui-react\";\nimport {TeamInvitation} from \"../model/TeamInvitation\";\nimport OpenInvitation from \"./OpenInvitation\";\n\ninterface OwnProps {\n    invitations: List<TeamInvitation>\n}\n\ntype OpenInvitationListProps = OwnProps;\n\nconst OpenInvitationList = (props: OpenInvitationListProps) => {\n\n    const items = props.invitations.map((invitation) => {\n        return <OpenInvitation teamInvitation={invitation} key={invitation.uid}/>;\n    });\n\n    return <SemanticList relaxed={true} divided={true}>\n        {items}\n    </SemanticList>;\n};\n\nexport default OpenInvitationList;","import {List} from \"immutable\";\nimport * as React from \"react\";\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Icon, Input, Modal, Search} from \"semantic-ui-react\";\nimport * as uuid from \"uuid\";\nimport {\n    execForEach,\n    execValidate,\n    execValidateEach,\n    isFailure,\n    isSuccess,\n    pipe, predicateEither, validate\n} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport * as Action from \"../actions\";\nimport {fetchOpenTeamInvitations} from \"../actions/api\";\nimport {Team} from \"../model\";\nimport {createTeamInvitationFromServerData, TeamInvitation} from \"../model/TeamInvitation\";\nimport OpenInvitationList from \"./OpenInvitationList\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {UserId} from \"../../User/model/UserInfo\";\nimport {makeIioFilteredUserListSelector} from \"../../User/selectors/iioUserInfo\";\n\ninterface OwnProps {\n    team: Team.Team;\n    open: boolean;\n    onClose: () => void;\n}\n\ntype InviteUserToTeamModalProps = WithNamespaces & RouteComponentProps & OwnProps;\n\nconst InviteUserToTeamModal = (props: InviteUserToTeamModalProps) => {\n    const [email, setEmail] = useState('');\n    const [loadingInvitations, setLoadingInvitations] = useState(true);\n    const [invitations, setInvitations] = useState(List<TeamInvitation>());\n    const [failedToLoad, setFailedToLoad] = useState(false);\n\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const organizationUserIds = List<UserId>(organization ? [organization.ownerId, ...organization.members.toJS()] : []);\n    const organizationUsers = useSelector(makeIioFilteredUserListSelector(organizationUserIds));\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if(props.open) {\n            setLoadingInvitations(true);\n            fetchOpenTeamInvitations(props.team.uid).then(({response, error}) => {\n                setLoadingInvitations(false);\n\n                if(error) {\n                    // tslint:disable-next-line:no-console\n                    console.error(error);\n                    setFailedToLoad(true);\n                }\n\n                if(response) {\n                    const result = pipe(\n                        response.data,\n                        execValidate([isArray(), \"Response data is not of type Array\"]),\n                        execForEach(createTeamInvitationFromServerData)\n                    );\n\n                    if(isFailure(result)) {\n                        // tslint:disable-next-line:no-console\n                        console.error(\"Failed to process open team invitations loaded from server\", result.value, response.data);\n                        setFailedToLoad(true);\n                    }\n\n                    if(isSuccess(result)) {\n                        setInvitations(List(result.value));\n                        dispatch(Action.Event.teamInvitationsLoaded(List(result.value)));\n                    }\n                }\n            });\n        }\n\n        if(!props.open) {\n            setInvitations(List());\n        }\n    }, [props.open]);\n\n    const handleSubmit = () => {\n        dispatch(Action.Command.inviteUserToTeam(uuid.v4(), props.team.uid, email));\n        setEmail('');\n        props.onClose();\n    };\n\n    const hasInvitations = !(!loadingInvitations && invitations.count() === 0);\n\n    const filteredUsers = organizationUsers\n        .filter(user => user.username.toLocaleLowerCase().includes(email.toLocaleLowerCase()) || user.email.toLocaleLowerCase().includes(email.toLocaleLowerCase()))\n        .sortBy(user => user.username)\n        .map(user => {\n            return {\n                id: user.userId,\n                title: user.username,\n                description: user.email,\n                image: user.avatarUrl,\n            }\n        });\n\n    return (\n        <Modal open={props.open} closeIcon={true} onClose={props.onClose}>\n            <Modal.Header>{props.t('insp.team.invite_user')}</Modal.Header>\n            <Modal.Content>\n                <form onSubmit={handleSubmit}>\n                    <div style={{ marginBottom: '10px' }}>\n                        <Search\n                            style={{ width: '100%' }}\n                            fluid={true}\n                            value={email}\n                            results={filteredUsers.toArray()}\n                            placeholder={props.t('insp.team.user_email')}\n                            showNoResults={false}\n                            resultRenderer={data => {\n                                return <div key={data.id}>\n                                    <div className=\"ui image avatar\">\n                                        <img src={data.image} alt={data.title} />\n                                    </div>\n                                    <div className=\"content\">\n                                        <div className=\"title\">{data.title}</div>\n                                        <div className=\"description\">{data.description}</div>\n                                    </div>\n                                </div>\n                            }}\n                            onSearchChange={(e, data) => setEmail(data.value || '')}\n                            onResultSelect={(e, data) => {\n                                setEmail(data.result.description);\n                            }}\n                            autoFocus={true}\n                        />\n                    </div>\n                    <Button primary={true} type=\"submit\" disabled={!isValidEmail(email)}>\n                        {props.t('insp.team.send_invitation')}\n                    </Button>\n                </form>\n                <div className=\"ui horizontal divider\">{ props.t('insp.team.open_invitations') }</div>\n                {loadingInvitations && <Icon loading={true} name=\"spinner\" />}\n                {hasInvitations && <OpenInvitationList invitations={invitations} />}\n                {!hasInvitations && !failedToLoad && <p className=\"infotextSecondary\">{ props.t('insp.team.empty_invitations') }</p>}\n                {failedToLoad && <p className=\"infotextSecondary\" style={{color: 'red'}}>{ props.t('insp.team.error_loading_invitations') }</p>}\n            </Modal.Content>\n        </Modal>\n    );\n};\n\n/**\n * Validates the basic email structure; not a perfect validation\n *\n * @param value\n */\nconst isValidEmail = (value: string) => {\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value);\n};\n\nexport default withNamespaces()(withRouter(InviteUserToTeamModal));\n","import * as React from 'react';\nimport {SyntheticEvent, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Confirm, Dropdown} from \"semantic-ui-react\";\nimport {useOnBodyClick} from \"../../core/hooks/useOnBodyClick\";\nimport * as UserModule from \"../../User\";\nimport {IioUserInfo} from \"../../User/model\";\nimport * as Action from \"../actions\";\nimport {Team} from \"../model\";\n\ninterface OwnProps {\n    isOwner: boolean;\n    teamId: Team.TeamId;\n    member: IioUserInfo.IioUserInfo;\n    readonly?: boolean;\n}\n\ntype MemberEntryProps = OwnProps & WithNamespaces;\n\nconst MemberEntry = (props: MemberEntryProps) => {\n    const [showDropdown, setShowDropdown] = useState(false);\n    const [avatarLoaded, setAvatarLoaded] = useState(false);\n    const [showRemoveMemberConfirm, setShowRemoveMemberConfirm] = useState(false);\n    const dispatch = useDispatch();\n\n    useOnBodyClick(() => {\n        setShowDropdown(false);\n    });\n\n    const canBeRemoved = (userId: UserModule.UserModel.UserId): boolean => {\n        return !props.isOwner && !props.readonly;\n    }\n\n    const handleMemberClick = (e: SyntheticEvent) => {\n        if(canBeRemoved(props.member.userId)) {\n            e.stopPropagation();\n            setShowDropdown(!showDropdown);\n        }\n    };\n\n    const removeMemberFromTeam = () => {\n        if(!props.readonly) {\n            dispatch(Action.Command.removeMemberFromTeam(props.teamId, props.member.userId));\n        }\n        setShowRemoveMemberConfirm(false);\n    };\n\n    const adminClass = props.isOwner? 'admin-member' : '';\n\n    return <div className={\"item \" + adminClass} key={props.member.userId} style={canBeRemoved(props.member.userId) ? {cursor: \"pointer\"} : {}}>\n        <Dropdown open={showDropdown} icon={false} pointing=\"top\" disabled={props.readonly}>\n            <Dropdown.Menu>\n                <Dropdown.Item\n                    text={props.t('app.form.remove')}\n                    onClick={() => setShowRemoveMemberConfirm(true)}\n                />\n            </Dropdown.Menu>\n        </Dropdown>\n        {!avatarLoaded && <span className=\"ui avatar image placeholder\" onClick={handleMemberClick} />}\n        <img className=\"ui avatar image\"\n             src={props.member.avatar()}\n             onClick={handleMemberClick}\n             alt={props.member.username}\n             onLoad={() => setAvatarLoaded(true)}\n             style={{display: avatarLoaded ? 'inline-block' : 'none'}} />\n        <div className=\"content\" onClick={handleMemberClick}>\n            <div className=\"header\">{props.member.username}</div>\n        </div>\n        <Confirm\n            open={!props.readonly && showRemoveMemberConfirm}\n            header={props.t('insp.team.remove_user_confirm_title')}\n            content={props.t(\n                'insp.team.remove_user_confirm_text',\n                { user_name: props.member.username }\n            )}\n            confirmButton={props.t('insp.team.remove_user_confirm_button')}\n            cancelButton={<Button content={props.t('app.form.cancel')} className=\"basic noborder\" />}\n            onCancel={() => setShowRemoveMemberConfirm(false)}\n            onConfirm={removeMemberFromTeam}\n        />\n    </div>\n};\n\nexport default withNamespaces()(MemberEntry);\n","import * as React from 'react';\nimport {TeamId} from \"../model/Team\";\nimport {List} from \"immutable\";\nimport {UserOrganizationInfo} from \"../../Organization/model/UserOrganizationInfo\";\nimport {useDispatch} from \"react-redux\";\nimport {useState} from \"react\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {Button, Grid, GridColumn, Message, Select} from \"semantic-ui-react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport * as Action from \"../actions\";\n\ninterface OwnProps {\n    teamId: TeamId;\n    organizations: List<UserOrganizationInfo>;\n}\n\ntype MoveTeamMenuProps = OwnProps & WithNamespaces;\n\nconst MoveTeamMenu = (props: MoveTeamMenuProps) => {\n    const dispatch = useDispatch();\n    const [selectedOrganization, setSelectedOrganization] = useState<OrganizationId|undefined>();\n\n    const options = props.organizations.map(orga => ({\n        key: orga.uid,\n        value: orga.uid,\n        text: orga.organizationName\n    }));\n\n    const handleMoveTeam = () => {\n        if(selectedOrganization) {\n            dispatch(Action.Command.moveTeamToOrganization(props.teamId, selectedOrganization));\n        }\n    }\n\n    return <Grid columns={2}>\n        <GridColumn mobile={16} tablet={16} computer={12} largeScreen={12} widescreen={12}>\n            <Select options={options.toJS()}\n                    fluid={true}\n                    placeholder={props.t('insp.team.move_to_organization_select') as string}\n                    onChange={(e, data) => setSelectedOrganization(data.value as OrganizationId)}\n            />\n        </GridColumn>\n        <GridColumn mobile={16} tablet={16} computer={4} largeScreen={4} widescreen={4}>\n            <Button primary={true} floated=\"right\" onClick={() => handleMoveTeam()}>{props.t('insp.team.move_to_organization_submit')}</Button>\n        </GridColumn>\n        <Message size=\"small\" info={true}>{props.t('insp.team.move_to_organization_desc')}</Message>\n    </Grid>;\n};\n\nexport default withNamespaces()(MoveTeamMenu);\n","import * as React from 'react';\nimport {SyntheticEvent, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Confirm, Dropdown} from \"semantic-ui-react\";\nimport * as BoardModule from \"../../InspectioBoards\";\nimport {makeGetTeamBoards} from \"../../InspectioBoards/selectors/boardList\";\nimport {makeIioFilteredUserListSelector} from \"../../User/selectors/iioUserInfo\";\nimport {Action} from \"../index\";\nimport {Team} from \"../model\";\nimport AddBoardToTeamModal from \"./AddBoardToTeamModal\";\nimport BoardEntry from \"./BoardEntry\";\nimport EditableTeamHeader from \"./EditableTeamHeader\";\nimport InviteUserToTeamModal from \"./InviteUserToTeamModal\";\nimport MemberEntry from \"./MemberEntry\";\nimport {List} from \"immutable\";\nimport {UserOrganizationInfo} from \"../../Organization/model/UserOrganizationInfo\";\nimport MoveTeamMenu from \"./MoveTeamMenu\";\n\ninterface OwnProps {\n    team: Team.Team,\n    blueprint?: boolean,\n    onTeamAdded?: (team: Team.TeamId) => void,\n    onCancelName?: (team: Team.TeamId) => void,\n    onCancelDescription?: (team: Team.TeamId) => void,\n    isMovable: boolean,\n    targetOrganizations: List<UserOrganizationInfo>,\n}\n\ntype TeamCardProps = OwnProps & WithNamespaces;\n\nconst TeamCard = (props: TeamCardProps) => {\n    const members = useSelector(makeIioFilteredUserListSelector(props.team.members));\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\n    const [showAddUserModal, setShowAddUserModal] = useState<boolean>(false);\n    const [showAddBoardToTeamModal, setShowAddBoardToTeamModal] = useState(false);\n    const boards = useSelector(makeGetTeamBoards(props.team.uid));\n\n    const dispatch = useDispatch();\n\n    // Team Edit\n\n    const handleTeamNameChanged = (teamName: Team.TeamName) => {\n        if(props.blueprint && props.onTeamAdded) {\n            props.onTeamAdded(props.team.uid);\n        }\n    }\n\n    const handleCancelName = () => {\n        if(props.onCancelName) {\n            props.onCancelName(props.team.uid);\n        }\n    }\n\n    const handleCancelDescription = () => {\n        if(props.onCancelDescription) {\n            props.onCancelDescription(props.team.uid);\n        }\n    }\n\n    const handleDeleteClick = (e: SyntheticEvent) => {\n        e.preventDefault();\n        setShowDeleteModal(true);\n    }\n\n    const deleteTeam = () => {\n        dispatch(Action.Command.deleteTeam(props.team.uid));\n    }\n\n    // Add User Modal\n\n    const handleAddUserClick = (e: SyntheticEvent) => {\n        e.preventDefault();\n        setShowAddUserModal(true);\n    }\n\n    const closeAddUserModal = () => {\n        setShowAddUserModal(false);\n    };\n\n    // Add Board To Team Modal#\n\n    const handleAddBoardClick = (e: SyntheticEvent) => {\n        e.preventDefault();\n        setShowAddBoardToTeamModal(true);\n    };\n\n    const closeAddBoardToTeamModal = () => {\n        setShowAddBoardToTeamModal(false);\n    };\n\n    const handleAddBoardToTeamSubmit = (selectedBoard: BoardModule.BoardModel.BoardId) => {\n        dispatch(Action.Command.adminGrantTeamAccessToBoard(selectedBoard, [props.team.uid]));\n        setShowAddBoardToTeamModal(false);\n    };\n    // Lists\n\n    const memberList = members.sortBy(m => m.username).sort((mA, mB) => {\n        if(mA.userId === props.team.ownerId) {\n            return  -1;\n        }\n\n        if(mB.userId === props.team.ownerId) {\n            return 1;\n        }\n\n        return 0;\n    }).map(member => <MemberEntry \n        key={member.userId} \n        member={member} \n        isOwner={props.team.ownerId === member.userId} \n        teamId={props.team.uid} />);\n\n    const boardList = boards.map(board => <BoardEntry board={board} team={props.team} key={board.uid}/>);\n\n    return <div className=\"ui segment\">\n                {!props.blueprint && <a  href=\"#\" className=\"ui small right floated basic button noborder\" onClick={handleDeleteClick}>\n                Delete\n                </a>}\n\n                <EditableTeamHeader\n                    team={props.team}\n                    addTeamMode={props.blueprint}\n                    onNameChanged={handleTeamNameChanged}\n                    onCancelName={handleCancelName}\n                    onCancelDescription={handleCancelDescription}\n                />\n                <div className=\"ui horizontal divider\">Teammember</div>               \n               <div className=\"ui horizontal list\">\n                   <Button basic={true} icon={true} color=\"blue\" size=\"large\" onClick={handleAddUserClick} disabled={props.blueprint}>\n                       <i className=\"blue user icon\" />\n                   </Button>\n                    {!props.blueprint && memberList}\n                </div>\n                <div className=\"ui horizontal divider\">Teamboards</div>\n                <div className=\"ui horizontal list\">\n                    <Button basic={true} icon={true} color=\"orange\" size=\"large\" onClick={handleAddBoardClick} disabled={props.blueprint}>\n                        <i className=\"orange sticky note icon\" />\n                    </Button>\n                    {!props.blueprint && boardList}\n                </div>\n                {props.isMovable && <div className=\"ui horizontal divider\">{props.t('insp.team.move_to_organization_title')}</div>}\n                {props.isMovable && <MoveTeamMenu organizations={props.targetOrganizations} teamId={props.team.uid}/>}\n            <InviteUserToTeamModal\n                team={props.team}\n                open={showAddUserModal}\n                onClose={closeAddUserModal}\n            />\n            <AddBoardToTeamModal\n                teamId={props.team.uid}\n                open={showAddBoardToTeamModal}\n                onClose={closeAddBoardToTeamModal}\n                onSubmit={handleAddBoardToTeamSubmit}\n            />\n            <Confirm\n                open={showDeleteModal}\n                header={props.t('insp.team.remove_team_confirm_title')}\n                confirmButton={props.t('app.form.remove')}\n                cancelButton={<Button content={props.t('app.form.cancel')} className=\"basic noborder\" />}\n                content={props.t('insp.team.remove_team_confirm_text', {team_name: props.team.name})}\n                onCancel={() => setShowDeleteModal(false)}\n                onConfirm={deleteTeam}\n                />\n        </div>\n};\n\nexport default withNamespaces()(TeamCard);\n","import * as React from 'react';\nimport {SyntheticEvent, useMemo, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Message, MessageContent, MessageItem} from \"semantic-ui-react\";\nimport uuid from \"uuid\";\nimport * as UserSelector from \"../../User/selectors/currentUser\";\nimport {createNewTeam} from \"../model/Team\";\nimport {makeTeamListSelector} from \"../selectors/selectTeam\";\nimport TeamCard from \"./TeamCard\";\nimport {List} from \"immutable\";\n\ninterface OwnProps {\n    disabled: boolean;\n}\n\ntype AddTeamCardProps = OwnProps & WithNamespaces;\n\nconst AddTeamCard = (props: AddTeamCardProps) => {\n    const [showCard, setShowCard] = useState(false);\n    const [checkExistingTeams, setCheckExistingTeams] = useState(false);\n    const team = useMemo(() => {\n        return createNewTeam(uuid.v4());\n    }, [showCard]);\n\n    // Poll team list to check if newly added team is there\n    const existingTeams = useSelector(makeTeamListSelector());\n    if(checkExistingTeams && existingTeams.find(existingTeam => existingTeam.uid === team.uid)) {\n        setCheckExistingTeams(false);\n        setShowCard(false);\n    }\n\n    const handleClick = (e: SyntheticEvent) => {e.preventDefault(); setShowCard(!showCard)};\n    const handleTeamAdded = () => setCheckExistingTeams(true);\n    const handleCancelName = () => setShowCard(false);\n\n    return <>\n        <div>\n            <button className=\"ui huge basic button\" onClick={handleClick}>\n                <i className=\"plus icon\" />\n                { props.t('insp.team.overview_add') }\n            </button>\n        </div>\n        {showCard && <TeamCard team={team} blueprint={true} onTeamAdded={handleTeamAdded} onCancelName={handleCancelName} isMovable={false} targetOrganizations={List()} />}\n    </>\n};\n\nexport default withNamespaces()(AddTeamCard);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {makeGetTeamBoards} from \"../../InspectioBoards/selectors/boardList\";\nimport {makeIioFilteredUserListSelector} from \"../../User/selectors/iioUserInfo\";\nimport {Team} from \"../model/Team\";\nimport BoardEntry from \"./BoardEntry\";\nimport MemberEntry from \"./MemberEntry\";\n\ninterface OwnProps {\n    team: Team;\n}\n\ntype JoinedTeamCardProps = OwnProps & WithNamespaces;\n\nconst JoinedTeamCard = (props: JoinedTeamCardProps) => {\n    const members = useSelector(makeIioFilteredUserListSelector(props.team.members));\n    const boards = useSelector(makeGetTeamBoards(props.team.uid));\n\n    const memberList = members.sortBy(m => m.username).sort((mA, mB) => {\n        if(mA.userId === props.team.ownerId) {\n            return  -1;\n        }\n\n        if(mB.userId === props.team.ownerId) {\n            return 1;\n        }\n\n        return 0;\n    }).map(member => <MemberEntry\n        key={member.userId}\n        member={member}\n        isOwner={props.team.ownerId === member.userId}\n        teamId={props.team.uid}\n        readonly={true}\n    />);\n\n    const boardList = boards.map(board => <BoardEntry board={board} team={props.team} key={board.uid} readonly={true}/>);\n\n    return <div className=\"ui segment\">\n        <h3 style={{margin:0}}>\n            {props.team.name}\n            <span> &mdash; </span>\n            <span className=\"sub header\">\n                {props.team.description}\n            </span>\n        </h3>\n        <div className=\"ui horizontal divider\">Teammember</div>\n        <div className=\"ui horizontal list\">\n            {memberList}\n        </div>\n        <div className=\"ui horizontal divider\">Teamboards</div>\n        <div className=\"ui horizontal list\">\n            {boardList}\n        </div>\n    </div>;\n};\n\nexport default withNamespaces()(JoinedTeamCard);","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Grid, Header, Message} from \"semantic-ui-react\";\nimport {UserOrganizationInfo} from \"../../../Organization/model/UserOrganizationInfo\";\nimport {\n    makeActiveUserOrganizationInfoSelector,\n    makeUserOrganizationInfoListSelector\n} from \"../../../Organization/selectors/selectUserOrganizationInfo\";\nimport {UserId, UserInfo} from \"../../../User/model/UserInfo\";\nimport {Team} from \"../../model/Team\";\nimport AddTeamCard from \"../AddTeamCard\";\nimport JoinedTeamCard from \"../JoinedTeamCard\";\nimport TeamCard from \"../TeamCard\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\n\ninterface OwnProps {\n    teams: List<Team>,\n    currentUser: UserInfo,\n}\n\ntype TeamTabProps = OwnProps & WithNamespaces;\n\nconst TeamTab = (props: TeamTabProps) => {\n    const activeOrganizationInfo = useSelector(makeActiveUserOrganizationInfoSelector());\n    const organizations = useSelector(makeUserOrganizationInfoListSelector(props.currentUser.uid));\n\n    const isPrivateWorkspace = !activeOrganizationInfo || !activeOrganizationInfo.explicitOrganization;\n    const validTargetOrganizations = isPrivateWorkspace? organizations.filter(orga => orga.explicitOrganization && !orga.userIsGuest) : List();\n    const teamsAreMovable = isPrivateWorkspace && validTargetOrganizations.count() > 0;\n\n\n    const isAdmin = (team: Team, userId: UserId, orgaInfo?: UserOrganizationInfo) => {\n        if(team.organizationId && orgaInfo && team.organizationId === orgaInfo.organizationId) {\n            if(orgaInfo.userIsAdmin) {\n                return true;\n            }\n        }\n\n        return team.isAdmin(userId);\n    }\n\n    // First sort by name, then check if a team is marked as new and move it on top of the list\n    const teamCards = props.teams.filter(team => isAdmin(team, props.currentUser.uid, activeOrganizationInfo))\n        .sortBy(team => team.name)\n        .sortBy(team => !team.isNew)\n        .map((team) => {\n            return <TeamCard isMovable={teamsAreMovable} targetOrganizations={validTargetOrganizations} team={team} key={team.uid}/>\n        });\n\n    const joinedTeamCards = props.teams.filter(team => !isAdmin(team, props.currentUser.uid, activeOrganizationInfo))\n        .sortBy(team => team.name)\n        .map((team) => {\n            return <JoinedTeamCard team={team} key={team.uid}/>\n        });\n\n    return <>\n        <Grid.Row>\n            <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n            <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                <Header as=\"h1\" icon={true} textAlign='center'>\n                    <Header.Content>\n                        Manage Your Teams\n                        <Header.Subheader />\n                    </Header.Content>\n                </Header>\n            </Grid.Column>\n        </Grid.Row>\n        <Grid.Row>\n            <Grid.Column>\n                <div>\n                    <AddTeamCard disabled={false} />\n                    {teamCards}\n                </div>\n            </Grid.Column>\n        </Grid.Row>\n        {teamCards.count() === 0 && joinedTeamCards.count() === 0 && <Grid.Row>\n            <Grid.Column>\n                <Message info={true} floating={true} content={props.t('insp.team.no_teams')} />\n            </Grid.Column>\n        </Grid.Row>}\n        {joinedTeamCards.count() > 0 && <Grid.Row>\n            <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\"/>\n            <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                <Header as=\"h2\" icon={true} textAlign='center'>\n                    <Header.Content>\n                        Joined Teams\n                        <Header.Subheader />\n                    </Header.Content>\n                </Header>\n            </Grid.Column>\n        </Grid.Row>}\n        <Grid.Row>\n            <Grid.Column>\n                {joinedTeamCards}\n            </Grid.Column>\n        </Grid.Row>\n    </>\n};\n\nexport default withNamespaces()(TeamTab);\n","import * as React from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Icon} from \"semantic-ui-react\";\nimport {hideOwnBoardsOnOverview, hideSharedBoardsOnOverview} from \"../../InspectioBoards/actions/commands\";\nimport {BoardOverviewState} from \"../../InspectioBoards/reducers/applyOverviewActions\";\nimport {boardOverviewSelector} from \"../../InspectioBoards/selectors/boardList\";\n\ninterface OwnProps {\n    count: number;\n}\n\nexport enum DisplayMode {\n    all = 'all',\n    onlyShared = 'onlyShared',\n    noShared = 'noShared',\n}\n\ntype SharedBoardsItemProps = OwnProps;\n\nconst SharedBoardsItem = (props: SharedBoardsItemProps) => {\n\n    const boardOverview = useSelector(boardOverviewSelector);\n    const mode = getModeFromBoardOverviewSettingss(boardOverview);\n    const dispatch = useDispatch();\n\n    const nextMode = () => {\n        switch (mode) {\n            case DisplayMode.all:\n                dispatch(hideOwnBoardsOnOverview(true));\n                dispatch(hideSharedBoardsOnOverview(false));\n                break;\n            case DisplayMode.onlyShared:\n                dispatch(hideOwnBoardsOnOverview(false));\n                dispatch(hideSharedBoardsOnOverview(true));\n                break;\n            case DisplayMode.noShared:\n                dispatch(hideOwnBoardsOnOverview(false));\n                dispatch(hideSharedBoardsOnOverview(false));\n                break;\n        }\n    };\n\n    let badgeClasses = \"ui small label\";\n\n    if(mode === DisplayMode.onlyShared) {\n        badgeClasses += \" teal\";\n    }\n\n    return <div className=\"ui item\" style={{cursor: \"pointer\"}} onClick={nextMode}>\n        <Icon className=\"share icon\"/>\n        {mode !== DisplayMode.noShared && <div className={badgeClasses}>{props.count}</div>}\n        Shared Boards\n        {mode === DisplayMode.noShared && <Icon className=\"eye slash icon\"/>}\n    </div>\n};\n\nexport default SharedBoardsItem;\n\nconst getModeFromBoardOverviewSettingss = (settings: BoardOverviewState): DisplayMode => {\n    if(settings.allSharedBoardsHidden) {\n        return DisplayMode.noShared;\n    }\n\n    if(settings.allOwnBoardsHidden) {\n        return DisplayMode.onlyShared;\n    }\n\n    return DisplayMode.all;\n};\n","import * as React from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {keyLiteMode, makeUserSettingSelector} from \"../selectors/userSettings\";\nimport {Icon, MenuItem, Popup} from \"semantic-ui-react\";\nimport {upsertUserSetting} from \"../actions/commands\";\nimport {SemanticICONS} from \"semantic-ui-react/dist/commonjs/generic\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\n\ninterface OwnProps {\n\n}\n\ntype TopmenuLiteModeProps = OwnProps & WithNamespaces;\n\nconst TopmenuLiteMode = (props: TopmenuLiteModeProps) => {\n    const liteMode = useSelector(makeUserSettingSelector(keyLiteMode(), false));\n    const dispatch = useDispatch();\n\n    const handleClick = () => {\n        dispatch(upsertUserSetting(keyLiteMode(), !liteMode));\n    }\n\n    const color = liteMode? '#2eba46' : 'inherit';\n    const icon = liteMode? 'high' : 'half';\n    const translateKey = liteMode? 'lite_mode_is_active' : 'activate_lite_mode';\n\n    return <Popup trigger={<MenuItem onClick={handleClick}>\n        <Icon name={ `battery ${icon}` as SemanticICONS } style={{color}} />\n    </MenuItem>} content={<>\n        <p>{props.t('insp.top_menu.'+translateKey)}</p>\n        {liteMode && <p><small>{props.t('insp.top_menu.lite_mode_is_active_details')}</small></p>}\n    </>} />\n\n};\n\nexport default withNamespaces()(TopmenuLiteMode);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {NavLink} from \"react-router-dom\";\nimport { pure } from 'recompose';\nimport {Dropdown, Icon, Label, MenuItem, Popup} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\nimport {\n    toggleBoardHistory,\n    toggleCodyConsole,\n    toggleElementDetails, togglePlayshotModal, toggleTimerModal, toggleVideoSession,\n    triggerExportBoard,\n    triggerImportBoard\n} from \"../actions/commands\";\nimport {BoardId} from \"../model/Board\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport TopmenuLiteMode from \"../../User/components/TopmenuLiteMode\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {makeUserSettingSelector, makeUserSettingsLoadedSelector} from \"../../User/selectors/userSettings\";\nimport {useEffect, useState} from \"react\";\nimport {upsertUserSetting} from \"../../User/actions/commands\";\n\nexport interface BoardTopMenuRouteMatchParams {\n    uid: BoardId;\n}\n\ntype BoardTopMenuProps =  WithNamespaces & RouteComponentProps<BoardTopMenuRouteMatchParams>;\n\nconst BoardTopMenu = pure((props: BoardTopMenuProps) => {\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const board = useSelector(makeBoardByIdSelector(props.match.params.uid));\n    const settingsLoaded = useSelector(makeUserSettingsLoadedSelector());\n    const showHint = useSelector(makeUserSettingSelector('show_timer_hint', false));\n    const [popupOpen, setPopupOpen] = useState(false);\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if(settingsLoaded  && showHint) {\n            setPopupOpen(true);\n        }\n    }, [settingsLoaded, showHint])\n\n    const handleHintClick = () => {\n        dispatch(upsertUserSetting('show_timer_hint', false));\n        setPopupOpen(false);\n    }\n\n    const isAdmin = organization ? organization.isAdmin(currentUser.uid) || board && board.isCreator(currentUser.uid) : board && board.owner === currentUser.uid;\n\n    return <>\n        <TopmenuLiteMode />\n        <Popup\n            open={popupOpen}\n            trigger={<MenuItem icon=\"hourglass half\" onClick={() => dispatch(toggleTimerModal(props.match.params.uid, true))} />}\n            openOnTriggerClick={false}\n            openOnTriggerFocus={false}\n            openOnTriggerMouseEnter={false}\n            position=\"bottom left\"\n            content={\n                <>\n                    <p>{props.t('insp.board.timer.hint')}</p>\n                    <p><span style={{\"color\": \"#9cc8f5\", \"cursor\": \"pointer\", float: \"right\"}} onClick={handleHintClick}>{props.t('insp.hint.got_it')}</span></p>\n                </>\n            }\n        />\n        <Dropdown item={true} icon=\"ellipsis vertical\">\n            <Dropdown.Menu direction=\"left\">\n                <Dropdown.Item icon=\"history\" text=\"Activity\" onClick={() => dispatch(toggleBoardHistory(props.match.params.uid, true))} />\n                <Dropdown.Item\n                    icon={'clipboard outline'}\n                    text={props.t('insp.top_menu.element_details')}\n                    onClick={() => dispatch(toggleElementDetails(props.match.params.uid, true, false))}\n                />\n                <Dropdown.Item icon=\"code\" text=\"Cody\" onClick={() => dispatch(toggleCodyConsole(props.match.params.uid, true)) } />\n                <Dropdown.Item icon=\"play\" text=\"Cody Play\" onClick={() => dispatch(togglePlayshotModal(props.match.params.uid, true))} />\n                {board && (board.organization? isAdmin : !board.shared) && <Dropdown.Item icon=\"cog\" text=\"Settings\" to={Routes.compileInspectioBoardEdit(props.match.params.uid)} as={NavLink}/>}\n                <Dropdown.Item icon=\"upload\" text=\"Export Board\" onClick={() => dispatch(triggerExportBoard(props.match.params.uid))} />\n                <Dropdown.Item icon=\"question\" text=\"FAQs\" as=\"a\" href=\"https://wiki.prooph-board.com\" target=\"_blank\" />\n            </Dropdown.Menu>\n        </Dropdown>\n    </>});\n\nexport default withNamespaces()(withRouter(BoardTopMenu));\n","import * as React from 'react';\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {Button, Grid, GridColumn, GridRow, Input, Modal, Search, Table} from \"semantic-ui-react\";\nimport {Permissions} from \"../model/BoardPermissionForUser\";\nimport {useSelector} from \"react-redux\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {List} from \"immutable\";\nimport {Email, UserId} from \"../../User/model/UserInfo\";\nimport {makeIioFilteredUserListSelector} from \"../../User/selectors/iioUserInfo\";\nimport {useEffect, useState} from \"react\";\n\ninterface OwnProps {\n    open: boolean;\n    onClose: () => void;\n    onSubmit: () => void;\n    email: string;\n    onEmailChange: (email: Email) => void;\n    permissions: Permissions,\n    onPermissionsChange: (permissions: Permissions) => void;\n}\n\ntype InviteUserToBoardProps = OwnProps & WithNamespaces;\n\nconst InviteUserToBoardModal = (props: InviteUserToBoardProps) => {\n\n    const [email, setEmail] = useState<string>(props.email);\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const organizationUserIds = List<UserId>(organization ? [organization.ownerId, ...organization.members.toJS()] : []);\n    const organizationUsers = useSelector(makeIioFilteredUserListSelector(organizationUserIds));\n\n    useEffect(() => {\n        setEmail(props.email);\n    }, [props.email])\n\n    const filteredUsers = organizationUsers\n        .filter(user => user.username.toLocaleLowerCase().includes(email.toLocaleLowerCase()) || user.email.toLocaleLowerCase().includes(email.toLocaleLowerCase()))\n        .sortBy(user => user.username)\n        .map(user => {\n            return {\n                id: user.userId,\n                title: user.username,\n                description: user.email,\n                image: user.avatarUrl,\n            }\n        });\n\n    const handleSearchChange = (emailVal: Email) => {\n        setEmail(emailVal);\n        if(isValidEmail(emailVal)) {\n            props.onEmailChange(emailVal);\n        }\n    }\n\n    return (\n        <Modal open={props.open} closeIcon={true} onClose={props.onClose} size=\"tiny\">\n            <Modal.Header>{props.t('insp.board.invite_user')}</Modal.Header>\n            <Modal.Content>\n                <div style={{ marginBottom: '10px' }}>\n                        <Grid container={true} stackable={true} doubling={true} >\n                            <GridColumn mobile={16} tablet={8} computer={10}>\n                                <Search\n                                    fluid={true}\n                                    value={email}\n                                    results={filteredUsers.toArray()}\n                                    placeholder={props.t('insp.board.form.email') as string}\n                                    showNoResults={false}\n                                    resultRenderer={data => {\n                                        return <div key={data.id}>\n                                            <div className=\"ui image avatar\">\n                                                <img src={data.image} alt={data.title} />\n                                            </div>\n                                            <div className=\"content\">\n                                                <div className=\"title\">{data.title}</div>\n                                                <div className=\"description\">{data.description}</div>\n                                            </div>\n                                        </div>\n                                    }}\n                                    onSearchChange={(e, data) => handleSearchChange(data.value || '')}\n                                    onResultSelect={(e, data) => {\n                                        setEmail(data.result.description);\n                                        props.onEmailChange(data.result.description);\n                                    }}\n                                />\n                            </GridColumn>\n                            <GridColumn mobile={16} tablet={8} computer={6}>\n                                <Button.Group>\n                                    <Button\n                                        type={'button'}\n                                        className={'positive'}\n                                        children={'Read'}\n                                        onClick={() => props.onPermissionsChange({...props.permissions, writeAccess: false})}\n                                    />\n                                    <Button.Or text=\"+\" />\n                                    <Button\n                                        type={'button'}\n                                        className={props.permissions.writeAccess ? 'positive' : ''}\n                                        children={'Write'}\n                                        onClick={() => props.onPermissionsChange({...props.permissions, writeAccess: !props.permissions.writeAccess})}\n                                    />\n                                </Button.Group>\n                            </GridColumn>\n                        </Grid>\n                    </div>\n            </Modal.Content>\n            <Modal.Actions>\n                <Button primary={true} type=\"submit\" onClick={props.onSubmit} disabled={!isValidEmail(email)}>\n                    {props.t('app.form.confirm')}\n                </Button>\n            </Modal.Actions>\n        </Modal>\n    );\n};\n\n/**\n * Validates the basic email structure; not a perfect validation\n *\n * @param value\n */\nconst isValidEmail = (value: string) => {\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value);\n};\n\nexport default withNamespaces()(InviteUserToBoardModal);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Icon, MenuItem} from \"semantic-ui-react\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport {BoardTopMenuRouteMatchParams} from \"./BoardTopMenu\";\nimport * as Action from \"../actions\";\nimport InviteUserToBoardModal from \"./InviteUserToBoardModal\";\nimport {Permissions} from \"../model/BoardPermissionForUser\";\nimport {Email} from \"../../User/model/UserInfo\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\n\ninterface OwnProps {\n\n}\n\ntype ShareBoardButtonProps = OwnProps & RouteComponentProps<BoardTopMenuRouteMatchParams>;\n\nconst ShareBoardButton = (props: ShareBoardButtonProps) => {\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const [userEmail, setUserEmail] = useState<string>('');\n    const [showAddUserModal, setShowAddUserModal] = useState<boolean>(false);\n    const [permissions, setPermissions] = useState<Permissions>({adminAccess: false, writeAccess: true, readAccess: true});\n    const board = useSelector(makeBoardByIdSelector(props.match.params.uid));\n    const dispatch = useDispatch();\n\n    const isAdmin = organization ? organization.isAdmin(currentUser.uid) || (board && board.isCreator(currentUser.uid)) : false;\n\n    const openAddUserModal = (event: React.MouseEvent) => {\n        event.stopPropagation();\n        setShowAddUserModal(true);\n    };\n\n    const closeAddUserModal = () => {\n        setShowAddUserModal(false);\n    };\n\n    const handleShareBoardSubmit = () => {\n        dispatch(Action.Command.shareBoard(board.uid, userEmail, permissions));\n\n        setUserEmail('');\n        closeAddUserModal();\n    };\n\n    const onEmailChange = (email: Email) => {\n        setUserEmail(email);\n    };\n\n    return <>{board && (board.organization? isAdmin : !board.shared) &&\n        <>\n            <MenuItem>\n                <Button icon={true} className=\"share\" onClick={openAddUserModal}><Icon name=\"share alternate\"/>&nbsp;share</Button>\n            </MenuItem>\n            <InviteUserToBoardModal\n                open={showAddUserModal}\n                onClose={closeAddUserModal}\n                onSubmit={handleShareBoardSubmit}\n                email={userEmail}\n                onEmailChange={onEmailChange}\n                permissions={permissions}\n                onPermissionsChange={setPermissions}\n            />\n        </>\n    }\n    </>;\n}\n\nexport default withRouter(ShareBoardButton);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {NavLink} from \"react-router-dom\";\nimport {Icon, Label, Menu, MenuItem, Popup} from \"semantic-ui-react\";\nimport {logout} from \"../../index\";\nimport * as Routes from \"../../routes\";\nimport {makeGetCurrentUser} from \"../selectors/currentUser\";\nimport SideMenuOrganizationSwitch from \"./SideMenuOrganizationSwitch\";\n\ninterface OwnProps {\n\n}\n\ntype TopmenuAvatarProps = OwnProps;\n\nconst TopmenuAvatar = (props: TopmenuAvatarProps) => {\n    const currentUserSelector = makeGetCurrentUser();\n    const currentUser = useSelector(currentUserSelector);\n    const [open, setOpen] = useState(false);\n\n    return <>\n            <Popup\n            on=\"click\"\n            position='bottom center'\n            open={open}\n            onOpen={() => {setOpen(true)}}\n            onClose={() => {setOpen(false)}}\n            trigger={\n                <MenuItem>\n                    <Label circular={true} className=\"user\" style={{backgroundImage: `url(${currentUser.avatarUrl})`, backgroundSize: 'cover'}} />\n                </MenuItem>\n            }\n            content={\n                <Menu vertical={true} secondary={true} compact={true}>\n                    <MenuItem to={Routes.userProfile} as={NavLink} activeClassName=\"active\" onClick={() => setOpen(false)}>\n                        <Icon name=\"user\" />\n                        Profile\n                    </MenuItem>\n                    <MenuItem onClick={() => logout()}>\n                        <Icon name=\"sign-out\" />\n                        Sign Out\n                    </MenuItem>\n                </Menu>\n            }\n            />\n        </>\n};\n\nexport default TopmenuAvatar;\n","import * as React from 'react';\nimport {ReactNode} from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Link} from \"react-router-dom\";\nimport {Breadcrumb} from \"semantic-ui-react\";\nimport {BoardId} from \"../../InspectioBoards/model/Board\";\nimport {makeBoardByIdSelector} from \"../../InspectioBoards/selectors/board\";\nimport * as Routes from \"../../routes\";\n\ntype BoardCrumbProps = RouteComponentProps<{uid: BoardId}>;\n\nconst BoardLink = (props: {children: ReactNode, boardId: BoardId, activeCrumb: boolean}) => {\n    return <Link to={Routes.compileInspectioBoardWorkspace(props.boardId)} className={(props.activeCrumb? \"active \" : \"\")+\"section\"}>{props.children}</Link>\n};\n\nconst BoarCrumb = (props: BoardCrumbProps) => {\n    const getBoardById = makeBoardByIdSelector(props.match.params.uid);\n    const board = useSelector(getBoardById);\n    let boardName = 'Unknown';\n    let readOnly = <></>;\n\n    if(board) {\n        boardName = board.name;\n\n        if(!board.writeAccess) {\n            readOnly = <Breadcrumb.Section>&nbsp;(read only)</Breadcrumb.Section>;\n        }\n    }\n\n\n\n    return <>\n        <Breadcrumb.Divider />\n        <Breadcrumb.Section\n            active={true}\n            as={BoardLink}\n            activeCrumb={true}\n            boardId={props.match.params.uid}\n        >{boardName}</Breadcrumb.Section>\n        {readOnly}\n    </>\n};\n\nexport default withRouter(BoarCrumb);\n","import * as React from 'react';\nimport {ReactNode} from \"react\";\nimport {Link} from \"react-router-dom\";\nimport {Breadcrumb} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\n\ninterface OwnProps {\n\n}\n\ntype BoardOverviewCrumbProps = OwnProps;\n\nconst HomeLink = (props: {children: ReactNode}) => {\n    return <Link to={Routes.inspectio}>{props.children}</Link>\n};\n\nconst BoardOverviewCrumb = (props: BoardOverviewCrumbProps) => {\n    return <Breadcrumb.Section as={HomeLink}>Boards</Breadcrumb.Section>;\n};\n\nexport default BoardOverviewCrumb;","import * as React from 'react';\nimport {Breadcrumb} from \"semantic-ui-react\";\n\ninterface OwnProps {\n\n}\n\ntype OrganizationOverviewCrumbProps = OwnProps;\n\nconst OrganizationOverviewCrumb = (props: OrganizationOverviewCrumbProps) => {\n    return <Breadcrumb.Section>Organization</Breadcrumb.Section>\n};\n\nexport default OrganizationOverviewCrumb;\n","import * as React from 'react';\nimport {Breadcrumb} from \"semantic-ui-react\";\n\ninterface OwnProps {\n\n}\n\ntype TeamOverviewCrumbProps = OwnProps;\n\nconst TeamOverviewCrumb = (props: TeamOverviewCrumbProps) => {\n    return <Breadcrumb.Section>Teams</Breadcrumb.Section>\n};\n\nexport default TeamOverviewCrumb;","import * as React from 'react';\nimport {Breadcrumb} from \"semantic-ui-react\";\n\ninterface OwnProps {\n\n}\n\ntype UpdatesCrumbProps = OwnProps;\n\nconst UpdatesCrumb = (props: UpdatesCrumbProps) => {\n    return <Breadcrumb.Section>Updates</Breadcrumb.Section>\n};\n\nexport default UpdatesCrumb;","import * as React from 'react';\nimport {Breadcrumb} from \"semantic-ui-react\";\n\ninterface OwnProps {\n\n}\n\ntype UserProfileCrumbProps = OwnProps;\n\nconst UserProfileCrumb = (props: UserProfileCrumbProps) => {\n    return <Breadcrumb.Section>Profile</Breadcrumb.Section>\n};\n\nexport default UserProfileCrumb;","import * as React from 'react';\nimport { withNamespaces, WithNamespaces } from 'react-i18next';\nimport {useSelector} from \"react-redux\";\nimport {Route, RouteComponentProps, withRouter} from 'react-router';\nimport {NavLink,} from 'react-router-dom';\nimport {Breadcrumb, Button, Dropdown, Icon, Image, Label, Menu, MenuItem} from 'semantic-ui-react';\nimport {logout} from \"../index\";\nimport BoardTopMenu from \"../InspectioBoards/components/BoardTopMenu\";\nimport ShareBoardButton from \"../InspectioBoards/components/ShareBoardButton\";\nimport * as Routes from '../routes';\nimport TopmenuAvatar from \"../User/components/TopmenuAvatar\";\nimport BoardCrumb from \"./Breadcrumb/BoardCrumb\";\nimport BoardOverviewCrumb from \"./Breadcrumb/BoardOverviewCrumb\";\nimport OrganizationOverviewCrumb from \"./Breadcrumb/OrganizationOverviewCrumb\";\nimport TeamOverviewCrumb from \"./Breadcrumb/TeamOverviewCrumb\";\nimport UpdatesCrumb from \"./Breadcrumb/UpdatesCrumb\";\nimport UserProfileCrumb from \"./Breadcrumb/UserProfileCrumb\";\nimport {makeGetSidebarSelector} from \"./selectors/sidebar\";\n\ntype TopMenuProps =  WithNamespaces & RouteComponentProps<{uid?: string}>;\n\nconst TopMenu = (props: TopMenuProps) => {\n    const sidebar = useSelector(makeGetSidebarSelector());\n    const isBoardWorkspace = Routes.isInspectioBoardWorkspace(props.location.pathname);\n\n    const paddingLeft = isBoardWorkspace? (sidebar.width + 20) + 'px' : '270px';\n\n    return (<Menu fixed=\"top\" inverted={false} id=\"topmenu\" style={{paddingLeft}} className=\"touch-only-pan\">\n        <Route path={Routes.inspectio}>\n            <MenuItem>\n                <Breadcrumb>\n                    <Route exact={true} path={[Routes.inspectio, Routes.inspectioBoardWorkspace, Routes.inspectioEditBoard]} component={BoardOverviewCrumb} />\n                    <Route exact={true} path={Routes.userProfile} component={UserProfileCrumb} />\n                    <Route exact={true} path={Routes.Updates} component={UpdatesCrumb} />\n                    <Route exact={true} path={[Routes.inspectioBoardWorkspace, Routes.inspectioEditBoard]} component={BoardCrumb} />\n                    <Route exact={true} path={Routes.teamOverview} component={TeamOverviewCrumb} />\n                    <Route exact={true} path={Routes.organizationOverview} component={OrganizationOverviewCrumb} />\n                </Breadcrumb>\n            </MenuItem>\n        </Route>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={ShareBoardButton} />\n        <Menu.Menu position='right' id=\"topmenuUsers\" />\n        <TopmenuAvatar />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardTopMenu} />\n    </Menu>);\n};\n\nexport default withNamespaces()(withRouter(TopMenu));\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Message, Modal} from \"semantic-ui-react\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\n\ninterface OwnProps {\n    open: boolean;\n    onClose: () => void;\n}\n\ntype BoardQuotaReachedModalProps = OwnProps & WithNamespaces;\n\nconst BoardQuotaReachedModal = (props: BoardQuotaReachedModalProps) => {\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n\n\n    return <Modal open={props.open} closeIcon={true} onClose={props.onClose}>\n        <Modal.Header>{ props.t(\"insp.board.add\") }</Modal.Header>\n        <Modal.Content>\n            <Message icon=\"dollar\" warning={true}\n                     content={\n                         activeOrganization && activeOrganization.userIsGuest\n                             ? props.t('insp.user.quota_reached_guest')\n                             : activeOrganization && activeOrganization.explicitOrganization\n                                ? props.t('insp.user.quota_reached')\n                                : props.t('insp.user.quota_reached_user')\n                     } />\n        </Modal.Content>\n    </Modal>\n};\n\nexport default withNamespaces()(BoardQuotaReachedModal);\n","import * as React from 'react';\nimport {ChangeEvent, FormEvent, SyntheticEvent, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Input, Message, Modal, Transition} from \"semantic-ui-react\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {UserSelector} from \"../../User/selectors\";\nimport BoardQuotaReachedModal from \"../../InspectioBoards/components/BoardQuotaReachedModal\";\n\ntype AddBoardProps = WithNamespaces & RouteComponentProps;\n\nconst AddBoard = (props: AddBoardProps) => {\n    const [visible, setVisible] = useState(false);\n    const [showModal, setShowModal] = useState(false);\n    const [boardName, setBoardName] = useState('');\n    const [hasError, setHasError] = useState(false);\n    const inputEl = useRef<Input>(null);\n    const getUserQuota = UserSelector.makeGetCurrentBoardQuota();\n    const userQuota = useSelector(getUserQuota);\n    const getUser = UserSelector.makeGetCurrentUser();\n    const user = useSelector(getUser);\n    const dispatch = useDispatch();\n\n    const handleClick = () => {\n        setVisible(!visible);\n        if(!visible) {\n            window.setTimeout(() => {\n                inputEl.current!.focus();\n            }, 200);\n        }\n    };\n\n    const handleSubmit = (e: FormEvent) => {\n        e.preventDefault();\n\n        if(boardName === '') {\n            setHasError(true);\n            return;\n        }\n\n        if(userQuota === 0) {\n            setShowModal(true);\n            return;\n        }\n\n        const board = BoardModel.createUserBoard(user.uid, boardName as BoardModel.BoardName);\n\n        dispatch(Action.Command.addBoard(board, props.history));\n    };\n\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n        setBoardName(e.target.value);\n        setHasError(e.target.value === '');\n    };\n\n    const handleCloseModal = () => {\n        setBoardName('');\n        setVisible(false);\n        setShowModal(false);\n    };\n\n    return <div className=\"item\">\n            <Button className=\"large basic\" onClick={handleClick}><i className=\"plus icon\" /> Add&nbsp;Board</Button>\n            <Transition animation=\"fade down\" visible={visible} duration={200} >\n                <div className=\"ui icon input\">\n                    <form onSubmit={handleSubmit}>\n                        <Input placeholder=\"Board name ...\" fluid={true} ref={inputEl} error={hasError} value={boardName} onChange={handleChange} />\n                    </form>\n                </div>\n            </Transition>\n            <BoardQuotaReachedModal open={showModal} onClose={handleCloseModal} />\n    </div>;\n};\n\nexport default withNamespaces()(withRouter(AddBoard));\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Button, Dropdown, DropdownProps, Modal} from \"semantic-ui-react\";\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {Team, TeamId} from \"../model/Team\";\nimport {makeTeamListSelector} from \"../selectors/selectTeam\";\n\ninterface OwnProps {\n    board: BoardModel.Board;\n    open: boolean;\n    onClose: () => void;\n    onSubmit: (selectedTeam: TeamId) => void;\n}\n\ntype AddTeamToBoardModalProps = OwnProps & WithNamespaces;\n\nconst AddTeamToBoardModal = (props: AddTeamToBoardModalProps) => {\n    const currentUserSelector = makeGetCurrentUser();\n    const currentUser = useSelector(currentUserSelector);\n    const teams = useSelector(makeTeamListSelector(true));\n    const [selectedTeam, setSelectedTeam] = useState('');\n\n    const ownTeamsOptions = teams.map(team => ({\n        key: team.uid,\n        value: team.uid,\n        text: team.name\n    })).toArray();\n\n    const handleChange = (e: React.SyntheticEvent, dProps: DropdownProps) => setSelectedTeam(dProps.value as string);\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n\n        props.onSubmit(selectedTeam);\n        setSelectedTeam('');\n    }\n\n    return (\n        <Modal open={props.open} closeIcon={true} onClose={props.onClose}>\n            <Modal.Header>{props.t('insp.team.add_to_board', {board_name: props.board.name})}</Modal.Header>\n            <Modal.Content>\n                <form onSubmit={handleSubmit}>\n                    <Dropdown\n                        placeholder={props.t('insp.team.choose') as string}\n                        fluid={true}\n                        search={true}\n                        selection={true}\n                        options={ownTeamsOptions}\n                        onChange={handleChange}\n                        value={selectedTeam}\n                    />\n                    <div style={{marginTop: '10px'}}>\n                        <Button primary={true} type=\"submit\" disabled={!validateTeamExists(selectedTeam, teams)}>\n                            {props.t('app.form.confirm')}\n                        </Button>\n                    </div>\n                </form>\n            </Modal.Content>\n        </Modal>\n    );\n};\n\nconst validateTeamExists = (teamId: TeamId, teams: List<Team>): boolean => {\n    const matchingTeam = teams.find(team => team.uid === teamId);\n\n    return !!matchingTeam;\n}\n\nexport default withNamespaces()(AddTeamToBoardModal);\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useState} from \"react\";\nimport {useEffect} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {NavLink} from \"react-router-dom\";\nimport {Confirm, Icon} from \"semantic-ui-react\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport InviteUserToBoardModal from \"../../InspectioBoards/components/InviteUserToBoardModal\";\nimport {Board} from \"../../InspectioBoards/model/Board\";\nimport {Permissions} from \"../../InspectioBoards/model/BoardPermissionForUser\";\nimport {Action as TeamAction} from \"../../InspectioTeams\";\nimport AddTeamToBoardModal from \"../../InspectioTeams/components/AddTeamToBoardModal\";\nimport {Team, TeamId, TeamName} from \"../../InspectioTeams/model/Team\";\nimport {makeTeamListSelector} from \"../../InspectioTeams/selectors/selectTeam\";\nimport * as Route from \"../../routes\";\nimport {isStandalone} from \"../../standalone/util\";\nimport * as UserAction from \"../../User/actions\";\nimport {upsertUserSetting} from \"../../User/actions/commands\";\nimport {UserModel} from \"../../User/model\";\nimport {IioUserInfo} from \"../../User/model/IioUserInfo\";\nimport {Email} from \"../../User/model/UserInfo\";\nimport {makeIioUserListSelector} from \"../../User/selectors/iioUserInfo\";\nimport {keyBoardHidden, makeUserSettingSelector} from \"../../User/selectors/userSettings\";\n\ninterface OwnProps {\n    board: Board;\n}\n\ntype BoardListItemProps = OwnProps & WithNamespaces;\n\nconst BoardListItem = (props: BoardListItemProps) => {\n    const [visible, setVisible] = useState(false);\n    const [iconUp, setIconUp] = useState(false);\n    const [userEmail, setUserEmail] = useState<string>('');\n    const [permissions, setPermissions] = useState<Permissions>({adminAccess: false, writeAccess: true, readAccess: true});\n    const [showAddUserModal, setShowAddUserModal] = useState<boolean>(false);\n    const [showAddTeamModal, setShowAddTeamModal] = useState<boolean>(false);\n    const [showRemoveMemberConfirm, setShowRemoveMemberConfirm] = useState<boolean>(false);\n    const [showRemoveTeamConfirm, setShowRemoveTeamConfirm] = useState<boolean>(false);\n    const [memberToRemove, setMemberToRemove] = useState<UserModel.UserId|undefined>(undefined);\n    const [teamToRemove, setTeamToRemove] = useState<TeamId|undefined>(undefined);\n    const dispatch = useDispatch();\n    const users = useSelector(makeIioUserListSelector());\n    const teams = useSelector(makeTeamListSelector());\n    const hidden = useSelector(makeUserSettingSelector(keyBoardHidden(props.board.uid), false));\n\n    const angleIcon = iconUp ? 'angle up icon' : 'angle down icon';\n    const contentClass = 'ui labels ' + (visible ? 'slidedown' : 'slideup');\n\n    useEffect(() => {\n        if (props.board.sharedWith.count() < 1) {\n            return;\n        }\n\n        dispatch(UserAction.Query.loadUsersInfo(props.board.sharedWith.toArray()))\n    }, [props.board.sharedWith]);\n\n    const getUsernameByUserId = (userId: string) => {\n        const user = users.find((userInfo: IioUserInfo) => userInfo.userId === userId);\n        return user ? user.username : ''\n    };\n\n    const handleVisibleClick = () => {\n        setVisible(!visible);\n        if(iconUp) {\n            window.setTimeout(() => {\n                setIconUp(false);\n            }, 150);\n        } else {\n            setIconUp(true);\n        }\n    };\n\n    // Team Handling\n    const openAddTeamModal = (event: React.MouseEvent) => {\n        stopPropagation(event);\n        setShowAddTeamModal(true);\n    };\n\n    const closeAddTeamModal = () => {\n        setShowAddTeamModal(false);\n    };\n\n    const handleAddTeamSubmit = (teamId: TeamId) => {\n        dispatch(TeamAction.Command.adminGrantTeamAccessToBoard(props.board.uid, [teamId]));\n        setShowAddTeamModal(false);\n    };\n\n    const removeTeamFromBoard = () => {\n        if(!teamToRemove) {\n            return;\n        }\n\n        dispatch(TeamAction.Command.adminRevokeTeamAccessToBoard(props.board.uid, teamToRemove));\n        setShowRemoveTeamConfirm(false);\n    }\n\n    // User Handling\n    const openAddUserModal = (event: React.MouseEvent) => {\n        stopPropagation(event);\n        setShowAddUserModal(true);\n    };\n\n    const closeAddUserModal = () => {\n        setShowAddUserModal(false);\n    };\n\n    const stopPropagation = (event: React.MouseEvent) => {\n        event.stopPropagation();\n    };\n\n    const handleShareBoardSubmit = () => {\n        dispatch(Action.Command.shareBoard(props.board.uid, userEmail, permissions));\n\n        setUserEmail('');\n        closeAddUserModal();\n    };\n\n    const onEmailChange = (email: Email) => {\n        setUserEmail(email);\n    };\n\n    const removeMemberFromBoard = () => {\n        if (!memberToRemove) {\n            return;\n        }\n\n        dispatch(Action.Command.revokeAccessToBoard(props.board.uid, memberToRemove));\n        setShowRemoveMemberConfirm(false);\n    };\n\n    const handleHideBoardClick = (e: React.SyntheticEvent) => {\n        e.stopPropagation();\n        dispatch(upsertUserSetting(keyBoardHidden(props.board.uid), !hidden));\n    };\n\n    const eyeIcon = hidden ? \"eye slash icon\" : \"eye icon\";\n\n    return <div className=\"ui item\"  style={{cursor: \"pointer\"}}>\n        {!isStandalone() && <Icon className={angleIcon} onClick={handleVisibleClick}/>}\n        <NavLink className=\"board-list board\" to={Route.compileInspectioBoardWorkspace(props.board.uid)}>{props.board.name}</NavLink>\n        <Icon className={eyeIcon} onClick={handleHideBoardClick} />\n        {!isStandalone() && <div className={contentClass}>\n            <a className=\"ui blue basic label\" onClick={openAddTeamModal}>\n                <i className=\"white plus icon\"/>\n                Add Team\n            </a>\n            {props.board.assignedTeams.map((teamId) => {\n                return <div key={teamId} className=\"ui basic label\">\n                    {getTeamNameById(teamId, teams)}\n                    <i className=\"red delete icon\" onClick={(event: React.MouseEvent) => {\n                        stopPropagation(event);\n                        setTeamToRemove(teamId);\n                        setShowRemoveTeamConfirm(true);\n                    }}/>\n                </div>\n            })}\n            <a className=\"ui blue basic label\" onClick={openAddUserModal}>\n                <i className=\"white plus icon\"/>\n                Add User\n            </a>\n            {props.board.sharedWith.map((userId) => {\n                return <div key={userId} className=\"ui basic label\">\n                    {getUsernameByUserId(userId)}\n                    <i className=\"red delete icon\" onClick={(event: React.MouseEvent) => {\n                        stopPropagation(event);\n                        setMemberToRemove(userId);\n                        setShowRemoveMemberConfirm(true);\n                    }}/>\n                </div>;\n            })}\n        </div>}\n        <div onClick={stopPropagation}>\n            <AddTeamToBoardModal\n                open={showAddTeamModal}\n                onClose={closeAddTeamModal}\n                onSubmit={handleAddTeamSubmit}\n                board={props.board}\n            />\n            <InviteUserToBoardModal\n                open={showAddUserModal}\n                onClose={closeAddUserModal}\n                onSubmit={handleShareBoardSubmit}\n                email={userEmail}\n                onEmailChange={onEmailChange}\n                permissions={permissions}\n                onPermissionsChange={setPermissions}\n            />\n            <Confirm\n                open={showRemoveMemberConfirm}\n                header={props.t('insp.board.remove_user_confirm_title')}\n                content={props.t(\n                    'insp.board.remove_user_confirm_text',\n                    { user_name: memberToRemove ? getUsernameByUserId(memberToRemove) : '' }\n                )}\n                onCancel={() => setShowRemoveMemberConfirm(false)}\n                onConfirm={removeMemberFromBoard}\n            />\n            <Confirm\n                open={showRemoveTeamConfirm}\n                header={props.t('insp.team.remove_from_board_confirm_title')}\n                content={props.t(\n                    'insp.team.remove_from_board_confirm_text',\n                    { team_name: teamToRemove ? getTeamNameById(teamToRemove, teams) : '' }\n                )}\n                onCancel={() => setShowRemoveTeamConfirm(false)}\n                onConfirm={removeTeamFromBoard}\n            />\n        </div>\n    </div>;\n};\n\nconst getTeamNameById = (teamId: TeamId, teams: List<Team>): TeamName => {\n    const team = teams.find(t => t.uid === teamId);\n\n    if(!team) {\n        return 'Unknown Team';\n    }\n\n    return team.name;\n}\n\nexport default withNamespaces()(BoardListItem);\n","import {fromJS} from \"immutable\";\nimport * as React from 'react';\nimport {ChangeEvent, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Icon, Message, Modal} from \"semantic-ui-react\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {makeGetAllBoards} from \"../../InspectioBoards/selectors/boardList\";\nimport {UserSelector} from \"../../User/selectors\";\nimport BoardQuotaReachedModal from \"../../InspectioBoards/components/BoardQuotaReachedModal\";\nimport {BoardId} from \"../../InspectioBoards/model/Board\";\nimport * as uuid from \"uuid\";\nimport {Redirect} from \"react-router\";\nimport * as Routes from \"../../routes\";\n\ninterface OwnProps {};\n\nexport enum ImportMode {\n    newBoard = 'new_board',\n    replaceBoard = 'replace_board',\n    tempBoard = 'temp_board',\n}\n\ntype ImportBoardProps = WithNamespaces & OwnProps;\n\nconst readFileContent = (file: File, handleFileContent: (content: string) => void) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n        let content = reader.result as string|null;\n\n        if(content === null) {\n            content = '';\n        }\n\n        handleFileContent(content);\n    }\n    reader.readAsText(file);\n};\n\nconst extractBoardName = (file: File): string => {\n    return file.name.split('.').slice(0, -1).join('.');\n}\n\nconst ImportBoard = (props: ImportBoardProps) => {\n    const uploadEl = useRef<HTMLInputElement>(null);\n    const [disabled, setDisabled] = useState(false);\n    const [showQuotaModal, setShowQuotaModal] = useState(false);\n    const [askForImportMode, setAskForImportMode] = useState(false);\n    const [currentFile, setCurrentFile] = useState<File|null>(null);\n    const getUserQuota = UserSelector.makeGetCurrentBoardQuota();\n    const userQuota = useSelector(getUserQuota);\n    const getUser = UserSelector.makeGetCurrentUser();\n    const user = useSelector(getUser);\n    const getBoards = makeGetAllBoards();\n    const boards = useSelector(getBoards);\n    const [existingBoardName, setExistingBoardName] = useState('undefined');\n    const [boardId, setBoardId] = useState<BoardId|undefined>(undefined);\n    const dispatch = useDispatch();\n\n    const handleClick = () => {\n        uploadEl.current!.click();\n    };\n\n    const processFile = (boardName: string, file: File, importMode: ImportMode) => {\n        if(importMode === ImportMode.newBoard) {\n            if (userQuota === 0) {\n                setShowQuotaModal(true);\n                setDisabled(false);\n                return;\n            }\n\n            readFileContent(file, (content) => {\n                const newBoardId = uuid.v4();\n                dispatch(Action.Command.importNewBoard(boardName, content, newBoardId));\n                setDisabled(false);\n                setBoardId(newBoardId);\n            });\n        } else {\n            const existingBoardList = boards.filter((board) => {\n                return board.name === boardName;\n            });\n\n            if(existingBoardList.count() > 0) {\n                const existingBoard: BoardModel.Board = existingBoardList.first();\n\n                readFileContent(file, (content) => {\n                    const updatedBoard = existingBoard.updateXml(content, user.uid);\n                    dispatch(Action.Command.importExistingBoard(updatedBoard));\n                    // wait a moment, so that board xml gets updated before redirect to board workspace happens\n                    window.setTimeout(() => {\n                        setBoardId(updatedBoard.uid);\n                    }, 50);\n                    setDisabled(false);\n                });\n            }\n        }\n\n        uploadEl.current!.value = '';\n    };\n\n    const handleFileSelected = (e: ChangeEvent<HTMLInputElement>) => {\n        setDisabled(true);\n\n        const file = e.target.files![0] || null;\n\n        const boardName = extractBoardName(file);\n\n        const existingBoardList = boards.filter((board) => {\n            return board.name === boardName;\n        });\n\n        if(existingBoardList.count() !== 0) {\n            setCurrentFile(file);\n            setExistingBoardName(boardName);\n            setAskForImportMode(true);\n            return;\n        }\n\n        processFile(extractBoardName(file), file, ImportMode.newBoard);\n    }\n\n    const handleQuotaModalClose = () => {\n        setShowQuotaModal(false);\n    }\n\n    const handleImportModalClose = () => {\n        setAskForImportMode(false);\n    }\n\n    const handleImportCopyClick = () => {\n        setAskForImportMode(false);\n        if(currentFile) {\n            processFile(extractBoardName(currentFile) + \" (Copy)\", currentFile, ImportMode.newBoard);\n        }\n    };\n\n    const handleOverrideClick = () => {\n        setAskForImportMode(false);\n        if(currentFile) {\n            processFile(extractBoardName(currentFile), currentFile, ImportMode.replaceBoard);\n        }\n    }\n\n    if(boardId && boards.filter(board => board.uid === boardId).count() === 1) {\n        return <Redirect to={Routes.compileInspectioBoardWorkspace(boardId)} />;\n    }\n\n    return <div className=\"item\">\n        <Button className=\"large basic\" onClick={handleClick} disabled={disabled}><i className=\"download icon\" /> Import&nbsp;Board</Button>\n        <input type=\"file\" ref={uploadEl} style={{display: 'none'}} onChange={handleFileSelected} />\n        <BoardQuotaReachedModal open={showQuotaModal} onClose={handleQuotaModalClose} />\n        <Modal open={askForImportMode} closeIcon={true} onClose={handleImportModalClose}>\n            <Modal.Header>{ props.t(\"insp.board.import\") }</Modal.Header>\n            <Modal.Content>\n                <Message icon=\"warning\" warning={true} content={props.t('insp.board.import_existing_board').replace('%name%', existingBoardName)} />\n            </Modal.Content>\n            <Modal.Actions>\n                <Button primary={true} onClick={handleImportCopyClick}><Icon name='plus' /> { props.t('insp.board.btn_import_as_new') }</Button>\n                <Button basic={true} onClick={handleOverrideClick}>{ props.t('insp.board.btn_replace_board') }</Button>\n            </Modal.Actions>\n        </Modal>\n    </div>\n};\n\nexport default withNamespaces()(ImportBoard);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useTranslation} from \"react-i18next/hooks\";\n\ninterface OwnProps {\n    showAll: boolean;\n    onClick: () => void;\n}\n\ntype ShowMoreBoardsItemProps = OwnProps & WithNamespaces;\n\nconst ShowMoreBoardsItem = (props: ShowMoreBoardsItemProps) => {\n    const handleClick = () => props.onClick();\n\n    return <div className=\"ui item\" style={{cursor: \"pointer\", textAlign: \"center\", color: \"#00b5ad\"}} onClick={handleClick}>\n        {props.showAll? props.t('app.showLess') : props.t('app.showAll')}\n    </div>\n};\n\nexport default withNamespaces()(ShowMoreBoardsItem);","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useMemo, useState} from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {makeGetBoards} from \"../../InspectioBoards/selectors/boardList\";\nimport {keyBoardHidden, makeUserSettingsSelector} from \"../../User/selectors/userSettings\";\nimport BoardListItem from \"./BoardListItem\";\nimport SharedBoardsItem from \"./SharedBoardsItem\";\nimport ShowMoreBoardsItem from \"./ShowMoreBoardsItem\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeOrganizationSelector} from \"../../Organization/selectors/selectOrganization\";\nimport {isStandalone} from \"../../standalone/util\";\n\ninterface OwnProps {\n\n}\n\ntype BoardListProps = OwnProps;\n\nconst BoardList = (props: BoardListProps) => {\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organization = useSelector(makeOrganizationSelector(currentUser.activeOrganization));\n    const isOrgaAdmin = organization? organization.isAdmin(currentUser.uid) : false;\n\n\n    const [showAll, setShowAll] = useState(false);\n    const getBoards = makeGetBoards(true);\n    const boards = useSelector(getBoards);\n    const userSettings = useSelector(makeUserSettingsSelector());\n    const sharedBoardsCount = useMemo<number>(() => {\n        return boards.filter(board => board.shared && !isOrgaAdmin).count();\n    }, [boards]);\n\n    const handleShowMoreClick = () => {\n        setShowAll(!showAll);\n    };\n\n    let ownVisibleBoards = List<BoardModel.Board>();\n    let ownHiddenBoards = List<BoardModel.Board>();\n\n    boards\n        .filter(board => !board.shared || isOrgaAdmin)\n        .sortBy(board => board.name, (a, b) => a === b ? 0 : (a! < b! ? -1 : 1))\n        .forEach(ownBoard => {\n            if (userSettings[keyBoardHidden(ownBoard.uid)] === true) {\n                ownHiddenBoards = ownHiddenBoards.push(ownBoard);\n            } else {\n                if(!showAll && ownVisibleBoards.count() >= 3) {\n                    ownHiddenBoards = ownHiddenBoards.push(ownBoard);\n                } else {\n                    ownVisibleBoards = ownVisibleBoards.push(ownBoard);\n                }\n            }\n        });\n\n    if(showAll) {\n        ownVisibleBoards = ownVisibleBoards.push(...ownHiddenBoards.toArray());\n    }\n\n    const boardListItems = ownVisibleBoards\n        .map((board) => {\n        return <BoardListItem key={board.uid} board={board} />\n    }).toArray();\n\n    if(ownHiddenBoards.count() > 0 || ownVisibleBoards.count() > 3) {\n        boardListItems.push(<ShowMoreBoardsItem showAll={showAll} key=\"sidebar-show-more-boards\" onClick={handleShowMoreClick} />);\n    } else if (showAll) {\n        setShowAll(false);\n    }\n\n    if(!isStandalone()) {\n        boardListItems.push(<SharedBoardsItem count={sharedBoardsCount} key=\"sidebar-shared-boards\"/>);\n    }\n\n\n    return <>{boardListItems}</>;\n};\n\nexport default BoardList;\n","import * as React from 'react';\nimport {useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {NavLink} from \"react-router-dom\";\nimport {Icon} from \"semantic-ui-react\";\nimport {makeGetBoards} from \"../../InspectioBoards/selectors/boardList\";\nimport * as Routes from \"../../routes\";\n\ninterface OwnProps {}\n\ntype BoardOverviewProps = OwnProps & RouteComponentProps;\n\nconst BoardOverview = (props: BoardOverviewProps) => {\n    const getBoards = makeGetBoards(true);\n    const boards = useSelector(getBoards);\n\n    let badgeClasses = \"ui small label\";\n\n    if(props.location.pathname === Routes.inspectio) {\n       badgeClasses += \" teal\";\n    }\n\n    return <NavLink exact={true} className=\"item\" activeClassName=\"active\" to={Routes.inspectio}>\n        <Icon className=\"sticky note icon\"/>\n        <div className={badgeClasses}>{ boards.count() }</div>\n        Boards\n    </NavLink>\n};\n\nexport default withRouter(BoardOverview);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Divider, Icon, Message, MessageContent, Modal, TextArea, TextAreaProps} from \"semantic-ui-react\";\nimport {isStandalone} from \"../../standalone/util\";\n\ninterface OwnProps {\n    open: boolean;\n    onClose: () => void;\n    onSubmit: (feedbackText: string) => void;\n    reset?: boolean;\n}\n\ntype FeedbackModalProps = OwnProps & WithNamespaces;\n\nconst FeedbackModal = (props: FeedbackModalProps) => {\n    const [feedback, setFeedback] = useState('');\n\n    const handleChange = (event: React.FormEvent<HTMLTextAreaElement>, {value}: TextAreaProps) => {\n        if(value) {\n            setFeedback(value + '');\n        }\n    };\n    const handleSendBtnClick = () => {\n        props.onSubmit(feedback);\n    };\n\n    if(props.reset && feedback !== '') {\n        setFeedback('');\n    }\n\n    return <Modal open={props.open} closeIcon={true} onClose={props.onClose}>\n        <Modal.Header>{ props.t('insp.feedback.header') }</Modal.Header>\n        <Modal.Content>\n            <Message>\n                <MessageContent>\n                    { props.t('insp.feedback.info_text') }\n                    <p>&nbsp;</p>\n                    <p><a href=\"https://gitter.im/proophboard/community\" target=\"_blank\"><Icon name=\"arrow right\" />&nbsp;Chat</a></p>\n                    <p><a href=\"https://github.com/proopboard/issue-tracker/issues\" target=\"_blank\"><Icon name=\"arrow right\" />&nbsp;Issue Tracker</a></p>\n                </MessageContent>\n            </Message>\n            {!isStandalone() && <>\n                <Divider horizontal={true}>OR</Divider>\n                <p>{props.t('insp.feedback.direct_msg')}</p>\n                <form className=\"ui form\">\n                    <TextArea placeholder={props.t('insp.feedback.placeholder')}\n                              autoHeight={true}\n                              autoFocus={true}\n                              value={feedback}\n                              onChange={handleChange}\n                              style={{minHeight: '100px'}}/>\n                </form>\n            </>}\n        </Modal.Content>\n        {!isStandalone() && <Modal.Actions>\n            <Button primary={true} onClick={handleSendBtnClick}>{props.t('insp.feedback.send')}</Button>\n        </Modal.Actions>}\n    </Modal>\n};\n\nexport default withNamespaces()(FeedbackModal);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button} from \"semantic-ui-react\";\nimport {sendUserFeedback} from \"../../Feedback/actions/api\";\nimport FeedbackModal from \"../../Feedback/components/FeedbackModal\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\n\ninterface OwnProps {\n\n}\n\ntype FeedbackProps = OwnProps;\n\nconst ERROR_MSG = \"Failed to send feedback. Please try again or send an email to contact@prooph.de\";\n\nconst Feedback = (props: FeedbackProps) => {\n    const dispatch = useDispatch();\n    const [showFeedbackModal, setShowFeedbackModal] = useState(false);\n    const [resetFeedbackModal, setResetFeedbackModal] = useState(false);\n    const user = useSelector(makeGetCurrentUser());\n\n    const handleFeedbackBtnClick = () => {\n        setResetFeedbackModal(false);\n        setShowFeedbackModal(true);\n    };\n    const handleModalClose = () => setShowFeedbackModal(false);\n    const handleFeedbackSubmit = (feedback: string) => {\n        sendUserFeedback(feedback, user.email)\n            .then(({response, error}) => {\n                if(error) {\n                    dispatch(Notify.Command.error(\"Request Error\", ERROR_MSG));\n                }\n\n                if(response) {\n                    setResetFeedbackModal(true);\n                    setShowFeedbackModal(false);\n                    dispatch(Notify.Command.info(\"Feedback sent\", \"We received your feedback. Thank you!\"))\n                }\n            })\n            .catch(() => {\n                dispatch(Notify.Command.error(\"Request Error\", ERROR_MSG));\n            });\n    };\n\n    return <>\n        <div className=\"ui item\">\n            <Button className=\"big\" onClick={handleFeedbackBtnClick}>\n                <div className=\"header\">Feedback</div>\n                <div className=\"sub header\" style={{textTransform:\"none\", fontWeight:\"normal\"}}>Send Bugs & Feature Requests</div>\n            </Button>\n        </div>\n        <FeedbackModal open={showFeedbackModal} onClose={handleModalClose} onSubmit={handleFeedbackSubmit} reset={resetFeedbackModal} />\n    </>;\n};\n\nexport default Feedback;","import {axiosApiPromise, ResponseType} from \"../../api/util\";\nimport {Email} from \"../../User/model/UserInfo\";\nimport {SERVER_CONTEXT} from \"./constants\";\n\nexport const sendUserFeedback = (feedbackText: string, email: Email): Promise<ResponseType> => {\n    return axiosApiPromise(SERVER_CONTEXT + 'SendUserFeedback', {text: feedbackText, userEmail: email});\n};\n","import * as _ from 'lodash';\nimport * as React from 'react';\nimport {ChangeEvent, useRef, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps} from \"react-router\";\nimport {Dropdown, DropdownDivider, DropdownItem, DropdownMenu, Input, Search} from \"semantic-ui-react\";\nimport {Palette} from \"../../theme/palette\";\nimport {filterElementsTree} from \"../actions/commands\";\nimport {BoardId} from \"../model/Board\";\nimport {parseFilter} from \"../model/ElementsTree\";\nimport {NodeType} from \"../model/Graph\";\nimport {HistoryCellType} from \"../model/HistoryEntry\";\nimport {makeElementsTreeByBoardIdSelector} from \"../selectors/elementsTree\";\nimport CellIcon from \"./CellIcon\";\n\ninterface OwnProps {\n\n}\n\ninterface SearchRouteProps {\n    uid: BoardId;\n}\n\ntype MxGraphBoardSearchProps = OwnProps & RouteComponentProps<SearchRouteProps> & WithNamespaces;\n\nlet lastFilterVal = '';\nlet lastSelectedType: HistoryCellType | undefined;\n\nconst withoutSelectedType = (searchVal: string, selectedType: HistoryCellType | undefined): string => {\n    if(!selectedType) {\n        return searchVal;\n    }\n\n    return searchVal.replace(`type:${selectedType};`, '');\n}\n\nconst withSelectedType = (searchVal: string, selectedType: HistoryCellType | undefined): string => {\n    if(!selectedType) {\n        return searchVal;\n    }\n\n    return `type:${selectedType};` + searchVal;\n}\n\nconst validFilterType = (type: HistoryCellType): boolean => {\n    switch (type) {\n        case NodeType.event:\n        case NodeType.command:\n        case NodeType.role:\n        case NodeType.aggregate:\n        case NodeType.document:\n        case NodeType.policy:\n        case NodeType.externalSystem:\n        case NodeType.hotSpot:\n        case NodeType.ui:\n        case NodeType.boundedContext:\n        case NodeType.feature:\n        case NodeType.icon:\n        case NodeType.image:\n        case NodeType.freeText:\n            return true;\n        default:\n            return false;\n    }\n}\n\nlet filterIsOpen = false;\n\nconst mapLowercaseTypeToNodeType = (type: string): HistoryCellType => {\n    switch (type) {\n        case HistoryCellType.boundedContext.toLowerCase():\n            return HistoryCellType.boundedContext;\n        case HistoryCellType.freeText.toLowerCase():\n            return HistoryCellType.freeText;\n        case HistoryCellType.hotSpot.toLowerCase():\n            return HistoryCellType.hotSpot;\n        case HistoryCellType.externalSystem.toLowerCase():\n            return HistoryCellType.externalSystem;\n        default:\n            return type as HistoryCellType;\n    }\n}\n\nconst MxGraphBoardSearch = (props: MxGraphBoardSearchProps) => {\n    const dispatch = useDispatch();\n\n    const elementsTreeSelector = makeElementsTreeByBoardIdSelector(props.match.params.uid);\n    const elementsTree = useSelector(elementsTreeSelector);\n    const [value, setValue] = useState(elementsTree.filter);\n    const searchInput = useRef<HTMLInputElement>(null);\n    const [showFilter, setShowFilter] = useState(false);\n    const [selectedType, setSelectedType] = useState<HistoryCellType|undefined>();\n    const [searchHasFocus, setSearchHasFocus] = useState(false);\n\n    // Sync filter val from redux store with local state and focus search input\n    if(lastFilterVal !== elementsTree.filter) {\n        lastFilterVal = elementsTree.filter;\n        lastSelectedType = selectedType;\n\n        const parsedFilter = parseFilter(elementsTree.filter);\n\n        if(parsedFilter.nodeTypes.length) {\n            lastSelectedType = parsedFilter.nodeTypes[0] as HistoryCellType;\n\n            if(Object.values(HistoryCellType).map(type => type.toLowerCase()).includes(lastSelectedType)) {\n                setSelectedType(lastSelectedType);\n            } else {\n                lastSelectedType = selectedType;\n            }\n        }\n\n        setValue(withoutSelectedType(elementsTree.filter, lastSelectedType));\n    } else if(lastSelectedType && !selectedType) {\n        const parsedFilter = parseFilter(elementsTree.filter);\n\n        if(parsedFilter.nodeTypes.length && parsedFilter.nodeTypes[0] === lastSelectedType) {\n            setValue(withoutSelectedType(elementsTree.filter, lastSelectedType));\n            setSelectedType(lastSelectedType);\n        }\n    }\n\n    if(elementsTree.focus) {\n        if(searchInput && searchInput.current) {\n            searchInput.current.focus();\n            dispatch(filterElementsTree(props.match.params.uid, elementsTree.filter, false));\n        }\n    }\n\n    const dispatchFilterChange = _.debounce((val) => {\n        lastFilterVal = withSelectedType(val, selectedType);\n        dispatch(filterElementsTree(props.match.params.uid, lastFilterVal))\n    }, 500);\n\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n        setValue(e.target.value);\n        dispatchFilterChange(e.target.value);\n    };\n\n    const handleFilterMouseDown = () => {\n        filterIsOpen = showFilter;\n    }\n\n    const handleFilterClick = () => {\n        if(!filterIsOpen) {\n            setShowFilter(true);\n        }\n    }\n\n    const handleSelectType = (type: HistoryCellType) => {\n        lastFilterVal = withoutSelectedType(lastFilterVal, selectedType);\n        setSelectedType(type);\n        lastSelectedType = type;\n        lastFilterVal = withSelectedType(lastFilterVal, type);\n        dispatch(filterElementsTree(props.match.params.uid, lastFilterVal));\n    }\n\n    const handleClearFilter = () => {\n        lastFilterVal = withoutSelectedType(lastFilterVal, selectedType);\n        lastSelectedType = undefined;\n        setSelectedType(undefined);\n        dispatch(filterElementsTree(props.match.params.uid, lastFilterVal));\n    }\n\n    const handleClear = () => {\n        setValue('');\n        setSelectedType(undefined);\n        lastFilterVal = '';\n        lastSelectedType = undefined;\n        dispatch(filterElementsTree(props.match.params.uid, ''))\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent) => {\n        if(e.keyCode === 27) {\n            handleClear();\n        }\n    }\n\n    const filterColor = selectedType ? Palette.stickyColors[selectedType] : '#909090';\n    const focusClass = searchHasFocus ? ' focus' : '';\n\n    return <div className=\"item\">\n        <div className=\"ui left action right icon input\">\n            <Dropdown open={showFilter} icon={false} onClose={() => {\n                setShowFilter(false)\n            }} scrolling={true}>\n                <DropdownMenu style={{zIndex: 99000}}>\n                    <DropdownItem text=\"Clear Filter\" icon=\"close\" disabled={!selectedType} onClick={handleClearFilter}/>\n                    <DropdownDivider />\n                    {Object.values(HistoryCellType).filter(validFilterType).map(type => {\n                        return <DropdownItem\n                            key={type}\n                            onClick={() => handleSelectType(type.toLowerCase())}\n                            icon={<CellIcon cellType={type} />}\n                            text={props.t('app.stickyTypes.'+type)  } />;\n                    })}\n                </DropdownMenu>\n            </Dropdown>\n            <div className={\"ui left action input search filter\"+focusClass} style={{\n                borderTop: \"1px solid #dedede\",\n                borderBottom: \"1px solid #dedede\",\n                borderLeft: \"1px solid #dedede\",\n                borderTopLeftRadius: \"0.28571429rem\",\n                borderBottomLeftRadius: \"0.28571429rem\",\n            }}>\n                <button className=\"ui basic icon button\" onMouseDown={handleFilterMouseDown} onClick={handleFilterClick}>\n                    {!selectedType && <i className=\"filter icon\" style={{color: filterColor}}/>}\n                    {selectedType && <CellIcon cellType={mapLowercaseTypeToNodeType(selectedType)} size=\"normal\" />}\n                </button>\n            </div>\n            <input\n                type=\"text\"\n                placeholder=\"Search...\"\n                onChange={handleChange}\n                onFocus={() => setSearchHasFocus(true)}\n                onBlur={() => setSearchHasFocus(false)}\n                className=\"tree search\" value={value}\n                ref={searchInput}\n                onKeyDown={handleKeyDown}\n                style={{width: '80%'}}  />\n            {!elementsTree.isFiltered() && !selectedType && <i className=\"search icon\"/>}\n            {(elementsTree.isFiltered() || selectedType) &&\n            <i className=\"close link icon\" style={{cursor: \"pointer\"}} onClick={handleClear}/>}\n        </div>\n    </div>\n};\n\nexport default withNamespaces()(MxGraphBoardSearch);\n","import {List} from \"immutable\";\nimport {SyntheticEvent, useEffect, useMemo, useRef, useState} from \"react\";\nimport * as React from \"react\";\nimport Draggable, {DraggableData, DraggableEvent} from 'react-draggable';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Card, Icon, Message} from \"semantic-ui-react\";\nimport {setRightSidebarWidth, setSidebarWidth, toggleSidebarCollapsed} from \"../../Layout/actions/commands\";\nimport {makeGetSidebarSelector} from \"../../Layout/selectors/sidebar\";\nimport * as Action from \"../actions\";\nimport {toggleElementDetails} from \"../actions/commands\";\nimport {activeGraphElementChanged} from \"../actions/events\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {BoardId} from \"../model/Board\";\nimport {Node, NodeType} from \"../model/Graph\";\nimport {ActiveGraphElement, makeNodeFromActiveGraphElement} from \"../reducers/applyActiveGraphElementActions\";\nimport {makeActiveGraphElementSelector} from \"../selectors/activeGraphElement\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport {makeElementsTreeByBoardIdSelector} from \"../selectors/elementsTree\";\nimport {makeBoardStickyTemplateMapSelector} from \"../selectors/StickyTemplate\";\nimport BoardElementMetadata, {BoardElementMetadataRef} from \"./BoardElementDetails/BoardElementMetadata\";\nimport RunCodyOnSelect from \"./CodyEngineWizard/CodyMonitor/RunCodyOnSelect\";\n\ninterface ElementDetailsRouteMatchParams {\n    uid: BoardId;\n}\n\ntype BoardElementDetailsProps =  WithNamespaces & RouteComponentProps<ElementDetailsRouteMatchParams>;\n\nexport const isConnected = (ele: ActiveGraphElement): boolean => {\n    const tags = ele.tags || [];\n\n    return tags.includes(ispConst.TAG_CONNECTED);\n}\n\nexport const markAsDisconnected = (ele: ActiveGraphElement): string[] => {\n    const tags = ele.tags || [];\n\n    tags.push(ispConst.TAG_DISCONNECTED);\n    return tags.filter(tag => tag !== ispConst.TAG_CONNECTED);\n}\n\nexport const markAsConnected = (ele: ActiveGraphElement): string[] => {\n    const tags = ele.tags || [];\n\n    tags.push(ispConst.TAG_CONNECTED);\n    return tags.filter(tag => tag !== ispConst.TAG_DISCONNECTED);\n}\n\nlet syncTimer: number;\n\nconst BoardElementDetails = (props: BoardElementDetailsProps) => {\n\n    const dispatch = useDispatch();\n    const sidebar = useSelector(makeGetSidebarSelector());\n    const [showSimilarElements, setShowSimilarElements] = useState<boolean>(false);\n    const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.match.params.uid), []);\n    const board = useSelector(getBoardByIdSelector);\n    const activeGraphElement = useSelector(makeActiveGraphElementSelector(props.match.params.uid));\n    const visible =  (board && board.shouldShowElementDetails) || false;\n    const boardStickyTemplates = useSelector(makeBoardStickyTemplateMapSelector(props.match.params.uid));\n    const elementsTree = useSelector(makeElementsTreeByBoardIdSelector(props.match.params.uid));\n    const [isDragging, setIsDragging] = useState(false);\n    const [collabsableRight, setCollabsableRight] = useState(sidebar.rightSidebarWidth);\n    const [graph] = useGraph();\n    const boardElementMetadataRef = useRef<BoardElementMetadataRef|null>(null);\n    const [showRunCody, setShowRunCody] = useState(true);\n\n    useEffect(() => {\n        const isMobile = window.matchMedia('(max-width: 900px)');\n\n        const checkMobile = (matches: boolean) => {\n            if(matches) {\n                const availWidth = window.screen.availWidth - 90 /* left mini sidebar */ - 100 /* some space for the board */;\n\n                dispatch(setRightSidebarWidth(Math.min(availWidth, 450)));\n            }\n        }\n\n        const listener = (e: MediaQueryListEvent) => {\n            checkMobile(e.matches);\n        }\n\n        isMobile.addEventListener(\"change\", listener);\n\n        checkMobile(isMobile.matches);\n\n        return () => {\n            isMobile.removeEventListener(\"change\", listener);\n        }\n    }, []);\n\n    useEffect(() => {\n        if(!isDragging) {\n            setCollabsableRight(sidebar.rightSidebarWidth);\n        }\n    }, [sidebar.rightSidebarWidth]);\n\n    useEffect(() => {\n        dispatch(Action.Query.fetchBoardStickyTemplates(props.match.params.uid))\n        setShowRunCody(true);\n    }, [props.match.params.uid])\n\n    useEffect(() => {\n        if(board && board.shouldFocusMetadataEditor) {\n            dispatch(Action.Command.toggleElementDetails(props.match.params.uid, visible, false));\n            setShowRunCody(false);\n        }\n    }, [board && board.shouldFocusMetadataEditor])\n\n    const activeElementId = activeGraphElement ? activeGraphElement.id : null;\n\n    useEffect(() => {\n        setShowRunCody(true);\n    }, [activeElementId]);\n\n\n    let similarElements = List<string>();\n    let activeNodeSources: List<Node> = List();\n    let activeNodeTargets: List<Node> = List();\n\n    const handleDragging = (e: DraggableEvent, data: DraggableData) => {\n        if(!isDragging) {\n            setIsDragging(true);\n        }\n\n        const newWidth = sidebar.rightSidebarWidth - data.deltaX;\n\n        dispatch(setRightSidebarWidth(newWidth));\n    }\n\n    const handleDragStop = (e: DraggableEvent, data: DraggableData) => {\n        setIsDragging(false);\n        setCollabsableRight(sidebar.rightSidebarWidth);\n    }\n\n\n    if(activeGraphElement && activeGraphElement.type !== NodeType.edge) {\n        const node = elementsTree.getElement(activeGraphElement.id) || makeNodeFromActiveGraphElement(activeGraphElement);\n        const similarElementsNodes = elementsTree.getSimilarElements(node)\n          .filter(ele => ele.getTags().contains(ispConst.TAG_CONNECTED));\n\n        similarElements = similarElementsNodes.map(ele => ele.getId());\n\n        const activeNode = elementsTree.getElement(activeGraphElement.id);\n\n        if(activeNode) {\n            activeNodeSources = activeNode.getSources();\n            activeNodeTargets = activeNode.getTargets();\n\n            let activeNodeSourcesIds = activeNodeSources.map(n => n.getId());\n            let activeNodeTargetsIds = activeNodeTargets.map(n => n.getId());\n\n            similarElementsNodes.forEach(se => {\n                const deduplicatedSources = se.getSources().filter(s => !activeNodeSourcesIds.contains(s.getId()));\n                const deduplicatedTargets = se.getTargets().filter(t => !activeNodeTargetsIds.contains(t.getId()));\n\n                activeNodeSources = activeNodeSources.push(...deduplicatedSources.toArray());\n                activeNodeSourcesIds = activeNodeSourcesIds.push(...deduplicatedSources.toArray().map(s => s.getId()));\n                activeNodeTargets = activeNodeTargets.push(...deduplicatedTargets.toArray());\n                activeNodeTargetsIds = activeNodeTargetsIds.push(...deduplicatedTargets.toArray().map(t => t.getId()));\n            })\n        }\n    }\n\n    if(activeGraphElement && activeGraphElement.type === NodeType.edge && activeGraphElement.edgeData) {\n        const activeSource = elementsTree.getElement(activeGraphElement.edgeData.source);\n        const activeTarget = elementsTree.getElement(activeGraphElement.edgeData.target);\n        if(activeSource) {\n            activeNodeSources = List([activeSource]);\n        }\n        if(activeTarget) {\n            activeNodeTargets = List([activeTarget]);\n        }\n    }\n\n\n    const handleCloseElementDetails = () => {\n        dispatch(activeGraphElementChanged(props.match.params.uid, activeGraphElement || undefined));\n        dispatch(toggleElementDetails(props.match.params.uid, false, false));\n        graph.focus();\n    };\n\n    const handleUpdateMetadata = (editorValue: string, force?: boolean) => {\n        activeGraphElement!.metadata = editorValue;\n        activeGraphElement!.updateMetadata(editorValue, force);\n\n        if(isConnected(activeGraphElement!) && similarElements.count()) {\n\n            if(syncTimer) {\n                window.clearTimeout(syncTimer);\n            }\n\n            syncTimer = window.setTimeout(() => {\n                activeGraphElement!.updateSimilarElements(similarElements.toArray(), editorValue);\n            }, 300);\n        }\n    };\n\n    const handleDisconnectElement = (e: SyntheticEvent) => {\n        e.preventDefault();\n\n        if(activeGraphElement) {\n            if(activeGraphElement.locked) {\n                return;\n            }\n\n            activeGraphElement.replaceTags(markAsDisconnected(activeGraphElement));\n        }\n    }\n\n    const handleConnectElement = (e: SyntheticEvent) => {\n        e.preventDefault();\n\n        if(activeGraphElement) {\n            if(activeGraphElement.locked) {\n                return;\n            }\n\n            activeGraphElement.replaceTags(markAsConnected(activeGraphElement));\n        }\n    }\n\n    const runCody = (e: SyntheticEvent) => {\n        e.preventDefault();\n\n        graph.openCodyWizard(true);\n    }\n\n    return (\n        // Transition.Group in combination with monaco editor causes very expensive painting when closing the sidebar: main thread is blocked for > 10 sec\n        // Hence, it is deactivated for now, but we should investigate further\n        /*<Transition.Group animation=\"slide down\">*/<>\n            {visible && <div id=\"metadata-sidebar\" className=\"touch-only-pan\" style={{position: \"absolute\", paddingTop: \"50px\", top: \"0px\", right: \"0px\", height: \"100%\", overflow: \"hidden\", borderLeft:\"5px solid #eee\", zIndex: 99}}>\n            <Card style={{height: \"100%\", borderRadius:'0', width: sidebar.rightSidebarWidth + 'px'}}>\n                <Card.Content>\n                    <Card.Header><Icon name=\"close\" className=\"right floated\" onClick={handleCloseElementDetails} style={{cursor: \"pointer\"}} />\n                    {activeGraphElement && <>{activeGraphElement!.label}</>}\n                    {!activeGraphElement && <>Metadata</>}\n                    </Card.Header>\n                </Card.Content>\n                <Card.Content style={{position: \"relative\", height: \"100%\", overflowY: \"auto\", display: \"flex\", flexDirection: \"column\"}}>\n                    {!activeGraphElement && <Message info={true}>{props.t('insp.sidebar.element_details.no_element_selected')}</Message>}\n                    {activeGraphElement && (\n                        <BoardElementMetadata\n                            boardId={props.match.params.uid}\n                            board={board}\n                            activeNodeSources={activeNodeSources}\n                            activeNodeTargets={activeNodeTargets}\n                            activeGraphElement={activeGraphElement}\n                            similarElements={similarElements}\n                            boardStickyTemplate={boardStickyTemplates.get(activeGraphElement.type as NodeType)!}\n                            onTriggerCody={() => graph.triggerCody()}\n                            onUpdateMetadata={handleUpdateMetadata}\n                            onShowRunCody={setShowRunCody}\n                            onClose={handleCloseElementDetails}\n                            t={props.t}\n                            ref={boardElementMetadataRef}\n                            focusEditor={!!board.shouldFocusMetadataEditor}\n                        />\n                    )}\n                </Card.Content>\n                {showRunCody && activeGraphElement && <Card.Content style={{textAlign: 'center'}}>\n                    <p><RunCodyOnSelect /></p>\n                    <Button primary={true} icon=\"play circle\" content={props.t('insp.cody_wizard.run_cody') as string} onClick={runCody}  />\n                </Card.Content>}\n                {!showRunCody && activeGraphElement && isConnected(activeGraphElement) && similarElements.size > 0 && <Card.Content>\n                    <Message info={true} size=\"small\" style={{textAlign: 'center'}}>\n                        {props.t('insp.sidebar.element_details.disconnect_from_similar_elements_text', {number: similarElements.size})}\n                        <p style={{textAlign: 'center', paddingTop: '10px'}}>\n                            <a href='#' onClick={handleDisconnectElement} className={'button' + (activeGraphElement.locked? ' disabled' : '')}>{props.t('insp.sidebar.element_details.disconnect_from_similar_elements_link')}</a>\n                        </p>\n                    </Message>\n                </Card.Content>}\n                {!showRunCody && activeGraphElement && !isConnected(activeGraphElement) && similarElements.size > 0 && <Card.Content>\n                    <Message warning={true} size=\"small\" style={{textAlign: 'center'}}>\n                        {props.t('insp.sidebar.element_details.connect_with_similar_elements_text', {number: similarElements.size})}\n                        <p style={{textAlign: 'center', paddingTop: '10px'}}>\n                            <a href='#' onClick={handleConnectElement} className={'button' + (activeGraphElement.locked? ' disabled' : '' )}>{props.t('insp.sidebar.element_details.connect_with_similar_elements_link')}</a>\n                        </p>\n                    </Message>\n                </Card.Content>}\n            </Card>\n            <Draggable\n                axis=\"x\"\n                onDrag={handleDragging}\n                onStop={handleDragStop}\n                position={{x: 0, y: 0}}\n            >\n                <div className=\"thin collapsebar collapsible\" style={{right: collabsableRight + 'px', cursor: 'grabbing'}} />\n            </Draggable>\n        </div>}\n        </>\n        /*</Transition.Group> */\n    );\n};\n\nexport default withNamespaces()(withRouter(BoardElementDetails));\n","import * as React from 'react';\nimport {useEffect, useRef} from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Label} from \"semantic-ui-react\";\nimport {loadCodyConsoleHistory, saveCodyConsoleHistory} from \"../../../core/localStorage\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\nimport {toggleElementDetails} from \"../../actions/commands\";\nimport {useGraph} from \"../../hooks/useGraph\";\nimport {BoardId} from \"../../model/Board\";\nimport {CodyResponse, CodyResponseType} from \"../../service/Cody\";\n\ninterface OwnProps {\n    boardId: BoardId;\n    messageCount: number;\n    lastCodyMsg?: CodyResponse;\n    visible: boolean;\n    onEnter: (val: string) => void;\n    onEscape: () => void;\n    onClose: () => void;\n    showConnectDefault?: boolean;\n}\n\ntype UserInputProps = OwnProps;\n\nlet history: string[] = loadCodyConsoleHistory();\nlet currentHistoryEntry: number|undefined;\n\nconst UserInput = (props: UserInputProps) => {\n    const user = useSelector(makeGetCurrentUser());\n    const inputEl = useRef<HTMLInputElement>(null);\n    const [graph] = useGraph();\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        window.setTimeout(() => {\n            if(inputEl.current && ((props.lastCodyMsg && props.lastCodyMsg.type === CodyResponseType.Question) || props.showConnectDefault)) {\n                inputEl.current.focus();\n            }\n        }, 100);\n    }, [props.messageCount, props.lastCodyMsg, props.visible, props.showConnectDefault]);\n\n    useEffect(() => {\n        return () => {\n            saveCodyConsoleHistory(history.slice(0,10));\n        }\n    });\n\n    const defaultValue = props.showConnectDefault? '/connect http://localhost:3311' : '';\n\n    const handleKeyDown = (e: React.KeyboardEvent) => {\n        if(e.key === 'Enter') {\n            props.onEnter(inputEl.current!.value || '');\n\n            if(inputEl.current!.value !== '') {\n                if(currentHistoryEntry !== undefined && currentHistoryEntry !== -1) {\n                    if(history[currentHistoryEntry] === inputEl.current!.value) {\n                        history.splice(currentHistoryEntry, 1);\n                    }\n\n                }\n                if(!history.length || history[0] !== inputEl.current!.value) {\n                    history.unshift(inputEl.current!.value);\n                }\n            }\n            inputEl.current!.value = '';\n            currentHistoryEntry = undefined;\n\n        } else if (e.key === 'Escape') {\n            props.onEscape();\n        } else if (e.ctrlKey && e.key === 'q') {\n            props.onClose();\n        } else if (e.key === 'ArrowUp') {\n            if(currentHistoryEntry === undefined) {\n                currentHistoryEntry = 0;\n            } else {\n                currentHistoryEntry++;\n            }\n\n            if(currentHistoryEntry + 1 > history.length) {\n                currentHistoryEntry = history.length - 1;\n            }\n\n            if(currentHistoryEntry !== -1) {\n                inputEl.current!.value = history[currentHistoryEntry];\n            }\n            e.preventDefault();\n        } else if (e.key === 'ArrowDown') {\n            if(currentHistoryEntry === undefined) {\n                return;\n            }\n\n            currentHistoryEntry--;\n\n            if(currentHistoryEntry > -1) {\n                inputEl.current!.value = history[currentHistoryEntry];\n                inputEl.current!.focus();\n            }\n\n            if(currentHistoryEntry === -1) {\n                if(history.length && history[0] === inputEl.current!.value) {\n                    inputEl.current!.value = '';\n                    inputEl.current!.focus();\n                }\n                currentHistoryEntry = undefined;\n\n            }\n            e.preventDefault();\n        } else if (e.ctrlKey && e.key === 'g') {\n            graph.triggerCody();\n            e.preventDefault();\n        } else if (e.ctrlKey && e.key === 'm') {\n            dispatch(toggleElementDetails(props.boardId, true, true));\n            e.preventDefault();\n        } else {\n            currentHistoryEntry = undefined;\n        }\n    }\n\n    return <div className=\"console-message\">\n        <Label circular={true} className=\"user\" style={{backgroundImage: `url(${user.avatarUrl})`, backgroundSize: 'cover', marginLeft: '1px'}} />\n        <span style={{marginLeft: '3px'}}>&nbsp;&nbsp;</span>\n        <input type=\"text\" defaultValue={defaultValue} ref={inputEl} onKeyDown={handleKeyDown} />\n    </div>\n};\n\nexport default UserInput;\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Link} from \"react-router-dom\";\nimport {Icon, MenuItem, Popup} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\nimport {upsertUserSetting} from \"../../User/actions/commands\";\nimport {makeUserSettingSelector, makeUserSettingsLoadedSelector} from \"../../User/selectors/userSettings\";\n\ninterface OwnProps {\n    collapsed: boolean;\n}\n\ntype LogoProps = OwnProps & WithNamespaces;\n\nconst Logo = (props: LogoProps) => {\n\n    const dispatch = useDispatch();\n    const [popupOpen, setPopupOpen] = useState(false);\n    const [logoLoaded, setLogoLoaded] = useState(false);\n    const settingsLoaded = useSelector(makeUserSettingsLoadedSelector());\n    const showHint = useSelector(makeUserSettingSelector('show_logo_hint', false));\n\n\n    useEffect(() => {\n        if(settingsLoaded && logoLoaded && showHint) {\n            setPopupOpen(true);\n        }\n    }, [settingsLoaded, logoLoaded, showHint])\n\n    const handleHintClick = () => {\n        setPopupOpen(false);\n        dispatch(upsertUserSetting('show_logo_hint', false));\n    }\n\n    const handleLogoLoaded = () => {\n        setLogoLoaded(true);\n    }\n\n    return <Popup\n                open={popupOpen}\n                position=\"bottom center\"\n                content={<>\n                    <p><strong>{props.t('insp.hint.new_logo_header')}</strong></p>\n                    <p>{props.t('insp.hint.new_logo_text')}!</p>\n                    <p><Icon name=\"arrow right\"/>&nbsp;<a href=\"https://github.com/event-engine/inspectio/wiki/Rebranding\" target=\"_blank\">{props.t('insp.hint.learn_more')}</a></p>\n                    <p><span style={{\"color\": \"#9cc8f5\", \"cursor\": \"pointer\", float: \"right\"}} onClick={handleHintClick}>{props.t('insp.hint.got_it')}</span></p>\n                </>}\n                trigger={\n                    <MenuItem className=\"logo-item\">\n                        <Link to={Routes.inspectio}>\n                            <img className=\"logo\" src=\"img/prooph-board-logo.png\" alt=\"prooph board logo\"  onLoad={handleLogoLoaded} />\n                        </Link>\n                    </MenuItem>\n                }\n            />\n};\n\nexport default withNamespaces()(Logo);\n","import * as React from 'react';\nimport {Route, RouteComponentProps, Switch, withRouter} from \"react-router\";\nimport BoardOverviewSearch from \"../../InspectioBoards/components/BoardOverviewSearch\";\nimport MxGraphBoardSearch from \"../../InspectioBoards/components/MxGraphBoardSearch\";\nimport * as Routes from '../../routes';\n\ntype SearchProps = RouteComponentProps;\n\nconst Search = (props: SearchProps) => {\n    return <Switch>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={MxGraphBoardSearch} />\n    </Switch>\n};\n\nexport default withRouter(Search);\n","import * as React from 'react';\nimport {Grid, Label, Message} from \"semantic-ui-react\";\nimport moment from \"moment\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {\n    makeUserSettingSelector,\n    makeUserSettingsLoadedSelector,\n    keyUpdateViewed\n} from \"../../User/selectors/userSettings\";\nimport {useEffect} from \"react\";\nimport {upsertUserSetting} from \"../../User/actions/commands\";\n\ninterface OwnProps {\n    date: string;\n    children: React.ReactNode;\n}\n\ntype UpdateListEntryProps = OwnProps;\n\nconst UpdateListEntry = (props: UpdateListEntryProps) => {\n\n    const dispatch = useDispatch();\n    const settingsLoaded = useSelector(makeUserSettingsLoadedSelector());\n    const viewed = useSelector(makeUserSettingSelector(keyUpdateViewed(props.date), false));\n\n    useEffect(\n        () => {\n            window.setTimeout(() => {\n                if (settingsLoaded && !viewed) {\n                    dispatch(upsertUserSetting(keyUpdateViewed(props.date), true));\n                }\n            }, 5000);\n        },\n        [viewed, settingsLoaded]\n    );\n\n    return (\n        <Grid.Row>\n            <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                <Message>\n                    <Label className={`${viewed ? 'black' : 'red'} top left attached`}>\n                        New Features released {moment(props.date).format('LL')}\n                    </Label>\n                    {props.children}\n                </Message>\n            </Grid.Column>\n        </Grid.Row>\n    );\n};\n\nexport default UpdateListEntry;\n","import * as React from 'react';\nimport {Container, Grid, MessageHeader} from \"semantic-ui-react\";\nimport UpdateListEntry from \"./UpdateListEntry\";\n\nexport const UpdateList = [\n  {\n    date: '2025-02-7',\n    content: <>\n      <MessageHeader>Side-by-Side View</MessageHeader>\n      <p>\n        A long requested feature was to quickly look up the metadata of an element while editing another element. This is now possible with the new \"Side-by-Side\" view.\n        There are various new ways to open this view:\n      </p>\n      <ul>\n        <li>Select two elements on the board and pick \"Side-by-Side\" from the context menu</li>\n        <li>Click on the new metadata icon in the context menu of the elements tree in the left sidebar</li>\n        <li>Press Ctrl/Cmd and click on a connection in the Metadata sidebar</li>\n        <li>Press Ctrl/Cmd and click on a schema reference in the schema editor</li>\n      </ul>\n      <p>\n        The last option listed above, is a new feature of its own. Schema references are not only suggested, but now also turn into clickable links, that let you look up the details of the reference.\n      </p>\n    </>\n  },\n  {\n    date: '2025-02-05',\n    content: <>\n      <MessageHeader>Reworked Lite Mode</MessageHeader>\n      <p>\n        Large Event Models are common. You usually want to have the full story on a board, right? However, working on large Event Models can get slow due to the amount of elements a browser\n        can handle at once. We realized, that the present Lite Mode is not enough for really large models, so we did a rework to tackle the issues. If you now turn the <a href=\"https://wiki.prooph-board.com/board_workspace/Lite-Mode.html\" target=\"_blank\">Lite Mode</a> on,\n        you have to double click on a frame to show its details, and press Ctrl/Cmd + double click to hide the details again. The behavior is inspired by navigating a folder structure.\n        The effect is, that as long as you organize your Event Model using frames the Lite Mode can hide many elements and reduce the work the browser has to do while navigating on the board.\n      </p>\n    </>\n  },\n  {\n    date: '2024-07-10',\n    content: <>\n      <MessageHeader>Cody goes Event Modeling first</MessageHeader>\n      <p>\n        The next major update has landed in prooph board. The whole Cody specific design and configuration as well as Cody Play is now focused on an Event Modeling first approach.\n        This means, that you can freely design your software using Event Modeling and in a second step make it work in Cody Play. No more design limitations to make Cody happy.\n        It can handle a whole new bunch of scenarios like information projections, pure command handlers, aggregateless events, and more. This update also marks the end of the Cody beta phase. We're going to work on the Cody Play tutorial and wiki next,\n        so that you get detailed instructions of how to develop prototypes and software with it. Stay tuned!\n      </p>\n    </>\n  },\n  {\n    date: '2024-05-19',\n    content: <>\n      <MessageHeader>Laser Focus on Event Modeling</MessageHeader>\n      <p>\n        Three months ago we started our journey to shift the primary focus of prooph board towards Event Modeling. The first update introduced Slices, which worked similar to Feature boxes, but had Swimlanes built-in. With this update, we are moving Swimlanes into a dedicated element (available in sidebar) and bring the feature boxes back. The Swimlanes element is similar to a Context box and is the container for an entire Event Model (or part of it). With the feature boxes back in the game, you can mark Vertical Slices of the Event Model.\n      </p>\n    </>\n  },\n  {\n    date: '2024-03-04',\n    content: <>\n      <MessageHeader>Draggable Tree View Elements</MessageHeader>\n      <p>\n        You can now drag elements from the Tree View in the left sidebar on the board. Dragged elements are copied so\n        you're not moving the original element. This is very useful when you want to reuse an element in another place.\n        Especially events and information cards are often reused across the board.\n      </p>\n    </>\n  },\n  {\n    date: '2024-02-25',\n    content: <>\n      <MessageHeader>Event Modeling Mode</MessageHeader>\n      <p>\n        prooph board supports <a href=\"https://eventmodeling.org/posts/what-is-event-modeling/\" target=\"_blank\">Event\n        Modeling</a> from day one, but with this new update we are shifting focus, and make Event Modeling the\n        recommended format on prooph board. For this, an Event Modeling Mode has been introduced. It's activated by\n        default for all new boards. You can activate the mode for an existing board in the board settings. In Event\n        Modeling mode feature frames become \"Slices\" with typical Event Modeling swim lanes. Cody suggestions are also\n        tuned to place cards in the correct lanes. Cody looks for slices and only provides suggestions for cards that\n        are in a Slice. The card types itself are the same and Cody Play and Cody Engine continue to work as before.\n        With the next updates we'll make a few more backwards compatible changes to further align with ideas from Event\n        Modeling. Tell us if you like or don't like the direction we are heading to! We hope, you'll jump on the Event\n        Modeling train and do the journey together with us!\n      </p>\n    </>\n  },\n  {\n    date: '2023-11-20',\n    content: <>\n      <MessageHeader>Playshots</MessageHeader>\n      <p>\n        So far, it was only possible to save Cody Play in the browser's local storage. With this update, Cody Play\n        snapshots (short Playshots) are saved on the server (only SaaS version). You can start Cody Play from a Playshot\n        listed in the new Cody Play dialog. The dialog can be accessed from the prooph board top menu.\n      </p>\n    </>\n  },\n  {\n    date: '2023-11-17',\n    content: <>\n      <MessageHeader>Collaborative Schema Design</MessageHeader>\n      <p>\n        When building software systems, data structures always play an important role. Cody reads the schema of a data\n        structure from the metadata of Information/Command/Event Cards. You can define the schema in the metadata\n        sidebar. That works good when working alone on an Event Map. In an Event Storming session it is better to use\n        Information Cards for all properties of a data structure. This way, it is easier to collaborate as a group. Now\n        you can combine both approaches. First brainstorm with Information Cards, then drag & drop them on Commands,\n        Events or other Information Cards to let Cody fill the schema from dropped Information Cards.\n      </p>\n    </>\n  },\n  {\n    date: '2023-11-16',\n    content: <>\n      <MessageHeader>Disable Cody Suggestions</MessageHeader>\n      <p>\n        Cody Suggestions are useful for Design-Level Event Storming. Cody helps you to prepare the Event Map for Cody\n        Play or Cody Engine. But it can get in your way on architecture or high-level boards. Therefor, we added an\n        option to deactivate Cody Suggestions. You can find the option in the board settings.\n      </p>\n    </>\n  },\n  {\n    date: '2023-10-06',\n    content: <>\n      <MessageHeader>Cody Play</MessageHeader>\n      <p>\n        We're striving for instant feedback-loops to avoid hand overs at all costs. To achieve that goal, a browser-only\n        version of Cody Engine is now available. You can use it for ultra rapid prototyping. No installation needed, no\n        servers, nothing that might get in the way between you and the feedback-loop. It's hosted on <a\n        href=\"https://play.prooph-board.com\" target=\"cody_play\">https://play.prooph-board.com</a>. prooph board can\n        connect to Cody Play by using <strong>/connect play</strong> in the Cody Console. However, the easiest way is to\n        run Cody from the Cody Wizard (modal or metadata sidebar). You'll find a new <strong>run on:</strong> dropdown\n        that let's you select the Cody environment. The default setting is <strong>auto</strong>, which means that Cody\n        Wizard first tries to connect to a locally running Cody Engine and if that fails switches to Cody Play.\n      </p>\n    </>\n  },\n  {\n    date: '2023-09-23',\n    content: <>\n      <MessageHeader>\n        improophed Cody Wizard (beta)\n      </MessageHeader>\n      <p>\n        We ran a couple of design sessions using the new Cody Wizard and while it is working great, we noticed one\n        drawback: the Cody Wizard forces you to leave the collaboration space and switch to a configuration-driven\n        workflow. That's not what we aim for. On prooph board it should be possible to design software together. Hence,\n        we redesigned the Cody Wizard, so that it integrates seamlessly into the collaboration workflow. You'll notice\n        that Cody appears on the collaboration space to suggest Cards. Cody also found a way into the toolbar. A click\n        will open the metadata sidebar, which has a new \"Cody\" tab. Everything you could do in the Cody Wizard is now\n        possible as a combination of Cody suggestions on the collaboration space + settings in the Cody tab.\n      </p>\n    </>\n  },\n  {\n    date: '2023-08-21',\n    content: <>\n      <MessageHeader>\n        Element Activity\n      </MessageHeader>\n      <p>\n        You might know the board activity sidebar, that you can open from the board top menu. It shows the history of\n        each action done on the board. While this is useful to get an overview of what happened, it's not that easy to\n        find actions related to a specific element. Who wrote that card and when? Now you can answer such questions with\n        the new \"Activity\" tab in the metadata sidebar. Select a card, open the sidebar from the top or context menu and\n        switch to the tab to get activity filtered by the selected card.\n      </p>\n    </>\n  },\n  {\n    date: '2023-07-16',\n    content: <>\n      <MessageHeader>\n        Cody wizard (beta)\n      </MessageHeader>\n      <p>\n        prooph board and Cody are a powerful combination for code assistance. With <a\n        href=\"https://github.com/proophboard/cody-engine\" target=\"_blank\">Cody Engine</a> we push the limits of Cody's\n        capabilities to a new level. Cody Engine is a ready-to-use, open source application stack to support\n        cross-functional teams in product development. And the new integrated \"Cody Wizard\" is the counterpart on prooph\n        board to boost Design-Level Event Storming and prepare everything for Cody to generate fully working application\n        source code. You can start the wizard by right clicking on a card on the board and selecting \"Cody Wizard\" from\n        the context menu. The wizard is available as a beta version at the moment. We're adding more features in the\n        next weeks and document everything.\n      </p>\n    </>\n  },\n  {\n    date: '2023-02-26',\n    content: <>\n      <MessageHeader>\n        Tagging\n      </MessageHeader>\n      <p>\n        Tagging cards and other elements is now possible by prefixing words with <strong>#</strong>. Tags are detected\n        automatically and added to the element. They can be used in the Tree-View search to filter elements and also\n        Cody can make use of them. More about tagging is documented in the <a\n        href=\"https://wiki.prooph-board.com/board_workspace/Cards.html#tagging\" target=\"_blank\">wiki</a>.\n      </p>\n    </>\n  },\n  {\n    date: '2022-07-27',\n    content: <>\n      <MessageHeader>\n        Anyone Permissions\n      </MessageHeader>\n      <p>\n        We've added a new permissions level that allows you to grant access to a board to all organization members or\n        even anyone with a valid prooph board account. More about all available permission levels is documented in\n        the <a href=\"https://wiki.prooph-board.com/access_management/Access-Rights.html\" target=\"_blank\">wiki</a>.\n      </p>\n    </>\n  },\n  {\n    date: '2022-04-04',\n    content: <>\n      <MessageHeader>\n        Sort & Filter Overview\n      </MessageHeader>\n      <p>\n        The board overview can now be sorted by name, created at and last modified date. You can change sort direction\n        by clicking on the sort icon. A team dropdown lets you quickly filter all boards of a team. Your sort and filter\n        settings are stored in the browser's local storage. Additionally, board search supports tags now. Add tags to\n        existing boards on the board edit page or in the advanced settings while adding a new board.\n      </p>\n    </>\n  },\n  {\n    date: '2022-01-31',\n    content: <>\n      <MessageHeader>\n        Rearranged Editing Toolbar\n      </MessageHeader>\n      <p>\n        <ul>\n          <li>Moved \"font color\" into main toolbar</li>\n          <li>Moved \"background color\" into main toolbar</li>\n          <li>Moved \"clear formatting\" into align menu</li>\n          <li>Removed formatting menu</li>\n          <li>Added a \"wiki link\" button</li>\n        </ul>\n      </p>\n    </>\n  },\n  {\n    date: '2021-11-20',\n    content: <>\n      <MessageHeader>\n        More Styling Options\n      </MessageHeader>\n      <p>\n        New styling options are available for advanced modelling and different workshop formats. The update includes:\n      </p>\n      <p>\n        <ul>\n          <li>Stickies\n            <ul>\n              <li>Change sticky type via context menu or shortcut (check context menu for available shortcuts)</li>\n              <li>Align a group of stickies vertically and horizontally (context menu + shortcuts)</li>\n            </ul>\n          </li>\n          <li>Contexts, Features, Textboxes\n            <ul>\n              <li>Change Style\n                <ul>\n                  <li>Ellipse</li>\n                  <li>Triangle</li>\n                  <li>Rhombus</li>\n                  <li>Hexagon</li>\n                </ul>\n              </li>\n            </ul>\n          </li>\n          <li>Arrows\n            <ul>\n              <li>Change Color</li>\n              <li>Dotted Style</li>\n              <li>Thickness</li>\n            </ul>\n          </li>\n          <li>Comic Style\n            <ul>\n              <li>Select a group of elements and turn \"Comic Style\" on or off in the context menu</li>\n            </ul>\n          </li>\n          <li>Keyboard Controls\n            <ul>\n              <li>Move selected element with arrow keys (keep key pressed for continued move + SHIFT key pressed for\n                even faster move)\n              </li>\n              <li>Resize selected element with CTRL/CMD + arrow keys (CTRL/CMD+SHIFT for bigger resize steps)</li>\n              <li>ALT+SHIFT + arrow keys: Copy selected element in direction of arrow key and connect it\n                <ul>\n                  <li>You can model a complete flow via keyboard in combination with switch sticky type shortcuts</li>\n                </ul>\n              </li>\n              <li>ENTER: Start text editing on selected sticky with</li>\n              <li>ESC: Finish text editing</li>\n              <li>CTRL/CMD+M: Start metadata editing</li>\n              <li>ESC: pressed in metadata editor finishes editing and focuses cell on board again</li>\n            </ul>\n          </li>\n        </ul>\n      </p>\n    </>\n  },\n  {\n    date: '2021-11-19',\n    content: <>\n      <MessageHeader>\n        Copy & Paste\n      </MessageHeader>\n      <p>\n        Copy & Pasting prooph board content is now possible across browsers. Next time you paste something, prooph board\n        will ask you for access to your system's clipboard. If you grant access, the feature gets activated. Please\n        note: this security check is built into modern browsers. By default, JavaScript is not allowed to access the\n        system clipboard without explicit permission.\n      </p>\n    </>\n  },\n  {\n    date: '2021-11-12',\n    content: <>\n      <MessageHeader>\n        Performance and Handling Updates\n      </MessageHeader>\n      <p>We sat down last week to benchmark and improve performance on lager prooph boards. We disabled a couple of fade\n        in/out animations in favor of performance and added a little physics effect when moving a board around. The\n        latter gives a more natural feeling to compensate the deactivated fade effects. The Lite Mode still gives you\n        best performance in case your system is under heavy load, but you should less likely have a need to activate\n        it.</p>\n    </>\n  },\n  {\n    date: '2021-11-02',\n    content: <>\n      <MessageHeader>\n        Synchronized Timer\n      </MessageHeader>\n      <p>You'll find a new timer feature in the board top menu (click on the hour glass icon). Setting a timer enables\n        it for all users on the current board. Everybody will see the time ticking and a red blinking timer, when the\n        set time is over. This is especially useful for time-boxed collaboration sessions. The person who sets the timer\n        has control over it (pause, stop, reset).</p>\n    </>\n  },\n  {\n    date: '2021-02-13',\n    content: <>\n      <MessageHeader>\n        Direct Import\n      </MessageHeader>\n      <p>A new import functionality allows you to prepare a link that opens prooph board and imports a board fetched\n        from an URL. This is especially useful for demo boards in combination with the new free version of prooph board.\n        For example you could upload a board export on Github and prepare a link to Free Version like this: <a\n          href=\"https://free.prooph-board.com/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fevent-engine%2Finspectio%2Fmaster%2Fassets%2FExample%2520Boards%2FThe%2520Picture.xml\">https://free.prooph-board.com/inspectio/boards/import/https%3A%2F%2Fraw.githubusercontent.com%2Fevent-engine%2Finspectio%2Fmaster%2Fassets%2FExample%2520Boards%2FThe%2520Picture.xml</a>\n      </p>\n    </>\n  },\n  {\n    date: '2021-01-18',\n    content: <>\n      <MessageHeader>\n        Organization\n      </MessageHeader>\n      <p>We've added a new administrative layer called \"Organization\" to make user and board management easier. With an\n        organization you can share your board and user quota with colleagues. They don't need to worry about\n        limitations, can easily create boards and share them with members. <a\n          href=\"https://wiki.prooph-board.com/access_management/Managing-an-Organization.html\" target=\"_blank\">Learn\n          about the details</a>.</p>\n    </>\n  }\n];\n\ninterface OwnProps {\n\n}\n\ntype UpdatePageProps = OwnProps;\n\nconst UpdatePage = (props: UpdatePageProps) => {\n  return (\n    <Container>\n      <Grid stackable={true} padded={true}>\n        {UpdateList.map((update, updateIndex) => (\n          <UpdateListEntry key={updateIndex} date={update.date}>\n            {update.content}\n          </UpdateListEntry>\n        ))}\n      </Grid>\n    </Container>\n  );\n};\n\nexport default UpdatePage;\n","import * as React from 'react';\nimport {NavLink, RouteComponentProps, withRouter} from \"react-router-dom\";\nimport * as Routes from \"../../routes\";\nimport {makeUserSettingsSelector} from \"../../User/selectors/userSettings\";\nimport {useSelector} from \"react-redux\";\nimport {UpdateList} from \"../../Updates/components/UpdatePage\";\n\n\ninterface OwnProps {\n\n}\n\ntype UpdatesProps = OwnProps & RouteComponentProps;\n\nconst Updates = (props: UpdatesProps) => {\n\n    const userSettings = useSelector(makeUserSettingsSelector());\n\n    const count = UpdateList\n        .map(update => update.date)\n        .filter(date => !userSettings[`update_${date}_viewed`])\n        .length;\n\n    return <NavLink className=\"item\" to={Routes.Updates}>\n        <div className={'ui small label' + (props.location.pathname === Routes.Updates? ' teal' : (count > 0? ' red' : ''))}>{count}</div>\n        Updates\n    </NavLink>\n};\n\nexport default withRouter(Updates);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Button, Grid, Message, Modal} from \"semantic-ui-react\";\n\ninterface OwnProps {\n\n}\n\ntype UpgradeProps = OwnProps & WithNamespaces;\n\nconst Upgrade = (props: UpgradeProps) => {\n\n    return <>\n        <div className=\"middle aligned item\">\n            <div className=\"ui big header\">Free Version</div>\n            <Grid className=\"stackable two column\">\n                <Grid.Column>\n                    <Button className=\"positive\" href=\"https://prooph-board.com#pricing\" target=\"_blank\">Upgrade</Button>\n                </Grid.Column>\n                <Grid.Column>\n                    <div className=\"sub header\">More Features, Organization & Teams, Realtime Collaboration</div>\n                </Grid.Column>\n            </Grid>\n        </div>\n    </>;\n};\n\nexport default withNamespaces()(Upgrade);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport AddBoard from \"../../../../Layout/Sidebar/AddBoard\";\nimport BoardList from \"../../../../Layout/Sidebar/BoardList\";\nimport BoardOverview from \"../../../../Layout/Sidebar/BoardOverview\";\nimport Feedback from \"../../../../Layout/Sidebar/Feedback\";\nimport ImportBoard from \"../../../../Layout/Sidebar/ImportBoard\";\nimport Logo from \"../../../../Layout/Sidebar/Logo\";\nimport Search from \"../../../../Layout/Sidebar/Search\";\nimport Updates from \"../../../../Layout/Sidebar/Updates\";\nimport Upgrade from \"../../../../Layout/Sidebar/Upgrade\";\nimport {makeGetCurrentBoardQuota} from \"../../../../User/selectors/currentUser\";\n\ninterface OwnProps {\n\n}\n\ntype OverviewSidebarProps = OwnProps & WithNamespaces;\n\nconst OverviewSidebar = (props: OverviewSidebarProps) => {\n    return <>\n        <Logo collapsed={false} />\n        <Upgrade />\n        <Search />\n        <ImportBoard />\n        <AddBoard />\n        <BoardOverview />\n        <BoardList />\n        <Updates />\n        <Feedback />\n    </>;\n};\n\nexport default withNamespaces()(OverviewSidebar);\n","import * as React from 'react';\nimport {Icon} from \"semantic-ui-react\";\nimport {NodeType} from \"../model/Graph\";\nimport CellIcon from \"./CellIcon\";\n\ninterface OwnProps {\n    type: NodeType;\n    open?: boolean;\n    className?: string;\n    title?: string;\n}\n\ntype LeafIconProps = OwnProps;\n\nconst LeafIcon = (props: LeafIconProps) => {\n    const open = !!props.open;\n\n    switch (props.type) {\n        case NodeType.layer:\n            const iconName = open ? 'folder open' : 'folder';\n            return <Icon name={iconName}  style={{cursor: 'pointer'}} className={props.className} title={props.title} />;\n        default:\n            return <CellIcon cellType={props.type} size=\"normal\" title={props.title} className={props.className} />;\n    }\n\n};\n\nexport default LeafIcon;\n","import * as React from 'react';\nimport {PropsWithChildren, useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {NavLink} from \"react-router-dom\";\nimport {Button, Icon, List, Menu, MenuItem, Popup} from \"semantic-ui-react\";\nimport EditableTextline from \"../../../core/components/EditableTextline\";\nimport {useGraph} from \"../../hooks/useGraph\";\nimport {BoardId} from \"../../model/Board\";\nimport {Node, NodeType} from \"../../model/Graph\";\nimport {\n    EDITABLE_LAYER_ADDITIONAL_CHAR_PADDING,\n    EDITABLE_LAYER_CHAR_SIZE_UNIT,\n    EDITABLE_LAYER_INPUT_CHAR_SIZE\n} from \"../BoardTreeView\";\nimport LeafIcon from \"../LeafIcon\";\nimport MaxLengthLabel from \"../MaxLengthLabel\";\n\ninterface OwnProps {\n    name: string;\n    boardId: BoardId;\n    expand: boolean;\n    deletable: boolean;\n    active: boolean;\n    layer: Node;\n    onLayerVisibilityChanged?: (visible: boolean) => void;\n    onActiveLayerChanged?: () => void;\n    copyToLayerSuccess?: boolean;\n}\n\ntype BoardLayerProps = PropsWithChildren<OwnProps> & WithNamespaces;\n\nconst btnWidth = 20;\nlet dblClickTimer: any = null;\n\nconst BoardLayer = (props: BoardLayerProps) => {\n    const [showChildren, setShowChildren] = useState(false);\n    const [showSettings, setShowSettings] = useState(false);\n    const [graph] = useGraph();\n    // Force component rerender after click to read changes from graph\n    const [clicks, setClicks] = useState(0);\n    const [copyToLayerSuccess, setCopyToLayerSuccess] = useState<boolean|null>(null);\n    const [nameEditMode, setNameEditMode] = useState(false);\n    const [layerDeleteMode, setLayerDeleteMode] = useState(false);\n    const dispatch = useDispatch();\n\n    const visible =  graph.isVisible(props.layer);\n    const locked = graph.isLocked(props.layer);\n\n    useEffect(() => {\n        setShowChildren(props.expand)\n    }, [props.expand]);\n\n\n    const handleLeafIconClick = (leafOpen: boolean, e: React.MouseEvent) => {\n        if(null !== dblClickTimer) {\n            window.clearTimeout(dblClickTimer);\n            dblClickTimer = null;\n            if(visible) {\n                graph.highlightLayer(props.layer);\n                setClicks(clicks + 1);\n            }\n            return;\n        }\n\n        dblClickTimer = window.setTimeout(() => {\n            if(!leafOpen && !graph.isActiveLayer(props.layer)) {\n                graph.setAsActiveLayer(props.layer);\n\n                if(props.onActiveLayerChanged) {\n                    props.onActiveLayerChanged();\n                }\n            }\n\n            if(leafOpen && !props.layer.isDefaultLayer()) {\n                graph.setDefaultLayerAsActive();\n                if(props.onActiveLayerChanged) {\n                    props.onActiveLayerChanged();\n                }\n            }\n\n            setShowChildren(!leafOpen);\n            if(showSettings) {\n                setShowSettings(false);\n            }\n            dblClickTimer = null;\n        }, 200);\n\n        e.preventDefault();\n    };\n\n    const handleItemContextMenu = (e: React.MouseEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n\n        setShowSettings(true);\n    }\n\n    const handleLockClick = () => {\n        graph.setLocked(props.layer, !graph.isLocked(props.layer));\n        setClicks(clicks + 1);\n    }\n\n    const handleVisibleClick = () => {\n        const willBeVisible = !graph.isVisible(props.layer);\n        graph.setUserVisible(props.layer, willBeVisible);\n        if(props.onLayerVisibilityChanged) {\n            props.onLayerVisibilityChanged(willBeVisible);\n        }\n        setClicks(clicks + 1);\n    }\n\n    const handleEditNameClick = () => {\n        setNameEditMode(true);\n    }\n\n    const handleCancelEditLayer = () => {\n        setNameEditMode(false);\n        setShowSettings(false);\n    }\n\n    const handleEditLayer = (newLayerName: string) => {\n        graph.changeNodeName(props.layer, newLayerName);\n        setNameEditMode(false);\n        setShowSettings(false);\n    }\n\n    const handleDeleteLayerClick = (e: React.MouseEvent) => {\n        setLayerDeleteMode(true);\n    }\n\n    const handleAbortDeleteLayer = () => {\n        setLayerDeleteMode(false);\n        setShowSettings(false);\n    }\n\n    const handleConfirmDeleteLayer = () => {\n        graph.deleteLayer(props.layer);\n        setLayerDeleteMode(false);\n    }\n\n    const visibleIcon = visible ? 'eye' : 'eye slash';\n    const lockIcon = locked? 'lock' : 'lock open';\n    const showCopySuccess = props.copyToLayerSuccess? props.copyToLayerSuccess : copyToLayerSuccess;\n\n    return <>\n        {!nameEditMode && <List.Item style={{padding: \"5px\", background: 'rgba(0,0,0,0.05)'}}\n                      as={ NavLink }\n                      to=\"#\"\n                      isActive={() => false}\n                      onClick={(e) => {handleLeafIconClick(showChildren, e)}}\n                      onContextMenu={handleItemContextMenu}\n                      className={visible? '' : 'hidden'}\n        >\n            <LeafIcon type={NodeType.layer}\n                      open={showChildren}\n                      title={props.t('insp.board.layers.folder_title') as string}\n                      className={(props.active? 'active-layer' : 'layer') + (showCopySuccess !== null? (showCopySuccess? ' copy-success' : ' copy-failed') : '')} />\n            {locked && <Icon name={lockIcon} className=\"corner left\" size=\"mini\" fitted={true}/>}\n            {!visible && <Icon name={visibleIcon} className=\"corner right\" size=\"mini\" fitted={true}/>}\n            <List.Content>\n                <Popup\n                    position='bottom center'\n                    closeOnTriggerBlur={false}\n                    closeOnTriggerMouseLeave={false}\n                    hideOnScroll={true}\n                    open={showSettings}\n                    onClose={() => setShowSettings(false)}\n                    style={{padding: \"0px\"}}\n                    trigger={\n                        <div>\n                            <MaxLengthLabel label={props.name} maxLength={50} />\n                        </div>\n                    }\n                    content={\n                        <>\n                        {!layerDeleteMode && <Menu secondary={true} compact={true}>\n                            <MenuItem\n                                title={props.t('insp.board.layers.edit_name') as string}\n                                onClick={e => {\n                                e.stopPropagation();\n                                handleEditNameClick();\n                            }}>\n                                <Icon name=\"edit\" />\n                            </MenuItem>\n                            <MenuItem\n                                title={props.t('insp.board.layers.lock_layer') as string}\n                                onClick={e => {\n                                e.stopPropagation();\n                                handleLockClick();\n                            }}>\n                               <Icon name={lockIcon} />\n                            </MenuItem>\n                            <MenuItem\n                                title={props.t('insp.board.layers.visibility') as string}\n                                onClick={e => {\n                                e.stopPropagation();\n                                handleVisibleClick();\n                            }}>\n                                <Icon name={visibleIcon} />\n                            </MenuItem>\n                            <MenuItem className=\"delete-ele\" onClick={e => {\n                                e.stopPropagation();\n                                handleDeleteLayerClick(e);\n                            }} title={props.t('insp.board.layers.delete_layer') as string} disabled={!props.deletable}>\n                                <Icon name=\"trash\" />\n                            </MenuItem>\n                        </Menu>}\n                        {layerDeleteMode && <Menu secondary={true} compact={true}>\n                            <MenuItem>\n                                {props.t('insp.board.layers.delete_confirmation')}\n                            </MenuItem>\n                            <MenuItem\n                                onClick={e => {\n                                    e.stopPropagation();\n                                    handleConfirmDeleteLayer();\n                                }}\n                            >\n                                {props.t('app.form.yes')}\n                            </MenuItem>\n                            <MenuItem\n                                onClick={e => {\n                                    e.stopPropagation();\n                                    handleAbortDeleteLayer();\n                                }}\n                            >\n                                {props.t('app.form.no')}\n                            </MenuItem>\n                        </Menu>}\n                        </>\n                    }\n                />\n                {showChildren && props.children}\n            </List.Content>\n        </List.Item>\n        }\n        {nameEditMode &&\n        <List.Item className=\"add-layer\">\n            <Button icon={true} basic={true} size=\"medium\">\n                <Icon name=\"folder outline\" />\n            </Button>\n            <EditableTextline\n                text={props.layer.getName()}\n                charSize={EDITABLE_LAYER_INPUT_CHAR_SIZE}\n                widthUnit={EDITABLE_LAYER_CHAR_SIZE_UNIT}\n                padding={EDITABLE_LAYER_ADDITIONAL_CHAR_PADDING}\n                minWidth={120}\n                required={true}\n                onTextChanged={handleEditLayer}\n                focus={true}\n                onCancel={handleCancelEditLayer}\n                placeholder={'Board'}\n            />\n        </List.Item>\n        }\n    </>;\n};\n\nexport default withNamespaces()(BoardLayer);\n","import * as React from 'react';\nimport {useEffect, useMemo, useRef, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {NavLink} from \"react-router-dom\";\nimport {Icon, List, Menu, MenuItem, Popup} from \"semantic-ui-react\";\nimport {setSideBySideCell} from \"../../../Layout/actions/commands\";\nimport * as Routes from \"../../../routes\";\nimport {toggleElementDetails} from \"../../actions/commands\";\nimport {useGraph} from \"../../hooks/useGraph\";\nimport {BoardId} from \"../../model/Board\";\nimport {Node, NodeType} from \"../../model/Graph\";\nimport {HistoryCellType} from \"../../model/HistoryEntry\";\nimport {isEventModel} from \"../../service/cody-wizard/context/feature-context\";\nimport {isValidLeaf} from \"../BoardTreeView\";\nimport LeafIcon from \"../LeafIcon\";\nimport MaxLengthLabel from \"../MaxLengthLabel\";\nimport BoardTree from \"./BoardTree\";\n\ninterface OwnProps {\n    element: Node;\n    boardId: BoardId;\n    expand: boolean;\n    isMetadataVisible: boolean;\n}\n\ntype BoardTreeLeafProps = OwnProps & WithNamespaces;\n\nlet dblClickTimer: any = null;\n\nconst BoardTreeLeaf = (props: BoardTreeLeafProps) => {\n\n    const dispatch = useDispatch();\n    const [clicks, setClicks] = useState(1);\n    const [showChildren, setShowChildren] = useState(false);\n    const [showSettings, setShowSettings] = useState(false);\n    const [deleteMode, setDeleteMode] = useState(false);\n    const [graph] = useGraph();\n    const labelRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        setShowChildren(props.expand)\n    }, [props.expand]);\n\n    useEffect(() => {\n        if(labelRef.current && !props.element.isLayer()) {\n            const div = labelRef.current;\n            const listItem = div.closest('.item');\n            if(listItem) {\n                const itemIcon = listItem.querySelector('i');\n                if(itemIcon) {\n                    graph.makeDraggable(itemIcon, props.element);\n                }\n            }\n\n            graph.makeDraggable(div, props.element);\n\n\n        }\n    }, [props.element.getId()]);\n\n    const locked = graph.isLocked(props.element);\n    const visible = graph.isVisible(props.element);\n    const visibleIcon = visible ? 'eye' : 'eye slash';\n    const lockIcon = locked ? 'lock' : 'lock open';\n\n    const handleItemClick = (e: React.MouseEvent) => {\n        e.stopPropagation();\n\n        if(null !== dblClickTimer) {\n            window.clearTimeout(dblClickTimer);\n            dblClickTimer = null;\n            setClicks(clicks + 1);\n            return;\n        }\n\n        dblClickTimer = window.setTimeout(() => {\n\n            setShowChildren(!showChildren);\n            if(showSettings) {\n                setShowSettings(false);\n            }\n            dblClickTimer = null;\n        }, 200);\n\n\n        if(visible && props.element.getType() !== NodeType.boundedContext && props.element.getType() !== NodeType.feature) {\n            setClicks(clicks + 1);\n        } else {\n            e.preventDefault();\n        }\n    };\n\n    const handleItemContextMenu = (e: React.MouseEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n        setShowSettings(true);\n    }\n\n    const handleSideBySideClick = (e: React.MouseEvent) => {\n        e.stopPropagation();\n        e.preventDefault();\n\n        if(props.isMetadataVisible) {\n            dispatch(setSideBySideCell(props.element.getId()));\n        } else {\n            graph.selectNode(props.element);\n            dispatch(toggleElementDetails(props.boardId, true, false));\n        }\n        setShowSettings(false);\n    }\n\n    const handleLockClick = () => {\n        graph.setLocked(props.element, !locked);\n        setClicks(clicks + 1);\n    }\n\n    const handleVisibleClick = () => {\n        graph.setUserVisible(props.element, !visible);\n        setClicks(clicks + 1);\n    }\n\n    const handleDeleteClick = () => {\n        setDeleteMode(true);\n    }\n\n    const handleAbortDelete = () => {\n        setDeleteMode(false);\n        setShowSettings(false);\n    }\n\n    const handleConfirmDelete = () => {\n        graph.deleteNode(props.element);\n        setDeleteMode(false);\n    }\n\n\n    const canHaveChildren = props.element.getType() === NodeType.boundedContext || props.element.getType() === NodeType.feature;\n    const validChildren = props.element.children().filter(isValidLeaf);\n    const hiddenClass = visible? '' : ' hidden';\n\n    const preventDrag = (e: DragEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    return <>\n        <List.Item as={ NavLink }\n                          to={{pathname: Routes.compileInspectioBoardWorkspace(props.boardId), search: `?cells=${props.element.getId()}&clicks=${clicks}`}}\n                          onClick={handleItemClick}\n                          onContextMenu={handleItemContextMenu}\n                          isActive={() => false}\n                          style={{padding: \"5px\"}}\n                          onDragStart={preventDrag}\n                          className={showSettings? 'edit' + hiddenClass : hiddenClass}\n        >\n            <LeafIcon type={isEventModel(props.element)? HistoryCellType.swimlanes : props.element.getType()} open={showChildren} />\n            {locked && <Icon name={lockIcon} className=\"corner left\" size=\"mini\" fitted={true}/>}\n            {!visible && <Icon name={visibleIcon} className=\"corner right\" size=\"mini\" fitted={true}/>}\n            <List.Content>\n                <Popup\n                    position='bottom center'\n                    closeOnTriggerBlur={false}\n                    closeOnTriggerMouseLeave={false}\n                    hideOnScroll={true}\n                    open={showSettings}\n                    onClose={() => setShowSettings(false)}\n                    trigger={<div ref={labelRef}><MaxLengthLabel label={props.element.getName()} maxLength={30} /></div>}\n                    style={{padding: \"0px\"}}\n                    content={\n                        <>\n                            {!deleteMode && <Menu secondary={true} compact={true}>\n                                <MenuItem onClick={e => {\n                                    handleSideBySideClick(e);\n                                }}>\n                                    <Icon name=\"clipboard outline\" />\n                                </MenuItem>\n                                <MenuItem\n                                    onClick={e => {\n                                        e.stopPropagation();\n                                        handleLockClick();\n                                    }}\n                                >\n                                    <Icon name={lockIcon}/>\n                                </MenuItem>\n                                <MenuItem\n                                    onClick={e => {\n                                        e.stopPropagation();\n                                        handleVisibleClick();\n                                    }}\n                                >\n                                    <Icon name={visibleIcon}/>\n                                </MenuItem>\n                                <MenuItem className=\"delete-ele\"\n                                    onClick={e => {\n                                        e.stopPropagation();\n                                        handleDeleteClick();\n                                    }}\n                                >\n                                    <Icon name=\"trash\"/>\n                                </MenuItem>\n                            </Menu>\n                            }\n                            {deleteMode && <Menu secondary={true} compact={true}>\n                                <MenuItem>\n                                    {props.t('insp.board.layers.delete_confirmation')}\n                                </MenuItem>\n                                <MenuItem\n                                    onClick={e => {\n                                        e.stopPropagation();\n                                        handleConfirmDelete();\n                                    }}\n                                >\n                                    {props.t('app.form.yes')}\n                                </MenuItem>\n                                <MenuItem\n                                    onClick={e => {\n                                        e.stopPropagation();\n                                        handleAbortDelete();\n                                    }}\n                                >\n                                    {props.t('app.form.no')}\n                                </MenuItem>\n                            </Menu>\n                            }\n                        </>\n                    }\n                />\n                {validChildren.count() > 0\n                    && showChildren\n                    && <BoardTree leafs={validChildren} boardId={props.boardId} expandLeafs={props.expand} isMetadataVisible={props.isMetadataVisible} />}\n                {validChildren.count() === 0\n                    && canHaveChildren\n                    && showChildren\n                && <List><List.Item><span style={{color: '#747474'}}>(empty)</span></List.Item></List>}\n            </List.Content>\n        </List.Item>\n    </>;\n};\n\nexport default withNamespaces()(BoardTreeLeaf);\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {List as SemanticList} from 'semantic-ui-react';\nimport {BoardId} from \"../../model/Board\";\nimport {Node, sortNodesByType} from \"../../model/Graph\";\nimport {isValidLeaf} from \"../BoardTreeView\";\nimport BoardTreeLeaf from \"./BoardTreeLeaf\";\nimport BoardLayer from \"./BoardLayer\";\n\ninterface OwnProps {\n    leafs: List<Node>;\n    boardId: BoardId;\n    expandLeafs: boolean;\n    isMetadataVisible: boolean;\n}\n\ntype BoardTreeProps = OwnProps;\n\nconst BoardTree = (props: BoardTreeProps) => {\n    const leafs = props.leafs.filter(isValidLeaf)\n        .sort(sortNodesByType)\n        .map(ele => <BoardTreeLeaf expand={props.expandLeafs} element={ele} key={ele.getId()} boardId={props.boardId} isMetadataVisible={props.isMetadataVisible} />);\n\n    return <SemanticList className=\"elements tree\">{ leafs }</SemanticList>;\n};\n\nexport default BoardTree;\n","import {List, Map} from \"immutable\";\nimport {useEffect, useMemo, useState} from 'react';\nimport * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Icon, List as SemanticList, Ref, Sticky, Transition} from \"semantic-ui-react\";\nimport EditableTextline from \"../../core/components/EditableTextline\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {BoardId, BoardName} from \"../model/Board\";\nimport {GraphPoint, makeNodeRecord, Node, NodeId, NodeLink, NodeName, NodeTag, NodeType, Size} from \"../model/Graph\";\nimport {makeBoardByIdSelector, makeGetBoard} from \"../selectors/board\";\nimport {makeElementsTreeByBoardIdSelector} from \"../selectors/elementsTree\";\nimport BoardLayer from \"./BoardTreeView/BoardLayer\";\nimport BoardTree from \"./BoardTreeView/BoardTree\";\nimport {fqcn} from \"../service/cody-wizard/node/fqcn\";\n\nexport const EDITABLE_LAYER_INPUT_CHAR_SIZE = 9;\nexport const EDITABLE_LAYER_CHAR_SIZE_UNIT = 'px';\nexport const EDITABLE_LAYER_ADDITIONAL_CHAR_PADDING = 0;\n\nexport const isValidLeaf = (ele: Node): boolean => {\n    switch (ele.getType()) {\n        case NodeType.misc:\n        case NodeType.edge:\n        case NodeType.textCard:\n            return false;\n        default:\n            if(ele.getName() === '') {\n                return false;\n            }\n            return true;\n    }\n};\n\ninterface OwnProps {\n\n}\n\ninterface RouteMatchParams {\n    uid: BoardId;\n}\n\ntype BoardTreeViewProps = OwnProps & RouteComponentProps<RouteMatchParams> & WithNamespaces;\n\n\nclass NoContextNode implements Node {\n    private childrenList: List<Node>;\n    private boardName: string;\n\n    constructor (children: List<Node>, boardName: BoardName) {\n        this.childrenList = children;\n        this.boardName = boardName;\n    }\n\n    public getId(): NodeId {\n        return '__NO_CONTEXT__';\n    }\n\n    public getName(): NodeName {\n        return this.boardName;\n    }\n\n    public getTechnicalName(): NodeName {\n        return this.getName();\n    }\n\n    public getFQCN(defaultService: string): NodeName {\n        return fqcn(this, false, false, true, defaultService);\n    }\n\n    public getTechnicalFQCN(defaultService: string): NodeName {\n        return fqcn(this, false, false, false, defaultService);\n    }\n\n    public changeName(name: NodeName): NoContextNode {\n        // do nothing\n        return this;\n    }\n\n    public getDescription(): NodeName {\n        return '';\n    }\n\n    public getType(): NodeType {\n        return NodeType.boundedContext;\n    }\n\n    public getLink(): NodeLink | null {\n        return null;\n    }\n\n    public getTags(): List<NodeTag> {\n        return List();\n    }\n\n    public isLayer(): boolean {\n        return false;\n    }\n\n    public isDefaultLayer(): boolean {\n        return false;\n    }\n\n    public getParent(): Node | null {\n        return null;\n    }\n\n    public changeParent(parent: Node | null): Node {\n        // Do nothing\n        return this;\n    }\n\n    public children(): List<Node> {\n        return this.childrenList;\n    }\n\n    public setChildren(children: List<Node>): Node {\n        this.childrenList = children;\n        return this;\n    }\n\n    public getSources(): List<Node> {\n        return List();\n    }\n\n    public getTargets(): List<Node> {\n        return List();\n    }\n\n    public getGeometry(): GraphPoint {\n        return {x: 0, y: 0};\n    }\n\n    public getSize(): Size {\n        return {width: 0, height: 0};\n    }\n\n    public getMetadata(): string | null {\n        return null;\n    }\n\n    public getParsedMetadata(): {[metaKey: string]: any} {\n        return {};\n    }\n\n    public changeMetadata(metadata: string): NoContextNode {\n        // do nothing\n        return this;\n    }\n\n    public isEnabled(): boolean {\n        return true;\n    }\n\n    public changeGeometry(geometry: GraphPoint): Node {\n        // do nothing\n        return this;\n    }\n\n    public changeSize(size: Size): Node {\n        // do nothing\n        return this;\n    }\n\n    public getVersion(): number {\n        return 1;\n    }\n}\n\nlet refreshTimer: number | null = null;\n\nconst BoardTreeView = (props: BoardTreeViewProps) => {\n    const boardId = props.match.params.uid;\n    const getElementsTreeSelector = useMemo(() => makeElementsTreeByBoardIdSelector(boardId), []);\n    const elementsTree = useSelector(getElementsTreeSelector);\n    const [layers, setLayers] = useState<List<Node>>(List([]));\n    const dispatch = useDispatch();\n    const [transitionVisible, setTransitionVisible] = useState(true);\n    const board = useSelector(makeBoardByIdSelector(boardId));\n    const [graph] = useGraph();\n    const [visibilityChanges, setVisibilityChanges] = useState(0);\n    const [activeLayerChanges, setActiveLayerChanges] = useState(0);\n    const [showNewLayerInput, setShowNewLayerInput] = useState(false);\n    const [copyIntoLayerPossible, setCopyIntoLayerPossible] = useState(false);\n    const [showCopyToLayerSuccess, setShowCopyToLayerSuccess] = useState<boolean | undefined>(undefined);\n\n    useEffect(() => {\n        graph.onSelectionChanged(hasSelection => setCopyIntoLayerPossible(hasSelection));\n    }, []);\n\n    useEffect(() => {\n        if(refreshTimer) {\n            clearTimeout(refreshTimer);\n            refreshTimer = null;\n        }\n\n        refreshTimer = window.setTimeout(() => {\n            requestAnimationFrame(() => {\n                setLayers(elementsTree.getFilteredElementsAsTree().sortBy(l => l.getName()))\n            })\n        }, elementsTree.isFiltered() ? 150 : 600)\n    }, [elementsTree]);\n\n    const handleApplyVisibilityGloballyClick = () => {\n        graph.applyVisibilityGlobally();\n        setVisibilityChanges(visibilityChanges + 1);\n    }\n\n    const handleAddLayerClick = () => {\n        setShowNewLayerInput(true);\n    }\n\n    const handleCancelAddLayer = () => {\n        setShowNewLayerInput(false);\n    }\n\n    const handleAddLayer = (layerName: string) => {\n        graph.addLayer(layerName);\n\n        setShowNewLayerInput(false);\n    }\n\n    const handleLayerVisibilityChanged = (layer: Node, visible: boolean): void => {\n        if(!visible && graph.isActiveLayer(layer)) {\n            let defaultLayerSetAsActive = false;\n\n            layers.forEach(l => {\n                if(l.isDefaultLayer() && graph.isVisible(l)) {\n                    defaultLayerSetAsActive = true;\n                    graph.setAsActiveLayer(l);\n                }\n            })\n\n            if(!defaultLayerSetAsActive) {\n                for (const l of layers.toArray()) {\n                    if(graph.isVisible(l)) {\n                        graph.setAsActiveLayer(l);\n                    }\n                }\n            }\n        }\n\n        setVisibilityChanges(visibilityChanges + 1);\n    }\n\n    const handleCopyToLayerClick = () => {\n        graph.copySelectionToActiveLayer();\n        setShowCopyToLayerSuccess(true);\n\n        window.setTimeout(() => {\n            setShowCopyToLayerSuccess(undefined);\n        }, 2000);\n    }\n\n    const layerComponents = useMemo(() => {\n        return layers.map(layer => <BoardLayer\n          key={layer.getId()}\n          name={layer.getName() === '' ? 'Board' : layer.getName()}\n          boardId={boardId}\n          layer={layer}\n          deletable={!layer.isDefaultLayer()}\n          active={graph.isActiveLayer(layer)}\n          onLayerVisibilityChanged={(visible: boolean) => handleLayerVisibilityChanged(layer, visible)}\n          onActiveLayerChanged={() => setActiveLayerChanges(activeLayerChanges + 1)}\n          copyToLayerSuccess={showCopyToLayerSuccess}\n          expand={(elementsTree.isFiltered() && layer.children().count() > 0) || layer.isDefaultLayer()}>\n            {layer.children().count() > 0\n              ? <BoardTree leafs={layer.children()} boardId={boardId} expandLeafs={elementsTree.isFiltered()} isMetadataVisible={!!board.shouldShowElementDetails} />\n              : <SemanticList><SemanticList.Item><span style={{color: '#747474'}}>(empty)</span></SemanticList.Item></SemanticList>\n            }\n        </BoardLayer>)\n    }, [layers]);\n\n    return <>\n        <div className=\"item\">\n            <SemanticList className=\"elements tree\">\n                <SemanticList.Item style={{paddingBottom: '0px'}}>\n                    <div className=\"context-menu\">\n                        <Button icon={true}\n                                basic={true}\n                                size=\"medium\"\n                                onClick={handleAddLayerClick}\n                                disabled={showNewLayerInput}\n                                title={props.t('insp.board.layers.add_layer')}\n                        >\n                            <Icon name=\"plus\" />\n                        </Button>\n                        <Button icon={true}\n                                basic={true}\n                                size={\"medium\"}\n                                disabled={!copyIntoLayerPossible}\n                                onClick={handleCopyToLayerClick}\n                                title={props.t('insp.board.layers.insert_selection')}\n                        >\n                            <Icon name=\"window restore outline\" />\n                        </Button>\n                        {/*User visibility is deactivated. For more info see MxGraphWrapper::setUserVisible */}\n                        {/*<Transition visible={visibilityChanges % 2 === 0} animation=\"pulse\" duration={1000}>\n                            <Button icon={true}\n                                    basic={true}\n                                    size=\"medium\"\n                                    floated=\"right\"\n                                    disabled={!graph.hasUserLevelVisibilityChanges()}\n                                    onClick={handleApplyVisibilityGloballyClick}\n                                    title={props.t('insp.board.layers.set_global_visibility')}\n                            >\n                                <Icon name=\"share square\"/>\n                            </Button>\n                        </Transition>*/}\n                    </div>\n                </SemanticList.Item>\n                {showNewLayerInput && <SemanticList.Item className=\"add-layer\">\n                    <Button icon={true} basic={true} size=\"medium\">\n                        <Icon name=\"folder outline\" />\n                    </Button>\n                    <EditableTextline\n                        text={''}\n                        charSize={EDITABLE_LAYER_INPUT_CHAR_SIZE}\n                        widthUnit={EDITABLE_LAYER_CHAR_SIZE_UNIT}\n                        padding={EDITABLE_LAYER_ADDITIONAL_CHAR_PADDING}\n                        minWidth={120}\n                        required={true}\n                        onTextChanged={handleAddLayer}\n                        focus={true}\n                        onCancel={handleCancelAddLayer}\n                        placeholder={'Layer name'}\n                    />\n                    </SemanticList.Item>\n                }\n                {layerComponents}\n            </SemanticList>\n        </div>\n    </>\n};\n\nexport default withNamespaces()(withRouter(BoardTreeView));\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Route} from \"react-router\";\nimport BoardTreeView from \"../../../../InspectioBoards/components/BoardTreeView\";\nimport Feedback from \"../../../../Layout/Sidebar/Feedback\";\nimport Logo from \"../../../../Layout/Sidebar/Logo\";\nimport Search from \"../../../../Layout/Sidebar/Search\";\nimport Upgrade from \"../../../../Layout/Sidebar/Upgrade\";\nimport * as Routes from \"../../../../routes\";\n\ninterface OwnProps {\n    collapsed: boolean;\n}\n\ntype WorkspaceSidebarProps = OwnProps & WithNamespaces;\n\nconst WorkspaceSidebar = (props: WorkspaceSidebarProps) => {\n    return <>\n        {!props.collapsed && <Logo collapsed={props.collapsed} />}\n        {!props.collapsed && <Upgrade />}\n        <div className=\"item\">\n            <div id=\"boardSidebarContainer\" />\n        </div>\n        {!props.collapsed && <>\n            <Search />\n            <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardTreeView} />\n            <Feedback/>\n        </>}\n    </>;\n};\n\nexport default withNamespaces()(WorkspaceSidebar);\n","import * as React from 'react';\nimport {useDispatch} from \"react-redux\";\nimport {Button} from \"semantic-ui-react\";\nimport {setSidebarWidth, toggleSidebarCollapsed} from \"../actions/commands\";\n\ninterface OwnProps {\n    collapsed: boolean;\n}\n\ntype CollapseToggleProps = OwnProps;\n\nconst CollapseToggle = (props: CollapseToggleProps) => {\n    const dispatch = useDispatch();\n    const handleClick = () => {\n        const newCollapsed = !props.collapsed;\n        dispatch(toggleSidebarCollapsed(newCollapsed));\n        dispatch(setSidebarWidth(newCollapsed? 85 : 250));\n    };\n\n    const iconClass = props.collapsed? 'angle double right icon' : 'angle double left icon';\n\n    return <span className=\"collaps-handle\" onClick={handleClick} style={\n        {}\n    }><i className={ iconClass } /></span>\n};\n\nexport default CollapseToggle;\n","import * as React from \"react\";\nimport {useState} from \"react\";\nimport {useRef} from \"react\";\nimport {ChangeEvent} from \"react\";\nimport {FormEvent} from \"react\";\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Input, Message, Modal, Transition} from \"semantic-ui-react\";\nimport * as uuid from 'uuid';\nimport * as Action from \"../../InspectioTeams/actions\";\nimport * as UserSelector from \"../../User/selectors/currentUser\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\n\ntype AddTeamProps = WithNamespaces & RouteComponentProps;\n\nconst AddTeam = (props: AddTeamProps) => {\n\n    const [visible, setVisible] = useState(false);\n    const [teamName, setTeamName] = useState('');\n    const [hasError, setHasError] = useState(false);\n\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n\n    const inputEl = useRef<Input>(null);\n    const dispatch = useDispatch();\n\n    const handleClick = () => {\n        setVisible(!visible);\n\n        if (!visible) {\n            window.setTimeout(() => {\n                inputEl.current!.focus();\n            }, 200);\n        }\n    };\n\n    const handleSubmit = (e: FormEvent) => {\n        e.preventDefault();\n\n        if (teamName === '') {\n            setHasError(true);\n            return;\n        }\n\n        dispatch(Action.Command.addTeam(uuid.v4(), teamName, activeOrganization? activeOrganization.uid : null));\n        setTeamName('');\n    };\n\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n        setTeamName(e.target.value);\n        setHasError(e.target.value === '');\n    };\n\n    return (\n        <div className=\"item\">            \n            <Button className=\"large basic\" onClick={handleClick}><i className=\"plus icon\" /> Add&nbsp;Team</Button>\n            <Transition animation=\"fade down\" visible={visible} duration={200} >\n                <div className=\"ui icon input\">\n                    <form onSubmit={handleSubmit}>\n                        <Input\n                            placeholder={props.t(\"insp.team.team_name\") + ' ...'}\n                            fluid={true}\n                            ref={inputEl}\n                            error={hasError}\n                            value={teamName}\n                            onChange={handleChange}\n                        />\n                    </form>\n                </div>\n            </Transition>\n        </div>\n    );\n};\n\nexport default withNamespaces()(withRouter(AddTeam));\n","import * as React from \"react\";\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Redirect, RouteComponentProps, withRouter} from \"react-router\";\nimport {NavHashLink} from \"react-router-hash-link\";\nimport {Confirm, Icon} from \"semantic-ui-react\";\nimport * as Action from \"../../InspectioTeams/actions\";\nimport InviteUserToTeamModal from \"../../InspectioTeams/components/InviteUserToTeamModal\";\nimport {Team} from \"../../InspectioTeams/model\";\nimport * as Route from \"../../routes\";\nimport {IioUserInfo} from \"../../User/model/IioUserInfo\";\nimport {makeIioFilteredUserListSelector, makeIioUserListSelector} from \"../../User/selectors/iioUserInfo\";\n\ninterface OwnProps {\n    team: Team.Team\n}\n\ntype TeamListItemProps = WithNamespaces & RouteComponentProps & OwnProps;\n\nconst TeamListItem = (props: TeamListItemProps) => {\n    const [visible, setVisible] = useState(false);\n    const [iconUp, setIconUp] = useState(false);\n    const [showAddUserModal, setShowAddUserModal] = useState<boolean>(false);\n    const [showRemoveMemberConfirm, setShowRemoveMemberConfirm] = useState<boolean>(false);\n    const [memberToRemove, setMemberToRemove] = useState<string|undefined>(undefined);\n\n    const users = useSelector(makeIioFilteredUserListSelector(props.team.members));\n    const dispatch = useDispatch();\n\n    const angleIcon = iconUp ? 'angle up icon' : 'angle down icon';\n    const contentClass = 'ui labels ' + (visible ? 'slidedown' : 'slideup');\n\n    const getUsernameByUserId = (userId: string) => {\n        const user = users.find((userInfo: IioUserInfo) => userInfo.userId === userId);\n        return user ? user.username : ''\n    };\n\n    const handleVisibleClick = () => {\n        setVisible(!visible);\n\n        if (iconUp) {\n            window.setTimeout(() => {\n                setIconUp(false);\n            }, 150);\n        } else {\n            setIconUp(true);\n        }\n    };\n\n    const openAddUserModal = (event: React.MouseEvent) => {\n        stopPropagation(event);\n        setShowAddUserModal(true);\n    };\n\n    const closeAddUserModal = () => {\n        setShowAddUserModal(false);\n    };\n\n    const stopPropagation = (event: React.MouseEvent) => {\n        event.stopPropagation();\n    };\n\n    const removeMemberFromTeam = () => {\n        if (!memberToRemove) {\n            return;\n        }\n\n        dispatch(Action.Command.removeMemberFromTeam(props.team.uid, memberToRemove));\n        setShowRemoveMemberConfirm(false);\n    };\n\n    const handleScrollToTeam = (el: HTMLHeadElement) => {\n        const headerOffset = 60;\n        const bodyRect = document.body.getBoundingClientRect().top;\n        const elementRect = el.getBoundingClientRect().top;\n        const elementPosition = elementRect - bodyRect;\n        const offsetPosition = elementPosition - headerOffset;\n        window.scrollTo({behavior: \"smooth\", top: offsetPosition})\n    }\n\n    return (\n        <div className=\"ui item\"  style={{cursor: \"pointer\"}}>\n            <Icon className={angleIcon} onClick={handleVisibleClick} />\n            <NavHashLink scroll={handleScrollToTeam} to={Route.teamOverview + '#' + props.team.uid} className=\"team-list team\">{props.team.name}</NavHashLink>\n            <Icon className=\"eye icon\" style={{visibility: \"hidden\"}}/>\n            <div className={contentClass}>\n                <a className=\"ui blue basic label\" onClick={openAddUserModal}>\n                    <i className=\"white plus icon\" />\n                    {props.t('insp.team.add_user')}\n                </a>\n                {props.team.members.filter(m => m !== props.team.ownerId).map(member => (\n                    <div key={member} className=\"ui basic label\">\n                        {getUsernameByUserId(member)}\n                        <i className=\"red delete icon\" onClick={(event: React.MouseEvent) => {\n                            stopPropagation(event);\n                            setMemberToRemove(member);\n                            setShowRemoveMemberConfirm(true);\n                        }} />\n                    </div>\n                ))}\n            </div>\n            <div onClick={stopPropagation}>\n                <InviteUserToTeamModal\n                    team={props.team}\n                    open={showAddUserModal}\n                    onClose={closeAddUserModal}\n                />\n                <Confirm\n                    open={showRemoveMemberConfirm}\n                    header={props.t('insp.team.remove_user_confirm_title')}\n                    content={props.t(\n                        'insp.team.remove_user_confirm_text',\n                        { user_name: memberToRemove ? getUsernameByUserId(memberToRemove) : '' }\n                    )}\n                    confirmButton={props.t('insp.team.remove_user_confirm_button')}\n                    onCancel={() => setShowRemoveMemberConfirm(false)}\n                    onConfirm={removeMemberFromTeam}\n                />\n            </div>\n        </div>\n    );\n};\n\nexport default withNamespaces()(withRouter(TeamListItem));\n","import * as React from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {makeTeamListSelector, teamListSelector} from \"../../InspectioTeams/selectors/selectTeam\";\nimport TeamListItem from \"./TeamListItem\";\n\ninterface TeamListProps {\n\n}\n\nconst TeamList = (props: TeamListProps) => {\n    const teamList = useSelector(makeTeamListSelector(true));\n\n    return (\n        <>\n            {teamList.sortBy(team => team.name).sortBy(team => !team.isNew).map(team => <TeamListItem key={team.uid} team={team} />)}\n        </>\n    );\n};\n\nexport default TeamList;\n","import * as React from 'react';\nimport {useSelector} from \"react-redux\";\nimport {NavLink, RouteComponentProps, withRouter} from \"react-router-dom\";\nimport {Icon} from \"semantic-ui-react\";\nimport {makeTeamListSelector} from \"../../InspectioTeams/selectors/selectTeam\";\nimport * as Routes from \"../../routes\";\n\ninterface OwnProps {\n\n}\n\ntype TeamOverviewProps = OwnProps & RouteComponentProps;\n\nconst TeamOverview = (props: TeamOverviewProps) => {\n    const teamList = useSelector(makeTeamListSelector(false));\n\n    let badgeClasses = \"ui small label\";\n\n    if(props.location.pathname === Routes.teamOverview) {\n        badgeClasses += \" teal\";\n    }\n\n    return (\n        <NavLink exact={true} className=\"item\" activeClassName=\"active\" to={Routes.teamOverview}>\n            <Icon className=\"ui group icon\"/>\n            <div className={badgeClasses}>{teamList.count()}</div>\n            Teams\n        </NavLink>\n    );\n};\n\nexport default withRouter(TeamOverview);\n","import * as React from 'react';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Dropdown, DropdownItem, DropdownMenu, Icon, Popup} from \"semantic-ui-react\";\nimport {OrganizationId} from \"../../Organization/model/Organization\";\nimport {makeUserOrganizationInfoListSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\nimport * as Action from \"../actions\";\nimport {makeGetCurrentUser} from \"../selectors/currentUser\";\nimport {useEffect, useState} from \"react\";\nimport {useOnBodyClick} from \"../../core/hooks/useOnBodyClick\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {keyUpdateViewed, makeUserSettingSelector, makeUserSettingsLoadedSelector} from \"../selectors/userSettings\";\nimport {upsertUserSetting} from \"../actions/commands\";\n\ninterface OwnProps {\n\n}\n\ntype SideMenuOrganizationSwitchProps = OwnProps & WithNamespaces;\n\nconst SideMenuOrganizationSwitch = (props: SideMenuOrganizationSwitchProps) => {\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organizations = useSelector(makeUserOrganizationInfoListSelector(currentUser.uid));\n    const [open, setOpen] = useState(false);\n    const [arrowClick, setArrowClick] = useState(false);\n    const [popupOpen, setPopupOpen] = useState(false);\n    const settingsLoaded = useSelector(makeUserSettingsLoadedSelector());\n    const showHint = useSelector(makeUserSettingSelector('show_orga_hint', false));\n\n    useOnBodyClick(() => {\n        setArrowClick(false);\n    })\n\n    useEffect(() => {\n        if(showHint) {\n            setPopupOpen(true);\n        }\n    }, [showHint, settingsLoaded])\n\n    const dispatch = useDispatch();\n\n    const handleOrganizationClick = (organizationId: OrganizationId | null) => {\n        dispatch(Action.Command.switchActiveOrganization(organizationId));\n        setOpen(false);\n    }\n\n    let activeOrgaName = 'My Workspace';\n\n    let hasImplicitOrganization = false;\n    let items = organizations.map(orga => {\n        if(orga.ownOrganization && !orga.explicitOrganization) {\n            hasImplicitOrganization = true;\n        }\n\n        const orgaName = orga.explicitOrganization? orga.organizationName : orga.ownOrganization? 'My Workspace' : orga.organizationName;\n\n        const isActive = currentUser.activeOrganization === orga.organizationId;\n\n        if(isActive) {\n            activeOrgaName = orgaName;\n        }\n\n        return <DropdownItem\n            active={isActive}\n            onClick={() => !isActive && handleOrganizationClick(orga.organizationId)}\n            key={orga.organizationId}>{orgaName}</DropdownItem>;\n    })\n\n    if(!hasImplicitOrganization) {\n        items = items.push(<DropdownItem\n            active={currentUser.activeOrganization === null}\n            onClick={() => currentUser.activeOrganization !== null && handleOrganizationClick(null)}\n            key=\"__implicit__own_orga__\"\n            >My Workspace</DropdownItem>)\n    }\n\n    const angleIcon = open ? 'angle up' : 'angle down';\n\n    const handleClick = (e: React.SyntheticEvent) => {\n        e.stopPropagation();\n        setOpen(!open);\n        setArrowClick(true);\n    }\n\n    const handleHintClick = () => {\n        setPopupOpen(false);\n        dispatch(upsertUserSetting('show_orga_hint', false));\n    }\n\n    return <Popup\n        open={popupOpen}\n        content={<>\n            <p><strong>{props.t('insp.organisation.switch_hint_header')}</strong></p>\n            <p>{props.t('insp.organisation.switch_hint')}</p>\n            <p><span style={{\"color\": \"#32c0e7\", \"cursor\": \"pointer\", float: \"right\"}} onClick={handleHintClick}>{props.t('insp.organisation.switch_hint_ok')}</span></p>\n        </>}\n        position=\"right center\"\n        trigger={ <div className=\"organization switch\"><Icon name={angleIcon} style={{cursor: \"pointer\"}} onClick={handleClick} /><Dropdown\n            icon={false}\n            open={open}\n            onOpen={() => setOpen(true)}\n            onClose={() => {if(!arrowClick) {\n                setOpen(false)\n            }}}\n            text={activeOrgaName}>\n            <DropdownMenu>\n                {items}\n            </DropdownMenu>\n        </Dropdown></div>\n        } />\n};\n\nexport default withNamespaces()(SideMenuOrganizationSwitch);\n","import * as React from 'react';\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {NavLink} from \"react-router-dom\";\nimport {Button, Dropdown} from \"semantic-ui-react\";\nimport * as Routes from \"../../routes\";\nimport SideMenuOrganizationSwitch from \"../../User/components/SideMenuOrganizationSwitch\";\nimport {useSelector} from \"react-redux\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\n\ninterface OwnProps {\n\n}\n\ntype OrganizationProps = OwnProps & RouteComponentProps;\n\nconst Organization = (props: OrganizationProps) => {\n    const currentUser = useSelector(makeGetCurrentUser());\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n\n    return <div className=\"item\">\n        {activeOrganization && activeOrganization.userIsAdmin && <NavLink to={Routes.organizationOverview}><Button className=\"large basic\"><i\n            className=\"building icon\"/> Organization</Button></NavLink>}\n        {(!activeOrganization || !activeOrganization.userIsAdmin) && <Button className=\"large basic organization\" disabled={true}>\n            <i className=\"building icon\"/> Organization\n        </Button>}\n        <SideMenuOrganizationSwitch />\n    </div>\n};\n\nexport default withRouter(Organization);\n","import * as React from 'react';\n\ninterface OwnProps {\n\n}\n\ntype CopyrightProps = OwnProps;\n\nconst Copyright = (props: CopyrightProps) => {\n    return <div className=\"bottom aligned item\">\n        <p className=\"copyright\">&copy; {(new Date()).getFullYear()} <a href=\"http://prooph-software.de\">prooph software GmbH</a></p>\n    </div>\n};\n\nexport default Copyright;\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Route} from \"react-router\";\nimport BoardTreeView from \"../../InspectioBoards/components/BoardTreeView\";\nimport * as Routes from \"../../routes\";\nimport {makeGetCurrentBoardQuota} from \"../../User/selectors/currentUser\";\nimport AddBoard from \"./AddBoard\";\nimport AddTeam from \"./AddTeam\";\nimport BoardList from \"./BoardList\";\nimport BoardOverview from \"./BoardOverview\";\nimport Feedback from \"./Feedback\";\nimport ImportBoard from \"./ImportBoard\";\nimport Logo from \"./Logo\";\nimport Search from \"./Search\";\nimport TeamList from \"./TeamList\";\nimport TeamOverview from \"./TeamOverview\";\nimport Updates from \"./Updates\";\nimport Upgrade from \"./Upgrade\";\nimport Organization from \"./Organization\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../../Organization/selectors/selectUserOrganizationInfo\";\n\ninterface OwnProps {\n\n}\n\ntype OverviewSidebarProps = OwnProps & WithNamespaces;\n\nconst OverviewSidebar = (props: OverviewSidebarProps) => {\n\n    const boardQuota: number = useSelector(makeGetCurrentBoardQuota());\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n\n    return <>\n        <Logo collapsed={false} />\n        <Organization />\n        <Search />\n        <ImportBoard />\n        <AddBoard />\n        <BoardOverview />\n        <BoardList />\n        {boardQuota < 2 && activeOrganization && activeOrganization.explicitOrganization && !activeOrganization.userIsGuest && (\n            <div className=\"item\">\n                <div className=\"ui icon negative message\">\n                    <i className=\"warning icon\" />\n                    <div className=\"content\">\n                        <div className=\"header\">\n                            {boardQuota === 0\n                                ? props.t('insp.sidebar.no_boards_left_warning')\n                                : props.t('insp.sidebar.boards_left_warning', { board_count: boardQuota })\n                            }\n                        </div>\n                        <p>{props.t('insp.sidebar.boards_left_warning_upgrade')}</p>\n                    </div>\n                </div>\n            </div>\n        )}\n        <AddTeam />\n        <TeamOverview />\n        <TeamList />\n        <Updates />\n        <Feedback/>\n    </>;\n};\n\nexport default withNamespaces()(OverviewSidebar);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Route} from \"react-router\";\nimport BoardTreeView from \"../../InspectioBoards/components/BoardTreeView\";\nimport * as Routes from \"../../routes\";\nimport Feedback from \"./Feedback\";\nimport Logo from \"./Logo\";\nimport Organization from \"./Organization\";\nimport Search from \"./Search\";\n\ninterface OwnProps {\n    collapsed: boolean;\n}\n\ntype WorkspaceSidebarProps = OwnProps & WithNamespaces;\n\nconst WorkspaceSidebar = (props: WorkspaceSidebarProps) => {\n    return <>\n        {!props.collapsed && <Logo collapsed={props.collapsed} />}\n        {!props.collapsed && <Organization />}\n        <div className=\"item\">\n            <div id=\"boardSidebarContainer\" />\n        </div>\n        {!props.collapsed && <>\n            <Search />\n            <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardTreeView} />\n            <Feedback/>\n        </>}\n    </>;\n};\n\nexport default withNamespaces()(WorkspaceSidebar);\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport Draggable, {DraggableData, DraggableEvent} from 'react-draggable';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport * as Routes from \"../routes\";\nimport StandaloneOverviewSidebar from \"../standalone/components/Layout/Sidebar/OverviewSidebar\"\nimport StandaloneWorkspaceSidebar from \"../standalone/components/Layout/Sidebar/WorkspaceSidebar\"\nimport {isStandalone} from \"../standalone/util\";\nimport {setSidebarWidth, toggleSidebarCollapsed} from \"./actions/commands\";\nimport {makeGetSidebarSelector} from \"./selectors/sidebar\";\nimport CollapseToggle from \"./Sidebar/CollapseToggle\";\nimport OverviewSidebar from \"./Sidebar/OverviewSidebar\";\nimport WorkspaceSidebar from \"./Sidebar/WorkspaceSidebar\";\nimport Copyright from \"./Sidebar/Copyright\";\n\ntype SidebarProps =  WithNamespaces & RouteComponentProps;\n\nconst Sidebar = (props: SidebarProps) => {\n    const isBoardWorkspace = Routes.isInspectioBoardWorkspace(props.location.pathname);\n    const state = useSelector(makeGetSidebarSelector());\n    const dispatch = useDispatch();\n    const [collabsableLeft, setCollabsableLeft] = useState(state.width);\n    const [isDragging, setIsDragging] = useState(false);\n\n    useEffect(() => {\n        const isMobile = window.matchMedia('(max-width: 900px)');\n\n        const checkMobile = (matches: boolean) => {\n            if(matches && isBoardWorkspace) {\n                dispatch(setSidebarWidth(90));\n                setCollabsableLeft(90);\n                dispatch(toggleSidebarCollapsed(true));\n            }\n        }\n\n        const listener = (e: MediaQueryListEvent) => {\n            checkMobile(e.matches);\n        }\n\n        isMobile.addEventListener(\"change\", listener);\n\n        checkMobile(isMobile.matches);\n\n        return () => {\n            isMobile.removeEventListener(\"change\", listener);\n        }\n    }, [isBoardWorkspace]);\n\n    useEffect(() => {\n        if(!isDragging) {\n            setCollabsableLeft(state.width);\n        }\n    }, [state.width]);\n\n    const collapsible = isBoardWorkspace ? \" collapsible\" : \"\";\n    const collapsed = (isBoardWorkspace && state.collapsed)? \" collapsed\" : \"\";\n    const touchOnlyPan = (isBoardWorkspace)? \" touch-only-pan\" : \"\";\n\n    const handleDragging = (e: DraggableEvent, data: DraggableData) => {\n        if(!isDragging) {\n            setIsDragging(true);\n        }\n\n        const newWidth = state.width + data.deltaX;\n\n        dispatch(setSidebarWidth(newWidth));\n\n        if(state.width <= 230 && !state.collapsed) {\n            dispatch(toggleSidebarCollapsed(true));\n        }\n\n        if(state.width > 230 && state.collapsed) {\n            dispatch(toggleSidebarCollapsed(false));\n        }\n    }\n\n    const handleDragStop = (e: DraggableEvent, data: DraggableData) => {\n        setIsDragging(false);\n        setCollabsableLeft(state.width);\n    }\n\n    return (\n        <>\n            <div className={\"ui left fixed large vertical menu leftbar\"+collapsed+touchOnlyPan} style={{overflowY:\"scroll\", width: (isBoardWorkspace? state.width : 250) + \"px\"}}>\n                {!isBoardWorkspace && !isStandalone() && <OverviewSidebar />}\n                {!isBoardWorkspace && isStandalone() && <StandaloneOverviewSidebar />}\n                {isBoardWorkspace && !isStandalone() && <WorkspaceSidebar collapsed={state.collapsed} />}\n                {isBoardWorkspace && isStandalone() && <StandaloneWorkspaceSidebar collapsed={state.collapsed} />}\n                <Copyright />\n            </div>\n            <Draggable\n                axis={isBoardWorkspace? \"x\" : \"none\"}\n                onDrag={handleDragging}\n                onStop={handleDragStop}\n                position={{x: 0, y: 0}}\n            >\n                <div className={\"collapsebar\"+collapsible+collapsed}\n                     style={{\n                         left: (isBoardWorkspace? collabsableLeft : 250) + 'px',\n                         cursor: (isBoardWorkspace? 'grabbing' : 'inherit')\n                     }}\n                >{isBoardWorkspace && <CollapseToggle collapsed={state.collapsed} />}</div>\n            </Draggable>\n        </>\n    );\n};\n\nexport default withNamespaces()(withRouter(Sidebar));\n","import {Map} from \"immutable\";\nimport {Reducer} from 'redux';\nimport {\n    ACTIVE_GRAPH_ELEMENT_CHANGED,\n    ACTIVE_GRAPH_ELEMENT_LABEL_CHANGED,\n    ACTIVE_GRAPH_ELEMENT_METADATA_CHANGED,\n} from '../actions/constants';\nimport {makeNodeFromJs, Node, NodeId, NodeType} from \"../model/Graph\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface EdgeData {\n    source: NodeId,\n    target: NodeId,\n}\n\nexport const makeNodeFromActiveGraphElement = (element: ActiveGraphElement): Node => {\n    return makeNodeFromJs({\n        id: element.id,\n        type: element.type as NodeType,\n        name: element.label,\n        metadata: element.metadata,\n        tags: element.tags,\n    })\n}\n\nexport interface ActiveGraphElement {\n    id: string,\n    type: string,\n    label: string,\n    metadata?: string,\n    edgeData?: EdgeData,\n    tags?: string[];\n    updateMetadata: (schema: string, force?: boolean) => void;\n    updateSimilarElements: (elementIds: string[], schema: string) => void;\n    replaceTags: (tags: string[]) => void;\n    locked?: boolean;\n}\n\nexport interface ActiveGraphElementState extends Map<string, ActiveGraphElement | undefined> {\n}\n\nexport const initialState: ActiveGraphElementState = Map<string, ActiveGraphElement>();\n\nconst reducer: Reducer<ActiveGraphElementState, InspectioBoardsAction> = (state: ActiveGraphElementState = initialState, action: InspectioBoardsAction): ActiveGraphElementState => {\n    switch (action.type) {\n        case ACTIVE_GRAPH_ELEMENT_CHANGED:\n            if(!action.payload.element) {\n                return state.set(action.payload.boardId, undefined);\n            }\n\n            return state.set(action.payload.boardId, {\n                id: action.payload.element.id,\n                type: action.payload.element.type,\n                label: action.payload.element.label,\n                metadata: action.payload.element.metadata || undefined,\n                edgeData: action.payload.element.edgeData || undefined,\n                tags: action.payload.element.tags || [],\n                updateMetadata: action.payload.element.updateMetadata,\n                updateSimilarElements: action.payload.element.updateSimilarElements,\n                replaceTags: action.payload.element.replaceTags,\n                locked: !!action.payload.element.locked,\n            });\n        case ACTIVE_GRAPH_ELEMENT_LABEL_CHANGED:\n            if(state.getIn([action.payload.boardId, 'id']) !== action.payload.elementId) {\n                return state;\n            }\n\n            return state.setIn([action.payload.boardId, 'label'], action.payload.label);\n        case ACTIVE_GRAPH_ELEMENT_METADATA_CHANGED:\n            if(state.getIn([action.payload.boardId, 'id']) !== action.payload.elementId) {\n                return state;\n            }\n\n            return state.setIn([action.payload.boardId, 'metadata'], action.payload.metadata);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveActiveGraphElementReducer };\n","import {List, Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\nimport {createSelector} from \"reselect\";\nimport {MODULE} from \"../index\";\nimport {BoardId} from \"../model/Board\";\nimport {ActiveGraphElement} from \"../reducers/applyActiveGraphElementActions\";\n\nexport const activeGraphElementsSelector = (state: Record<ApplicationState>, props: any): Map<string, ActiveGraphElement> =>\n    state.getIn([MODULE, 'activeGraphElements']);\n\nexport const makeActiveGraphElementSelector = (boardId: BoardId): (state: Record<ApplicationState>, props?: any) => ActiveGraphElement|null => {\n    return createSelector(\n        [activeGraphElementsSelector],\n        (activeGraphElements): ActiveGraphElement|null =>  {\n            return activeGraphElements.has(boardId) ? activeGraphElements.get(boardId)! : null;\n        }\n    )\n};\n","import * as React from 'react';\nimport {Button, Modal} from \"semantic-ui-react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\n\ninterface OwnProps {\n    open: boolean;\n    onClose: () => void;\n    headerKey: 'header_team' | 'header_history'\n}\n\ntype CollaborationInfoModalProps = OwnProps & WithNamespaces;\n\nconst CollaborationInfoModal = (props: CollaborationInfoModalProps) => {\n    return (\n        <Modal open={props.open} closeIcon={false} onClose={props.onClose} size=\"tiny\">\n            <Modal.Header>{props.t('insp.collaboration_modal.'+props.headerKey)}</Modal.Header>\n            <Modal.Content>\n                <p>{props.t('insp.collaboration_modal.text')}</p>\n            </Modal.Content>\n            <Modal.Actions>\n                <Button className=\"positive\" href=\"https://prooph-board.com#pricing\" target=\"_blank\">\n                    Upgrade\n                </Button>\n            </Modal.Actions>\n        </Modal>\n    );\n};\n\nexport default withNamespaces()(CollaborationInfoModal);\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {Button, Divider, Icon, List as SemanticList, Popup} from \"semantic-ui-react\";\nimport * as Routes from \"../../../routes\";\nimport {BoardId} from \"../../model/Board\";\nimport {Node, NodeType} from \"../../model/Graph\";\nimport CellIcon from \"../CellIcon\";\nimport {Link} from \"react-router-dom\";\nimport {useState} from \"react\";\nimport {RANGE_ELEMENT_CONNECTIONS} from \"../MxGraphBoard/clickRange\";\nimport MaxLengthLabel from \"../MaxLengthLabel\";\nimport {useDispatch} from \"react-redux\";\nimport {setSideBySideCell} from \"../../../Layout/actions/commands\";\n\ninterface OwnProps {\n    boardId: BoardId,\n    sources: List<Node>,\n    targets: List<Node>,\n}\n\ntype ElementConnectionsProps = OwnProps & WithNamespaces;\n\nconst ElementConnections = (props: ElementConnectionsProps) => {\n    const dispatch = useDispatch();\n    const [clicks, setClicks] = useState(RANGE_ELEMENT_CONNECTIONS);\n    const [showMore, setShowMore] = useState(false);\n    const [showConnections, setShowConnections] = useState(true);\n\n    const numOfSources = props.sources.count();\n    const numOfTargets = props.targets.count();\n    const total = numOfSources + numOfTargets;\n\n    let visibleSources = props.sources.filter(s => !(s.getType() === NodeType.icon && s.getName() === ''));\n    let visibleTargets = props.targets.filter(t => !(t.getType() === NodeType.icon && t.getName() === ''));\n\n    if(total > 4 && !showMore) {\n        if(numOfSources > 4 && numOfTargets < 2) {\n            visibleSources = visibleSources.take(4 - numOfTargets);\n        } else if(numOfTargets > 4 && numOfSources < 2) {\n            visibleTargets = visibleTargets.take(4 - numOfSources);\n        } else {\n            visibleSources = visibleSources.take(2);\n            visibleTargets = visibleTargets.take(2);\n        }\n    }\n\n    const handleClick = () => {\n        setShowMore(!showMore);\n    }\n\n    const handleConnectionClick = (e: React.MouseEvent, node: Node) => {\n        if(e.ctrlKey) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            dispatch(setSideBySideCell(node.getId()));\n            return;\n        }\n\n        setClicks(clicks + 1);\n    }\n\n    const links = visibleSources.map(source => {\n        return <SemanticList.Item key={source.getId()}\n                                  style={{borderRadius:'0', color:'#424242'}}\n                                  title=\"Source\"\n                                  as={ Link }\n                                  to={{pathname: Routes.compileInspectioBoardWorkspace(props.boardId), search: `?cells=${source.getId()}&select=1&clicks=${clicks}`}}\n                                  onClick={e => handleConnectionClick(e, source)}  >\n            <SemanticList.Icon name=\"arrow left\" />\n            <SemanticList.Content><CellIcon cellType={source.getType()} /><MaxLengthLabel label={source.getName()} maxLength={30} /></SemanticList.Content>\n        </SemanticList.Item>;\n    }).toArray();\n\n    visibleTargets.forEach(target => {\n        links.push(<SemanticList.Item key={target.getId()}\n                                      style={{borderRadius:'0', color:'#424242'}}\n                                      title=\"Target\"\n                                      as={ Link }\n                                      to={{pathname: Routes.compileInspectioBoardWorkspace(props.boardId), search: `?cells=${target.getId()}&select=1&clicks=${clicks}`}}\n                                      onClick={e => handleConnectionClick(e, target)}  >\n            <SemanticList.Icon name=\"arrow right\" />\n            <SemanticList.Content><CellIcon cellType={target.getType()} /><MaxLengthLabel label={target.getName()} maxLength={30} /></SemanticList.Content>\n        </SemanticList.Item>);\n    })\n\n    return <>\n        <Divider horizontal={true} onClick={() => setShowConnections(!showConnections)}\n                 style={showConnections ? {cursor: 'pointer'} : {textDecoration: 'line-through', cursor: 'pointer'}}\n        >Connections&nbsp;&nbsp;<Popup trigger={<Icon name=\"question circle outline\" />}\n            >\n                <p>{props.t('insp.cody_wizard.connections.help1')}</p>\n                <p>{props.t('insp.cody_wizard.connections.help2')}</p>\n                <p>{props.t('insp.cody_wizard.connections.help3')}</p>\n                <p>{props.t('insp.cody_wizard.connections.help4')}</p>\n                <p>{props.t('insp.cody_wizard.connections.help5')}</p>\n            </Popup></Divider>\n        {showConnections && <>\n            <SemanticList>\n                {links}\n            </SemanticList>\n            {total > 4 && <Button basic={true}\n                                  compact={true}\n                                  icon={'arrow alternate circle ' + (showMore ? 'up' : 'down')}\n                                  className=\"noborder\"\n                                  content={showMore ? props.t('app.showLess') : props.t('app.showAll')}\n                                  style={{textAlign: 'left', paddingLeft: '30px'}}\n                                  onClick={handleClick}\n            />  }\n        </>}\n    </>;\n};\n\nexport default withNamespaces()(ElementConnections);\n","export const RANGE_ELEMENT_CONNECTIONS = 5000;\nexport const RANGE_BOARD_ELEMENT_DETAILS = 6000;\n","import * as React from 'react';\nimport {FormEvent, useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useElementsTree} from \"../../../hooks/useElementsTree\";\nimport {useGraph} from \"../../../hooks/useGraph\";\nimport {Node} from \"../../../model/Graph\";\nimport {ImmutablePolicyContext } from \"../../../service/cody-wizard/context/policy-context\";\nimport {\n  EventMetadata,\n  getEventMetadata\n} from \"../../../service/cody-wizard/event/get-event-metadata\";\nimport {Schema} from \"../../../service/cody-wizard/schema/schema\";\nimport {ValueObjectMetadata} from \"../../../service/cody-wizard/vo/get-vo-metadata\";\nimport {cloneDeepJSON, stringify} from \"../../../service/json/json-comment-wrapper\";\nimport SchemaEditorDivider from \"../Editor/Divider/SchemaEditorDivider\";\nimport SchemaEditor from \"../Editor/SchemaEditor\";\nimport {WithWizardStepProps} from \"../WizardModal\";\n\ninterface OwnProps {\n\n}\n\ntype PolicyEventProps = OwnProps & WithWizardStepProps<ImmutablePolicyContext> & WithNamespaces;\n\nconst PolicyEvent = (props: PolicyEventProps) => {\n  const event = props.ctx.event;\n  const version = event ? event.getVersion() : 0;\n\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.ctx.board.uid);\n  const [selectedEvent, setSelectedEvent] = useState<Node|null>(null);\n  const [metadata, setMetadata] = useState<EventMetadata>({});\n  const [autoFocusSchema, setAutoFocusSchema] = useState(false);\n\n  const updateMetadata = (meta: ValueObjectMetadata) => {\n    if(props.onUpdateMetadata) {\n      props.onUpdateMetadata(stringify(meta, null, 2), true);\n    }\n\n    setMetadata(meta);\n  }\n\n  useEffect(() => {\n    resetForm();\n\n    if(event) {\n      setSelectedEvent(event);\n      const meta = getEventMetadata(event);\n\n      setMetadata(meta);\n    }\n\n  }, [event, version])\n\n  const resetForm = () => {\n    setSelectedEvent(null);\n    setMetadata({});\n    setAutoFocusSchema(false);\n  }\n\n  const handleSubmit = (evt: FormEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  const handleSchemaChanged = (newSchema: Schema | undefined) => {\n    if(!newSchema) {\n      const clonedMeta = cloneDeepJSON(metadata);\n      delete clonedMeta.schema;\n      updateMetadata(clonedMeta);\n      return;\n    }\n\n    updateMetadata({...metadata, schema: newSchema});\n  }\n\n  return <form className='ui form' onSubmit={handleSubmit}>\n    <SchemaEditorDivider content={<>\n      <SchemaEditor boardId={props.ctx.board.uid}\n                    sessionId={selectedEvent ? selectedEvent.getId() : undefined }\n                    schema={metadata.schema || Schema.fromString('{}')}\n                    readonly={!!(selectedEvent && !selectedEvent.isEnabled())}\n                    onSchemaChanged={handleSchemaChanged}\n                    autofocus={autoFocusSchema}\n      />\n    </>} />\n\n  </form>\n};\n\nexport default withNamespaces()(PolicyEvent);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {Card, Icon} from \"semantic-ui-react\";\nimport {Node, NodeType} from \"../../../model/Graph\";\nimport {dddActionFromNode} from \"../../../service/cody-wizard/context/ddd-action\";\nimport {policyContextFromNode} from \"../../../service/cody-wizard/context/policy-context\";\nimport {WizardContext, WizardContextType} from \"../../../service/cody-wizard/context/wizard-context\";\nimport CellIcon from \"../../CellIcon\";\nimport {WithWizardStepProps} from \"../WizardModal\";\n\ninterface OwnProps {\n  contexts: WizardContextType[];\n  node: Node\n}\n\ntype SelectContextProps = OwnProps & WithWizardStepProps<WizardContext> & WithNamespaces;\n\ninterface ContextDescription {\n  header: string;\n  meta: string;\n  description: string;\n  type: WizardContextType;\n  nodeType: NodeType;\n  extra?: React.ReactElement\n}\n\nconst SelectContext = (props: SelectContextProps) => {\n\n  const handleContextSelected = (ctxType: WizardContextType) => {\n    switch (ctxType) {\n      case \"dddAction\":\n        props.onCtxChanged(dddActionFromNode(props.node, props.ctx.board));\n        break;\n      case \"policy\":\n        props.onCtxChanged(policyContextFromNode(props.node, props.ctx.board));\n        break;\n      default:\n        throw new Error(`Cannot switch context to type ${ctxType}. This seems to be a developer bug. Please contact the prooph board team!`);\n    }\n  }\n\n  const contexts = makeContextDescriptions(props.node, props.contexts, props.t)\n    .map(c => <Card link={true} key={c.type} onClick={() => handleContextSelected(c.type)} style={{minWidth: '300px'}}>\n      <Card.Content>\n        <div style={{float: \"right\"}}><CellIcon cellType={c.nodeType} size=\"big\" /></div>\n        <Card.Header>{c.header}</Card.Header>\n        <Card.Meta>{c.meta}</Card.Meta>\n        <Card.Description>{c.description}</Card.Description>\n      </Card.Content>\n      {c.extra && <Card.Content extra={true}>{c.extra}</Card.Content>}\n    </Card>)\n\n  return <Card.Group itemsPerRow={3} stackable={true}>\n    {contexts}\n  </Card.Group>\n};\n\nexport default withNamespaces()(SelectContext);\n\nconst makeContextDescriptions = (node: Node, contexts: WizardContextType[], t: (key: string) => string): ContextDescription[] => {\n  const descriptions: ContextDescription[] = [];\n\n  contexts.forEach(cType => {\n    descriptions.push({\n      header: t(`insp.cody_wizard.step_select_context.header_${cType}`),\n      meta: t(`insp.cody_wizard.step_select_context.meta_${cType}`),\n      description: t(`insp.cody_wizard.step_select_context.desc_${cType}`),\n      type: cType,\n      nodeType: getNodeTypeForContext(node, cType),\n      extra: getExtraDescriptionForContext(node, cType),\n    })\n  })\n\n  return descriptions;\n}\n\nconst getNodeTypeForContext = (node: Node, ctx: WizardContextType): NodeType => {\n  switch (ctx) {\n    case \"policy\":\n      return NodeType.policy;\n    case \"dddAction\":\n      return NodeType.command;\n    default:\n      return NodeType.freeText;\n  }\n}\n\nconst getExtraDescriptionForContext = (node: Node, ctx: WizardContextType): React.ReactElement | undefined => {\n  switch (ctx) {\n    case \"dddAction\":\n      return <>\n        <CellIcon cellType={NodeType.ui} size=\"normal\" />\n        <Icon name=\"arrow right\" />\n        <CellIcon cellType={NodeType.command} size=\"normal\" />\n        <Icon name=\"arrow right\" />\n        <CellIcon cellType={NodeType.aggregate} size=\"normal\" />\n        <Icon name=\"arrow right\" />\n        <CellIcon cellType={NodeType.event} size=\"normal\" />\n        <Icon name=\"arrow right\" />\n        <CellIcon cellType={NodeType.document} size=\"normal\" />\n      </>\n    case \"policy\":\n      return <>\n        <CellIcon cellType={NodeType.event} size=\"normal\" />\n        <Icon name=\"arrow right\" />\n        <CellIcon cellType={NodeType.policy} size=\"normal\" />\n        <Icon name=\"arrow right\" />\n        <CellIcon cellType={NodeType.command} size=\"normal\" />\n        &nbsp;/&nbsp;\n        <CellIcon cellType={NodeType.externalSystem} size=\"normal\" />\n      </>\n    default:\n      return undefined;\n  }\n}\n","import * as React from 'react';\nimport {useEffect, useMemo, useState} from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {useElementsTree} from \"../../hooks/useElementsTree\";\nimport {useGraph} from \"../../hooks/useGraph\";\nimport {BoardId} from \"../../model/Board\";\nimport {ActiveGraphElement} from \"../../reducers/applyActiveGraphElementActions\";\nimport {makeBoardByIdSelector} from \"../../selectors/board\";\nimport {dddActionFromNode, isDDDAction} from \"../../service/cody-wizard/context/ddd-action\";\nimport {suggestCommand} from \"../../service/cody-wizard/context/ddd-action/cody-suggestions\";\nimport {isFeatureContext} from \"../../service/cody-wizard/context/feature-context\";\nimport {isInformationContext} from \"../../service/cody-wizard/context/information-context\";\nimport {isPolicyContext, policyContextFromNode} from \"../../service/cody-wizard/context/policy-context\";\nimport {suggestPolicy} from \"../../service/cody-wizard/context/policy-context/cody-suggestions\";\nimport {isUiContext} from \"../../service/cody-wizard/context/ui\";\nimport {WizardContext} from \"../../service/cody-wizard/context/wizard-context\";\nimport {\n  determineWizardContextAndStep\n} from \"../../service/cody-wizard/graph-suggestions/initialize-cody-graph-suggestions\";\nimport Aggregate from \"../CodyEngineWizard/Step/Aggregate\";\nimport AnyVo from \"../CodyEngineWizard/Step/AnyVo\";\nimport DddCommand from \"../CodyEngineWizard/Step/DddCommand\";\nimport AggregateEvent from \"../CodyEngineWizard/Step/DddEvent\";\nimport Feature from \"../CodyEngineWizard/Step/Feature\";\nimport Policy from \"../CodyEngineWizard/Step/Policy\";\nimport PolicyCommand from \"../CodyEngineWizard/Step/PolicyCommand\";\nimport PolicyEvent from \"../CodyEngineWizard/Step/PolicyEvent\";\nimport SelectContext from \"../CodyEngineWizard/Step/SelectContext\";\nimport StateVO from \"../CodyEngineWizard/Step/StateVO\";\nimport Ui from \"../CodyEngineWizard/Step/Ui\";\nimport UnsupportedNode from \"../CodyEngineWizard/Unsupported/UnsupportedNode\";\nimport {EMPTY_CONTEXT, isSelectContextStep, WizardStep} from \"../CodyEngineWizard/WizardModal\";\nimport {makeNodeRecord, MxGraphElement} from \"../../model/Graph\";\n\ninterface OwnProps {\n  boardId: BoardId;\n  activeGraphElement: ActiveGraphElement;\n  onUpdateMetadata: (value: string, force?: boolean) => void;\n}\n\ntype MetadataCodyWizardProps = OwnProps;\n\nconst MetadataCodyWizard = (props: MetadataCodyWizardProps) => {\n  const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.boardId), [props.boardId]);\n  const board = useSelector(getBoardByIdSelector);\n  const elementsTree = useElementsTree(props.boardId);\n  const [graph, ] = useGraph();\n  const [ctx, setCtx] = useState<WizardContext>(EMPTY_CONTEXT);\n  const [activeStep, setActiveStep] = useState<WizardStep | null>(null);\n  const node = graph.getNode(props.activeGraphElement.id)!;\n  const readonly = !!props.activeGraphElement.locked;\n\n  useEffect(() => {\n    const result = determineWizardContextAndStep(\n      node,\n      board,\n      graph\n    );\n\n    setCtx(result.ctx);\n    setActiveStep(result.step);\n  }, [props.activeGraphElement.id, props.activeGraphElement.metadata, props.boardId]);\n\n\n  const unsupportedNode = !activeStep ? node : null;\n\n  const handleCtxChanged = (changedCtx: WizardContext) => {\n    if(node instanceof MxGraphElement) {\n      node.setPotentiallyStale();\n    }\n\n    if(isSelectContextStep(activeStep)) {\n      if(isDDDAction(changedCtx)) {\n        suggestCommand(changedCtx, graph);\n        setCtx(dddActionFromNode(activeStep.node, board));\n        setActiveStep('dddEvent');\n      }\n\n      if(isPolicyContext(changedCtx)) {\n        suggestPolicy(changedCtx, graph);\n        setCtx(policyContextFromNode(activeStep.node, board));\n        setActiveStep('policyEvent');\n      }\n    } else {\n      setCtx(changedCtx);\n    }\n  }\n\n  const updateMetadata = (value: string, force?: boolean): void => {\n    if(value !== node.getMetadata()) {\n      props.onUpdateMetadata(value, force);\n    }\n  }\n\n  return <>\n    {unsupportedNode && <UnsupportedNode node={unsupportedNode} />}\n    {!unsupportedNode\n      && activeStep === 'state'\n      && isDDDAction(ctx)\n      && <StateVO ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'dddEvent'\n      && isDDDAction(ctx)\n      && <AggregateEvent ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'policyEvent'\n      && isPolicyContext(ctx)\n      && <PolicyEvent ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />\n    }\n    {!unsupportedNode\n      && activeStep === 'aggregate'\n      && isDDDAction(ctx)\n      && <Aggregate ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'command'\n      && (isDDDAction(ctx))\n      && <DddCommand ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'ui'\n      && (isDDDAction(ctx) || isUiContext(ctx))\n      && <Ui ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'feature'\n      && (isDDDAction(ctx) || isPolicyContext(ctx) || isFeatureContext(ctx))\n      && <Feature ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'anyVO'\n      && (isInformationContext(ctx))\n      && <AnyVo ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />}\n    {!unsupportedNode\n      && activeStep === 'policy'\n      && (isPolicyContext(ctx))\n      && <Policy ctx={ctx} mode=\"sidebar\" readonly={readonly} onCtxChanged={handleCtxChanged} onUpdateMetadata={updateMetadata} />\n    }\n    {!unsupportedNode\n      && isSelectContextStep(activeStep)\n      && <SelectContext ctx={ctx} mode=\"sidebar\" readonly={readonly} contexts={activeStep.contexts} node={activeStep.node} onCtxChanged={handleCtxChanged} />\n    }\n  </>\n};\n\nexport default MetadataCodyWizard;\n","import {List} from \"immutable\";\nimport React, {useEffect, useImperativeHandle, useRef, useState} from \"react\";\nimport {Link} from \"react-router-dom\";\nimport {Icon, Menu, Message} from \"semantic-ui-react\";\nimport CodeEditor from \"../../../core/components/CodeEditor/CodeEditor\";\nimport * as Routes from \"../../../routes\";\nimport CollaborationInfoModal from \"../../../standalone/components/CollaborationInfoModal\";\nimport {isStandalone} from \"../../../standalone/util\";\nimport {useElementsTree} from \"../../hooks/useElementsTree\";\nimport {Board, BoardId} from \"../../model/Board\";\nimport {Node, NodeType} from \"../../model/Graph\";\nimport {HistoryCellType} from \"../../model/HistoryEntry\";\nimport {StickyTemplate} from \"../../model/StickyTemplate\";\nimport {ActiveGraphElement} from \"../../reducers/applyActiveGraphElementActions\";\nimport {isConnected} from \"../BoardElementDetails\";\nimport BoardHistory from \"../BoardHistory\";\nimport CellIcon from \"../CellIcon\";\nimport {RANGE_BOARD_ELEMENT_DETAILS} from \"../MxGraphBoard/clickRange\";\nimport ElementConnections from \"./ElementConnections\";\nimport MetadataCodyWizard from \"./MetadataCodyWizard\";\nimport {parse} from \"../../service/json/json-comment-wrapper\";\n\nexport interface BoardElementMetadataRef {\n    retrievePayload: () => string;\n}\n\ninterface OwnProps {\n    focusEditor: boolean;\n    boardId: BoardId;\n    board?: Board;\n    activeNodeSources: List<Node>;\n    activeNodeTargets: List<Node>;\n    activeGraphElement: ActiveGraphElement;\n    similarElements: List<string>;\n    boardStickyTemplate: StickyTemplate;\n    onTriggerCody: () => void;\n    onUpdateMetadata: (value: string, force?: boolean) => void;\n    onShowRunCody: (showRunCody: boolean) => void;\n    onClose?: () => void;\n    t: any; // Workaround for withNamespaces HOC not working with forwardRef\n}\n\nexport type ActiveTab = 'wizard' | 'metadata' | 'activity';\n\ntype BoardElementMetadataProps = OwnProps;\n\nconst errorRegistry: Record<string, string> = {};\n\nconst BoardElementMetadata = (props: BoardElementMetadataProps, ref: React.Ref<BoardElementMetadataRef>) => {\n    const elementsTree = useElementsTree(props.boardId);\n    const [clicks, setClicks] = useState(RANGE_BOARD_ELEMENT_DETAILS);\n    const codeEditorRef = useRef<CodeEditor|null>(null);\n    const [activeTab, setActiveTab] = useState<ActiveTab>(props.focusEditor ? 'metadata' : 'wizard');\n    const [infoModalOpen, setInfoModalOpen] = useState(false);\n\n    const isNodeWithMetadata = props.activeGraphElement.type !== NodeType.textCard\n        && props.activeGraphElement.type !== NodeType.edge;\n\n    const handleMetadataUpdate = (metadata: string, force?: boolean): void => {\n        if(props.boardStickyTemplate.templateType !== \"json\") {\n            props.onUpdateMetadata(metadata, force);\n        }\n\n        try {\n            parse(metadata);\n            props.onUpdateMetadata(metadata, force);\n            delete errorRegistry[props.activeGraphElement.id];\n        } catch (e) {\n            errorRegistry[props.activeGraphElement.id] = metadata;\n        }\n    }\n\n    useImperativeHandle<BoardElementMetadataRef, BoardElementMetadataRef>(ref, () => ({\n        retrievePayload: (): string => codeEditorRef.current!.retrievePayload(),\n    }));\n\n    useEffect(() => {\n        if(!props.board || !props.board.codySuggestEnabled) {\n            setActiveTab('metadata');\n        }\n    }, [props.boardId, (props.board && props.board.codySuggestEnabled)]);\n\n    useEffect(() => {\n        if (!codeEditorRef.current) {\n            return;\n        }\n\n        const disposable = codeEditorRef.current!.addKeyDownHandler((e: KeyboardEvent) => {\n            if (e.ctrlKey && (e.code === 'KeyS' || e.code === 'KeyG')) {\n                e.preventDefault();\n\n                handleMetadataUpdate(codeEditorRef.current!.retrievePayload(), true);\n                props.onTriggerCody();\n            }\n\n            if(e.code === 'Escape' && props.onClose) {\n                handleMetadataUpdate(codeEditorRef.current!.retrievePayload());\n                e.preventDefault();\n                e.stopPropagation();\n                props.onClose();\n            }\n        });\n\n        return () => {\n            disposable.dispose();\n        }\n    }, [props.activeGraphElement.id]);\n\n    useEffect(() => {\n        if(activeTab !== 'metadata') {\n            return;\n        }\n\n        if (!isNodeWithMetadata || !codeEditorRef.current) {\n            return;\n        }\n\n        if(!props.activeGraphElement.metadata && isConnected(props.activeGraphElement) && props.similarElements.count() > 0) {\n            const firstSimilarElement = elementsTree.getElement(props.similarElements.first(''));\n\n            if(firstSimilarElement && firstSimilarElement.getMetadata()) {\n                handleMetadataUpdate(firstSimilarElement.getMetadata() as string, true);\n            }\n        }\n\n        codeEditorRef.current!.initializeModel({\n            fileId: `graph_element_${props.activeGraphElement.id}.json`,\n            language: props.boardStickyTemplate.templateType,\n            value: errorRegistry[props.activeGraphElement.id] || props.activeGraphElement.metadata || props.boardStickyTemplate.template || '{\\n  \\n}\\n',\n            schema: props.boardStickyTemplate.templateSchema || undefined,\n            onChange: e => {\n                if (codeEditorRef.current) {\n                    handleMetadataUpdate(codeEditorRef.current.retrievePayload());\n                }\n            },\n        });\n    }, [props.activeGraphElement.id, props.activeGraphElement.metadata, props.similarElements, activeTab])\n\n    useEffect(() => {\n        if(props.focusEditor && activeTab !== 'metadata') {\n            changeActiveTab('metadata');\n        }\n        if(codeEditorRef.current && props.focusEditor) {\n            codeEditorRef.current!.focus();\n        }\n    }, [props.focusEditor, activeTab]);\n\n    const changeActiveTab = (changedTab: ActiveTab) => {\n        if (changedTab === 'activity' && isStandalone()) {\n            setInfoModalOpen(true);\n            return;\n        }\n        setActiveTab(changedTab);\n        props.onShowRunCody(changedTab === \"wizard\");\n    }\n\n    const invalidJson = !!errorRegistry[props.activeGraphElement.id];\n\n    return (<>\n        <Link\n            style={{borderRadius: '0', color: '#424242'}}\n            onClick={() => setClicks(clicks + 1)}\n            to={{pathname: Routes.compileInspectioBoardWorkspace(props.boardId), search: `?cells=${props.activeGraphElement.id}&clicks=${clicks}`}}>\n            {props.activeGraphElement.locked && <Icon name=\"lock\" title=\"Element is locked\"/>}<CellIcon cellType={props.activeGraphElement.type as HistoryCellType} /> <strong>{props.t('app.stickyTypes.' + props.activeGraphElement.type)}</strong>\n        </Link>\n        {(props.activeNodeSources.size > 0 || props.activeNodeTargets.size > 0) && (\n            <ElementConnections\n                boardId={props.boardId}\n                sources={props.activeNodeSources}\n                targets={props.activeNodeTargets}\n            />\n        )}\n        <Menu pointing={true} secondary={true} color=\"blue\">\n            <Menu.Item name=\"Cody\" active={activeTab === 'wizard'} onClick={() => changeActiveTab('wizard')} />\n            <Menu.Item name=\"Metadata\" active={activeTab === 'metadata'} onClick={() => changeActiveTab('metadata')} />\n            <Menu.Item name=\"Activity\" active={activeTab === 'activity'} onClick={() => changeActiveTab('activity')} />\n        </Menu>\n        {isNodeWithMetadata && activeTab === 'wizard' && (\n          <div style={{height: 'auto', overflowY: 'auto', flexGrow: 1}}>\n            <MetadataCodyWizard boardId={props.boardId} activeGraphElement={props.activeGraphElement} onUpdateMetadata={props.onUpdateMetadata} />\n          </div>\n        )}\n        {isNodeWithMetadata && activeTab === 'metadata' && (<>\n            {invalidJson &&\n              <Message error={true} size=\"small\" content={props.t('insp.cody_wizard.schema_editor.invalid_json') as string}\n                       icon=\"warning\" style={{display: 'flex'}}/>}\n            <CodeEditor\n                ref={codeEditorRef}\n                options={{\n                    fontSize: 12,\n                    folding: false,\n                    glyphMargin: false,\n                    lineNumbers: 'off',\n                    lineDecorationsWidth: 3,\n                    minimap: {\n                        enabled: false\n                    },\n                    formatOnPaste: true,\n                    scrollBeyondLastLine: false,\n                    automaticLayout: true,\n                    scrollbar: {\n                        alwaysConsumeMouseWheel: false\n                    },\n                    readOnly: props.activeGraphElement.locked\n                }}\n                style={{ height: '500px' }}\n\n            />\n        </>)}\n        {activeTab === 'activity' && <BoardHistory elementId={props.activeGraphElement.id} />}\n        <CollaborationInfoModal open={infoModalOpen} onClose={() => setInfoModalOpen(false)} headerKey={'header_history'} />\n    </>);\n}\n\nexport default React.forwardRef(BoardElementMetadata);\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Redirect} from \"react-router\";\nimport {RouteComponentProps} from \"react-router-dom\";\nimport {Dimmer, Loader} from \"semantic-ui-react\";\nimport {ResponseType} from \"../../api/util\";\nimport {exec, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {Action as Notify, Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Routes from \"../../routes\";\nimport * as UserModule from \"../../User\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {acceptInvitationToOrganization, fetchOrganization} from \"../actions/api\";\nimport {createOrganizationFromServerData} from \"../model/Organization\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../selectors/selectUserOrganizationInfo\";\nimport {Action} from \"../index\";\n\ninterface OwnProps {\n\n}\n\ninterface RouteMatchParams {\n    organization: string;\n    invitation: string;\n}\n\ntype AcceptOrganizationInvitationProps = OwnProps & RouteComponentProps<RouteMatchParams> & WithNamespaces;\n\nconst AcceptOrganizationInvitation = (props: AcceptOrganizationInvitationProps) => {\n    const organizationId = props.match.params.organization;\n    const invitationId = props.match.params.invitation;\n\n    const currentUserSelector = makeGetCurrentUser();\n\n    const currentUser = useSelector(currentUserSelector);\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n    const [doRedirect, setDoRedirect] = useState(false);\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if(currentUser.signedIn && activeOrganization) {\n            let retries = 0;\n\n            const handleAckResponse = (ackResponse: ResponseType) => {\n                if(ackResponse.error) {\n                    // Invited user is new and username sync seems still be in progress\n                    if(retries < 2) {\n                        retries++;\n                        window.setTimeout(() => {\n                            acceptInvitationToOrganization(organizationId, invitationId).then(handleAckResponse);\n                        }, 100);\n                        return;\n                    }\n\n                    dispatch(Notify.Command.error('Command failed', 'Failed to process organization invitation'));\n                    setDoRedirect(true);\n                    return;\n                }\n\n                fetchOrganization(organizationId)\n                    .then(({response, error}) => {\n                        if(error) {\n                            dispatch(Notify.Command.info(\n                                props.t('insp.organisation.joined.title'),\n                                ''\n                            ));\n                            setDoRedirect(true);\n                            return;\n                        }\n\n                        if(response) {\n                            const result = pipe(\n                                response.data,\n                                exec((data: any) => createOrganizationFromServerData(data)),\n                            );\n\n                            if (isFailure(result)) {\n                                console.error(\"Invalid organization response: \", result.value);\n                                dispatch(NotifyAction.Command.error('Request Error', 'Could not load organization'));\n                            }\n\n                            if (isSuccess(result)) {\n                                dispatch(Action.Query.fetchUserOrganizations());\n                                dispatch(UserModule.Action.Command.switchActiveOrganization(organizationId));\n                                dispatch(Notify.Command.info(\n                                    props.t('insp.organisation.joined.title'),\n                                    props.t('insp.organisation.joined.details', {name: result.value.name}))\n                                );\n                            }\n\n                            setDoRedirect(true);\n                        }\n                    });\n            };\n\n            acceptInvitationToOrganization(organizationId, invitationId)\n                .then(handleAckResponse);\n        }\n    }, [currentUser.signedIn, activeOrganization]);\n\n\n    if(doRedirect) {\n        return <Redirect to={Routes.inspectio} />\n    }\n\n    return <Dimmer active={true} className=\"page\"><Loader size=\"large\">Processing Organization Invitation</Loader></Dimmer>;\n};\n\nexport default withNamespaces()(AcceptOrganizationInvitation);\n","import * as React from 'react';\nimport {Label} from \"semantic-ui-react\";\nimport {DEFAULT_COLOR, ERROR_COLOR, WARNING_COLOR} from \"./definitions\";\n// tslint:disable-next-line:no-var-requires\nconst iioAvatar = require('../../../theme/img/inspect-avatar.png');\n\ninterface OwnProps {\n    message: string;\n    type?: 'default' | 'error' | 'warning';\n}\n\ntype InspectIoMessageProps = OwnProps;\n\nconst InspectIoMessage = (props: InspectIoMessageProps) => {\n\n    let msgColor = DEFAULT_COLOR;\n    let fontWeight: 'normal' | 'bold' = 'normal';\n    let backgroundColor = 'white';\n\n    if(props.type === 'error') {\n        msgColor = ERROR_COLOR;\n        fontWeight = 'bold';\n        backgroundColor = '#f1bec5';\n    }\n\n    if(props.type === 'warning') {\n        msgColor = WARNING_COLOR;\n        fontWeight = 'bold';\n    }\n\n    return <div className=\"console-message\" style={{backgroundColor}}>\n        <Label circular={true} className=\"user console-avatar\" style={{backgroundImage: `url(${iioAvatar})`, backgroundSize: 'cover', marginLeft: '3px'}} />\n        <div className=\"console-text\">\n            <span style={{color: msgColor, fontWeight}}>{props.message}</span>\n        </div>\n    </div>;\n};\n\nexport default InspectIoMessage;\n","import * as React from 'react';\nimport {useSelector} from \"react-redux\";\nimport {Label} from \"semantic-ui-react\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\n\ninterface OwnProps {\n    msg: string;\n}\n\ntype UserMessageProps = OwnProps;\n\nconst UserMessage = (props: UserMessageProps) => {\n    const user = useSelector(makeGetCurrentUser());\n\n    return <div className=\"console-message\">\n        <Label circular={true} className=\"user console-avatar\" style={{backgroundImage: `url(${user.avatarUrl})`, backgroundSize: 'cover', marginLeft: '1px'}} />\n        <div className=\"console-text\">\n            {props.msg === '' && <span>&nbsp;</span>}\n            <span>{props.msg}</span>\n        </div>\n    </div>\n};\n\nexport default UserMessage;\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {ReactElement, useMemo, useRef, useState} from 'react';\nimport Draggable, {DraggableData, DraggableEvent} from \"react-draggable\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Transition} from \"semantic-ui-react\";\nimport {setCodyConsoleHeight} from \"../../Layout/actions/commands\";\nimport {makeGetSidebarSelector} from \"../../Layout/selectors/sidebar\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {toggleCodyConsole} from \"../actions/commands\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {BoardId} from \"../model/Board\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport {CodyResponse, CodyResponseType, IIO, NO_CODY_CONNECTION} from \"../service/Cody\";\nimport CodyMessage from \"./CodyConsole/CodyMessage\";\nimport InspectIoMessage from \"./CodyConsole/InspectIoMessage\";\nimport UserInput from \"./CodyConsole/UserInput\";\nimport UserMessage from \"./CodyConsole/UserMessage\";\n\ninterface OwnProps {\n\n}\n\ninterface CodyConsoleRouteMatchParams {\n    uid: BoardId;\n}\n\nconst RESERVED_NAMES = [\n    'connect',\n    'disconnect',\n    'cockpit',\n    'help',\n    'talk'\n]\n\ntype CodyConsoleProps = OwnProps & RouteComponentProps<CodyConsoleRouteMatchParams>;\n\nconst CodyConsole = (props: CodyConsoleProps) => {\n    const dispatch = useDispatch();\n    const [messages, setMessages] = useState<List<ReactElement>>(List([]));\n    const [lastCodyMsg, setLastCodyMsg] = useState<CodyResponse|undefined>();\n    const sidebar = useSelector(makeGetSidebarSelector());\n    const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.match.params.uid), []);\n    const board = useSelector(getBoardByIdSelector);\n    const visible = board && board.shouldShowCodyConsole;\n    const [isDragging, setIsDragging] = useState(false);\n    const [collabsableBottom, setCollabsableBottom] = useState(sidebar.codyConsoleHeight);\n    const user = useSelector(makeGetCurrentUser());\n    const consoleEl = useRef<HTMLDivElement>(null);\n    const [graph] = useGraph();\n\n    const sidebarWidth = sidebar.width + 10 /* collapse handle */;\n    const bothSidebarsWidth = sidebarWidth + ((board && board.shouldShowElementDetails)\n      ? sidebar.rightSidebarWidth + 5 + (sidebar.sideBySideCell ? sidebar.sideBySideWidth + 5 : 0)\n      : 0);\n\n    const addMessage = (msg: ReactElement) => {\n        setMessages(messages.push(msg));\n        window.setTimeout(() => {\n            if(consoleEl.current) {\n                consoleEl.current.scrollBy({top: 200, behavior: \"smooth\"});\n            }\n        }, 10);\n    }\n\n    IIO.setCodyResponsePrinter((res: CodyResponse, codyName: string) => {\n        setLastCodyMsg(res);\n        addMessage(<CodyMessage key={messages.count() + 1} codyResponse={res} codyName={codyName} />);\n    });\n\n    IIO.setErrorPrinter((error: string) => {\n        if(messages.count() === 0 && error === NO_CODY_CONNECTION) {\n            return;\n        }\n\n        addMessage(<InspectIoMessage key={messages.count() + 1} message={error} type=\"error\" />);\n    });\n\n    IIO.setWarningPrinter((warn: string) => {\n        addMessage(<InspectIoMessage key={messages.count() + 1} message={warn} type=\"warning\" />);\n    });\n\n    const handleCloseClick = () => {\n        dispatch(toggleCodyConsole(props.match.params.uid, false));\n    }\n\n    const handleDragging = (e: DraggableEvent, data: DraggableData) => {\n        if(!isDragging) {\n            setIsDragging(true);\n        }\n\n        const newHeight = sidebar.codyConsoleHeight - data.deltaY;\n\n        dispatch(setCodyConsoleHeight(newHeight));\n    }\n\n    const handleDragStop = (e: DraggableEvent, data: DraggableData) => {\n        setIsDragging(false);\n        setCollabsableBottom(sidebar.codyConsoleHeight);\n    }\n\n    const handleUserInput = (val: string) => {\n        addMessage(<UserMessage key={messages.count() + 1} msg={val} />);\n\n        if(val === '/help') {\n            window.setTimeout(() => {\n                IIO.ask.Cody.forHelp();\n            })\n            return;\n        }\n\n        if(val === '/talk') {\n            IIO.talk.to.Cody();\n            return;\n        }\n\n        const foundConnect = val.match(/^\\/connect\\s+(?<uri>http(s)?:\\/\\/[^\\s]+|play)\\s*(?<name>[A-Za-z0-9]+)?$/);\n\n        if(foundConnect) {\n            if(foundConnect.groups!.name) {\n                if(RESERVED_NAMES.includes(foundConnect.groups!.name)) {\n                    addMessage(<CodyMessage codyResponse={{\n                        cody: `Oh sorry, you cannot use \"${foundConnect.groups!.name}\" as a name. It's a reserved word!`,\n                        type: CodyResponseType.Error\n                    }} codyName=\"cody\" />)\n                    return;\n                }\n            }\n\n            IIO.connect.Cody(foundConnect.groups!.uri, user.displayName, board.uid, foundConnect.groups!.name);\n            return;\n        }\n\n        const foundDisconnect = val.match(/^\\/disconnect\\s+(?<name>[A-Za-z0-9]+)$/);\n\n        if(foundDisconnect && foundDisconnect.groups!.name) {\n            IIO.disconnect(foundDisconnect.groups!.name);\n            return;\n        }\n\n        if(val.match(/^\\/cockpit\\s+http(s)?:\\/\\/.+$/)) {\n            graph.setCockpitBaseUrl(val.replace('/cockpit ', '').trim());\n            addMessage(<CodyMessage codyName=\"Cody\" codyResponse={{\n                cody: 'Cockpit is activated now.',\n                details: 'Right click on commands, events, queries or aggregates and choose \"Open In Cockpit\" from context menu.'}}\n            />);\n            return;\n        }\n\n        if(IIO.codyServers) {\n            IIO.reply(val);\n        } else {\n            IIO.connect.Cody(val.replace('/connect ', ''), user.displayName, board.uid);\n        }\n    }\n\n    const handleUserEscape = () => {\n        IIO.abortSession();\n    }\n\n    return <Transition.Group animation=\"slide up\">{visible && <div className=\"cody console\" ref={consoleEl} style={{\n        height: `${sidebar.codyConsoleHeight}px`,\n        left: `${sidebarWidth}px`,\n        width: `calc(100% - ${bothSidebarsWidth}px)`,\n    }}>\n        {!IIO.codyServers && <InspectIoMessage message=\"No connection to Cody. Try to connect with him first!\" type=\"warning\"/>}\n        {messages.toArray()}\n        <UserInput showConnectDefault={!IIO.codyServers}\n                   boardId={props.match.params.uid}\n                   messageCount={messages.count()}\n                   lastCodyMsg={lastCodyMsg}\n                   visible={visible}\n                   onEnter={handleUserInput}\n                   onEscape={handleUserEscape}\n                   onClose={handleCloseClick} />\n        <Draggable\n            axis=\"y\"\n            onDrag={handleDragging}\n            onStop={handleDragStop}\n            position={{x: 0, y: 0}}\n        >\n            <div className=\"collapsible\" style={{bottom: collabsableBottom + 'px', width: `calc(100% - ${bothSidebarsWidth}px)`,  cursor: 'grabbing'}}>\n                <span className=\"collaps-handle\" onClick={handleCloseClick}><i className=\"close icon\" /></span>\n            </div>\n        </Draggable>\n    </div>}</Transition.Group>;\n};\n\nexport default withRouter(CodyConsole);\n","import {List, Record} from \"immutable\";\nimport {createSelector} from \"reselect\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {OrganizationInvitation, OrganizationInvitationId} from \"../model/OrganizationInvitation\";\n\nexport const getOrganizationInvitationById = (state: Record<ApplicationState>, uid: OrganizationInvitationId): OrganizationInvitation | undefined => state.getIn([MODULE, 'OrganizationInvitation', uid]);\n\nexport const makeOrganizationInvitationSelector = (uid: OrganizationInvitationId): (state: Record<ApplicationState>) => OrganizationInvitation | undefined => (state: Record<ApplicationState>) => getOrganizationInvitationById(state, uid);\n\nexport const organizationInvitationListSelector = (state: Record<ApplicationState>, props: any): List<OrganizationInvitation> =>\n    List(state.getIn([MODULE, 'OrganizationInvitation']).toIndexedSeq().toArray()) || List();\n\nexport const makeOrganizationInvitationListSelector = (): (state: Record<ApplicationState>, props?: any) => List<OrganizationInvitation> => {\n    return createSelector(\n        [organizationInvitationListSelector],\n        (OrganizationInvitationList): List<OrganizationInvitation> => {\n            return OrganizationInvitationList;\n        }\n    )\n};\n","import * as React from 'react';\nimport {useEffect, useState} from \"react\";\nimport {WithNamespaces, withNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {ButtonGroup, ListItem} from \"semantic-ui-react\";\nimport SecondaryButton from \"../../../core/components/SecondaryButton\";\nimport {isSuccess} from \"../../../core/validation/either\";\nimport * as UserModule from \"../../../User\";\nimport UserAvatar from \"../../../User/components/UserAvatar\";\nimport {createAnonymous, IioUserInfo} from \"../../../User/model/IioUserInfo\";\nimport * as Action from \"../../actions\";\nimport {OrganizationInvitation, Status} from \"../../model/OrganizationInvitation\";\nimport {makeOrganizationInvitationSelector} from \"../../selectors/selectOrganizationInvitation\";\nimport {Organization} from \"../../model/Organization\";\n\ninterface OwnProps {\n    invitation: OrganizationInvitation,\n    organization: Organization,\n}\n\ntype OpenOrganizationInvitationProps = OwnProps & WithNamespaces;\n\nconst OpenOrganizationInvitation = (props: OpenOrganizationInvitationProps) => {\n\n    const [userInfo, setUserInfo] = useState(createAnonymous());\n    const [isResending, setIsResending] = useState(false);\n    const [isRevoking, setIsRevoking] = useState(false);\n    const [isRevoked, setIsRevoked] = useState(false);\n    const cachedInvitation = useSelector(makeOrganizationInvitationSelector(props.invitation.invitationId));\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        UserModule.Action.Api.getInspectioUserInfoByEmail(props.invitation.invitedUserEmail).then(({response, error}) => {\n            if(response) {\n                const result = UserModule.IioUserInfo.createIioUserInfoFromServerData(response.data);\n\n                if(isSuccess(result)) {\n                    setUserInfo(result.value);\n                }\n            }\n        })\n    }, [props.invitation.invitedUserEmail]);\n\n    useEffect(() => {\n        if(isResending) {\n            setIsResending(false);\n        }\n\n        if(isRevoking && cachedInvitation && cachedInvitation.status === Status.revoked) {\n            setIsRevoked(true);\n        }\n    }, [cachedInvitation]);\n\n    const handleResendClick = () => {\n        setIsResending(true);\n        dispatch(Action.Command.resendUserOrganizationInvitation(props.organization.uid, props.invitation.invitationId, props.invitation.invitedUserEmail));\n    };\n\n    const handleRevokeClick = () => {\n        setIsRevoking(true);\n        dispatch(Action.Command.revokeUserOrganizationInvitation(props.organization.uid, props.invitation.invitationId, props.invitation.invitedUserEmail));\n    }\n\n    if(isRevoked) {\n        return <></>;\n    };\n\n    return <ListItem>\n        <UserAvatar user={userInfo} size=\"mini\" />\n        <span style={{paddingLeft: \"10px\"}}>{props.invitation.invitedUserEmail}</span>\n        <ButtonGroup floated=\"right\">\n            <SecondaryButton content={props.t('app.form.resend')} icon=\"paper plane\" loading={isResending} onClick={handleResendClick} />\n            <SecondaryButton content={props.t('app.form.revoke')} icon=\"delete\" loading={isRevoking} onClick={handleRevokeClick} />\n        </ButtonGroup>\n    </ListItem>\n};\n\nexport default withNamespaces()(OpenOrganizationInvitation);\n","import {useState} from \"react\";\nimport * as React from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, ButtonGroup, Icon, Input, List as SemanticList, ListItem, Modal} from \"semantic-ui-react\";\nimport SecondaryButton from \"../../core/components/SecondaryButton\";\nimport {\n    isSuccess,\n} from \"../../core/validation/either\";\nimport UserAvatar from \"../../User/components/UserAvatar\";\nimport {createIioUserInfoFromServerData} from \"../../User/model/IioUserInfo\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport * as Action from \"../actions\";\nimport {Organization} from \"../model/Organization\";\nimport OpenOrganizationInvitation from \"./Invitations/OpenOrganizationInvitation\";\n\ninterface OwnProps {\n    open: boolean;\n    hasEnoughQuota: boolean;\n    onClose: () => void;\n    organization: Organization\n}\n\ntype InviteUserToOrganizationModalProps = WithNamespaces & OwnProps;\n\nconst InviteUserToOrganizationModal = (props: InviteUserToOrganizationModalProps) => {\n    const [email, setEmail] = useState('');\n    const currentUser = useSelector(makeGetCurrentUser());\n\n    const dispatch = useDispatch();\n\n    const success = createIioUserInfoFromServerData({\n        userId: currentUser.uid,\n        username: currentUser.displayName,\n        avatarUrl: currentUser.avatarUrl,\n        position: ''\n    });\n    let userInfo;\n\n    if(isSuccess(success)) {\n        userInfo = success.value;\n    }\n\n    const handleSubmit = () => {\n        dispatch(Action.Command.inviteUserToOrganization(props.organization.uid, email))\n        setEmail('');\n        props.onClose();\n    };\n\n    const hasInvitations = props.organization.invitations.count() > 0;\n\n    return (\n        <Modal open={props.open} closeIcon={true} onClose={props.onClose}>\n            <Modal.Header>{props.t('insp.organisation.invite_user')}</Modal.Header>\n            <Modal.Content>\n                <form onSubmit={handleSubmit}>\n                    <div style={{ marginBottom: '10px' }}>\n                        <Input\n                            style={{ width: '100%' }}\n                            value={email}\n                            onChange={(e, data) => setEmail(data.value)}\n                            placeholder={props.t('insp.organisation.user_email')}\n                            autoFocus={true}\n                        />\n                    </div>\n                    <Button primary={true} type=\"submit\" disabled={!isValidEmail(email) || !props.hasEnoughQuota}>\n                        {props.t('insp.organisation.send_invitation')}\n                    </Button>\n                </form>\n                <div className=\"ui horizontal divider\">{ props.t('insp.organisation.open_invitations') }</div>\n                {hasInvitations && <SemanticList relaxed={true} divided={true}>\n                    {props.organization.invitations.map(\n                        invitation => <OpenOrganizationInvitation\n                            invitation={invitation}\n                            organization={props.organization}\n                            key={invitation.invitationId} />\n                    )}\n                </SemanticList>}\n                {!hasInvitations && <p className=\"infotextSecondary\">{ props.t('insp.organisation.empty_invitations') }</p>}\n            </Modal.Content>\n        </Modal>\n    );\n};\n\n/**\n * Validates the basic email structure; not a perfect validation\n *\n * @param value\n */\nconst isValidEmail = (value: string) => {\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value);\n};\n\nexport default withNamespaces()(InviteUserToOrganizationModal);\n","import * as React from 'react';\nimport {SyntheticEvent, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {Button, Confirm, Dropdown, Label} from \"semantic-ui-react\";\nimport {useOnBodyClick} from \"../../core/hooks/useOnBodyClick\";\nimport * as UserModule from \"../../User\";\nimport {IioUserInfo} from \"../../User/model\";\nimport {Action} from \"../index\";\nimport {OrganizationId} from \"../model/Organization\";\n\ninterface OwnProps {\n    isOwner: boolean;\n    isAdmin: boolean;\n    organizationId: OrganizationId;\n    currentUserIsOwner: boolean;\n    member: IioUserInfo.IioUserInfo;\n    readonly?: boolean;\n    isGuest?: boolean;\n}\n\ntype OrganizationMemberEntryProps = OwnProps & WithNamespaces;\n\nconst OrganizationMemberEntry = (props: OrganizationMemberEntryProps) => {\n    const [showDropdown, setShowDropdown] = useState(false);\n    const [avatarLoaded, setAvatarLoaded] = useState(false);\n    const [showRemoveMemberConfirm, setShowRemoveMemberConfirm] = useState(false);\n    const dispatch = useDispatch();\n\n    useOnBodyClick(() => {\n        setShowDropdown(false);\n    });\n\n    const canBeRemoved = (userId: UserModule.UserModel.UserId): boolean => {\n        return !props.isOwner && !props.readonly;\n    }\n\n    const handleMemberClick = (e: SyntheticEvent) => {\n        if(canBeRemoved(props.member.userId)) {\n            e.stopPropagation();\n            setShowDropdown(!showDropdown);\n        }\n    };\n\n    const promoteMemberToAdmin = () => {\n        if(!props.readonly) {\n            dispatch(Action.Command.promoteUserToOrganizationAdmin(props.organizationId, props.member.userId));\n        }\n    }\n\n    const demoteUserToMember = () => {\n        if(!props.readonly) {\n            dispatch(Action.Command.demoteUserToOrganizationMember(props.organizationId, props.member.userId));\n        }\n    }\n\n    const turnGuestIntoMember = () => {\n        if(!props.readonly) {\n            dispatch(Action.Command.turnGuestIntoMember(props.member.userId, props.organizationId))\n        }\n    }\n\n    const removeMemberFromOrganization = () => {\n        if(!props.readonly) {\n            if(props.isGuest) {\n                dispatch(Action.Command.removeGuestFromOrganization(props.organizationId, props.member.userId));\n            } else {\n                dispatch(Action.Command.removeUserFromOrganization(props.organizationId, props.member.userId));\n            }\n\n        }\n        setShowRemoveMemberConfirm(false);\n    };\n\n    const adminClass = props.isOwner || props.isAdmin? 'admin-member' : '';\n\n    return <div className={\"item \" + adminClass} key={props.member.userId} style={canBeRemoved(props.member.userId) ? {cursor: \"pointer\"} : {}}>\n        <Dropdown open={showDropdown} icon={false} pointing=\"top\" disabled={props.readonly} className=\"organization\">\n            <Dropdown.Menu>\n                {props.currentUserIsOwner && props.isAdmin && <Dropdown.Item\n                    text={props.t('insp.organisation.demote_to_member')}\n                    onClick={() => demoteUserToMember()}\n                    />}\n                {props.currentUserIsOwner && !props.isAdmin && !props.isGuest && <Dropdown.Item\n                    text={props.t('insp.organisation.promote_to_admin')}\n                    onClick={() => promoteMemberToAdmin()}\n                />}\n                {props.isGuest && <Dropdown.Item\n                    text={props.t('insp.organisation.promote_to_member')}\n                    onClick={() => turnGuestIntoMember()}\n                />}\n                <Dropdown.Item\n                    text={props.t('app.form.remove')}\n                    onClick={() => setShowRemoveMemberConfirm(true)}\n                />\n            </Dropdown.Menu>\n        </Dropdown>\n        {!avatarLoaded && <span className=\"ui avatar image placeholder\" onClick={handleMemberClick} />}\n        <img className=\"ui avatar image\" src={props.member.avatar()} onClick={handleMemberClick}\n                              onLoad={() => setAvatarLoaded(true)}\n                              alt={props.member.username + \" Avatar\"} style={{display: avatarLoaded ? 'inline-block' : 'none'}}/>\n        <div className=\"content\" onClick={handleMemberClick}>\n            <div className=\"header\">{props.member.username}</div>\n        </div>\n        <Confirm\n            open={!props.readonly && showRemoveMemberConfirm}\n            header={props.t('insp.organisation.remove_user_confirm_title')}\n            content={props.t(\n                'insp.organisation.remove_user_confirm_text',\n                { user_name: props.member.username, email: props.member.email }\n            )}\n            confirmButton={props.t('insp.organisation.remove_user_confirm_button')}\n            cancelButton={<Button content={props.t('app.form.cancel')} className=\"basic noborder\" />}\n            onCancel={() => setShowRemoveMemberConfirm(false)}\n            onConfirm={removeMemberFromOrganization}\n        />\n    </div>\n};\n\nexport default withNamespaces()(OrganizationMemberEntry);\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {\n    Button,\n    Confirm,\n    Container,\n    Dropdown,\n    DropdownItemProps,\n    Grid,\n    Header,\n    Message,\n    Search,\n    Select\n} from \"semantic-ui-react\";\nimport EditableTextline from \"../../core/components/EditableTextline\";\nimport {UserInfo} from \"../../User/model/UserInfo\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeIioFilteredUserListSelector} from \"../../User/selectors/iioUserInfo\";\nimport * as Action from \"../actions\";\nimport {UserOrganizationInfo} from \"../model/UserOrganizationInfo\";\nimport {makeOrganizationSelector} from \"../selectors/selectOrganization\";\nimport InviteUserToOrganizationModal from \"./InviteUserToOrganisationModal\";\nimport OrganizationMemberEntry from \"./OrganizationMemberEntry\";\nimport {List} from \"immutable\";\n\ninterface OwnProps {\n    activeOrganization: UserOrganizationInfo,\n    currentUser: UserInfo\n}\n\ntype OrganisationManagementProps = OwnProps & WithNamespaces;\n\ninterface Orga {\n    name: string,\n    description: string,\n}\n\nconst INPUT_CHAR_SIZE = 9;\nconst CHAR_SIZE_UNIT = 'px';\nconst ADDITIONAL_CHAR_PADDING = 20;\n\nconst OrganisationManagement = (props: OrganisationManagementProps) => {\n    const [showNewOrga, setShowNewOrga] = useState(false);\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\n    const [showAddUserModal, setShowAddUserModal] = useState(false);\n    const currentUser = useSelector(makeGetCurrentUser());\n    const organizationData = useSelector(makeOrganizationSelector(props.activeOrganization.organizationId));\n    const [mailFilter, setMailFilter] = useState('');\n    const dispatch = useDispatch();\n    let members = useSelector(\n        organizationData\n            ? makeIioFilteredUserListSelector(organizationData.members.push(organizationData.ownerId))\n            : makeIioFilteredUserListSelector(List())\n    );\n    let guests = useSelector(\n        organizationData\n            ? makeIioFilteredUserListSelector(organizationData.guests)\n            : makeIioFilteredUserListSelector(List())\n    );\n\n    if(!organizationData) {\n        return <Message error={true}>Could not load organization data. Please refresh the page to try again!</Message>;\n    }\n\n    const hasEnoughQuota = (organizationData.memberQuota - organizationData.invitations.count()) > 0;\n\n    const handleDeleteClick = (e: React.MouseEvent<HTMLAnchorElement>) => {\n        e.stopPropagation();\n        e.preventDefault();\n        setShowDeleteModal(true);\n    }\n\n    const handleAddUserClick = () => {\n        setShowAddUserModal(true);\n    }\n\n    const closeAddUserModal = () => {\n        setShowAddUserModal(false);\n    }\n\n    const handleOrgaNameChanged = (name: string) => {\n        dispatch(Action.Command.renameOrganization(props.activeOrganization.organizationId, name));\n    }\n\n    const handleNewOrgaEntered = (name: string) => {\n        dispatch(Action.Command.setUpExplicitOrganization(props.activeOrganization.organizationId, name));\n        setShowNewOrga(false);\n    }\n\n    const emailSearchOptions: DropdownItemProps[] = members.map(m => ({text: m.email, key: m.uid, value: m.email})).toJS();\n\n    const handleMailFilterChanged = (newMailFilter: string) => {\n        setMailFilter(newMailFilter);\n    }\n\n    if(mailFilter !== '') {\n        members = members.filter(m => m.email === mailFilter);\n        guests = guests.filter(g => g.email === mailFilter);\n    }\n\n\n    const memberList = members.sortBy(m => m.username).sort((mA, mB) => {\n        if(mA.userId === organizationData.ownerId) {\n            return  -1;\n        }\n\n        if(mB.userId === organizationData.ownerId) {\n            return 1;\n        }\n\n        if(organizationData.admins.contains(mA.userId)) {\n            return -1;\n        }\n\n        if(organizationData.admins.contains(mB.userId)) {\n            return 1;\n        }\n\n        return 0;\n    }).map(member => <OrganizationMemberEntry\n        key={member.userId}\n        member={member}\n        currentUserIsOwner={organizationData.ownerId === currentUser.uid}\n        isOwner={organizationData.ownerId === member.userId}\n        isAdmin={organizationData.admins.contains(member.userId)}\n        readonly={organizationData.ownerId === member.userId || (organizationData.ownerId !== currentUser.uid && organizationData.admins.contains(member.userId))}\n        organizationId={organizationData.uid} />);\n\n    const guestList = guests.sortBy(m => m.username).map(member => <OrganizationMemberEntry\n        key={member.userId}\n        member={member}\n        currentUserIsOwner={organizationData.ownerId === currentUser.uid}\n        isOwner={organizationData.ownerId === member.userId}\n        isAdmin={organizationData.admins.contains(member.userId)}\n        isGuest={true}\n        readonly={organizationData.ownerId === member.userId || (organizationData.ownerId !== currentUser.uid && organizationData.admins.contains(member.userId))}\n        organizationId={organizationData.uid} />);\n\n    return <>\n            {props.activeOrganization.explicitOrganization && !hasEnoughQuota && <Grid.Row>\n                <Grid.Column>\n                    <Message warning={true} floating={true} content={props.t('insp.organisation.no_member_quota')} />\n                </Grid.Column>\n            </Grid.Row>}\n            <Grid.Row>\n                <Grid.Column>\n                    <div>\n                        {!props.activeOrganization.explicitOrganization && props.activeOrganization.ownOrganization\n                            && <button className=\"ui huge basic button\" onClick={() => setShowNewOrga(!showNewOrga)}>\n                            <i className=\"plus icon\"/>\n                            {props.t('insp.organisation.create_btn')}\n                        </button>}\n                        {showNewOrga && <div className=\"ui segment\">\n                            <EditableTextline\n                                text={''}\n                                charSize={INPUT_CHAR_SIZE}\n                                widthUnit={CHAR_SIZE_UNIT}\n                                padding={ADDITIONAL_CHAR_PADDING}\n                                minWidth={200}\n                                required={true}\n                                onTextChanged={handleNewOrgaEntered}\n                                focus={true}\n                                onCancel={() => {\n                                    setShowNewOrga(false)\n                                }}\n                                placeholder={props.t('insp.organisation.name') as string}\n                            />\n                        </div>\n                        }\n                        {props.activeOrganization.explicitOrganization && <div className=\"ui segment\">\n                            {<a href=\"#\" className=\"ui small right floated basic button noborder\"\n                                onClick={handleDeleteClick} style={{display: \"none\"}}>\n                                Delete\n                            </a>}\n\n                            <h3 style={{margin: 0, cursor: props.activeOrganization.ownOrganization? \"pointer\" : \"default\"}} id={'1234'}>\n                                <EditableTextline\n                                    text={props.activeOrganization.organizationName}\n                                    charSize={INPUT_CHAR_SIZE}\n                                    widthUnit={CHAR_SIZE_UNIT}\n                                    padding={ADDITIONAL_CHAR_PADDING}\n                                    minWidth={200}\n                                    required={true}\n                                    onTextChanged={handleOrgaNameChanged}\n                                    focus={false}\n                                    onCancel={() => {\n                                        console.log(\"cancel name change\")\n                                    }}\n                                    placeholder={props.t('insp.organisation.name') as string}\n                                    disabled={!props.activeOrganization.ownOrganization}\n                                />\n                            </h3>\n                            <Select options={emailSearchOptions} defaultValue={mailFilter} onChange={(e,data) => handleMailFilterChanged(data.value as string)} placeholder=\"Email Filter\" search={true} clearable={true} basic={true} floating={true} style={{float: \"right\", height: \"20px\", marginTop: \"-30px\"}} />\n                            <div className=\"ui horizontal divider\">{props.t('insp.organisation.member')}</div>\n                            <div className=\"ui horizontal list\">\n                                <Button basic={true} icon={true} color=\"blue\" size=\"large\" onClick={handleAddUserClick} disabled={!hasEnoughQuota && organizationData.invitations.count() === 0}>\n                                    <i className=\"blue user icon\"/>\n                                </Button>\n                                {memberList}\n                            </div>\n                            {guestList.count() > 0 &&  <div className=\"ui horizontal divider\">{props.t('insp.organisation.guests')}</div>}\n                            {guestList.count() > 0 && <div className=\"ui horizontal list\">\n                                {guestList}\n                            </div>}\n                            <InviteUserToOrganizationModal\n                                open={showAddUserModal}\n                                onClose={closeAddUserModal}\n                                organization={organizationData}\n                                hasEnoughQuota={hasEnoughQuota}\n                            />\n                            <Confirm\n                                open={showDeleteModal}\n                                header={props.t('insp.team.remove_team_confirm_title')}\n                                confirmButton={props.t('app.form.remove')}\n                                cancelButton={<Button content={props.t('app.form.cancel')} className=\"basic noborder\" />}\n                                content={props.t('insp.team.remove_team_confirm_text', {team_name: props.activeOrganization.organizationName})}\n                                onCancel={() => setShowDeleteModal(false)}\n                                onConfirm={() => {alert(\"confirmed!\")}}\n                            />\n                        </div>}\n                    </div>\n                </Grid.Column>\n            </Grid.Row>\n            {!props.activeOrganization.explicitOrganization && props.activeOrganization.ownOrganization && <Grid.Row>\n                <Grid.Column>\n                    <Message info={true} floating={true} content={props.t('insp.organisation.not_explicit')}/>\n                </Grid.Column>\n            </Grid.Row>}\n            <Grid.Row>\n                <Grid.Column />\n            </Grid.Row>\n        </>;\n};\n\nexport default withNamespaces()(OrganisationManagement);\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useSelector} from \"react-redux\";\nimport {Container, Grid, Header, Menu, MenuItem, Message} from \"semantic-ui-react\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport {makeActiveUserOrganizationInfoSelector} from \"../selectors/selectUserOrganizationInfo\";\nimport OrganisationManagement from \"./OrganisationManagement\";\n\ninterface OwnProps {\n\n}\n\ntype OrganizationOverviewProps = OwnProps & WithNamespaces;\n\nconst OrganizationOverview = (props: OrganizationOverviewProps) => {\n    const currentUser = useSelector(makeGetCurrentUser());\n    const activeOrganization = useSelector(makeActiveUserOrganizationInfoSelector());\n\n    return <Container>\n        <Grid stackable={true} padded={true}>\n            <Grid.Row>\n                <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n                <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                    <Header as=\"h1\" icon={true} textAlign='center'>\n                        <Header.Content>\n                            Manage Organisation\n                            <Header.Subheader />\n                        </Header.Content>\n                    </Header>\n                </Grid.Column>\n            </Grid.Row>\n            {activeOrganization && activeOrganization.userIsAdmin && <>\n            <OrganisationManagement currentUser={currentUser} activeOrganization={activeOrganization} />\n            </>}\n            {(!activeOrganization || !activeOrganization.userIsAdmin) && <Grid.Row>\n                <Grid.Column computer=\"1\" largeScreen=\"2\" widescreen=\"3\" />\n                <Grid.Column mobile=\"16\" tablet=\"16\" computer=\"14\" largeScreen=\"12\" widescreen=\"10\">\n                    <Message content={props.t('insp.organisation.no_admin')} warning={true} />\n                </Grid.Column>\n            </Grid.Row>\n            }\n        </Grid>\n    </Container>;\n};\n\nexport default withNamespaces()(OrganizationOverview);\n","import * as React from 'react';\nimport {useEffect, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Redirect, withRouter} from \"react-router\";\nimport {RouteComponentProps} from \"react-router-dom\";\nimport {Button, Dimmer, Icon, Loader, Message, Modal} from \"semantic-ui-react\";\nimport * as uuid from \"uuid\";\nimport {ImportMode} from \"../../Layout/Sidebar/ImportBoard\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport * as Routes from \"../../routes\";\nimport {makeGetCurrentUser} from \"../../User/selectors/currentUser\";\nimport * as Action from \"../actions\";\nimport {fetchBoardXmlFromLink, fetchPlayshotFromLink} from \"../actions/api\";\nimport {BoardModel} from \"../model\";\nimport {BoardId, BoardXml} from \"../model/Board\";\nimport {makeGetAllBoards, makeInitialBoardListLoaded} from \"../selectors/boardList\";\nimport {savePlayshot} from \"../service/playshot-storage\";\nimport {togglePlayshotModal} from \"../actions/commands\";\n\ninterface RouteProps {\n    link: string;\n}\n\ninterface OwnProps {\n\n}\n\ntype BoardImportFromLinkProps = OwnProps & RouteComponentProps<RouteProps> & WithNamespaces;\n\nconst extractBoardName = (link: string): string => {\n    const parts = link.split('/');\n    const boardFile = parts[parts.length - 1];\n    return boardFile.split('.').slice(0, -1).join('.');\n}\n\n\nconst BoardImportFromLink = (props: BoardImportFromLinkProps) => {\n    const [doRedirect, setDoRedirect] = useState(false);\n    const [redirectPath, setRedirectPath] = useState(Routes.inspectio);\n    const [askForImportMode, setAskForImportMode] = useState(false);\n    const [boardXml, setBoardXml] = useState<BoardXml|undefined>(undefined);\n    const [boardId, setBoardId] = useState<BoardId|undefined>(undefined);\n    const initialBoardListLoaded = useSelector(makeInitialBoardListLoaded());\n    const user = useSelector(makeGetCurrentUser());\n    const getBoards = makeGetAllBoards();\n    const boards = useSelector(getBoards);\n    const [existingBoardName, setExistingBoardName] = useState('undefined');\n    const dispatch = useDispatch();\n    const link = decodeURIComponent(props.match.params.link);\n    const [playshotLoaded, setPlayshotLoaded] = useState(false);\n\n    const queryParams = new URLSearchParams(props.location.search);\n\n    const shouldSave = !queryParams.has('temp') || parseInt(queryParams.get('temp')+'', undefined) !== 1;\n    const withPlayshot = queryParams.has('playshot');\n\n    useEffect(() => {\n        if(!initialBoardListLoaded) {\n            return;\n        }\n\n        setPlayshotLoaded(false);\n        fetchBoardXmlFromLink(link)\n            .then(loadedBoardXml => {\n                setBoardXml(loadedBoardXml);\n\n                const boardName = extractBoardName(link);\n\n                const existingBoardList = boards.filter((board) => {\n                    return board.name === boardName;\n                });\n\n                if(shouldSave && existingBoardList.count() !== 0) {\n                    setExistingBoardName(boardName);\n                    setAskForImportMode(true);\n                    return;\n                }\n\n                processFile(boardName, loadedBoardXml, shouldSave? ImportMode.newBoard : ImportMode.tempBoard);\n            })\n            .catch(err => {\n                console.error(err);\n                dispatch(Notify.Command.error('Request failed', 'Failed to load board. Please check if import link points to a valid prooph board XML file!'));\n                setDoRedirect(true);\n                return;\n            })\n    }, [link, initialBoardListLoaded]);\n\n    useEffect(() => {\n        if(!initialBoardListLoaded) {\n            return;\n        }\n\n        if(withPlayshot && boardId) {\n            const playshotLink = decodeURIComponent(queryParams.get('playshot') || '');\n\n            if(playshotLink) {\n                fetchPlayshotFromLink(playshotLink)\n                  .then(playshot => savePlayshot({...playshot, boardId}))\n                  .then(success => {\n                      if(!success) {\n                          dispatch(Notify.Command.error('Failed to save playshot', 'Failed to save playshot. Please check if import link points to a valid prooph board playshot file!'));\n                          setDoRedirect(true);\n                          return;\n                      }\n                      setPlayshotLoaded(true);\n                  })\n                  .catch(error => {\n                      console.error(error);\n                      dispatch(Notify.Command.error('Failed to load playshot', 'Failed to load playshot. Please check if import link points to a valid prooph board playshot file!'));\n                      setDoRedirect(true);\n                      return;\n                  })\n            }\n        }\n    }, [boardId]);\n\n    const handleImportModalClose = () => {\n        setAskForImportMode(false);\n    }\n\n    const processFile = (boardName: string, xml: BoardXml, importMode: ImportMode) => {\n\n        if(importMode === ImportMode.newBoard) {\n            const newBoardId = uuid.v4();\n            dispatch(Action.Command.importNewBoard(boardName, xml, newBoardId));\n\n            setBoardId(newBoardId);\n        } else if (importMode === ImportMode.tempBoard) {\n            const newBoardId = uuid.v4();\n            dispatch(Action.Command.importNewBoard(boardName, xml, newBoardId, true));\n\n            setBoardId(newBoardId);\n        } else {\n            const existingBoardList = boards.filter((board) => {\n                return board.name === boardName;\n            });\n\n            if(existingBoardList.count() > 0) {\n                const existingBoard: BoardModel.Board = existingBoardList.first();\n\n                const updatedBoard = existingBoard.updateXml(xml, user.uid);\n                dispatch(Action.Command.importExistingBoard(updatedBoard));\n\n                // wait a moment, so that board xml gets updated before redirect to board workspace happens\n                window.setTimeout(() => {\n                    setBoardId(updatedBoard.uid);\n                }, 50);\n            }\n        }\n    };\n\n    const handleImportCopyClick = () => {\n        setAskForImportMode(false);\n        if(boardXml) {\n            processFile(extractBoardName(link) + \" (Copy)\", boardXml, ImportMode.newBoard);\n        }\n    };\n\n    const handleOverrideClick = () => {\n        setAskForImportMode(false);\n        if(boardXml) {\n            processFile(extractBoardName(link), boardXml, ImportMode.replaceBoard);\n        }\n    }\n\n    if(boardId && boards.filter(board => board.uid === boardId).count() === 1 && (!withPlayshot || playshotLoaded)) {\n        if(withPlayshot) {\n            return <Redirect to={Routes.compileWorkspacePlayshotDeeplink(boardId)} />;\n        }\n        return <Redirect to={Routes.compileInspectioBoardWorkspace(boardId)} />;\n    }\n\n    if(doRedirect) {\n        return <Redirect to={redirectPath} />;\n    }\n\n    return <>\n            <Dimmer active={true} className=\"page\"><Loader size=\"large\">Loading board from {link}</Loader></Dimmer>\n            <Modal open={askForImportMode} closeIcon={true} onClose={handleImportModalClose}>\n                <Modal.Header>{ props.t(\"insp.board.import\") }</Modal.Header>\n                <Modal.Content>\n                    <Message icon=\"warning\" warning={true} content={props.t('insp.board.import_existing_board').replace('%name%', existingBoardName)} />\n                </Modal.Content>\n                <Modal.Actions>\n                    <Button primary={true} onClick={handleImportCopyClick}><Icon name='plus' /> { props.t('insp.board.btn_import_as_new') }</Button>\n                    <Button basic={true} onClick={handleOverrideClick}>{ props.t('insp.board.btn_replace_board') }</Button>\n                </Modal.Actions>\n            </Modal>\n        </>;\n};\n\nexport default withRouter(withNamespaces()(BoardImportFromLink));\n","import * as React from 'react';\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Dimmer, Loader} from \"semantic-ui-react\";\n\ninterface OwnProps {\n\n}\n\ntype MxGraphBoardRedirectProps = OwnProps & RouteComponentProps;\n\n// Special redirect component to force remounting of MxGraphBoard when a linked board is clicked\n// See mxgraph Graph.js Graph.prototype.labelLinkClicked\nconst MxGraphBoardRedirect = (props: MxGraphBoardRedirectProps) => {\n    const {href} = props.history.location.state;\n    window.setTimeout(() => {\n        props.history.replace(href);\n    }, 500);\n    return <Dimmer active={true} className=\"page\"><Loader size=\"large\">Loading Board</Loader></Dimmer>;\n};\n\nexport default withRouter(MxGraphBoardRedirect);\n","import * as React from 'react';\nimport {useEffect, useMemo, useRef, useState} from \"react\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {withRouter} from \"react-router\";\nimport {RouteComponentProps} from \"react-router-dom\";\nimport {Button, ButtonGroup, Icon, Input, Modal} from \"semantic-ui-react\";\nimport {makeGetSidebarSelector} from \"../../../Layout/selectors/sidebar\";\nimport {PublicSounds} from \"../../../routes\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\nimport {toggleTimerModal} from \"../../actions/commands\";\nimport {useMouseSync} from \"../../hooks/useMouseSync\";\nimport {BoardId} from \"../../model/Board\";\nimport {BoardTimer as BoardTimerAR, createBoardTimer} from \"../../model/BoardTimer\";\nimport {makeBoardByIdSelector} from \"../../selectors/board\";\nimport {UserJoinedListener, UserLeftListener} from \"../../service/RemoteMouseSync\";\n\ninterface BoardTimerRouteMatchParams {\n    uid: BoardId;\n}\n\ninterface OwnProps {\n\n}\n\nconst convertToTimeNumber = (val: string, max: number, emptyZeros: boolean = false): string => {\n    if (val.length === 1) {\n        val = '0'+val;\n    }\n\n    if(val.length === 3) {\n        val = val.slice(1);\n    }\n\n    if (parseInt(val, undefined) === 0) {\n        val = emptyZeros? '00' : '';\n    }\n\n    if(parseInt(val, undefined) > max) {\n        val = `${max}`;\n    }\n\n    return val;\n}\n\nconst convertDurationToHms = (d: number): [number, number, number] => {\n    d = Math.floor(Number(d) / 1000);\n\n    let h = Math.floor(d / 3600);\n    let m = Math.floor(d % 3600 / 60);\n    let s = Math.floor(d % 3600 % 60);\n\n    if(h < 0) {\n        h = 0;\n    }\n\n    if(m < 0) {\n        m = 0;\n    }\n\n    if(s < 0) {\n        s = 0;\n    }\n\n    return [h, m, s];\n}\n\nconst convertHmsToDuration = (h: string, m: string, s: string): number => {\n    const hoursMillis = parseInt(h === ''? '0' : h, undefined) * 60 * 60 * 1000;\n    const minutesMillis = parseInt(m === ''? '0' : m, undefined) * 60 * 1000;\n    const secondsMillis = parseInt(s === ''? '0' : s, undefined) * 1000;\n\n    return hoursMillis + minutesMillis + secondsMillis;\n}\n\nconst calculateCurrentTime = (\n    deadline: number,\n    duration: number,\n    hourglass: HourglassState,\n    setHourglass: (hourglass: HourglassState) => void,\n    setCurrentTime: (time: TimeTuple) => void,\n    stop: () => void\n) => {\n    let timerHours = 0;\n    let timerMinutes = 0;\n    let timerSeconds = 0;\n    let timeLeft = 0;\n\n    timeLeft = deadline - Date.now();\n\n    const leftPercentage = Math.floor(timeLeft * 100 / duration);\n\n    if(leftPercentage > 50 && hourglass !== 'start') {\n        setHourglass('start');\n    }\n\n    if(leftPercentage <= 50 && leftPercentage > 5 && hourglass !== 'half') {\n        setHourglass('half');\n    }\n\n    if(leftPercentage <= 5 && hourglass !== 'end') {\n        setHourglass('end');\n    }\n\n    if(timeLeft > 0) {\n        [timerHours, timerMinutes, timerSeconds] = convertDurationToHms(timeLeft);\n    }\n\n    if (deadline > 0 && timeLeft < -10000) {\n        stop();\n    }\n\n    setCurrentTime([timerHours, timerMinutes, timerSeconds]);\n}\n\ntype HourglassState = 'start' | 'half' | 'end';\ntype TimeTuple = [number, number, number];\n\nlet intervalRef: number|null = null;\n\ntype BoardTimerProps = OwnProps & RouteComponentProps<BoardTimerRouteMatchParams> & WithNamespaces;\n\nconst BoardTimer = (props: BoardTimerProps) => {\n    const dispatch = useDispatch();\n    const minRef = useRef<Input>(null);\n    const sidebar = useSelector(makeGetSidebarSelector());\n    const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.match.params.uid), []);\n    const board = useSelector(getBoardByIdSelector);\n    const visible = board && board.shouldShowTimerModal;\n    const user = useSelector(makeGetCurrentUser());\n    const [hours, setHours] = useState('');\n    const [minutes, setMinutes] = useState<string>('');\n    const [seconds, setSeconds] = useState('');\n    const [deadline, setDeadline] = useState(0);\n    const [duration, setDuration] = useState(0);\n    const [moderator, setModerator] = useState<string>();\n    const [isPlaying, setIsPlaying] = useState(false);\n    const [currentTime, setCurrentTime] = useState<TimeTuple>([0,0,0]);\n    const [pausedTime, setPausedTime] = useState<TimeTuple>();\n    const [hourglass, setHourglass] = useState<HourglassState>('start');\n    const [moderatorHasLeft, setModeratorHasLeft] = useState(false);\n    const [gongPlayed, setGongPlayed] = useState(true);\n    const [mouseSync, ] = useMouseSync();\n\n    useEffect(() => {\n        if(visible) {\n            window.setTimeout(() => {\n                if(minRef && minRef.current) {\n                    minRef.current.focus();\n                }\n            }, 200);\n        }\n    }, [visible])\n\n    const handleHoursChanged = (hoursVal: string) => {\n        setHours(convertToTimeNumber(hoursVal, 23));\n    }\n\n    const handleMinutesChanged = (minutesVal: string) => {\n        setMinutes(convertToTimeNumber(minutesVal, 59));\n    }\n\n    const handleSecondsChanged = (secondsVal: string) => {\n        setSeconds(convertToTimeNumber(secondsVal, 59));\n    }\n\n    const handleClose = () => {\n        dispatch(toggleTimerModal(props.match.params.uid, false));\n    }\n\n    const play = (ignorePausedTime: boolean = false) => {\n        let hoursMillis = parseInt(hours === ''? '0' : hours, undefined) * 60 * 60 * 1000;\n        let minutesMillis = parseInt(minutes === ''? '0' : minutes, undefined) * 60 * 1000;\n        let secondsMillis = parseInt(seconds === ''? '0' : seconds, undefined) * 1000;\n\n        if(pausedTime && !ignorePausedTime) {\n            [hoursMillis, minutesMillis, secondsMillis] = pausedTime;\n            hoursMillis = hoursMillis * 60 * 60 * 1000;\n            minutesMillis = minutesMillis * 60 * 1000;\n            secondsMillis = secondsMillis * 1000;\n        }\n\n        const calculatedDuration = hoursMillis + minutesMillis + secondsMillis;\n\n        if(!pausedTime || ignorePausedTime) {\n            setDuration(calculatedDuration);\n        } else {\n            setPausedTime(undefined);\n        }\n\n        const newDeadline = Date.now() + calculatedDuration;\n\n        setDeadline(newDeadline);\n        setIsPlaying(true);\n        setCurrentTime(convertDurationToHms(calculatedDuration));\n        setModerator(user.uid);\n        setGongPlayed(false);\n        mouseSync.startBoardTimer(createBoardTimer(\n            props.match.params.uid,\n            newDeadline,\n            convertHmsToDuration(hours, minutes, seconds),\n            user.uid,\n        ))\n        dispatch(toggleTimerModal(props.match.params.uid, false))\n        calculateCurrentTime(\n            newDeadline,\n            calculatedDuration,\n            hourglass,\n            setHourglass,\n            setCurrentTime,\n            stop\n        );\n    }\n\n    const pause = (triggerMouseSync: boolean = true) => {\n        setIsPlaying(false);\n        setPausedTime([currentHours, currentMinutes, currentSeconds]);\n        if(triggerMouseSync) {\n            mouseSync.pauseBoardTimer(createBoardTimer(\n                props.match.params.uid,\n                deadline,\n                convertHmsToDuration(hours, minutes, seconds),\n                user.uid,\n                [currentHours, currentMinutes, currentSeconds]\n            ))\n        }\n\n    }\n\n    const deadlineReached = () => {\n        const gong = new Audio(PublicSounds + '/gong.wav');\n        gong.play();\n        setGongPlayed(true);\n    }\n\n    const stop = (triggerMouseSync: boolean = true) => {\n        setDuration(0);\n        setDeadline(0);\n        setIsPlaying(false);\n        setPausedTime(undefined);\n        setModerator(undefined);\n        setHourglass('start');\n        setGongPlayed(true);\n        if(triggerMouseSync) {\n            mouseSync.stopBoardTimer(createBoardTimer(\n                props.match.params.uid,\n                0,\n                0,\n                ''\n            ))\n        }\n    }\n\n    const reset = () => {\n        setPausedTime(undefined);\n        setIsPlaying(false);\n        play(true);\n    }\n\n    const handleRemoteTimerStarted = (timer: BoardTimerAR) => {\n        setDeadline(timer.deadline);\n        setDuration(timer.duration);\n        setModerator(timer.moderator);\n        setIsPlaying(true);\n        setGongPlayed(false);\n        calculateCurrentTime(\n            timer.deadline,\n            timer.duration,\n            hourglass,\n            setHourglass,\n            setCurrentTime,\n            stop\n        );\n\n        const [remoteHours, remoteMinutes, remoteSeconds] = convertDurationToHms(timer.duration);\n\n        console.log(\"remote time started: \", timer.toJSON());\n\n        setHours(convertToTimeNumber(remoteHours.toString(), 23));\n        setMinutes(convertToTimeNumber(remoteMinutes.toString(), 59));\n        setSeconds(convertToTimeNumber(remoteSeconds.toString(), 59));\n    }\n\n    const handleRemoteTimerStopped = (timer: BoardTimerAR) => {\n        console.log(\"Received remote timer stopped: \", timer.toJSON());\n        stop(false);\n    }\n\n    const handleRemoteTimerPaused = (timer: BoardTimerAR) => {\n        setIsPlaying(false);\n\n        console.log(\"remote paused time: \", timer.toJSON());\n\n        if(timer.pausedTime) {\n            setCurrentTime(timer.pausedTime);\n            setPausedTime(timer.pausedTime);\n        }\n    }\n\n    const handleRemoteUserJoined: UserJoinedListener = (userId: string, name: string, avatar: string, color: string) => {\n        if(userId === moderator) {\n            setModeratorHasLeft(false);\n        }\n    }\n\n    const handleRemoteUserLeft: UserLeftListener = (userId: string) => {\n        if(userId === moderator) {\n            setModeratorHasLeft(true);\n        }\n    }\n\n    useEffect(() => {\n        if(isPlaying) {\n            intervalRef = window.setInterval(() => {\n                calculateCurrentTime(\n                    deadline,\n                    duration,\n                    hourglass,\n                    setHourglass,\n                    setCurrentTime,\n                    stop\n                );\n            }, 1000);\n\n            calculateCurrentTime(\n                deadline,\n                duration,\n                hourglass,\n                setHourglass,\n                setCurrentTime,\n                stop\n            );\n        }\n\n        return () => {\n            if(intervalRef) {\n                clearInterval(intervalRef);\n            }\n        }\n    }, [isPlaying, hourglass, duration, deadline])\n\n    useEffect(() => {\n        console.log(\"attach listeners\");\n        mouseSync.onBoardTimerStarted(handleRemoteTimerStarted);\n        mouseSync.onBoardTimerStopped(handleRemoteTimerStopped);\n        mouseSync.onBoardTimerPaused(handleRemoteTimerPaused);\n        mouseSync.onUserJoined(handleRemoteUserJoined);\n        mouseSync.onUserLeft(handleRemoteUserLeft);\n\n        return () => {\n            console.log(\"detach listeners\");\n            mouseSync.offBoardTimerStarted(handleRemoteTimerStarted);\n            mouseSync.offBoardTimerPaused(handleRemoteTimerPaused);\n            mouseSync.offBoardTimerStopped(handleRemoteTimerStopped);\n            mouseSync.offUserJoined(handleRemoteUserJoined);\n            mouseSync.offUserLeft(handleRemoteUserLeft);\n        }\n    }, [props.match.params.uid, hours, minutes, seconds, moderator])\n\n    useEffect(() => {\n        stop();\n    }, [props.match.params.uid])\n\n    const [currentHours, currentMinutes, currentSeconds] = currentTime;\n    const isTimeLeft = (currentHours + currentMinutes + currentSeconds) > 0;\n    const isModerator = moderator === user.uid;\n    const canModerate = !moderator || isModerator || moderatorHasLeft;\n\n    if(!isTimeLeft && !gongPlayed) {\n        deadlineReached();\n    }\n\n    return (<>\n        {deadline > 0 && <div style={{\n            position: \"absolute\",\n            left: sidebar.width + 20 + \"px\",\n            top: \"60px\",\n            backgroundColor: 'rgb(249 251 253 / 52%)',\n            cursor: 'pointer'\n        }}\n              onClick={() => dispatch(toggleTimerModal(props.match.params.uid, true))}\n        >\n            <p style={{padding: '20px', fontWeight: 'bold', fontSize: '20px', color: isTimeLeft? '#939393' : '#c10303'}} className={isTimeLeft? '' : 'blink'}>\n                <Icon name={'hourglass ' + (isTimeLeft? hourglass : 'end') as any}/>&nbsp;&nbsp;\n                {convertToTimeNumber(currentHours.toString(), 23, true)}&nbsp;:&nbsp;\n                {convertToTimeNumber(currentMinutes.toString(), 59, true)}&nbsp;:&nbsp;\n                {convertToTimeNumber(currentSeconds.toString(), 59, true)}\n            </p>\n        </div>}\n        <Modal open={visible} closeIcon={true} onClose={handleClose} size=\"tiny\">\n            <Modal.Header>{props.t('insp.board.timer.modal_header')}</Modal.Header>\n            <Modal.Content>\n                <p style={{textAlign: \"center\", fontWeight: \"bold\", fontSize: \"24px\"}}>\n                    <Input name=\"hours\"\n                           transparent={true}\n                           type=\"number\"\n                           min={0}\n                           max={23}\n                           placeholder=\"00\"\n                           size=\"large\"\n                           style={{width: \"55px\"}}\n                           value={deadline > 0? convertToTimeNumber(currentHours.toString(), 23) : hours}\n                           onKeyDown={(e: KeyboardEvent) => e.key === 'Enter'? play() : true}\n                           onChange={(e, data) => handleHoursChanged(data.value)}\n                           disabled={deadline > 0}\n                    />\n                    <span style={{paddingRight: \"20px\"}}>&nbsp;:&nbsp;</span>\n                    <Input name=\"minutes\"\n                           ref={minRef}\n                           transparent={true}\n                           type=\"number\"\n                           min={0}\n                           max={59}\n                           placeholder=\"00\"\n                           size=\"large\"\n                           style={{width: \"55px\"}}\n                           value={deadline > 0? convertToTimeNumber(currentMinutes.toString(), 59) : minutes}\n                           onKeyDown={(e: KeyboardEvent) => e.key === 'Enter' ? play() : true}\n                           onChange={(e, data) => handleMinutesChanged(data.value)}\n                           disabled={deadline > 0}\n                    />\n                    <span style={{paddingRight: \"20px\"}}>&nbsp;:&nbsp;</span>\n                    <Input name=\"seconds\"\n                           transparent={true}\n                           type=\"number\"\n                           min={0}\n                           max={59}\n                           placeholder=\"00\"\n                           size=\"large\"\n                           style={{width: \"55px\"}}\n                           value={deadline > 0? convertToTimeNumber(currentSeconds.toString(), 59) : seconds}\n                           onKeyDown={(e: KeyboardEvent) => e.key === 'Enter'? play() : true}\n                           onChange={(e, data) => handleSecondsChanged(data.value)}\n                           disabled={deadline > 0}\n                    />\n                </p>\n            </Modal.Content>\n            <Modal.Actions style={{textAlign: \"center\"}}>\n                <ButtonGroup>\n                    {!isPlaying && <Button icon=\"play\" onClick={() => play()} disabled={!canModerate}/>}\n                    {isPlaying && <Button icon=\"pause\" onClick={() => pause()} disabled={!canModerate}/>}\n                    <Button icon=\"stop\" onClick={() => stop()} disabled={!isPlaying || !canModerate} />\n                    <Button icon=\"undo\" onClick={() => reset()} disabled={deadline === 0 || !canModerate} />\n                </ButtonGroup>\n            </Modal.Actions>\n        </Modal>\n    </>);\n};\n\nexport default withRouter(withNamespaces()(BoardTimer));\n","import {List, Record} from \"immutable\";\nimport {ApplicationState} from \"../../reducer\";\nimport {MODULE} from \"../index\";\nimport {BoardId} from \"../model/Board\";\nimport {PlayshotId, PlayshotSummary} from \"../model/PlayshotSummary\";\n\nexport const getPlayshotSummaryById = (state: Record<ApplicationState>, uid: PlayshotId): PlayshotSummary | undefined => state.getIn([MODULE, 'playshots', uid]);\n\nexport const makePlayshotSummarySelector = (uid: PlayshotId): (state: Record<ApplicationState>) => PlayshotSummary | undefined => (state: Record<ApplicationState>) => getPlayshotSummaryById(state, uid);\n\nexport const getPlayshotSummariesByBoardId = (state: Record<ApplicationState>, boardId: BoardId): List<PlayshotSummary> => {\n  const summaries: List<PlayshotSummary> = List(state.getIn([MODULE, 'playshots']).toIndexedSeq().toArray());\n\n  return summaries.filter(playshot => playshot.boardId === boardId);\n}\n\nexport const makePlayshotSummaryListSelector = (boardId: BoardId): (state: Record<ApplicationState>) => List<PlayshotSummary> => {\n  return (state: Record<ApplicationState>): List<PlayshotSummary> => {\n    return getPlayshotSummariesByBoardId(state, boardId);\n  }\n};\n","import {NodeId} from \"../../model/Graph\";\nimport {Rule} from \"./rule-definitions\";\nimport {SortOrder, SortOrderItem} from \"./document-store-types\";\n\nexport interface ProophBoardDescription {\n  _pbBoardId: string;\n  _pbCardId: string;\n  _pbCreatedBy: string;\n  _pbCreatedAt: string;\n  _pbLastUpdatedBy: string;\n  _pbLastUpdatedAt: string;\n  _pbVersion: number;\n  _pbLink: string;\n}\n\nexport const ProophBoardDescriptionKeys = [\n  \"_pbBoardId\",\n  \"_pbCardId\",\n  \"_pbCreatedBy\",\n  \"_pbCreatedAt\",\n  \"_pbLastUpdatedBy\",\n  \"_pbLastUpdatedAt\",\n  \"_pbVersion\",\n  \"_pbLink\"\n];\n\nexport const getNodeIdFromProophBoardDescription = (desc: ProophBoardDescription): NodeId => {\n  return desc._pbCardId;\n}\n\nexport type DependencyType = \"query\" | \"service\" | \"events\";\n\nexport interface Dependency {\n  type: DependencyType,\n  options?: Record<string, any>,\n  alias?: string,\n  if?: string,\n}\n\nexport interface DependencyRegistry {[dependencyName: string]: Dependency | Dependency[]}\n\nexport interface AggregateDescription extends ProophBoardDescription {\n  name: string;\n  identifier: string;\n  collection: string;\n  stream?: string;\n  state: string;\n}\n\nexport interface CommandDescription extends ProophBoardDescription {\n  name: string;\n  aggregateCommand: boolean;\n  dependencies?: DependencyRegistry;\n  streamCommand?: boolean;\n}\n\nexport interface AggregateCommandDescription extends CommandDescription{\n  newAggregate: boolean;\n  aggregateName: string;\n  aggregateIdentifier: string;\n  persistState?: boolean;\n  deleteState?: boolean;\n  deleteHistory?: boolean;\n}\n\nexport function isAggregateCommandDescription (desc: CommandDescription | AggregateCommandDescription): desc is AggregateCommandDescription {\n  return desc.aggregateCommand;\n}\n\nexport function isEntityCommandDescription (desc: CommandDescription | AggregateCommandDescription): desc is AggregateCommandDescription {\n  return isAggregateCommandDescription(desc) && !!desc.persistState;\n}\n\nexport interface StreamCommandDescription extends CommandDescription {\n  streamIdExpr: string;\n  streamName?: string;\n  publicStream?: string;\n}\n\nexport function isStreamCommandDescription (desc: CommandDescription | StreamCommandDescription): desc is StreamCommandDescription {\n  return !desc.aggregateCommand && !!desc.streamCommand;\n}\n\nexport interface PureCommandDescription extends CommandDescription {\n  streamName?: string;\n  publicStream?: string;\n}\n\nexport function isPureCommandDescription (desc: CommandDescription | PureCommandDescription): desc is PureCommandDescription {\n  return !isAggregateCommandDescription(desc) && !isStreamCommandDescription(desc);\n}\n\nexport interface EventDescription extends ProophBoardDescription {\n  name: string;\n  aggregateEvent: boolean;\n  public: boolean;\n}\n\nexport interface AggregateEventDescription extends EventDescription {\n  aggregateName: string;\n  aggregateIdentifier: string;\n  aggregateState: string;\n}\n\nexport interface QueryDescription extends ProophBoardDescription {\n  name: string;\n  returnType: string;\n  dependencies?: DependencyRegistry;\n}\n\nexport interface PolicyDescription extends ProophBoardDescription {\n  name: string;\n  dependencies?: DependencyRegistry;\n  live?: boolean;\n  projection?: string;\n}\n\nexport interface ValueObjectDescriptionFlags {\n  isList: boolean;\n  hasIdentifier: boolean;\n  isQueryable: boolean;\n  isNotStored?: boolean;\n}\n\nexport interface ValueObjectDescription extends ProophBoardDescription, ValueObjectDescriptionFlags {\n  name: string;\n  projection?: string;\n}\n\nexport interface QueryableDescription extends ValueObjectDescription {\n  query: string;\n}\n\nexport interface QueryableValueObjectDescription extends QueryableDescription {\n  collection: string;\n}\n\nexport const isQueryableDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableDescription => {\n  return desc.isQueryable;\n}\n\nexport const isQueryableValueObjectDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableValueObjectDescription => {\n  return desc.isQueryable && !desc.hasIdentifier && !desc.isList && !desc.isNotStored;\n}\n\nexport interface QueryableNotStoredValueObjectDescription extends ValueObjectDescription {\n  query: string;\n}\n\nexport const isQueryableNotStoredValueObjectDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableNotStoredValueObjectDescription => {\n  return desc.isQueryable && !desc.hasIdentifier && !desc.isList && !!desc.isNotStored;\n}\n\nexport interface StateDescription extends ValueObjectDescription {\n  identifier: string;\n}\n\nexport const isStateDescription = (desc: ValueObjectDescriptionFlags): desc is StateDescription => {\n  return desc.hasIdentifier && !desc.isList;\n}\n\nexport interface ListDescription extends ValueObjectDescription {\n  itemType: string;\n}\n\nexport const isListDescription = (desc: ValueObjectDescriptionFlags): desc is ListDescription => {\n  return desc.isList;\n}\n\nexport interface StateListDescription extends ValueObjectDescription{\n  itemIdentifier: string;\n}\n\nexport const isStateListDescription = (desc: ValueObjectDescriptionFlags): desc is StateListDescription => {\n  return desc.hasIdentifier && desc.isList;\n}\n\nexport interface QueryableStateDescription extends StateDescription {\n  query: string;\n  collection: string;\n}\n\nexport const isQueryableStateDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableStateDescription => {\n  return isStateDescription(desc) && desc.isQueryable;\n}\n\n\nexport interface QueryableNotStoredStateDescription extends StateDescription {\n  query: string;\n}\n\nexport const isQueryableNotStoredStateDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableNotStoredStateDescription => {\n  return isStateDescription(desc) && desc.isQueryable && !!desc.isNotStored;\n}\n\nexport interface QueryableNotStoredStateListDescription extends StateListDescription {\n  query: string;\n  itemType: string;\n}\n\nexport const isQueryableNotStoredStateListDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableNotStoredStateListDescription => {\n  return isStateListDescription(desc) && !!desc.isNotStored && desc.isQueryable;\n}\n\nexport interface QueryableStateListDescription extends StateListDescription {\n  query: string;\n  collection: string;\n  itemType: string;\n}\n\nexport const isQueryableStateListDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableStateListDescription => {\n  return isStateListDescription(desc) && desc.isQueryable && !desc.isNotStored;\n}\n\nexport interface QueryableListDescription extends ValueObjectDescription {\n  query: string;\n  itemType: string;\n}\n\nexport interface StoredQueryableListDescription extends ValueObjectDescription {\n  query: string;\n  itemType: string;\n  collection: string;\n}\n\nexport const isQueryableListDescription = (desc: ValueObjectDescriptionFlags): desc is QueryableListDescription => {\n  return desc.isList && !desc.hasIdentifier && desc.isQueryable;\n}\n\nexport const isStoredQueryableListDescription = (desc: ValueObjectDescriptionFlags): desc is StoredQueryableListDescription => {\n  return desc.isList && !desc.hasIdentifier && desc.isQueryable && !desc.isNotStored;\n}\n\nexport type ValueObjectDescriptionType = \"ValueObjectDescription\" | \"StateDescription\" | \"StateListDescription\"\n  | \"QueryableValueObjectDescription\" | \"QueryableNotStoredValueObjectDescription\"\n  | \"QueryableStateDescription\" | \"QueryableNotStoredStateDescription\" | \"QueryableStateListDescription\"\n  | \"QueryableNotStoredStateListDescription\" | \"QueryableListDescription\" | \"StoredQueryableListDescription\";\n\nexport const detectDescriptionType = (desc: ValueObjectDescriptionFlags): ValueObjectDescriptionType => {\n  switch (true) {\n    case isQueryableStateListDescription(desc):\n      return \"QueryableStateListDescription\";\n    case isStoredQueryableListDescription(desc):\n      return \"StoredQueryableListDescription\";\n    case isQueryableListDescription(desc):\n      return \"QueryableListDescription\";\n    case isQueryableNotStoredStateListDescription(desc):\n      return \"QueryableNotStoredStateListDescription\";\n    case isQueryableNotStoredStateDescription(desc):\n      return \"QueryableNotStoredStateDescription\";\n    case isQueryableStateDescription(desc):\n      return \"QueryableStateDescription\";\n    case isStateListDescription(desc):\n      return \"StateListDescription\";\n    case isStateDescription(desc):\n      return \"StateDescription\";\n    case isQueryableValueObjectDescription(desc):\n      return \"QueryableValueObjectDescription\";\n    case isQueryableNotStoredValueObjectDescription(desc):\n      return \"QueryableNotStoredValueObjectDescription\";\n    default:\n      return \"ValueObjectDescription\";\n  }\n}\n\nexport interface ResolveConfig {\n  where?: Rule,\n  orderBy?: SortOrderItem | SortOrder,\n  rules?: Rule[],\n}\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {SyntheticEvent, useEffect, useMemo, useRef, useState} from \"react\";\nimport Draggable, {DraggableData, DraggableEvent} from \"react-draggable\";\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Card, Icon, Message} from 'semantic-ui-react';\nimport {setSideBySideCell, setSideBySideWidth} from \"../../Layout/actions/commands\";\nimport {SidebarState} from \"../../Layout/reducers/applySidebarActions\";\nimport {makeGetSidebarSelector} from \"../../Layout/selectors/sidebar\";\nimport {useGraph} from \"../hooks/useGraph\";\nimport {BoardId} from \"../model/Board\";\nimport {Node, NodeType} from \"../model/Graph\";\nimport {ActiveGraphElement, makeNodeFromActiveGraphElement} from \"../reducers/applyActiveGraphElementActions\";\nimport {makeBoardByIdSelector} from \"../selectors/board\";\nimport {makeElementsTreeByBoardIdSelector} from \"../selectors/elementsTree\";\nimport {makeBoardStickyTemplateMapSelector} from \"../selectors/StickyTemplate\";\nimport {isConnected, markAsConnected, markAsDisconnected} from \"./BoardElementDetails\";\nimport BoardElementMetadata, {BoardElementMetadataRef} from \"./BoardElementDetails/BoardElementMetadata\";\n\ninterface RouteMatchParams {\n  uid: BoardId;\n}\n\ntype SideBySideDetailsProps = WithNamespaces & RouteComponentProps<RouteMatchParams>;\n\nlet syncTimer: number;\n\nconst SideBySideDetails = (props: SideBySideDetailsProps) => {\n  const dispatch = useDispatch();\n  const sidebar = useSelector(makeGetSidebarSelector());\n  const [collabsableRight, setCollabsableRight] = useState(calculateCollapsableRight(sidebar));\n  const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.match.params.uid), []);\n  const board = useSelector(getBoardByIdSelector);\n  const boardStickyTemplates = useSelector(makeBoardStickyTemplateMapSelector(props.match.params.uid));\n  const [isDragging, setIsDragging] = useState(false);\n  const elementsTree = useSelector(makeElementsTreeByBoardIdSelector(props.match.params.uid));\n  const visible =  ((board && board.shouldShowElementDetails) || false) && sidebar.sideBySideCell;\n  const boardElementMetadataRef = useRef<BoardElementMetadataRef|null>(null);\n  const [graph] = useGraph();\n\n  const activeGraphElement: ActiveGraphElement | null = useMemo(() => {\n    if(sidebar.sideBySideCell) {\n      const node = graph.getNode(sidebar.sideBySideCell);\n\n      if(!node) {\n        return null;\n      }\n\n      return graph.makeActiveGraphElementIfPossible(node);\n    }\n\n    return null;\n  }, [\n    sidebar.sideBySideCell\n  ])\n\n\n  useEffect(() => {\n    if(!isDragging) {\n      setCollabsableRight(calculateCollapsableRight(sidebar));\n    }\n  }, [sidebar.sideBySideWidth, sidebar.rightSidebarWidth]);\n\n  const handleCloseSideBySide = () => {\n    dispatch(setSideBySideCell(null));\n  }\n\n  const handleDragging = (e: DraggableEvent, data: DraggableData) => {\n    if(!isDragging) {\n      setIsDragging(true);\n    }\n\n    const newWidth = sidebar.sideBySideWidth - data.deltaX;\n\n    dispatch(setSideBySideWidth(newWidth));\n  }\n\n  const handleDragStop = (e: DraggableEvent, data: DraggableData) => {\n    setIsDragging(false);\n    setCollabsableRight(calculateCollapsableRight(sidebar));\n  }\n\n  let similarElements = List<string>();\n  let activeNodeSources: List<Node> = List();\n  let activeNodeTargets: List<Node> = List();\n\n  if(activeGraphElement && activeGraphElement.type !== NodeType.edge) {\n    const node = elementsTree.getElement(activeGraphElement.id) || makeNodeFromActiveGraphElement(activeGraphElement);\n    const similarElementsNodes = elementsTree.getSimilarElements(node)\n      .filter(ele => ele.getTags().contains(ispConst.TAG_CONNECTED));\n\n    similarElements = similarElementsNodes.map(ele => ele.getId());\n\n    const activeNode = elementsTree.getElement(activeGraphElement.id);\n\n    if(activeNode) {\n      activeNodeSources = activeNode.getSources();\n      activeNodeTargets = activeNode.getTargets();\n\n      let activeNodeSourcesIds = activeNodeSources.map(n => n.getId());\n      let activeNodeTargetsIds = activeNodeTargets.map(n => n.getId());\n\n      similarElementsNodes.forEach(se => {\n        const deduplicatedSources = se.getSources().filter(s => !activeNodeSourcesIds.contains(s.getId()));\n        const deduplicatedTargets = se.getTargets().filter(t => !activeNodeTargetsIds.contains(t.getId()));\n\n        activeNodeSources = activeNodeSources.push(...deduplicatedSources.toArray());\n        activeNodeSourcesIds = activeNodeSourcesIds.push(...deduplicatedSources.toArray().map(s => s.getId()));\n        activeNodeTargets = activeNodeTargets.push(...deduplicatedTargets.toArray());\n        activeNodeTargetsIds = activeNodeTargetsIds.push(...deduplicatedTargets.toArray().map(t => t.getId()));\n      })\n    }\n  }\n\n  if(activeGraphElement && activeGraphElement.type === NodeType.edge && activeGraphElement.edgeData) {\n    const activeSource = elementsTree.getElement(activeGraphElement.edgeData.source);\n    const activeTarget = elementsTree.getElement(activeGraphElement.edgeData.target);\n    if(activeSource) {\n      activeNodeSources = List([activeSource]);\n    }\n    if(activeTarget) {\n      activeNodeTargets = List([activeTarget]);\n    }\n  }\n\n  const handleUpdateMetadata = (editorValue: string, force?: boolean) => {\n    activeGraphElement!.metadata = editorValue;\n    activeGraphElement!.updateMetadata(editorValue, force);\n\n    if(isConnected(activeGraphElement!) && similarElements.count()) {\n\n      if(syncTimer) {\n        window.clearTimeout(syncTimer);\n      }\n\n      syncTimer = window.setTimeout(() => {\n        activeGraphElement!.updateSimilarElements(similarElements.toArray(), editorValue);\n      }, 300);\n    }\n  };\n\n  const handleDisconnectElement = (e: SyntheticEvent) => {\n    e.preventDefault();\n\n    if(activeGraphElement) {\n      if(activeGraphElement.locked) {\n        return;\n      }\n\n      activeGraphElement.replaceTags(markAsDisconnected(activeGraphElement));\n    }\n  }\n\n  const handleConnectElement = (e: SyntheticEvent) => {\n    e.preventDefault();\n\n    if(activeGraphElement) {\n      if(activeGraphElement.locked) {\n        return;\n      }\n\n      activeGraphElement.replaceTags(markAsConnected(activeGraphElement));\n    }\n  }\n\n  return <>{visible && <div id=\"side-by-side-sidebar\" style={{position: \"absolute\", paddingTop: \"50px\", top: \"0px\", right: sidebar.rightSidebarWidth + 5 + \"px\", height: \"100%\", overflow: \"hidden\", borderLeft:\"5px solid #eee\", zIndex: 99}}>\n    <Card style={{height: \"100%\", borderRadius:'0', width: sidebar.sideBySideWidth + 'px'}}>\n      <Card.Content>\n        <Card.Header><Icon name=\"close\" className=\"right floated\" onClick={handleCloseSideBySide} style={{cursor: \"pointer\"}} />\n          {activeGraphElement && <>{activeGraphElement!.label}</>}\n          {!activeGraphElement && <>Metadata</>}\n        </Card.Header>\n      </Card.Content>\n      <Card.Content style={{position: \"relative\", height: \"100%\", overflowY: \"auto\", display: \"flex\", flexDirection: \"column\"}}>\n        {!activeGraphElement && <Message info={true}>{props.t('insp.sidebar.element_details.no_element_selected')}</Message>}\n        {activeGraphElement && (\n          <BoardElementMetadata\n            boardId={props.match.params.uid}\n            board={board}\n            activeNodeSources={activeNodeSources}\n            activeNodeTargets={activeNodeTargets}\n            activeGraphElement={activeGraphElement}\n            similarElements={similarElements}\n            boardStickyTemplate={boardStickyTemplates.get(activeGraphElement.type as NodeType)!}\n            onTriggerCody={() => graph.triggerCody()}\n            onUpdateMetadata={handleUpdateMetadata}\n            onShowRunCody={() => { /* ignore */ }}\n            onClose={handleCloseSideBySide}\n            t={props.t}\n            ref={boardElementMetadataRef}\n            focusEditor={!!board.shouldFocusMetadataEditor}\n          />\n        )}\n      </Card.Content>\n    </Card>\n    <Draggable\n                axis=\"x\"\n                onDrag={handleDragging}\n                onStop={handleDragStop}\n                position={{x: 0, y: 0}}\n    >\n        <div className=\"thin collapsebar collapsible\" style={{right: collabsableRight + 'px', cursor: 'grabbing'}} />\n    </Draggable>\n  </div>}\n  </>\n};\n\nexport default withNamespaces()(withRouter(SideBySideDetails));\n\nconst calculateCollapsableRight = (sidebar: SidebarState): number => {\n  return sidebar.sideBySideWidth + 5 + sidebar.rightSidebarWidth;\n}\n\n\n","export const makeAsyncIterable = <T>(result: T): AsyncIterable<T> => {\n  return (async function* () {\n    yield result;\n  })();\n}\n","import {names} from \"../cody-wizard/node/names\";\n\nexport const playFQCNFromDefinitionId = (definitionId: string): string => {\n  const withoutPrefix = definitionId.replace('/definitions/', '');\n\n  const fqcnParts = withoutPrefix.split(\"/\");\n\n  return fqcnParts.map(p => names(p).className).join(\".\");\n}\n\nexport const playDefinitionIdFromFQCN = (fqcn: string): string => {\n  return '/definitions/' + fqcn\n    .split(\".\")\n    .map(r => names(r).fileName)\n    .join(\"/\");\n}\n","export const registryIdToDataReference = (registryId: string): string => {\n  return \"/\" + registryId.split(\".\").slice(1).join(\"/\");\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {isJsonSchemaArray} from \"../../cody-wizard/json-schema/is-json-schema-array\";\nimport {isJsonSchemaObject} from \"../../cody-wizard/json-schema/is-json-schema-object\";\nimport {isJsonSchemaPrimitive} from \"../../cody-wizard/json-schema/is-json-schema-primitive\";\nimport {isJsonSchemaRef} from \"../../cody-wizard/json-schema/is-json-schema-ref\";\nimport {Shorthand, ShorthandObject} from \"../../cody-wizard/schema/shorthand\";\nimport {playFQCNFromDefinitionId} from \"../../playshot/definition-id\";\nimport {registryIdToDataReference} from \"../../playshot/registry-id-to-data-reference\";\n\nexport const convertJsonSchemaToShorthandIfPossible = (jsonSchema: JSONSchema7): Shorthand | JSONSchema7 => {\n  const converted = tryToConvert(jsonSchema);\n\n  if(!converted) {\n    return jsonSchema;\n  }\n\n  return converted;\n}\n\nconst tryToConvert = (jsonSchema: JSONSchema7): Shorthand | false => {\n  if(isJsonSchemaObject(jsonSchema)) {\n    return convertObjToShorthand(jsonSchema);\n  }\n\n  if(isJsonSchemaArray(jsonSchema)) {\n    return convertArrayToShorthand(jsonSchema);\n  }\n\n  if(isJsonSchemaRef(jsonSchema)) {\n    return convertRefToShorthand(jsonSchema);\n  }\n\n  if(isJsonSchemaPrimitive(jsonSchema)) {\n    return convertScalarToShorthand(jsonSchema);\n  }\n\n  return false;\n}\n\nconst convertObjToShorthand = (jsonSchema: JSONSchema7): ShorthandObject | false => {\n  const required = jsonSchema.required || [];\n\n  if(!jsonSchema.properties) {\n    return false;\n  }\n\n  const shorthand: ShorthandObject = {};\n\n  // tslint:disable-next-line:forin\n  for (let propName in jsonSchema.properties) {\n    const shorthandProp = tryToConvert(jsonSchema.properties[propName] as JSONSchema7);\n\n    if(false === shorthandProp) {\n      return false;\n    }\n\n    if(!required.includes(propName)) {\n      propName += '?';\n    }\n\n    shorthand[propName] = shorthandProp;\n  }\n\n  if(jsonSchema.title) {\n    shorthand.$title = jsonSchema.title;\n  }\n\n  if(jsonSchema.default) {\n    shorthand.$default = jsonSchema.default as any;\n  }\n\n  return shorthand;\n}\n\nconst convertScalarToShorthand = (jsonSchema: JSONSchema7): Shorthand | false => {\n  const copy: any = {...jsonSchema};\n\n  if(!isJsonSchemaPrimitive(jsonSchema)) {\n    return false;\n  }\n\n  const type = copy.type;\n\n  delete copy.type;\n\n  if(copy.enum) {\n    return `enum:${copy.enum.join(\",\")}`\n  }\n\n  const options = Object.keys(copy);\n\n  let shorthandStr = type;\n\n  options.forEach(opt => {\n    shorthandStr += `|${opt}:${copy[opt]}`\n  })\n\n  return shorthandStr;\n}\n\nconst convertRefToShorthand = (jsonSchema: JSONSchema7): ShorthandObject | false => {\n  if(!jsonSchema.$ref) {\n    return false;\n  }\n\n  // Property ref\n  if(jsonSchema.$ref.includes(\":\")) {\n    return convertPropertyRefToShorthand(jsonSchema);\n  }\n\n  const fqcn = playFQCNFromDefinitionId(jsonSchema.$ref);\n\n  const shorthandObj: ShorthandObject = {\n    $ref: registryIdToDataReference(fqcn)\n  };\n\n  if(jsonSchema.title) {\n    shorthandObj.$title = jsonSchema.title;\n  }\n\n  if(jsonSchema.default) {\n    shorthandObj.$default = jsonSchema.default as any;\n  }\n\n  return shorthandObj;\n}\n\nconst convertPropertyRefToShorthand = (jsonSchema: JSONSchema7): ShorthandObject | false => {\n  if(!jsonSchema.$ref) {\n    return false;\n  }\n\n  // Property ref\n  if(!jsonSchema.$ref.includes(\":\")) {\n    return false;\n  }\n\n  const [ref, prop] = jsonSchema.$ref.split(\":\");\n\n  const fqcn = playFQCNFromDefinitionId(ref);\n\n  return {\n    $ref: registryIdToDataReference(fqcn) + `:${prop}`\n  }\n}\n\nconst convertArrayToShorthand = (jsonSchema: JSONSchema7): ShorthandObject | false => {\n  if(!isJsonSchemaArray(jsonSchema)) {\n    return false;\n  }\n\n  const items = tryToConvert(jsonSchema.items as JSONSchema7);\n\n  if(!items) {\n    return false;\n  }\n\n  let shorthandObj: ShorthandObject = {};\n\n  if(typeof items === \"object\" && items.$ref) {\n    shorthandObj = {\n      $items: items.$ref,\n    }\n  } else {\n    shorthandObj = {\n      $items: items\n    }\n  }\n\n  if(jsonSchema.title) {\n    shorthandObj.$title = jsonSchema.title;\n  }\n\n  if(jsonSchema.default) {\n    shorthandObj.$default = jsonSchema.default as any;\n  }\n\n  return shorthandObj;\n}\n","import {startCase} from \"lodash\";\nimport {Playshot} from \"../../model/Playshot\";\n\nexport const getService = (nodeData: object & {service?: string}, playshot: Playshot): string => {\n  return nodeData.service || getDefaultService(playshot);\n}\n\nexport const nodeLabel = (fqcn: string): string => {\n  const lastPart = fqcn.split(\".\").pop();\n\n  return startCase(lastPart || '');\n}\n\nexport const nodeService = (fqcn: string): string => {\n  const firstPart = fqcn.split(\".\").shift();\n\n  return firstPart || 'App';\n}\n\nexport const getDefaultService = (playshot: Playshot): string => {\n  return playshot.playConfig.defaultService || 'App';\n}\n\nexport const removeDefaultService = (fqcn: string, playshotOrDefaultService: string | Playshot): string => {\n  if(typeof playshotOrDefaultService !== \"string\") {\n    playshotOrDefaultService = playshotOrDefaultService.playConfig.defaultService;\n  }\n\n  const parts = fqcn.split(\".\");\n\n  if(parts.length && parts[0] === playshotOrDefaultService) {\n    parts.shift();\n  }\n\n  return parts.join(\".\");\n}\n","import {GraphPoint, Node} from \"../../../model/Graph\";\n\nexport const SPACING = 100;\nexport const CONNECT_SPACING = SPACING * 2;\nexport const Y_CTX_SPACING = 400;\nexport const X_SLICE_SPACING = SPACING;\nexport const Y_SLICE_SPACING = SPACING + 25;\nexport const SLICE_HEIGHT = 900;\n\n\nexport const getNextGeo = (addedNodes: {[nodeId: string]: Node}): GraphPoint => {\n  const addedNodesList = Object.values(addedNodes);\n\n  if(addedNodesList.length === 0) {\n    // Default padding\n    return {\n      x: SPACING,\n      y: Y_CTX_SPACING\n    }\n  }\n\n  const lastNode = addedNodesList.pop()!;\n\n  return {\n    x: lastNode.getGeometry().x + lastNode.getSize().width + 200,\n    y: Y_CTX_SPACING\n  }\n}\n\nexport const geoRight = (node: Node, spacing?: number): GraphPoint => {\n  const geo = node.getGeometry();\n  const size = node.getSize();\n\n  return {\n    x: geo.x + size.width + (typeof spacing === \"undefined\" ? CONNECT_SPACING : spacing),\n    y: geo.y,\n  }\n}\n\nexport const geoBelow = (node: Node, spacing?: number): GraphPoint => {\n  const geo = node.getGeometry();\n  const size = node.getSize();\n\n  return {\n    x: geo.x,\n    y: geo.y + size.height + (typeof spacing === \"undefined\" ? CONNECT_SPACING : spacing),\n  }\n}\n\nexport const geoAboveRight = (node: Node, xSpacing?: number, ySpacing?: number): GraphPoint => {\n  const geo = node.getGeometry();\n  const size = node.getSize();\n\n  return {\n    x: geo.x + size.width + (typeof xSpacing === \"undefined\" ? SPACING : xSpacing),\n    y: geo.y - (typeof ySpacing === \"undefined\" ? CONNECT_SPACING : ySpacing),\n  }\n}\n\nexport const geoBelowRight = (node: Node, xSpacing?: number, ySpacing?: number): GraphPoint => {\n  const geo = node.getGeometry();\n  const size = node.getSize();\n\n  return {\n    x: geo.x + size.width + (typeof xSpacing === \"undefined\" ? SPACING : xSpacing),\n    y: geo.y + size.height + (typeof ySpacing === \"undefined\" ? CONNECT_SPACING : ySpacing),\n  }\n}\n","import {omit} from \"lodash\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {AnyRule} from \"../../rule-definitions\";\nimport {PlayCommandRuntimeInfo} from \"./command-definitions\";\n\nexport const prepareDiffCommand = (command: PlayCommandRuntimeInfo, rules: AnyRule[]): object => {\n  return {\n    desc: omit(command.desc, ProophBoardDescriptionKeys),\n    schema: convertJsonSchemaToShorthandIfPossible(command.schema),\n    uiSchema: command.uiSchema,\n    factory: command.factory,\n    rules\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {makeNodeFromJs, NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {getNextGeo} from \"../graph-manipulation\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayCommandRuntimeInfo} from \"./command-definitions\";\nimport {prepareDiffCommand} from \"./prepare-diff-command\";\n\nexport class CommandAdded implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'NewCommand';\n  public readonly operation: PlayshotChangedOperation = 'added';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.command;\n  public readonly diff: PlayshotChangedDiff;\n\n  private newCommand: PlayCommandRuntimeInfo;\n\n  constructor(name: string, nodeId: string, command: PlayCommandRuntimeInfo, playshot: Playshot) {\n\n    const rules = playshot.playConfig.commandHandlers[command.desc.name] || [];\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffCommand(command, rules),\n      old: null,\n    };\n    this.newCommand = command;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = graph.getNode(this.nodeId);\n\n    if(existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the command seems to exist already on the board.`,\n        details: `There is at least an element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const rules = playshot.playConfig.commandHandlers[this.name] || [];\n\n    const node = makeNodeFromJs({\n      id: this.nodeId,\n      type: NodeType.command,\n      name: nodeLabel(this.name),\n      metadata: stringify(omit({\n        ...this.newCommand.desc,\n        schema: convertJsonSchemaToShorthandIfPossible(this.newCommand.schema),\n        uiSchema: this.newCommand.uiSchema,\n        rules,\n        // @TODO: handle factory\n      }, [\n        \"name\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    graph.addNode(node);\n    graph.switchParent(node, syncContext, getNextGeo(addedNodes), true);\n    graph.focusNode(node);\n\n    addedNodes[node.getId()] = graph.getNode(node.getId()) || node;\n\n    return makeAsyncIterable({\n      cody: `I've added a command card for \"${nodeLabel(this.name)}\" to the board`\n    });\n  }\n}\n","import {ElementsTree} from \"../../../model/ElementsTree\";\nimport {Graph, Node, NodeId, NodeType} from \"../../../model/Graph\";\nimport {nodeLabel, nodeService} from \"../../playshot/default-service\";\n\nexport const getNodeByIdOrFQCN = (nodeId: NodeId, fqcn: string, type: NodeType, graph: Graph, elementsTree: ElementsTree): Node | null => {\n  const node = graph.getNode(nodeId);\n\n  if(node) {\n    return node;\n  }\n\n  const service = nodeService(fqcn);\n\n  const matchingNodes = elementsTree.getFilteredElementsByTypeAndLabel(type, nodeLabel(fqcn), service);\n\n  return matchingNodes.first(null);\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayCommandRuntimeInfo} from \"./command-definitions\";\nimport {prepareDiffCommand} from \"./prepare-diff-command\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\n\nexport class CommandMetadataChanged implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'CommandMetadataChanged';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.command;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedCommand: PlayCommandRuntimeInfo;\n\n  constructor(name: string, nodeId: string, command: PlayCommandRuntimeInfo, newPlayshot: Playshot, oldPlayshot: Playshot) {\n\n    const newRules = newPlayshot.playConfig.commandHandlers[command.desc.name] || [];\n    let oldInfo = oldPlayshot.playConfig.commands[command.desc.name];\n\n    if(!oldInfo) {\n      oldInfo = command;\n    }\n\n    const oldRules = oldPlayshot.playConfig.commandHandlers[command.desc.name] || [];\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffCommand(command, newRules),\n      old: prepareDiffCommand(oldInfo, oldRules),\n    };\n    this.changedCommand = command;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.command, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the command cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const rules = playshot.playConfig.commandHandlers[this.name] || [];\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({\n      ...this.changedCommand.desc,\n      schema: convertJsonSchemaToShorthandIfPossible(this.changedCommand.schema),\n      uiSchema: this.changedCommand.uiSchema,\n      rules,\n      // @TODO: handle factory\n    }, [\n      \"name\",\n      ...ProophBoardDescriptionKeys\n    ])))\n\n\n    graph.focusNode(existingNode);\n\n\n    return makeAsyncIterable({\n      cody: `I've updated metadata of command card \"${nodeLabel(this.name)}\".`\n    });\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {getService, nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayCommandRuntimeInfo} from \"./command-definitions\";\nimport {prepareDiffCommand} from \"./prepare-diff-command\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\n\nexport class CommandRenamed implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'CommandRenamed';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.command;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedCommand: PlayCommandRuntimeInfo;\n  private oldName: string;\n  private newName: string;\n\n  constructor(newName: string, nodeId: string, command: PlayCommandRuntimeInfo, oldCommand: PlayCommandRuntimeInfo, newPlayshot: Playshot, oldPlayshot: Playshot) {\n    this.newName = newName;\n    this.oldName = oldCommand.desc.name;\n\n\n    const newRules = newPlayshot.playConfig.commandHandlers[command.desc.name] || [];\n    let oldInfo = oldPlayshot.playConfig.commands[this.oldName];\n\n    if(!oldInfo) {\n      oldInfo = command;\n    }\n\n    const oldRules = oldPlayshot.playConfig.commandHandlers[this.oldName] || [];\n\n    this.name = this.newName;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffCommand(command, newRules),\n      old: prepareDiffCommand(oldInfo, oldRules),\n    };\n    this.changedCommand = command;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.command, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the command cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const rules = playshot.playConfig.commandHandlers[this.name] || [];\n    const service = getService(this.changedCommand.desc, playshot)\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({\n      ...this.changedCommand.desc,\n      service,\n      schema: convertJsonSchemaToShorthandIfPossible(this.changedCommand.schema),\n      uiSchema: this.changedCommand.uiSchema,\n      rules,\n      // @TODO: handle factory\n    }, [\n      \"name\",\n      ...ProophBoardDescriptionKeys\n    ])));\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    graph.changeNodeName(existingNode, nodeLabel(this.newName));\n\n    similarNodes.forEach(sN => {\n      graph.changeNodeName(sN, nodeLabel(this.newName));\n    })\n\n    graph.focusNode(existingNode);\n\n    return makeAsyncIterable({\n      cody: `I've renamed the command \"${nodeLabel(this.newName)}\" and updated its metadata.`\n    });\n  }\n}\n","import {CODY_APPLY_PAUSE} from \"../../components/MxGraphBoard/PlayshotModal\";\nimport {CodyResponse, CodyResponseType} from \"../Cody\";\n\n\nexport interface ApplyTask {\n  name: string;\n  func: () => Promise<CodyResponse>\n}\n\nexport const makeApplyTask = (name: string, func: () => Promise<CodyResponse>): ApplyTask => {\n  return {\n    name,\n    func\n  }\n}\n\nexport const runApplyTasks = async (tasks: ApplyTask[]): Promise<AsyncIterable<CodyResponse>> => {\n  let lastResponseWasError = false;\n  return {\n    [Symbol.asyncIterator] () {\n      return {\n        async next() {\n          const nextTask = tasks.shift();\n\n          if(nextTask && !lastResponseWasError) {\n            const res = await nextTask.func();\n\n            lastResponseWasError = res.type === CodyResponseType.Error;\n\n            return new Promise(resolve => {\n              window.setTimeout(() => {\n                resolve({done: false, value: res});\n              }, tasks.length > 0 && res.type === CodyResponseType.Info || !res.type ? CODY_APPLY_PAUSE : 0);\n            })\n          } else {\n            return new Promise((resolve) => {\n              resolve({done: true, value: {\n                cody: `All tasks applied!`\n              }})\n            })\n          }\n        }\n      }\n    }\n  }\n}\n","import {startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ApplyTask, runApplyTasks} from \"../../run-apply-tasks\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayCommandRuntimeInfo} from \"./command-definitions\";\nimport {prepareDiffCommand} from \"./prepare-diff-command\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\n\nexport class CommandRemoved implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'CommandRemoved';\n  public readonly operation: PlayshotChangedOperation = 'removed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.command;\n  public readonly diff: PlayshotChangedDiff;\n\n  constructor(name: string, nodeId: string, command: PlayCommandRuntimeInfo, oldPlayshot: Playshot) {\n\n    const rules = oldPlayshot.playConfig.commandHandlers[command.desc.name] || [];\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: null,\n      old: prepareDiffCommand(command, rules),\n    };\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.command, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the command cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    const applyTasks: ApplyTask[] = [\n      {\n        name: \"Focus command to remove\",\n        func: async () => {\n          graph.focusNode(existingNode);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      },\n      {\n        name: \"Remove command\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(existingNode);\n\n              resolve({\n                cody: `I've removed the command card for \"${nodeLabel(this.name)}\" from the board`\n              });\n            }, 1500);\n          })\n        }\n      }\n    ];\n\n    similarNodes.forEach(sN => {\n      applyTasks.push({\n        name: \"Focus command to remove\",\n        func: async () => {\n          graph.focusNode(sN);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      });\n      applyTasks.push({\n        name: \"Remove command\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(sN);\n\n              resolve({\n                cody: ``,\n                type: CodyResponseType.Empty\n              });\n            }, 1500);\n          })\n        }\n      })\n    })\n\n    return runApplyTasks(applyTasks)\n  }\n}\n","import {omit} from \"lodash\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {AnyRule} from \"../../rule-definitions\";\nimport {PlayEventRuntimeInfo} from \"./event-definitions\";\n\nexport const prepareDiffEvent = (event: PlayEventRuntimeInfo, applyRules?: AnyRule[]): object => {\n  return {\n    desc: omit(event.desc, ProophBoardDescriptionKeys),\n    schema: convertJsonSchemaToShorthandIfPossible(event.schema),\n    factory: event.factory,\n    applyRules\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph, makeNodeFromJs, Node, NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {getNextGeo} from \"../graph-manipulation\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayEventRuntimeInfo} from \"./event-definitions\";\nimport {prepareDiffEvent} from \"./prepare-diff-event\";\n\nexport class EventAdded implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'NewEvent';\n  public readonly operation: PlayshotChangedOperation = 'added';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.event;\n  public readonly diff: PlayshotChangedDiff;\n\n  private newEvent: PlayEventRuntimeInfo;\n\n  constructor(name: string, nodeId: string, event: PlayEventRuntimeInfo, playshot: Playshot) {\n\n    // @TODO: handle aggregate event\n    const applyRules = undefined; /* = playshot.playConfig.eventReducers[event.desc.name]; */\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffEvent(event, applyRules),\n      old: null,\n    };\n    this.newEvent = event;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = graph.getNode(this.nodeId);\n\n    if(existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the event seems to exist already on the board.`,\n        details: `There is at least an element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const node = makeNodeFromJs({\n      id: this.nodeId,\n      type: NodeType.event,\n      name: nodeLabel(this.name),\n      metadata: stringify(omit({\n        ...this.newEvent.desc,\n        schema: convertJsonSchemaToShorthandIfPossible(this.newEvent.schema),\n        // @TODO: handle factory\n      }, [\n        \"name\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    graph.addNode(node);\n    graph.switchParent(node, syncContext, getNextGeo(addedNodes), true);\n    graph.focusNode(node);\n\n    addedNodes[node.getId()] = graph.getNode(node.getId()) || node;\n\n    return makeAsyncIterable({\n      cody: `I've added an event card for \"${nodeLabel(this.name)}\" to the board`\n    });\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayEventRuntimeInfo} from \"./event-definitions\";\nimport {prepareDiffEvent} from \"./prepare-diff-event\";\n\nexport class EventMetadataChanged implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'EventMetadataChanged';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.event;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedEvent: PlayEventRuntimeInfo;\n\n  constructor(name: string, nodeId: string, event: PlayEventRuntimeInfo, newPlayshot: Playshot, oldPlayshot: Playshot) {\n\n    // @TODO: handle aggregate event\n    const newApplyRules = undefined; /* = playshot.playConfig.eventReducers[event.desc.name]; */\n    const oldApplyRules = undefined;\n\n    let oldEvent = oldPlayshot.playConfig.events[event.desc.name];\n\n    if(!oldEvent) {\n      oldEvent = event;\n    }\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffEvent(event, newApplyRules),\n      old: prepareDiffEvent(oldEvent, oldApplyRules),\n    };\n    this.changedEvent = event;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.event, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the event cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    // @TODO: handle aggregate event\n    const newApplyRules = undefined; /* = playshot.playConfig.eventReducers[event.desc.name]; */\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({\n      ...this.changedEvent.desc,\n      schema: convertJsonSchemaToShorthandIfPossible(this.changedEvent.schema),\n      // @TODO: handle factory\n    }, [\n      \"name\",\n      ...ProophBoardDescriptionKeys\n    ])))\n\n    graph.focusNode(existingNode);\n\n    return makeAsyncIterable({\n      cody: `I've changed event metadata of \"${nodeLabel(this.name)}\".`\n    });\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {getService, nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayEventRuntimeInfo} from \"./event-definitions\";\nimport {prepareDiffEvent} from \"./prepare-diff-event\";\n\nexport class EventRenamed implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'EventRenamed';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.event;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedEvent: PlayEventRuntimeInfo;\n  private oldName: string;\n  private newName: string;\n\n  constructor(newName: string, nodeId: string, event: PlayEventRuntimeInfo, oldEvent: PlayEventRuntimeInfo, newPlayshot: Playshot, oldPlayshot: Playshot) {\n    this.newName = newName;\n    this.oldName = oldEvent.desc.name;\n\n    // @TODO: handle aggregate event\n    const newApplyRules = undefined; /* = playshot.playConfig.eventReducers[event.desc.name]; */\n    const oldApplyRules = undefined;\n\n    this.name = newName;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffEvent(event, newApplyRules),\n      old: prepareDiffEvent(oldEvent, oldApplyRules),\n    };\n\n    this.changedEvent = event;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.event, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the event cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    // @TODO: handle aggregate event\n    const newApplyRules = undefined; /* = playshot.playConfig.eventReducers[event.desc.name]; */\n\n    const service = getService(this.changedEvent.desc, playshot)\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({\n      ...this.changedEvent.desc,\n      service,\n      schema: convertJsonSchemaToShorthandIfPossible(this.changedEvent.schema),\n      // @TODO: handle factory\n    }, [\n      \"name\",\n      ...ProophBoardDescriptionKeys\n    ])))\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    graph.changeNodeName(existingNode, nodeLabel(this.newName));\n\n    similarNodes.forEach(sN => {\n      graph.changeNodeName(sN, nodeLabel(this.newName));\n    })\n\n    graph.focusNode(existingNode);\n\n    return makeAsyncIterable({\n      cody: `I've renamed the event \"${nodeLabel(this.name)}\" and updated its metadata.`\n    });\n  }\n}\n","import {startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ApplyTask, runApplyTasks} from \"../../run-apply-tasks\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayEventRuntimeInfo} from \"./event-definitions\";\nimport {prepareDiffEvent} from \"./prepare-diff-event\";\n\nexport class EventRemoved implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'EventRemoved';\n  public readonly operation: PlayshotChangedOperation = 'removed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.event;\n  public readonly diff: PlayshotChangedDiff;\n\n  constructor(name: string, nodeId: string, event: PlayEventRuntimeInfo, oldPlayshot: Playshot) {\n\n    // @TODO: handle aggregate event\n    const applyRules = undefined; /* = playshot.playConfig.eventReducers[event.desc.name]; */\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: null,\n      old: prepareDiffEvent(event, applyRules),\n    };\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.event, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the event cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    const applyTasks: ApplyTask[] = [\n      {\n        name: \"Focus event to remove\",\n        func: async () => {\n          graph.focusNode(existingNode);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      },\n      {\n        name: \"Remove event\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(existingNode);\n\n              resolve({\n                cody: `I've removed the event card for \"${nodeLabel(this.name)}\" from the board`\n              });\n\n              return\n            }, 1500);\n          })\n        }\n      }\n    ];\n\n    similarNodes.forEach(sN => {\n      applyTasks.push({\n        name: \"Focus event to remove\",\n        func: async () => {\n          graph.focusNode(sN);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      });\n      applyTasks.push({\n        name: \"Remove event\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(sN);\n\n              resolve({\n                cody: ``,\n                type: CodyResponseType.Empty\n              });\n            }, 1500);\n          })\n        }\n      })\n    })\n\n    return runApplyTasks(applyTasks)\n  }\n}\n","import {CodyResponse, CodyResponseType} from \"../Cody\";\n\nexport const playIsCodyError =(err: any): err is CodyResponse => {\n  if(err && typeof err === 'object') {\n    // eslint-disable-next-line no-prototype-builtins\n    return err.hasOwnProperty('cody') && err.hasOwnProperty('type') && err.type === CodyResponseType.Error;\n  }\n\n  return false;\n}\n\nexport const playIsCodyWarning =(warning: any): warning is CodyResponse => {\n  if(warning && typeof warning === 'object') {\n    // eslint-disable-next-line no-prototype-builtins\n    return warning.hasOwnProperty('cody') && warning.hasOwnProperty('type') && warning.type === CodyResponseType.Warning;\n  }\n\n  return false;\n}\n\nexport class CodyResponseException extends Error {\n  public codyResponse: CodyResponse;\n\n  constructor(error: CodyResponse) {\n    super();\n    this.codyResponse = error;\n  }\n}\n\nexport const playwithErrorCheck = <T extends (...args: any) => any>(func: T, args: Parameters<T>): Exclude<ReturnType<T>, CodyResponse> => {\n  const res = func.apply(func, args);\n\n  if(playIsCodyError(res)) {\n    throw new CodyResponseException(res);\n  }\n\n  return res;\n}\n","import {JSONSchema7} from \"json-schema\";\nimport {omit} from \"lodash\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {\n  ThenDeleteProjection,\n  ThenInsertProjection, ThenReplaceProjection,\n  ThenUpdateProjection,\n  ThenUpsertProjection\n} from \"../../../cody-wizard/rule-engine/configuration\";\nimport {Shorthand} from \"../../../cody-wizard/schema/shorthand\";\nimport {UiSchema} from \"../../../cody-wizard/ui/ui-schema\";\nimport {ProjectionConfig, ProjectionConfigCase} from \"../../../cody-wizard/vo/get-vo-metadata\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {playwithErrorCheck} from \"../../cody-error\";\nimport {ProophBoardDescriptionKeys, ResolveConfig} from \"../../descriptions\";\nimport {AnyRule, ThenType} from \"../../rule-definitions\";\nimport {PlayEventPolicyDescription} from \"../policies/policy-definitions\";\nimport {PlayInformationRuntimeInfo, PlayQueryRuntimeInfo} from \"./information-definitions\";\nimport {cloneDeepJSON} from \"../../../json/json-comment-wrapper\";\n\nexport interface PreparedInformation {\n  desc: object,\n  schema: Shorthand | JSONSchema7,\n  initialize: AnyRule[],\n  uiSchema?: UiSchema,\n  querySchema?: Shorthand | JSONSchema7,\n  resolve?: ResolveConfig,\n  projection?: ProjectionConfig\n}\n\nexport const prepareDiffInformation = (information: PlayInformationRuntimeInfo, playshot: Playshot): PreparedInformation => {\n  let queryInfo: PlayQueryRuntimeInfo | undefined;\n  let resolve: ResolveConfig | undefined;\n\n  Object.values(playshot.playConfig.queries).forEach(qInfo => {\n    if (qInfo.desc.returnType === information.desc.name) {\n      queryInfo = qInfo;\n    }\n  })\n\n  if(queryInfo) {\n    resolve = playshot.playConfig.resolvers[queryInfo.desc.name];\n  }\n\n  return {\n    desc: omit(information.desc, ProophBoardDescriptionKeys),\n    schema: convertJsonSchemaToShorthandIfPossible(information.schema),\n    uiSchema: information.uiSchema,\n    initialize: information.factory,\n    querySchema: queryInfo ? convertJsonSchemaToShorthandIfPossible(queryInfo.schema) : undefined,\n    resolve,\n    projection: collectProjectionConfig(information, playshot)\n  }\n}\n\nconst collectProjectionConfig = (information: PlayInformationRuntimeInfo, playshot: Playshot): ProjectionConfig | undefined => {\n  if(!information.desc.projection) {\n    return;\n  }\n\n  const prjName = information.desc.projection;\n\n  const cases: ProjectionConfigCase[] = [];\n\n  let live = true;\n\n  // tslint:disable-next-line:forin\n  for (const eventName in playshot.playConfig.eventPolicies) {\n    const eventPolicies = playshot.playConfig.eventPolicies[eventName];\n\n    if(eventPolicies[prjName]) {\n      live = !!eventPolicies[prjName].live;\n      cases.push(playwithErrorCheck(convertEventProjectionCaseToProjectionConfig, [{eventName, desc: eventPolicies[prjName]}]));\n    }\n  }\n\n  if(cases.length === 0) {\n    return;\n  }\n\n  return {\n    name: prjName,\n    live,\n    cases\n  }\n}\n\nconst convertEventProjectionCaseToProjectionConfig = (eventCase: {eventName: string, desc: PlayEventPolicyDescription}): ProjectionConfigCase | CodyResponse => {\n  eventCase = cloneDeepJSON(eventCase);\n\n  const rules = eventCase.desc.rules;\n\n  const thenRule = rules.pop();\n\n  if(!thenRule) {\n    return {\n      cody: `Can't resolve projection configuartion for \"${eventCase.desc.projection}\". The event case \"${eventCase.eventName}\" has no rules defined.`,\n      details: `Either the playshot config is broken or it is a bug in Cody Play. If you can't resolve the issue yourself, please contact the prooph board team!`,\n      type: CodyResponseType.Error\n    }\n  }\n\n  const given = rules.length > 0 ? rules : undefined;\n  const then = playwithErrorCheck(convertThenProjection, [thenRule.then, eventCase]);\n\n  return {\n    given,\n    when: eventCase.eventName,\n    then\n  }\n}\n\nconst allowedOperations = ['insert', 'upsert', 'update', 'replace', 'delete'];\n\nconst convertThenProjection = (then: ThenType, eventCase: {eventName: string, desc: PlayEventPolicyDescription}): ThenInsertProjection | ThenUpsertProjection | ThenUpdateProjection | ThenReplaceProjection | ThenDeleteProjection | CodyResponse => {\n  const operation = Object.keys(then).pop() || '';\n\n  if(!allowedOperations.includes(operation)) {\n    return {\n      cody: `Can't resolve projection configuartion for \"${eventCase.desc.projection}\". The event case \"${eventCase.eventName}\" has no valid rules defined.`,\n      details: `Either the playshot config is broken or it is a bug in Cody Play. If you can't resolve the issue yourself, please contact the prooph board team!`,\n      type: CodyResponseType.Error\n    }\n  }\n\n  return {\n    [operation]: omit((then as any)[operation], \"information\")\n  } as ThenInsertProjection | ThenUpsertProjection | ThenUpdateProjection | ThenReplaceProjection | ThenDeleteProjection;\n}\n\n\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph, makeNodeFromJs, Node, NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {getNextGeo} from \"../graph-manipulation\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayInformationRuntimeInfo} from \"./information-definitions\";\nimport {prepareDiffInformation, PreparedInformation} from \"./prepare-diff-information\";\n\nexport class InformationAdded implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'NewInformation';\n  public readonly operation: PlayshotChangedOperation = 'added';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.document;\n  public readonly diff: PlayshotChangedDiff;\n\n  private newInformation: PreparedInformation;\n\n  constructor(name: string, nodeId: string, vo: PlayInformationRuntimeInfo, playshot: Playshot) {\n    this.name = name;\n    this.nodeId = nodeId;\n    this.newInformation = prepareDiffInformation(vo, playshot);\n    this.diff = {\n      new: this.newInformation,\n      old: null,\n    };\n\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = graph.getNode(this.nodeId);\n\n    if(existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the information seems to exist already on the board.`,\n        details: `There is at least an element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n\n    const node = makeNodeFromJs({\n      id: this.nodeId,\n      type: NodeType.document,\n      name: nodeLabel(this.name),\n      metadata: stringify(omit({\n        ...this.newInformation.desc,\n        schema: this.newInformation.schema,\n        uiSchema: this.newInformation.uiSchema,\n        querySchema: this.newInformation.querySchema,\n        resolve: this.newInformation.resolve,\n        projection: this.newInformation.projection,\n        initialize: this.newInformation.initialize,\n      }, [\n        \"name\",\n      ]))\n    })\n\n    graph.addNode(node);\n    graph.switchParent(node, syncContext, getNextGeo(addedNodes), true);\n    graph.focusNode(node);\n\n    addedNodes[node.getId()] = graph.getNode(node.getId()) || node;\n\n    return makeAsyncIterable({\n      cody: `I've added an information card for \"${nodeLabel(this.name)}\" to the board`\n    });\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayInformationRuntimeInfo} from \"./information-definitions\";\nimport {prepareDiffInformation, PreparedInformation} from \"./prepare-diff-information\";\n\nexport class InformationMetadataChanged implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'InformationMetadataChanged';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.document;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedInformation: PreparedInformation;\n\n  constructor(name: string, nodeId: string, information: PlayInformationRuntimeInfo, newPlayshot: Playshot, oldPlayshot: Playshot) {\n\n    let oldInfo = oldPlayshot.playConfig.types[information.desc.name];\n\n    if(!oldInfo) {\n      oldInfo = information;\n    }\n\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffInformation(information, newPlayshot),\n      old: prepareDiffInformation(oldInfo, oldPlayshot),\n    };\n    this.changedInformation = prepareDiffInformation(information, newPlayshot);\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.document, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the information cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({\n      ...this.changedInformation.desc,\n      schema: this.changedInformation.schema,\n      uiSchema: this.changedInformation.uiSchema,\n      querySchema: this.changedInformation.querySchema,\n      resolve: this.changedInformation.resolve,\n      projection: this.changedInformation.projection,\n      initialize: this.changedInformation.initialize,\n    }, [\n      \"name\",\n    ])))\n\n\n    graph.focusNode(existingNode);\n\n\n    return makeAsyncIterable({\n      cody: `I've updated metadata of information card \"${nodeLabel(this.name)}\".`\n    });\n  }\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {getService, nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayInformationRuntimeInfo} from \"./information-definitions\";\nimport {prepareDiffInformation, PreparedInformation} from \"./prepare-diff-information\";\n\nexport class InformationRenamed implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'InformationRenamed';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.document;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedInformation: PreparedInformation;\n  private oldName: string;\n  private newName: string;\n\n  constructor(newName: string, nodeId: string, information: PlayInformationRuntimeInfo, oldInformation: PlayInformationRuntimeInfo, newPlayshot: Playshot, oldPlayshot: Playshot) {\n    this.newName = newName;\n    this.oldName = oldInformation.desc.name;\n\n    this.name = this.newName;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: prepareDiffInformation(information, newPlayshot),\n      old: prepareDiffInformation(oldInformation, oldPlayshot),\n    };\n    this.changedInformation = prepareDiffInformation(information, newPlayshot);\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.document, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the information cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const service = getService(this.changedInformation.desc, playshot)\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({\n      ...this.changedInformation.desc,\n      schema: this.changedInformation.schema,\n      uiSchema: this.changedInformation.uiSchema,\n      querySchema: this.changedInformation.querySchema,\n      resolve: this.changedInformation.resolve,\n      projection: this.changedInformation.projection,\n      initialize: this.changedInformation.initialize,\n    }, [\n      \"name\",\n    ])));\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    graph.changeNodeName(existingNode, nodeLabel(this.newName));\n\n    similarNodes.forEach(sN => {\n      graph.changeNodeName(sN, nodeLabel(this.newName));\n    })\n\n    graph.focusNode(existingNode);\n\n    return makeAsyncIterable({\n      cody: `I've renamed the information \"${nodeLabel(this.newName)}\" and updated its metadata.`\n    });\n  }\n}\n","import {startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ApplyTask, runApplyTasks} from \"../../run-apply-tasks\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PlayInformationRuntimeInfo} from \"./information-definitions\";\nimport {prepareDiffInformation} from \"./prepare-diff-information\";\n\nexport class InformationRemoved implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'InformationRemoved';\n  public readonly operation: PlayshotChangedOperation = 'removed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.document;\n  public readonly diff: PlayshotChangedDiff;\n\n  constructor(name: string, nodeId: string, information: PlayInformationRuntimeInfo, oldPlayshot: Playshot) {\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: null,\n      old: prepareDiffInformation(information, oldPlayshot),\n    };\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.document, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the information cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    const applyTasks: ApplyTask[] = [\n      {\n        name: \"Focus information to remove\",\n        func: async () => {\n          graph.focusNode(existingNode);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      },\n      {\n        name: \"Remove information\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(existingNode);\n\n              resolve({\n                cody: `I've removed the information card for \"${nodeLabel(this.name)}\" from the board`\n              })\n            }, 1500);\n          })\n        }\n      }\n    ];\n\n    similarNodes.forEach(sN => {\n      applyTasks.push({\n        name: \"Focus information to remove\",\n        func: async () => {\n          graph.focusNode(sN);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      });\n      applyTasks.push({\n        name: \"Remove information\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(sN);\n\n              resolve({\n                cody: ``,\n                type: CodyResponseType.Empty\n              });\n            }, 1500);\n          })\n        }\n      })\n    })\n\n    return runApplyTasks(applyTasks)\n  }\n}\n","import {PartialSelect, SortOrder} from \"./document-store-types\";\nimport {Filter} from \"./filter-types\";\n\nexport type RuleType = 'always' | 'condition';\n\nexport type AnyRule = AlwaysRule | ConditionRule;\n\nexport interface Rule {\n  rule: RuleType;\n  then: ThenType;\n}\n\nexport type AlwaysRule = Rule\n\nexport type ConditionRule = IfConditionRule | IfNotConditionRule;\n\nexport interface IfConditionRule extends Rule {\n  if: string;\n  else?: ThenType;\n  stop?: boolean;\n}\n\nexport const isIfConditionRule = (rule: any): rule is IfConditionRule => {\n  return typeof rule.if !== \"undefined\";\n}\n\nexport interface IfNotConditionRule extends Rule {\n  if_not: string;\n  else?: ThenType;\n  stop?: boolean;\n}\n\nexport const isIfNotConditionRule = (rule: any): rule is IfNotConditionRule => {\n  return typeof rule.if_not !== \"undefined\";\n}\n\nexport type ThenType = ThenRecordEvent | ThenThrowError | ThenAssignVariable | ThenTriggerCommand | ThenCallService\n  | ThenExecuteRules\n  | ThenForEach\n  | ThenFilter\n  | ThenFindInformation | ThenFindPartialInformation | ThenFindOneInformation | ThenFindOnePartialInformation\n  | ThenFindInformationById | ThenFindPartialInformationById\n  | ThenCountInformation\n  | ThenInsertInformation | ThenUpsertInformation | ThenUpdateInformation | ThenReplaceInformation | ThenDeleteInformation\n  | ThenLookupUsers | ThenLookupUser\n  | ThenLogMessage;\n\nexport interface PropMapping {[name: string]: string | string[] | PropMapping | PropMapping[]}\n\nexport interface ThenFilter {\n  filter: Filter;\n}\n\nexport const isFilter = (then: ThenType & {filter?: Filter}): then is ThenFilter => typeof then.filter !== 'undefined';\n\nexport interface ThenForEach {\n  forEach: {\n    variable: string;\n    then: ThenType;\n  }\n}\n\nexport const isForEach = (then: any): then is ThenForEach => typeof then.forEach !== 'undefined';\n\nexport interface ThenRecordEvent {\n  record: {\n    event: string;\n    mapping: string | PropMapping;\n    meta?: string | PropMapping;\n  }\n}\n\nexport const isRecordEvent = (then: any): then is ThenRecordEvent => typeof then.record !== 'undefined';\n\nexport interface ThenThrowError {\n  throw: {\n    error: string\n  }\n}\n\nexport const isThrowError = (then: any): then is ThenThrowError => typeof then.throw !== 'undefined';\n\nexport interface ThenAssignVariable {\n  assign: {\n    variable: string;\n    value: string | PropMapping;\n  }\n}\n\nexport const isAssignVariable = (then: any): then is ThenAssignVariable => typeof then.assign !== 'undefined';\n\nexport interface ThenTriggerCommand {\n  trigger: {\n    command: string;\n    mapping: string | PropMapping;\n    meta?: string | PropMapping;\n  }\n}\n\nexport const isTriggerCommand = (then: any): then is ThenTriggerCommand => typeof then.trigger !== 'undefined';\n\nexport interface ThenCallService {\n  call: {\n    service: string;\n    arguments?: string | PropMapping;\n    method?: string;\n    async?: boolean;\n    result?: {\n      variable: string;\n      mapping?: string | PropMapping;\n    }\n  }\n}\n\nexport const isCallService = (then: any): then is ThenCallService => typeof then.call !== 'undefined';\n\nexport interface ThenFindInformation {\n  find: {\n    information: string;\n    filter: Filter;\n    skip?: number;\n    limit?: number;\n    orderBy?: SortOrder;\n    variable?: string;\n  }\n}\n\nexport const isFindInformation = (then: any): then is ThenFindInformation => typeof then.find !== \"undefined\";\n\nexport interface ThenFindPartialInformation {\n  findPartial: {\n    information: string;\n    select: PartialSelect;\n    filter: Filter;\n    skip?: number;\n    limit?: number;\n    orderBy?: SortOrder;\n    variable?: string;\n  }\n}\n\nexport const isFindPartialInformation = (then: any): then is ThenFindPartialInformation => typeof then.findPartial !== \"undefined\";\n\nexport interface ThenFindInformationById {\n  findById: {\n    information: string;\n    id: string;\n    variable?: string;\n  }\n}\n\nexport const isFindInformationById = (then: any): then is ThenFindInformationById => typeof then.findById !== \"undefined\";\n\nexport interface ThenFindOneInformation {\n  findOne: {\n    information: string;\n    filter: Filter;\n    variable?: string;\n  }\n}\n\nexport const isFindOneInformation = (then: any): then is ThenFindOneInformation => typeof then.findOne !== \"undefined\";\n\nexport interface ThenFindPartialInformationById {\n  findPartialById: {\n    information: string;\n    id: string;\n    select: PartialSelect;\n    variable?: string;\n  }\n}\n\nexport const isFindPartialInformationById = (then: any): then is ThenFindPartialInformationById => typeof then.findPartialById !== \"undefined\";\n\nexport interface ThenFindOnePartialInformation {\n  findOnePartial: {\n    information: string;\n    select: PartialSelect;\n    filter: Filter;\n    variable?: string;\n  }\n}\n\nexport const isFindOnePartialInformation = (then: any): then is ThenFindOnePartialInformation => typeof then.findOnePartial !== \"undefined\";\n\nexport interface ThenLookupUsers {\n  lookup: {\n    users: {\n      filter: Filter,\n      skip?: number;\n      limit?: number;\n      orderBy?: SortOrder;\n      variable?: string;\n    }\n  }\n}\n\nexport const isLookupUsers = (then: any): then is ThenLookupUsers => typeof then.lookup === \"object\" && typeof then.lookup.users !== \"undefined\";\n\nexport interface ThenLookupUser {\n  lookup: {\n    user: string,\n    variable?: string,\n  }\n}\n\nexport const isLookupUser = (then: any): then is ThenLookupUser => typeof then.lookup === \"object\" && typeof then.lookup.user !== \"undefined\";\n\nexport interface ThenCountInformation {\n  count: {\n    information: string;\n    filter: Filter;\n    variable?: string;\n  }\n}\n\nexport const isCountInformation = (then: any): then is ThenCountInformation => typeof then.count !== \"undefined\";\n\nexport interface ThenInsertInformation {\n  insert: {\n    information: string;\n    id: string;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport const isInsertInformation = (then: any): then is ThenInsertInformation => typeof then.insert !== 'undefined';\n\nexport interface ThenUpsertInformation {\n  upsert: {\n    information: string;\n    id: string;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n  }\n}\n\nexport const isUpsertInformation = (then: any): then is ThenUpsertInformation => typeof then.upsert !== 'undefined';\n\nexport interface ThenUpdateInformation {\n  update: {\n    information: string;\n    filter: Filter;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n    loadDocIntoVariable?: string;\n  }\n}\n\nexport const isUpdateInformation = (then: any): then is ThenUpdateInformation => typeof then.update !== 'undefined';\n\nexport interface ThenReplaceInformation {\n  replace: {\n    information: string;\n    filter: Filter;\n    set: string | PropMapping;\n    meta?: string | PropMapping;\n    version?: number;\n    loadDocIntoVariable?: string;\n  }\n}\n\nexport const isReplaceInformation = (then: any): then is ThenReplaceInformation => typeof then.replace !== 'undefined';\n\nexport interface ThenDeleteInformation {\n  delete: {\n    information: string;\n    filter: Filter;\n  }\n}\n\nexport const isDeleteInformation = (then: any): then is ThenDeleteInformation => typeof then.delete !== 'undefined';\n\nexport interface ThenExecuteRules {\n  execute: {\n    rules: Rule[]\n  }\n}\n\nexport const isExecuteRules = (then: any): then is ThenExecuteRules => typeof then.execute !== 'undefined';\n\nexport interface ThenLogMessage {\n  log: {\n    msg: string | string[],\n    logLevel?: 'info' | 'error' | 'warn'\n  }\n}\n\nexport const isLogMessage = (then: any): then is ThenLogMessage => typeof then.log !== 'undefined';\n\ntype Visitor = (then: ThenType) => ThenType;\n\nexport const visitRulesThen = (rules: Rule[], visitor: Visitor): Rule[] => {\n  return rules.map(rule => visitRuleThen(rule, visitor));\n}\n\nexport const visitRuleThen = (rule: Rule, visitor: Visitor): Rule => {\n  const clonedRule = {...rule};\n  if(isIfConditionRule(rule) || isIfNotConditionRule(rule)) {\n    if(rule.else && (isIfConditionRule(clonedRule) || isIfNotConditionRule(clonedRule))) {\n      clonedRule.else = visitThen(rule.else, visitor);\n    }\n  }\n  clonedRule.then = visitThen(rule.then, visitor);\n\n  return clonedRule;\n}\n\nconst visitThen = (then: ThenType, visitor: Visitor): ThenType => {\n  then = visitor(then);\n\n  if(isExecuteRules(then)) {\n    return {execute: {rules: visitRulesThen(then.execute.rules, visitor)}};\n  }\n\n  if(isForEach(then)) {\n    return {forEach: {then: visitThen(then.forEach.then, visitor), variable: then.forEach.variable}};\n  }\n\n  return then;\n}\n\n\n\n","import {Playshot} from \"../../../../model/Playshot\";\nimport {PlayInformationRuntimeInfo} from \"./information-definitions\";\n\nexport const getViewRuntimeInformation = (viewName: string, playshot: Playshot): PlayInformationRuntimeInfo | undefined => {\n  const view = playshot.playConfig.views[viewName];\n\n  if(!view) {\n    return;\n  }\n\n  return playshot.playConfig.types[view.information];\n}\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {DEFAULT_CARD_HEIGHT, DEFAULT_CARD_WIDTH} from \"../../../../components/CodyEngineWizard/WizardModal\";\nimport {GraphPoint, makeNodeFromJs, Node, NodeId, NodeType} from \"../../../../model/Graph\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {UiSchema} from \"../../../cody-wizard/ui/ui-schema\";\nimport {\n  convertJsonSchemaToShorthandIfPossible\n} from \"../../../json/schema/convert-json-schema-to-shorthand-if-possible\";\nimport {Action, CommandAction, isCommandAction} from \"../../action-definitions\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {getNodeIdFromProophBoardDescription, ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {isRecordEvent, ThenType, visitRulesThen} from \"../../rule-definitions\";\nimport {ApplyTask, makeApplyTask, runApplyTasks} from \"../../run-apply-tasks\";\nimport {PlayCommandRuntimeInfo} from \"../commands/command-definitions\";\nimport {PlayEventRuntimeInfo} from \"../events/event-definitions\";\nimport {\n  CONNECT_SPACING,\n  geoBelow,\n  geoBelowRight,\n  geoRight,\n  getNextGeo, SLICE_HEIGHT,\n  SPACING,\n  X_SLICE_SPACING, Y_CTX_SPACING,\n  Y_SLICE_SPACING\n} from \"../graph-manipulation\";\nimport {getViewRuntimeInformation} from \"../information/get-view-runtime-information\";\nimport {\n  PlayInformationRegistry,\n  PlayInformationRuntimeInfo,\n} from \"../information/information-definitions\";\nimport {prepareDiffInformation} from \"../information/prepare-diff-information\";\nimport {PlayshotApplyContext} from \"../PlayshotChanged\";\nimport {PageDefinition} from \"./page-definitions\";\n\ninterface CommandSlice {\n  slice: Node;\n  page: Node;\n  command: Node;\n  // @TODO: Handle Command Dependencies\n  // @TODO: Handle Aggregate\n  events: Node[];\n}\n\ninterface ViewSlice {\n  slice: Node;\n  page: Node;\n  views: Node[];\n  nextPage?: Node;\n}\n\ninterface EventContext {\n  info: PlayEventRuntimeInfo;\n  node: Node;\n}\n\n\nexport const applySlices = async (pageId: NodeId, page: PageDefinition, ctx: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> => {\n  const tasks: ApplyTask[] = [];\n\n  const addedViews: PlayInformationRegistry = {};\n\n  const commands = getAllPageCommands(page, ctx);\n\n  commands.forEach(command => {\n    tasks.push(...makeAddCommandSliceTasks(command, page, ctx));\n  })\n\n\n  if(tasks.length === 0) {\n    tasks.push(makeAddPageTask(pageId, page, ctx));\n  }\n\n  return runApplyTasks(tasks);\n}\n\nconst getAllPageCommands = (page: PageDefinition, ctx: PlayshotApplyContext): PlayCommandRuntimeInfo[] => {\n  const commands: PlayCommandRuntimeInfo[] = [];\n\n  commands.push(...page.commands.filter(c => typeof c === \"string\" || c.type === \"command\").map(c => {\n    const commandName = typeof c === \"string\" ? c : (c as CommandAction).command;\n    return ctx.playshot.playConfig.commands[commandName]\n  }).filter(c => c))\n\n  page.components.forEach(view => {\n    if(typeof view === \"string\") {\n      const viewInformation = getViewRuntimeInformation(view, ctx.playshot);\n\n      if(viewInformation) {\n        commands.push(...getCommandsFromUiSchema(viewInformation.uiSchema || {}, ctx))\n      }\n\n      return;\n    } else {\n      if(view.uiSchema) {\n        commands.push(...getCommandsFromUiSchema(view.uiSchema, ctx));\n      }\n\n      const viewInformation = getViewRuntimeInformation(view.view, ctx.playshot);\n\n      if(viewInformation) {\n        commands.push(...getCommandsFromUiSchema(viewInformation.uiSchema || {}, ctx));\n      }\n    }\n  })\n\n  return commands;\n}\n\nconst getCommandsFromUiSchema = (uiSchema: UiSchema, ctx: PlayshotApplyContext): PlayCommandRuntimeInfo[] => {\n  const commands: PlayCommandRuntimeInfo[] = [];\n\n  if(uiSchema['ui:options'] && (uiSchema['ui:options'] as any).actions) {\n    const actions: Action[] = (uiSchema['ui:options'] as any).actions;\n\n    actions.forEach(a => {\n      if(isCommandAction(a) && ctx.playshot.playConfig.commands[a.command]) {\n        commands.push(ctx.playshot.playConfig.commands[a.command]);\n      }\n    })\n  }\n\n  return commands;\n}\n\nconst getEventsRecordedByCommand = (command: PlayCommandRuntimeInfo, ctx: PlayshotApplyContext): PlayEventRuntimeInfo[] => {\n  const rules = ctx.playshot.playConfig.commandHandlers[command.desc.name] || [];\n\n  const events: PlayEventRuntimeInfo[] = [];\n\n  visitRulesThen(rules, (then: ThenType): ThenType => {\n    if(isRecordEvent(then)) {\n      const event = ctx.playshot.playConfig.events[then.record.event];\n\n      if(event) {\n        events.push(event);\n      }\n    }\n\n\n    return then;\n  })\n\n  return events;\n}\n\nconst makeAddCommandSliceTasks = (command: PlayCommandRuntimeInfo, page: PageDefinition, ctx: PlayshotApplyContext): ApplyTask[] => {\n  const tasks: ApplyTask[] = [];\n\n  const commandId = getNodeIdFromProophBoardDescription(command.desc);\n\n  if(ctx.graph.getNode(commandId)) {\n    return tasks;\n  }\n\n  const commandSlice: Partial<CommandSlice> = {events: []};\n\n  tasks.push(makeAddCommandSliceFrameTask(command, commandSlice, ctx));\n  tasks.push(makeAddCommandSlicePageTask(page, commandSlice, ctx));\n  tasks.push(makeCommandSliceCommandTask(command, commandSlice, ctx));\n\n  const events = getEventsRecordedByCommand(command, ctx);\n\n  events.forEach(event => {\n    const eventContext: Partial<EventContext> = {info: event};\n    tasks.push(makeCommandSliceEventTask(eventContext as EventContext, commandSlice as CommandSlice, ctx));\n\n    const policies = ctx.playshot.playConfig.eventPolicies[event.desc.name] || {};\n\n    Object.values(policies).forEach(policy => {\n      if(policy.projection) {\n        const information = Object.values(ctx.playshot.playConfig.types)\n          .filter(iri => iri.desc.projection === policy.projection)\n          .shift();\n\n        if(information) {\n          tasks.push(...makeInformationProjectionSliceTasks(eventContext as EventContext, information, ctx));\n        }\n      } else {\n        // @TODO apply processor slice\n      }\n    })\n  })\n\n  return tasks;\n}\n\nconst makeInformationProjectionSliceTasks = (event: EventContext, information: PlayInformationRuntimeInfo, ctx: PlayshotApplyContext): ApplyTask[] => {\n  const tasks: ApplyTask[] = [];\n  const {views} = ctx.playshot.playConfig;\n  let viewName: string | undefined;\n\n  for (const viewKey in views) {\n    if(views[viewKey].information === information.desc.name) {\n      viewName = viewKey;\n    }\n  }\n\n  Object.values(ctx.playshot.playConfig.pages)\n    .filter(p => {\n      for (const component of p.components) {\n        const componentName = typeof component === \"string\" ? component : component.view;\n\n        return componentName === viewName;\n      }\n    })\n    .forEach(page => {\n      const viewSlice: Partial<ViewSlice> = {views: []};\n\n      tasks.push(makeViewInformationSliceFrameTask(information, page, viewSlice, ctx));\n      tasks.push(makeViewSliceInformationTask(information, event, viewSlice, ctx));\n      tasks.push(makeViewSlicePageTask(page, viewSlice, ctx));\n    })\n\n  return tasks;\n}\n\nconst makeViewInformationSliceFrameTask = (information: PlayInformationRuntimeInfo, page: PageDefinition, viewSlice: Partial<ViewSlice>, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"ViewInformationSliceFrameTask\", async () => {\n    viewSlice.slice = makeNodeFromJs({\n      id: ctx.graph.createCellId(),\n      type: NodeType.feature,\n      name: `View ${nodeLabel(information.desc.name)}`,\n      size: {\n        width: 520,\n        height: SLICE_HEIGHT\n      }\n    })\n\n    ctx.graph.addNode(viewSlice.slice);\n    ctx.graph.switchParent(viewSlice.slice, ctx.syncContext, getNextGeo(ctx.addedNodes), true);\n    ctx.graph.focusNode(viewSlice.slice);\n\n    ctx.addedNodes[viewSlice.slice.getId()] = ctx.graph.getNode(viewSlice.slice.getId()) || viewSlice.slice;\n\n    return {\n      cody: `I've added a view slice that documents what information is shown on page \"${nodeLabel(page.name)}\".`,\n      type: CodyResponseType.Info\n    }\n  })\n}\n\nconst makeViewSliceInformationTask = (information: PlayInformationRuntimeInfo, event: EventContext, viewSlice: Partial<ViewSlice>, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"ViewSliceInformationTask\", async () => {\n\n    const nodeId = getNodeIdFromProophBoardDescription(information.desc);\n\n    // Add a copy if information already exists on the board\n    const infoId = ctx.graph.getNode(nodeId) ? ctx.graph.createCellId() : nodeId;\n\n    const preparedInfo = prepareDiffInformation(information, ctx.playshot);\n\n    const node = makeNodeFromJs({\n      id: infoId,\n      type: NodeType.document,\n      name: nodeLabel(information.desc.name),\n      metadata: stringify(omit({\n        ...preparedInfo.desc,\n        schema: preparedInfo.schema,\n        uiSchema: preparedInfo.uiSchema,\n        querySchema: preparedInfo.querySchema,\n        resolve: preparedInfo.resolve,\n        projection: preparedInfo.projection,\n        initialize: preparedInfo.initialize,\n      }, [\n        \"name\",\n      ]))\n    })\n\n    const edgePoint = {\n      x: event.node.getParent()!.getGeometry().x + event.node.getGeometry().x + ((X_SLICE_SPACING * 2 + SPACING) / 2),\n      y: Y_CTX_SPACING + event.node.getGeometry().y - (CONNECT_SPACING / 2)\n    };\n\n    ctx.graph.addNode(node);\n    ctx.graph.switchParent(node, viewSlice.slice!, {\n      x: X_SLICE_SPACING,\n      y: Y_SLICE_SPACING + DEFAULT_CARD_HEIGHT + (CONNECT_SPACING - (Y_SLICE_SPACING - SPACING))\n    }, true);\n    ctx.graph.focusNode(node);\n    ctx.graph.connectNodes(event.node, node, undefined, [edgePoint], true);\n\n    addNodeBeforeSliceNode(node, viewSlice.slice!, ctx);\n\n    viewSlice.views!.push(ctx.graph.getNode(infoId) || node);\n\n    return {\n      cody: `I've added an information card for \"${nodeLabel(information.desc.name)}\" to the board`\n    };\n  })\n}\n\nconst makeViewSlicePageTask = (page: PageDefinition, viewSlice: Partial<ViewSlice>, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"ViewSlicePageTask\", async () => {\n    const pageNode = makeNodeFromJs({\n      id: ctx.graph.createCellId(),\n      type: NodeType.ui,\n      name: nodeLabel(page.name),\n      metadata: stringify(omit({...page, views: page.components}, [\n        \"name\",\n        \"topLevel\",\n        \"components\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    const lastView = viewSlice.views![viewSlice.views!.length -1];\n\n    ctx.graph.addNode(pageNode);\n    ctx.graph.switchParent(pageNode, viewSlice.slice!, {x: lastView.getGeometry().x + DEFAULT_CARD_WIDTH, y: Y_SLICE_SPACING}, true);\n    ctx.graph.focusNode(pageNode);\n    viewSlice.page = ctx.graph.getNode(pageNode.getId()) || pageNode;\n\n    viewSlice.views!.forEach(view => {\n      ctx.graph.connectNodes(view, pageNode, undefined, [{\n        x: viewSlice.page!.getGeometry().x - (DEFAULT_CARD_WIDTH / 2),\n        y: viewSlice.page!.getGeometry().y + viewSlice.page!.getSize().height + (CONNECT_SPACING / 2)\n      }], true);\n    })\n\n    addNodeBeforeSliceNode(viewSlice.page, viewSlice.slice!, ctx);\n\n    return {\n      cody: `I've added a UI card for the new page \"${nodeLabel(page.name)}\" to the slice \"${viewSlice.slice!.getName()}\"`,\n      type: CodyResponseType.Info\n    };\n  })\n}\n\nconst makeAddCommandSliceFrameTask = (command: PlayCommandRuntimeInfo, commandSlice: Partial<CommandSlice>, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"AddCommandSliceFrameTask\", async () => {\n    commandSlice.slice = makeNodeFromJs({\n      id: ctx.graph.createCellId(),\n      type: NodeType.feature,\n      name: nodeLabel(command.desc.name),\n      size: {\n        width: 520,\n        height: SLICE_HEIGHT\n      }\n    })\n\n    ctx.graph.addNode(commandSlice.slice);\n    ctx.graph.switchParent(commandSlice.slice, ctx.syncContext, getNextGeo(ctx.addedNodes), true);\n    ctx.graph.focusNode(commandSlice.slice);\n\n    ctx.addedNodes[commandSlice.slice.getId()] = ctx.graph.getNode(commandSlice.slice.getId()) || commandSlice.slice;\n\n    return {\n      cody: `I've added a command slice that documents how the command \"${nodeLabel(command.desc.name)}\" is processed.`,\n      type: CodyResponseType.Info\n    }\n  })\n}\n\nconst makeAddCommandSlicePageTask = (page: PageDefinition, commandSlice: Partial<CommandSlice>, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"AddCommandSlicePageTask\", async () => {\n    const pageNode = makeNodeFromJs({\n      id: ctx.graph.createCellId(),\n      type: NodeType.ui,\n      name: nodeLabel(page.name),\n      metadata: stringify(omit({...page, views: page.components}, [\n        \"name\",\n        \"topLevel\",\n        \"components\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    ctx.graph.addNode(pageNode);\n    ctx.graph.switchParent(pageNode, commandSlice.slice!, {x: X_SLICE_SPACING, y: Y_SLICE_SPACING}, true);\n    ctx.graph.focusNode(pageNode);\n    commandSlice.page = ctx.graph.getNode(pageNode.getId()) || pageNode;\n\n    addNodeBeforeSliceNode(commandSlice.page, commandSlice.slice!, ctx);\n\n    return {\n      cody: `I've added a UI card for the new page \"${nodeLabel(page.name)}\" to the command slice \"${commandSlice.slice!.getName()}\"`,\n      type: CodyResponseType.Info\n    };\n  })\n}\n\nconst makeCommandSliceCommandTask = (command: PlayCommandRuntimeInfo, commandSlice: Partial<CommandSlice>, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"CommandSliceCommandTask\", async () => {\n    const rules = ctx.playshot.playConfig.commandHandlers[command.desc.name] || [];\n\n    const commandNode = makeNodeFromJs({\n      id: getNodeIdFromProophBoardDescription(command.desc),\n      type: NodeType.command,\n      name: nodeLabel(command.desc.name),\n      metadata: stringify(omit({\n        ...command.desc,\n        schema: convertJsonSchemaToShorthandIfPossible(command.schema),\n        uiSchema: command.uiSchema,\n        rules,\n        // @TODO: handle factory\n      }, [\n        \"name\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    ctx.graph.addNode(commandNode);\n    ctx.graph.switchParent(\n      commandNode,\n      commandSlice.slice!,\n      // Remove the page Y spacing diff from connect spacing, so that command is centered in API lane\n      geoBelow(commandSlice.page!, CONNECT_SPACING - (Y_SLICE_SPACING - SPACING)),\n      true\n    );\n    ctx.graph.focusNode(commandNode);\n\n    commandSlice.command = ctx.graph.getNode(commandNode.getId()) || commandNode;\n\n    ctx.graph.connectNodes(commandSlice.page!, commandSlice.command);\n\n    addNodeBeforeSliceNode(commandSlice.command, commandSlice.slice!, ctx);\n\n    return {\n      cody: `I've added a command card for \"${nodeLabel(command.desc.name)}\" to the board`,\n      type: CodyResponseType.Info\n    }\n  })\n}\n\nconst makeCommandSliceEventTask = (event: EventContext, commandSlice: CommandSlice, ctx: PlayshotApplyContext): ApplyTask => {\n  const nodeId = getNodeIdFromProophBoardDescription(event.info.desc);\n\n  // Insert a copy if event already exists\n  const eventId = ctx.graph.getNode(nodeId) ? ctx.graph.createCellId() : nodeId;\n\n  return makeApplyTask(\"CommandSliceEventTask\", async () => {\n    const node = makeNodeFromJs({\n      id: eventId,\n      type: NodeType.event,\n      name: nodeLabel(event.info.desc.name),\n      metadata: stringify(omit({\n        ...event.info.desc,\n        schema: convertJsonSchemaToShorthandIfPossible(event.info.schema),\n        // @TODO: handle factory\n      }, [\n        \"name\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    const geo: GraphPoint = commandSlice.events.length > 0\n      ? geoRight(commandSlice.events[commandSlice.events.length - 1], 50)\n      : geoBelowRight(commandSlice.command, 0);\n\n    ctx.graph.addNode(node);\n    ctx.graph.switchParent(node, commandSlice.slice, geo, true);\n    ctx.graph.focusNode(node);\n    ctx.graph.connectNodes(commandSlice.command, node, undefined, [{\n      x: geo.x - (DEFAULT_CARD_WIDTH / 2),\n      y: geo.y - (CONNECT_SPACING / 2)\n    }], true);\n\n    const mxGraphNode = ctx.graph.getNode(node.getId()) || node;\n\n    commandSlice.events.push(mxGraphNode);\n\n    addNodeBeforeSliceNode(mxGraphNode, commandSlice.slice, ctx);\n\n    event.node = mxGraphNode;\n\n    return {\n      cody: `I've added the event \"${nodeLabel(event.info.desc.name)}\". It records the result of processing command \"${commandSlice.command.getName()}\".`,\n      type: CodyResponseType.Info\n    }\n  })\n}\n\n// Slice node needs to be the last added node so that follow up element position is calculated based on slice geo\nconst addNodeBeforeSliceNode = (node: Node, slice: Node, ctx: PlayshotApplyContext) => {\n  const sliceEle = ctx.addedNodes[slice.getId()];\n  delete ctx.addedNodes[sliceEle.getId()];\n  ctx.addedNodes[node.getId()] = node;\n  ctx.addedNodes[sliceEle.getId()] = sliceEle;\n}\n\nconst makeAddPageTask = (pageId: NodeId, page: PageDefinition, ctx: PlayshotApplyContext): ApplyTask => {\n  return makeApplyTask(\"AddPageTask\", async () => {\n    const existingNode = ctx.graph.getNode(pageId);\n\n    if(existingNode) {\n      return {\n        cody: `Hhm, I'm skipping the change \"New Page: ${nodeLabel(page.name)}\", because the UI card seems to exist already on the board.`,\n        details: `There is at least an element on the board with ID: ${pageId}`,\n        type: CodyResponseType.Warning\n      }\n    }\n\n    const node = makeNodeFromJs({\n      id: pageId,\n      type: NodeType.ui,\n      name: nodeLabel(page.name),\n      metadata: stringify(omit({...page, views: page.components}, [\n        \"name\",\n        \"topLevel\",\n        \"components\",\n        ...ProophBoardDescriptionKeys\n      ]))\n    })\n\n    ctx.graph.addNode(node);\n    ctx.graph.switchParent(node, ctx.syncContext, getNextGeo(ctx.addedNodes), true);\n    ctx.graph.focusNode(node);\n\n    ctx.addedNodes[node.getId()] = ctx.graph.getNode(node.getId()) || node;\n\n\n\n    return {\n      cody: `I've added a UI card for the new page \"${nodeLabel(page.name)}\" to the board`,\n      type: CodyResponseType.Info\n    };\n  })\n}\n","import {UiSchema} from \"../cody-wizard/ui/ui-schema\";\nimport {AnyRule, PropMapping} from \"./rule-definitions\";\n\nexport interface ButtonConfig {\n  variant?: \"text\" | \"outlined\" | \"contained\",\n  color?: 'inherit' | 'primary' | 'secondary' | 'success' | 'error' | 'info' | 'warning',\n  disabled?: boolean,\n  style?: object,\n  hidden?: boolean,\n  icon?: React.ReactNode,\n  label?: string,\n  endIcon?: React.ReactNode,\n  'variant:expr'?: string,\n  'color:expr'?: string,\n  'disabled:expr'?: string,\n  'style:expr'?: string,\n  'hidden:expr'?: string,\n  'icon:expr'?: string,\n  'label:expr'?: string,\n  'endIcon:expr'?: string,\n}\n\nexport interface Action {\n  type: \"command\" | \"link\" | \"rules\";\n  description?: string;\n  position: \"top-right\" | \"bottom-left\" | \"bottom-center\" | \"bottom-right\";\n  button: ButtonConfig;\n}\n\nexport const isLinkAction = (action: Action): action is LinkAction => {\n  return action.type === \"link\";\n}\n\nexport const isCommandAction = (action: Action): action is CommandAction => {\n  return (!action.type && (action as any).command) || action.type === \"command\";\n}\n\nexport const isRulesAction = (action: Action): action is RulesAction => {\n  return action.type === \"rules\";\n}\n\nexport interface LinkAction extends Action {\n  pageLink?: string | {page: string; mapping: Record<string, string>};\n  href?: string;\n}\n\nexport interface CommandAction extends Action {\n  command: string;\n  uiSchema?: UiSchema,\n  connectTo?: string,\n  directSubmit?: boolean,\n  forceSchema?: boolean,\n  data?: string | string[] | PropMapping | PropMapping[];\n}\n\nexport interface RulesAction extends Action {\n  rules: AnyRule[];\n}\n\nexport type ActionConfig = LinkAction | CommandAction | RulesAction;\n\n","import { NodeId, NodeType} from \"../../../../model/Graph\";\nimport {CodyResponse} from \"../../../Cody\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {applySlices} from \"./apply-slices\";\nimport {PageDefinition} from \"./page-definitions\";\n\nexport class PageAdded implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'NewPage';\n  public readonly operation: PlayshotChangedOperation = 'added';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.ui;\n  public readonly diff: PlayshotChangedDiff;\n\n  private newPage: PageDefinition;\n\n  constructor(name: string, nodeId: string, page: PageDefinition) {\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: page,\n      old: null,\n    };\n    this.newPage = page;\n  }\n\n  public async apply(ctx: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    return applySlices(this.nodeId, this.newPage, ctx);\n  }\n}\n\n","import {stringify} from \"comment-json\";\nimport {omit, startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ProophBoardDescriptionKeys} from \"../../descriptions\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PageDefinition} from \"./page-definitions\";\n\nexport class PageMetadataChanged implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'PageMetadataChanged';\n  public readonly operation: PlayshotChangedOperation = 'changed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.ui;\n  public readonly diff: PlayshotChangedDiff;\n\n  private changedPage: PageDefinition;\n\n  constructor(name: string, nodeId: string, page: PageDefinition, newPlayshot: Playshot, oldPlayshot: Playshot) {\n    let oldDefinition = oldPlayshot.playConfig.pages[name];\n\n    if(!oldDefinition) {\n      oldDefinition = page;\n    }\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: page,\n      old: oldDefinition,\n    };\n    this.changedPage = page;\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.ui, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the page cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    graph.changeNodeMetadata(existingNode, stringify(omit({...this.changedPage, views: this.changedPage.components}, [\n      \"name\",\n      \"topLevel\",\n      \"components\",\n      ...ProophBoardDescriptionKeys\n    ])))\n\n\n    graph.focusNode(existingNode);\n\n\n    return makeAsyncIterable({\n      cody: `I've updated metadata of ui card \"${nodeLabel(this.name)}\".`\n    });\n  }\n}\n","import {startCase} from \"lodash\";\nimport {NodeId, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {makeAsyncIterable} from \"../../../async-iterable/make-async-iterable\";\nimport {CodyResponse, CodyResponseType} from \"../../../Cody\";\nimport {getNodeByIdOrFQCN} from \"../../../cody-wizard/node/get-node-by-id-or-fqcn\";\nimport {nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {ApplyTask, runApplyTasks} from \"../../run-apply-tasks\";\nimport {\n  PlayshotApplyContext,\n  PlayshotChanged,\n  PlayshotChangedDiff,\n  PlayshotChangedOperation,\n  PlayshotChangedType\n} from \"../PlayshotChanged\";\nimport {PageDefinition} from \"./page-definitions\";\nimport app from \"../../../../../App\";\n\nexport class PageRemoved implements PlayshotChanged {\n  public readonly name: string;\n  public readonly type: PlayshotChangedType = 'PageRemoved';\n  public readonly operation: PlayshotChangedOperation = 'removed';\n  public readonly nodeId: NodeId;\n  public readonly nodeType = NodeType.ui;\n  public readonly diff: PlayshotChangedDiff;\n\n  constructor(name: string, nodeId: string, page: PageDefinition, oldPlayshot: Playshot) {\n\n    this.name = name;\n    this.nodeId = nodeId;\n    this.diff = {\n      new: null,\n      old: page,\n    };\n  }\n\n  public async apply({syncContext, graph, playshot, addedNodes, elementsTree}: PlayshotApplyContext): Promise<AsyncIterable<CodyResponse>> {\n    if(addedNodes[this.nodeId]) {\n      return makeAsyncIterable({\n        cody: ``,\n        type: CodyResponseType.Empty\n      })\n    }\n\n    const existingNode = getNodeByIdOrFQCN(this.nodeId, this.name, NodeType.ui, graph, elementsTree);\n\n    if(!existingNode) {\n      return makeAsyncIterable({\n        cody: `Hhm, I'm skipping the change \"${startCase(this.type)}: ${removeDefaultService(this.name, playshot)}\", because the page cannot be found on the board.`,\n        details: `There is no element on the board with ID: ${this.nodeId}`,\n        type: CodyResponseType.Warning\n      })\n    }\n\n    const similarNodes = elementsTree.getSimilarElements(existingNode);\n\n    const applyTasks: ApplyTask[] = [\n      {\n        name: \"Focus page to remove\",\n        func: async () => {\n          graph.focusNode(existingNode);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      },\n      {\n        name: \"Remove page\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(existingNode);\n\n              resolve({\n                cody: `I've removed the ui card for \"${nodeLabel(this.name)}\" from the board`\n              });\n            }, 1500);\n          })\n        }\n      }\n    ];\n\n    similarNodes.forEach(sN => {\n      applyTasks.push({\n        name: \"Focus page to remove\",\n        func: async () => {\n          graph.focusNode(sN);\n          return {\n            cody: ``,\n            type: CodyResponseType.Empty\n          }\n        }\n      });\n      applyTasks.push({\n        name: \"Remove page\",\n        func: async () => {\n          return new Promise(resolve => {\n            window.setTimeout(() => {\n              graph.deleteNode(sN);\n\n              resolve({\n                cody: ``,\n                type: CodyResponseType.Empty\n              });\n            }, 1500);\n          })\n        }\n      })\n    })\n\n    return runApplyTasks(applyTasks)\n  }\n}\n","import {ElementsTree} from \"../../model/ElementsTree\";\nimport {Graph} from \"../../model/Graph\";\nimport {Playshot} from \"../../model/Playshot\";\nimport {compareCommands} from \"./diff/commands/compare-commands\";\nimport {compareEvents} from \"./diff/events/compare-events\";\nimport {compareInformation} from \"./diff/information/compare-information\";\nimport {comparePages} from \"./diff/pages/compare-pages\";\nimport {PlayshotChanged} from \"./diff/PlayshotChanged\";\n\nexport const comparePlayshots = (oldPlayshot: Playshot, newPlayshot: Playshot, graph: Graph, elementsTree: ElementsTree): PlayshotChanged[] => {\n  const changeSet: PlayshotChanged[] = [];\n\n  changeSet.push(...comparePages(oldPlayshot, newPlayshot, graph, elementsTree));\n  changeSet.push(...compareCommands(oldPlayshot, newPlayshot, graph, elementsTree));\n  changeSet.push(...compareEvents(oldPlayshot, newPlayshot, graph, elementsTree));\n  changeSet.push(...compareInformation(oldPlayshot, newPlayshot, graph,elementsTree));\n\n  return changeSet;\n}\n","import {stringify} from \"comment-json\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph, NodeType} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {getService, nodeLabel, removeDefaultService} from \"../../default-service\";\nimport {PlayshotChanged} from \"../PlayshotChanged\";\nimport {PageAdded} from \"./PageAdded\";\nimport {PageMetadataChanged} from \"./PageMetadataChanged\";\nimport {PageRemoved} from \"./PageRemoved\";\n\nexport const comparePages = (oldPlayshot: Playshot, newPlayshot: Playshot, graph: Graph, elementsTree: ElementsTree): PlayshotChanged[] => {\n  const oldPages = oldPlayshot.playConfig.pages;\n  const newPages = newPlayshot.playConfig.pages;\n\n  const changeSet: PlayshotChanged[] = [];\n\n  const oldPageNames = Object.keys(oldPages).filter(n => n !== \"Welcome\" && n !== \"CodyPlay.VibeCodyProcessing\");\n  const newPageNames = Object.keys(newPages).filter(n => n !== \"Welcome\" && n !== \"CodyPlay.VibeCodyProcessing\");\n\n  const pagesToRemove: string[] = oldPageNames.filter(oldPageName => !newPageNames.includes(oldPageName));\n  const pagesToAdd: string[] = newPageNames.filter(newPageName => !oldPageNames.includes(newPageName));\n\n  const changedPages: string[] = newPageNames.filter(newPageName => {\n    if(pagesToAdd.includes(newPageName)) {\n      return false;\n    }\n\n    const oldPage = oldPages[newPageName];\n    const newPage = newPages[newPageName];\n\n    return stringify(oldPage) !== stringify(newPage);\n  });\n\n  pagesToAdd.forEach(pageNameToAdd => {\n    const pageToAdd = newPages[pageNameToAdd];\n\n    const pageLabel = nodeLabel(pageNameToAdd);\n    const similarPages = elementsTree.getFilteredElementsByTypeAndLabel(NodeType.ui, pageLabel, getService(pageToAdd, newPlayshot));\n\n    const nodeId = similarPages.map(p => p.getId()).first(undefined) || graph.createCellId();\n\n    // @TODO: Currently, we have no chance to detect a renamed page, because pages don't keep a reference to the UI card.\n    // cody play should be changed, to track prooph board info for pages as well\n\n    changeSet.push(new PageAdded(\n      pageToAdd.name,\n      nodeId,\n      pageToAdd)\n    );\n  });\n\n  changedPages.forEach(pageNameToUpdate => {\n    const pageToUpdate = newPages[pageNameToUpdate];\n\n    const pageLabel = nodeLabel(pageNameToUpdate);\n    const similarPages = elementsTree.getFilteredElementsByTypeAndLabel(NodeType.ui, pageLabel, getService(pageToUpdate, newPlayshot));\n\n    const nodeId = similarPages.map(p => p.getId()).first(undefined) || graph.createCellId();\n\n    changeSet.push(new PageMetadataChanged(pageNameToUpdate, nodeId, pageToUpdate, newPlayshot, oldPlayshot));\n  });\n\n  pagesToRemove.forEach(pageNameToRemove => {\n    const oldPage = oldPages[pageNameToRemove];\n\n    const pageLabel = nodeLabel(pageNameToRemove);\n    const similarPages = elementsTree.getFilteredElementsByTypeAndLabel(NodeType.ui, pageLabel, getService(oldPage, newPlayshot));\n\n    const nodeId = similarPages.map(p => p.getId()).first(undefined) || graph.createCellId();\n\n\n    changeSet.push(new PageRemoved(pageNameToRemove, nodeId, oldPage, oldPlayshot));\n  })\n\n  return changeSet;\n}\n","import {stringify} from \"comment-json\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {fqcn, fqcnWithDefaultService} from \"../../../cody-wizard/node/fqcn\";\nimport {getNodeIdFromProophBoardDescription} from \"../../descriptions\";\nimport {PlayshotChanged} from \"../PlayshotChanged\";\nimport {PlayCommandRegistry} from \"./command-definitions\";\nimport {CommandAdded} from \"./CommandAdded\";\nimport {CommandMetadataChanged} from \"./CommandMetadataChanged\";\nimport {CommandRenamed} from \"./CommandRenamed\";\nimport {CommandRemoved} from \"./CommandRemoved\";\n\nexport const compareCommands = (oldPlayshot: Playshot, newPlayshot: Playshot, graph: Graph, elementsTree: ElementsTree): PlayshotChanged[] => {\n  const oldCommands: PlayCommandRegistry = oldPlayshot.playConfig.commands;\n  const newCommands: PlayCommandRegistry = newPlayshot.playConfig.commands;\n\n  const changeSet: PlayshotChanged[] = [];\n\n  const oldNames = Object.keys(oldCommands);\n  const newNames = Object.keys(newCommands);\n\n  const commandsToRemove: string[] = oldNames.filter(oldName => !newNames.includes(oldName));\n  const commandsToAdd: string[] = newNames.filter(newName => !oldNames.includes(newName));\n\n  const changedCommands: string[] = newNames.filter(newName => {\n    if(commandsToAdd.includes(newName)) {\n      return false;\n    }\n\n    const oldCommand = oldCommands[newName];\n    const newCommand = newCommands[newName];\n    const oldRules = oldPlayshot.playConfig.commandHandlers[newName] || [];\n    const newRules = newPlayshot.playConfig.commandHandlers[newName] || [];\n\n\n    return stringify(oldCommand) !== stringify(newCommand) || stringify(oldRules) !== stringify(newRules);\n  })\n\n  commandsToAdd.forEach(cmdNameToAdd => {\n    const cmdToAdd = newCommands[cmdNameToAdd];\n\n    const existingNode = graph.getNode(getNodeIdFromProophBoardDescription(cmdToAdd.desc));\n\n    if(existingNode) {\n      const oldName = fqcnWithDefaultService(existingNode, oldPlayshot.playConfig.defaultService);\n\n      const oldInfo = oldPlayshot.playConfig.commands[oldName];\n\n      if(oldInfo) {\n        changeSet.push(new CommandRenamed(cmdNameToAdd, getNodeIdFromProophBoardDescription(cmdToAdd.desc), cmdToAdd, oldInfo, newPlayshot, oldPlayshot));\n        return;\n      }\n    }\n\n    changeSet.push(new CommandAdded(cmdNameToAdd, getNodeIdFromProophBoardDescription(cmdToAdd.desc), cmdToAdd, newPlayshot));\n  })\n\n  changedCommands.forEach(cmdNameToUpdate => {\n    const cmdToUpdate = newCommands[cmdNameToUpdate];\n\n    changeSet.push(new CommandMetadataChanged(cmdNameToUpdate, getNodeIdFromProophBoardDescription(cmdToUpdate.desc), cmdToUpdate, newPlayshot, oldPlayshot));\n  });\n\n  commandsToRemove.forEach(cmdNameToRemove => {\n    const oldCommand = oldCommands[cmdNameToRemove];\n\n    changeSet.push(new CommandRemoved(cmdNameToRemove, getNodeIdFromProophBoardDescription(oldCommand.desc), oldCommand, oldPlayshot));\n  })\n\n  return changeSet;\n}\n","import {stringify} from \"comment-json\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {getNodeIdFromProophBoardDescription} from \"../../descriptions\";\nimport {PlayshotChanged} from \"../PlayshotChanged\";\nimport {PlayEventRegistry} from \"./event-definitions\";\nimport {EventAdded} from \"./EventAdded\";\nimport {EventMetadataChanged} from \"./EventMetadataChanged\";\nimport {fqcnWithDefaultService} from \"../../../cody-wizard/node/fqcn\";\nimport {EventRenamed} from \"./EventRenamed\";\nimport {EventRemoved} from \"./EventRemoved\";\n\nexport const compareEvents = (oldPlayshot: Playshot, newPlayshot: Playshot, graph: Graph, elementsTree: ElementsTree): PlayshotChanged[] => {\n  const oldEvents: PlayEventRegistry = oldPlayshot.playConfig.events;\n  const newEvents: PlayEventRegistry = newPlayshot.playConfig.events;\n\n  const changeSet: PlayshotChanged[] = [];\n\n  const oldNames = Object.keys(oldEvents);\n  const newNames = Object.keys(newEvents);\n\n  const eventsToRemove: string[] = oldNames.filter(oldName => !newNames.includes(oldName));\n  const eventsToAdd: string[] = newNames.filter(newName => !oldNames.includes(newName));\n\n  const changedEvents: string[] = newNames.filter(newName => {\n    if(eventsToAdd.includes(newName)) {\n      return false;\n    }\n\n    const oldEvent = oldEvents[newName];\n    const newEvent = newEvents[newName];\n\n    return stringify(oldEvent) !== stringify(newEvent);\n  })\n\n  eventsToAdd.forEach(evtNameToAdd => {\n    const evtToAdd = newEvents[evtNameToAdd];\n\n    const existingNode = graph.getNode(getNodeIdFromProophBoardDescription(evtToAdd.desc));\n\n    if(existingNode) {\n      const oldName = fqcnWithDefaultService(existingNode, oldPlayshot.playConfig.defaultService);\n\n      const oldInfo = oldPlayshot.playConfig.events[oldName];\n\n      if(oldInfo) {\n        changeSet.push(new EventRenamed(evtNameToAdd, getNodeIdFromProophBoardDescription(evtToAdd.desc), evtToAdd, oldInfo, newPlayshot, oldPlayshot));\n        return;\n      }\n    }\n\n    changeSet.push(new EventAdded(evtNameToAdd, getNodeIdFromProophBoardDescription(evtToAdd.desc), evtToAdd, newPlayshot));\n  })\n\n  changedEvents.forEach(evtNameToChange => {\n    const evtToChange = newEvents[evtNameToChange];\n\n    changeSet.push(new EventMetadataChanged(evtNameToChange, getNodeIdFromProophBoardDescription(evtToChange.desc), evtToChange, newPlayshot, oldPlayshot));\n  })\n\n  eventsToRemove.forEach(evtNameToRemove => {\n    const evtToRemove = oldEvents[evtNameToRemove];\n\n    changeSet.push(new EventRemoved(evtNameToRemove, getNodeIdFromProophBoardDescription(evtToRemove.desc), evtToRemove, oldPlayshot));\n  })\n\n  return changeSet;\n}\n","import {stringify} from \"comment-json\";\nimport {ElementsTree} from \"../../../../model/ElementsTree\";\nimport {Graph} from \"../../../../model/Graph\";\nimport {Playshot} from \"../../../../model/Playshot\";\nimport {getNodeIdFromProophBoardDescription} from \"../../descriptions\";\nimport {PlayshotChanged} from \"../PlayshotChanged\";\nimport {PlayInformationRegistry} from \"./information-definitions\";\nimport {InformationAdded} from \"./InformationAdded\";\nimport {prepareDiffInformation} from \"./prepare-diff-information\";\nimport {InformationMetadataChanged} from \"./InformationMetadataChanged\";\nimport {fqcnWithDefaultService} from \"../../../cody-wizard/node/fqcn\";\nimport {CommandRenamed} from \"../commands/CommandRenamed\";\nimport {InformationRenamed} from \"./InformationRenamed\";\nimport {InformationRemoved} from \"./InformationRemoved\";\n\nexport const compareInformation = (oldPlayshot: Playshot, newPlayshot: Playshot, graph: Graph, elementsTree: ElementsTree): PlayshotChanged[] => {\n  const oldTypes: PlayInformationRegistry = oldPlayshot.playConfig.types;\n  const newTypes: PlayInformationRegistry = newPlayshot.playConfig.types;\n\n  const changeSet: PlayshotChanged[] = [];\n\n  const oldNames = Object.keys(oldTypes);\n  const newNames = Object.keys(newTypes);\n\n  const informationToRemove: string[] = oldNames.filter(oldName => !newNames.includes(oldName));\n  const informationToAdd: string[] = newNames.filter(newName => !oldNames.includes(newName));\n\n  const changedInformation: string[] = newNames.filter(newName => {\n    if(informationToAdd.includes(newName)) {\n      return false;\n    }\n\n    const oldInformation = oldTypes[newName];\n    const newInformation = newTypes[newName];\n\n    const oldPreparedInformation = prepareDiffInformation(oldInformation, oldPlayshot);\n    const newPreparedInformation = prepareDiffInformation(newInformation, newPlayshot);\n\n    return stringify(oldPreparedInformation) !== stringify(newPreparedInformation);\n  })\n\n  informationToAdd.forEach(infoNameToAdd => {\n    const infoToAdd = newTypes[infoNameToAdd];\n\n    const existingNode = graph.getNode(getNodeIdFromProophBoardDescription(infoToAdd.desc));\n\n    if(existingNode) {\n      const oldName = fqcnWithDefaultService(existingNode, oldPlayshot.playConfig.defaultService);\n\n      const oldInfo = oldPlayshot.playConfig.types[oldName];\n\n      if(oldInfo) {\n        changeSet.push(new InformationRenamed(infoNameToAdd, getNodeIdFromProophBoardDescription(infoToAdd.desc), infoToAdd, oldInfo, newPlayshot, oldPlayshot));\n        return;\n      }\n    }\n\n    changeSet.push(new InformationAdded(infoNameToAdd, getNodeIdFromProophBoardDescription(infoToAdd.desc), infoToAdd, newPlayshot));\n  })\n\n  changedInformation.forEach(infoNameToUpdate => {\n    const infoToUpdate = newTypes[infoNameToUpdate];\n\n    changeSet.push(new InformationMetadataChanged(infoNameToUpdate, getNodeIdFromProophBoardDescription(infoToUpdate.desc), infoToUpdate, newPlayshot, oldPlayshot));\n  });\n\n  informationToRemove.forEach(infoNameToRemove => {\n    const infoToRemove = oldTypes[infoNameToRemove];\n\n    changeSet.push(new InformationRemoved(infoNameToRemove, getNodeIdFromProophBoardDescription(infoToRemove.desc), infoToRemove, oldPlayshot));\n  })\n\n  return changeSet;\n}\n","import {stringify} from \"comment-json\";\nimport * as React from 'react';\nimport {useEffect, useRef} from \"react\";\nimport CodeEditor from \"../../../core/components/CodeEditor/CodeEditor\";\nimport {PlayshotChanged} from \"../../service/playshot/diff/PlayshotChanged\";\nimport {FormField} from \"semantic-ui-react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {makeEditorStateByNameSelector} from \"../../../Layout/selectors/sidebar-editor\";\nimport {toggleSidebarEditor} from \"../../../Layout/actions/commands\";\nimport ExpandButton from \"../CodyEngineWizard/Editor/ExpandButton\";\n\ninterface OwnProps {\n  change: PlayshotChanged;\n  containerId: string;\n}\n\ntype PlayshotDiffEditorProps = OwnProps;\n\nconst PlayshotDiffEditor = (props: PlayshotDiffEditorProps) => {\n  const codeEditorRef = useRef<CodeEditor|null>(null);\n  const editorState = useSelector(makeEditorStateByNameSelector(`playshot-diff-${props.containerId}`));\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if(!codeEditorRef.current) {\n      return;\n    }\n\n    codeEditorRef.current!.initializeDiffModel(\n      {\n        fileId: `${props.containerId}-diff-original.json`,\n        language: \"json\",\n        value: props.change.diff.old ? stringify(props.change.diff.old, null, 2) : ''\n      },\n      {\n        fileId: `${props.containerId}-diff-modified.json`,\n        language: \"json\",\n        value: props.change.diff.new ? stringify(props.change.diff.new, null, 2) : ''\n      }\n    )\n  }, []);\n\n  return <form className='ui form'>\n      <FormField>\n        <ExpandButton expanded={editorState.expanded} double={editorState.double} onExpandChanged={(expand, double) => dispatch(toggleSidebarEditor(`playshot-diff-${props.containerId}`, expand, !!double))}/>\n        <CodeEditor\n          containerId={props.containerId}\n          ref={codeEditorRef}\n          options={{\n            fontSize: 12,\n            glyphMargin: false,\n            lineNumbers: false,\n            lineDecorationsWidth: 3,\n            minimap: {\n              enabled: false\n            },\n            mouseWheelZoom: true,\n            automaticLayout: true,\n            scrollbar: {\n              alwaysConsumeMouseWheel: false\n            },\n            readOnly: true,\n            fixedOverflowWidgets: true,\n            renderSideBySide: true,\n            useInlineViewWhenSpaceIsLimited: false\n          }}\n          className={\"code editor focus\" + (editorState.expanded ? ' expanded' : '')  + (editorState.double ? ' double' : '')}\n          asDiffEditor={true}\n        />\n    </FormField>\n  </form>\n};\n\nexport default PlayshotDiffEditor;\n","import {startCase} from \"lodash\";\nimport * as React from 'react';\nimport {useState} from \"react\";\nimport {Button, ListContent, ListItem} from \"semantic-ui-react\";\nimport {Playshot} from \"../../model/Playshot\";\nimport {nodeLabel, removeDefaultService} from \"../../service/playshot/default-service\";\nimport {PlayshotChanged} from \"../../service/playshot/diff/PlayshotChanged\";\nimport CellIcon from \"../CellIcon\";\nimport PlayshotDiffEditor from \"./PlayshotDiffEditor\";\n\ninterface OwnProps {\n  change: PlayshotChanged;\n  playshot: Playshot;\n  id: string;\n}\n\ntype PlayshotChangedDiffProps = OwnProps;\n\nconst PlayshotChangedDiff = (props: PlayshotChangedDiffProps) => {\n  const [showDiff, setShowDiff] = useState(false);\n\n  return <ListItem>\n    <CellIcon cellType={props.change.nodeType} size=\"normal\" />\n    <ListContent>\n      {startCase(props.change.type)}: {nodeLabel(props.change.name)}\n        &nbsp;&nbsp;<Button basic={true} className=\"noborder nopadding\" size=\"small\" icon={`chevron ${showDiff ? 'down' : 'up'}`} compact={true} onClick={() => setShowDiff(!showDiff)} />\n      {showDiff && <div style={{padding: \"10px 0\"}}>\n        <PlayshotDiffEditor change={props.change} containerId={`diff-container-${props.id}`} />\n      </div>}\n    </ListContent>\n  </ListItem>\n};\n\nexport default PlayshotChangedDiff;\n","import {List} from \"immutable\";\nimport * as React from 'react';\nimport {useState} from \"react\";\nimport {Button, Header, Table} from \"semantic-ui-react\";\nimport {printIsoDateString} from \"../../../core/dateTime\";\nimport UserAvatar from \"../../../User/components/UserAvatar\";\nimport {IioUserInfo} from \"../../../User/model/IioUserInfo\";\nimport {Playshot} from \"../../model/Playshot\";\nimport {PlayshotId, PlayshotSummary} from \"../../model/PlayshotSummary\";\nimport {stringify} from \"../../service/json/json-comment-wrapper\";\nimport {loadPlayshot} from \"../../service/playshot-storage\";\nimport {PlayshotComparison} from \"./PlayshotModal\";\n\ninterface OwnProps {\n  playshot: PlayshotSummary,\n  previous: PlayshotSummary | null,\n  users: List<IioUserInfo>,\n  onInitPlayshot: (playshotId: PlayshotId) => void,\n  onComparePlayshots: (comparision: PlayshotComparison) => void,\n  onDeletePlayshot: (playshotId: PlayshotId) => void,\n  loading: boolean,\n}\n\ntype PlayshotTableRowProps = OwnProps;\n\nconst PlayshotTableRow = (props: PlayshotTableRowProps) => {\n  const user = props.users.find(u => u.userId === props.playshot.savedBy);\n  const [exporting, setExporting] = useState(false);\n  const [loadingPlayshots, setLoadingPlayshots] = useState(false);\n  const [deletingPlayshot, setDeletingPlayshot] = useState(false);\n\n  const handleExport = () => {\n    setExporting(true);\n    loadPlayshot(props.playshot.boardId, props.playshot.uid).then(playshot => {\n      setExporting(false);\n\n      const playshotData = playshot.toJS();\n\n      delete playshotData.uid;\n      delete playshotData.aggregateType;\n\n      const json = stringify(playshotData, null, 2);\n\n\n      const blob = new Blob([json], {type: 'application/json'});\n      const url = URL.createObjectURL(blob);\n\n      const a = document.createElement('a');\n\n      a.download = props.playshot.name + '.json';\n      a.href = url;\n      a.click();\n    })\n  }\n\n  const handleDelete = () => {\n    setDeletingPlayshot(true);\n    props.onDeletePlayshot(props.playshot.uid);\n  }\n\n  const handleShowChanges = () => {\n    setLoadingPlayshots(true);\n\n    const prevPlayshotPromise: Promise<Playshot> = new Promise(resolve => {\n      if (props.previous === null) {\n        resolve(new Playshot({}));\n      } else {\n        loadPlayshot(props.playshot.boardId, props.previous.uid).then(prev => resolve(prev));\n      }\n    });\n\n    const playshotPromise = loadPlayshot(props.playshot.boardId, props.playshot.uid);\n\n    Promise.all([prevPlayshotPromise, playshotPromise]).then((playshots) => {\n      props.onComparePlayshots({left: playshots[0], right: playshots[1]});\n    }).catch(e => {\n      throw e;\n    }).finally(() => setLoadingPlayshots(false))\n  }\n\n  return <Table.Row>\n    <Table.Cell>\n      <Header as=\"h4\" image={true}>\n        {user && <UserAvatar user={user} namePopup={true}/>}\n        <Header.Content>\n          {props.playshot.name}\n          <Header.Subheader>{printIsoDateString(props.playshot.savedAt)}</Header.Subheader>\n        </Header.Content>\n      </Header>\n    </Table.Cell>\n    <Table.Cell textAlign=\"right\">\n      <Button icon=\"play\" loading={props.loading} primary={true} circular={true} onClick={() => props.onInitPlayshot(props.playshot.uid)} title=\"Start Playshot\" />\n    </Table.Cell>\n    <Table.Cell textAlign=\"right\" width={\"1\"}>\n      <Button icon=\"sync\" loading={loadingPlayshots} basic={true} circular={true} className=\"noborder\" onClick={handleShowChanges} title=\"Sync Changes\" />\n    </Table.Cell>\n    <Table.Cell textAlign=\"right\" width={\"1\"}>\n      <Button icon=\"download\" loading={exporting} basic={true} circular={true} className=\"noborder\" onClick={handleExport} title=\"Download Playshot\" />\n    </Table.Cell>\n    <Table.Cell textAlign=\"right\" width={\"1\"}>\n      <Button icon=\"trash\" loading={deletingPlayshot} basic={true} circular={true} className=\"noborder\" onClick={handleDelete} title=\"Delete Playshot\" />\n    </Table.Cell>\n  </Table.Row>\n};\n\nexport default PlayshotTableRow;\n","import * as React from 'react';\nimport {useEffect, useMemo, useState} from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {Button, Dropdown, List, Message, MessageHeader, Modal, Table} from \"semantic-ui-react\";\nimport {Action as NotifyAction} from \"../../../NotificationSystem\";\nimport {makeGetCurrentUser} from \"../../../User/selectors/currentUser\";\nimport {makeIioFilteredUserListSelector} from \"../../../User/selectors/iioUserInfo\";\nimport * as Action from \"../../actions\";\nimport {toggleCodyConsole, togglePlayshotModal} from \"../../actions/commands\";\nimport {useElementsTree} from \"../../hooks/useElementsTree\";\nimport {useGraph} from \"../../hooks/useGraph\";\nimport {BoardId} from \"../../model/Board\";\nimport {Node} from \"../../model/Graph\";\nimport {CodyPlayConfig, Playshot} from \"../../model/Playshot\";\nimport {PlayshotId, PlayshotSummary} from \"../../model/PlayshotSummary\";\nimport {makeBoardByIdSelector} from \"../../selectors/board\";\nimport {makePlayshotSummaryListSelector} from \"../../selectors/PlayshotSummary\";\nimport {CODY_PLAY_SERVER_NAME, CodyResponse, CodyResponseType, useIIO} from \"../../service/Cody\";\nimport {deletePlayshot, loadPlayshot} from \"../../service/playshot-storage\";\nimport {comparePlayshots} from \"../../service/playshot/compare-playshots\";\nimport {PlayshotChanged} from \"../../service/playshot/diff/PlayshotChanged\";\nimport PlayshotChangedDiff from \"./PlayshotChangedDiff\";\nimport PlayshotTableRow from \"./PlayshotTableRow\";\n\ninterface PlayshotModalRouteMatchParams {\n  uid: BoardId;\n}\n\ninterface OwnProps {\n\n}\n\nexport interface PlayshotComparison {\n  left: Playshot;\n  right: Playshot;\n  applied?: boolean;\n  error?: boolean;\n}\n\nexport const CODY_APPLY_PAUSE = 1000;\n\ntype PlayshotModalProps = OwnProps & RouteComponentProps<PlayshotModalRouteMatchParams> & WithNamespaces;\n\nconst PlayshotModal = (props: PlayshotModalProps) => {\n  const dispatch = useDispatch();\n  const [graph] = useGraph();\n  const elementsTree = useElementsTree(props.match.params.uid);\n  const getBoardByIdSelector = useMemo(() => makeBoardByIdSelector(props.match.params.uid), []);\n  const board = useSelector(getBoardByIdSelector);\n  const visible = board && board.shouldShowPlayshotModal;\n  const playshots = useSelector(makePlayshotSummaryListSelector(props.match.params.uid));\n  const [loadingPlayshotId, setLoadingPlayshotId] = useState('');\n  const [playshotComparision, setPlayshotComparision] = useState<PlayshotComparison | undefined>(undefined);\n  const [syncError, setSyncError] = useState<string|{title: string, msg: string}|undefined>(undefined);\n  const [playshotDeletedCount, setPlayshotDeletedCount] = useState(0);\n\n  const userIds = playshots.map(playshot => playshot.savedBy);\n  const users = useSelector(makeIioFilteredUserListSelector(userIds));\n  const iio = useIIO();\n  const currentUser = useSelector(makeGetCurrentUser());\n\n  useEffect(() => {\n    if(visible) {\n      dispatch(Action.Query.fetchPlayshotSummaryList(props.match.params.uid));\n    }\n  }, [visible, playshotDeletedCount]);\n\n  const handleClose = () => {\n    setLoadingPlayshotId('');\n    setPlayshotComparision(undefined);\n    setSyncError(undefined);\n    dispatch(togglePlayshotModal(props.match.params.uid, false));\n  }\n\n  const initCodyPlay = (playshot: Playshot): void => {\n    if(!board) {\n      dispatch(NotifyAction.Command.error('Failed to load Board', 'Please contact the prooph board team!'))\n      return;\n    }\n\n    if(!iio.isConnected(CODY_PLAY_SERVER_NAME)) {\n      iio.connect.Cody('play', currentUser.name, board.uid, CODY_PLAY_SERVER_NAME);\n    }\n\n    iio.runCommand(board.uid, board.name, currentUser.uid, 'InitPlayshot', playshot, CODY_PLAY_SERVER_NAME);\n\n    window.setTimeout(handleClose, 500);\n  }\n\n  const handleInitPlayshot = (playshotId: PlayshotId) => {\n    setLoadingPlayshotId(playshotId);\n\n    loadPlayshot(board.uid, playshotId).then(playshot => {\n      initCodyPlay(playshot);\n    }).catch((e: Error) => {\n      dispatch(NotifyAction.Command.error('Failed to load playshot', e.message));\n    })\n  }\n\n  const handleDeletePlayshot = (playshotId: PlayshotId) => {\n    deletePlayshot(playshotId, board.uid).then(() => {\n        setPlayshotDeletedCount((prev) => prev + 1)\n    })\n  }\n\n  const handleFromScratch = () => {\n    initCodyPlay(new Playshot({\n      name: 'From Scratch Playshot',\n      playConfig: {} as unknown as CodyPlayConfig,\n      playData: {streams: {}, documents: {}},\n      savedBy: currentUser.uid,\n      boardId: board.uid,\n    }))\n  }\n\n\n\n  if(playshotComparision) {\n    const changeSet = comparePlayshots(playshotComparision!.left, playshotComparision!.right, graph, elementsTree);\n\n    const numOfChanges = changeSet.length;\n    let error = false;\n    let lastResponse: CodyResponse | undefined;\n    const addedNodes: {[nodeId: string]: Node} = {};\n    const syncContext = elementsTree.getFilteredElementsByTag('#PlayshotSync').first(undefined);\n\n    if(!syncContext && !syncError ) {\n      setSyncError('Missing a #PlayshotSync context on the board.')\n    }\n\n    if(syncContext && syncContext.children().count() > 1 && !syncError) {\n      setSyncError({\n        title: '#PlayshotSync context is not empty!',\n        msg: 'You have to move already generated elements out of the sync context, before Cody can run the next session.'\n      })\n    }\n\n    const syncChange = async (change: PlayshotChanged, currentIteration: number) => {\n      if(!syncContext || syncError) {\n        return;\n      }\n\n      for await(const response of await change.apply({\n        syncContext,\n        graph,\n        playshot: playshotComparision!.right,\n        elementsTree,\n        addedNodes\n      })) {\n        if(response.type !== CodyResponseType.Empty) {\n          iio.print(response, 'Cody');\n        }\n\n        lastResponse = response;\n\n        if(response.type === CodyResponseType.Error) {\n          error = true;\n        }\n      }\n\n      const nextIteration = currentIteration + 1;\n\n      if(!error && nextIteration < numOfChanges) {\n        setTimeout(async () => {\n          await syncChange(changeSet[nextIteration], nextIteration);\n        }, lastResponse && (!lastResponse.type || lastResponse.type === CodyResponseType.Info) ? CODY_APPLY_PAUSE : 0);\n      } else {\n        setTimeout(() => {\n          finishSync();\n        }, CODY_APPLY_PAUSE);\n      }\n    }\n\n    const finishSync = () => {\n      dispatch(togglePlayshotModal(props.match.params.uid, true));\n      setPlayshotComparision({...playshotComparision, error, applied: true});\n    }\n\n    const handlePlayshotSync = () => {\n      if(syncError) {\n        return;\n      }\n\n      if(numOfChanges > 0) {\n        dispatch(togglePlayshotModal(props.match.params.uid, false));\n        dispatch(toggleCodyConsole(props.match.params.uid, true));\n\n        iio.print({\n          cody: `I'm going to apply the changes. Lean back and watch how the board is updated. I'll open the Playshot modal again when everything is done.`\n        }, 'Cody');\n\n        window.setTimeout(async () => {\n          await syncChange(changeSet[0], 0);\n        }, CODY_APPLY_PAUSE)\n      }\n    }\n\n    const switchPlayshot = (playshotId: string, side: 'left' | 'right') => {\n      const playshotSummary = playshots.filter(p => p.uid === playshotId).first(undefined)\n\n      if(!playshotSummary) {\n        setPlayshotComparision({\n          left: side === 'left' ? new Playshot({}) : playshotComparision.left,\n          right: side === 'right' ? new Playshot({}) : playshotComparision.right\n        })\n      } else {\n        loadPlayshot(board.uid, playshotSummary.uid).then(p => {\n          setPlayshotComparision({\n            left: side === 'left' ? p : playshotComparision.left,\n            right: side === 'right' ? p : playshotComparision.right\n          })\n        })\n      }\n    }\n\n    const playshotOptions = playshots.sort((pA, pB) => pA.savedAt < pB.savedAt? 1 : -1 )\n      .map(p => ({\n      key: p.uid,\n      text: p.name,\n      value: p.uid\n    })).toJS();\n\n    playshotOptions.push({\n      key: 'empty-playshot',\n      text: '- empty -',\n      value: ''\n    });\n\n    return <Modal open={visible} closeIcon={true} onClose={handleClose}>\n      <Modal.Header><Button basic={true} className=\"noborder\" icon=\"chevron left\" onClick={() => setPlayshotComparision(undefined)} /> Compare Playshots (beta)</Modal.Header>\n      <Modal.Content scrolling={true} style={{minHeight: \"40vh\"}}>\n        {!playshotComparision!.applied && !syncError && <Message warning={true}>This is a new feature available for testing (beta version). Use at own risk.</Message>}\n        {playshotComparision!.applied && !playshotComparision.error && <Message success={true} onDismiss={() => setPlayshotComparision(undefined)}>{props.t('insp.playshots.sync_success')}</Message>}\n        {playshotComparision!.applied && playshotComparision.error && <Message error={true} onDismiss={handleClose}>{props.t('insp.playshots.sync_error')}</Message>}\n        {!playshotComparision!.applied && syncError && <SyncErrorMessage error={syncError} />}\n        <div className={'ui grid'}>\n          <div className={'two column row'}>\n            <div className={'column'}>\n              <span>Left: </span><Dropdown\n              placeholder={'- empty -'}\n              options={playshotOptions}\n              value={playshotComparision.left.uid}\n              label={'Left Playshot'}\n              onChange={(e, {value}) => switchPlayshot(value as string, 'left')}\n            />\n            </div>\n            <div className={'column'}>\n              <div className={'column'}>\n                <span>Right: </span><Dropdown\n                placeholder={'- empty -'}\n                options={playshotOptions}\n                value={playshotComparision.right.uid}\n                label={'Right Playshot'}\n                onChange={(e, {value}) => switchPlayshot(value as string, 'right')}\n              />\n              </div>\n            </div>\n          </div>\n        </div>\n        <List className=\"playshot changes\">\n          {changeSet.map((c, index) => <PlayshotChangedDiff change={c} playshot={playshotComparision!.right}\n                                                            key={`playshot_changed_diff_${index}`} id={`playshot-changed-id-${index}`}  />)}\n        </List>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button basic={true} className=\"noborder\" icon=\"sync\" disabled={playshotComparision!.applied || !!syncError} content={props.t('insp.playshots.sync_playshot')}\n                 onClick={handlePlayshotSync}/>\n      </Modal.Actions>\n    </Modal>\n  }\n\n  let prevPlayshot: PlayshotSummary | null = null;\n\n  return <Modal open={visible} closeIcon={true} onClose={handleClose}>\n    <Modal.Header>Cody Playshots</Modal.Header>\n    <Modal.Content scrolling={true}>\n      <p>{props.t('insp.playshots.select_playshot')}</p>\n      {playshots.count() === 0 && <Message info={true}>{props.t('insp.playshots.empty')}</Message>}\n      <Table unstackable={true} basic=\"very\">\n        <Table.Body>\n          {playshots.sort((pA, pB) => pA.savedAt < pB.savedAt? 1 : -1 )\n            .reverse() // Iterate trough oldest to newest, to pass previous playshot to table row\n            .map(playshot => {\n              const nextPlayshot = <PlayshotTableRow\n                playshot={playshot}\n                previous={prevPlayshot}\n                users={users} key={playshot.uid}\n                loading={loadingPlayshotId === playshot.uid}\n                onInitPlayshot={handleInitPlayshot}\n                onComparePlayshots={c => setPlayshotComparision(c)}\n                onDeletePlayshot={handleDeletePlayshot}\n              />;\n\n              prevPlayshot = playshot;\n\n              return nextPlayshot;\n            })\n            .reverse() // Reverse back, to show newest to oldest\n            .toArray()}\n        </Table.Body>\n      </Table>\n    </Modal.Content>\n    <Modal.Actions>\n      <Button basic={true} className=\"noborder\" icon=\"play circle\" content={props.t('insp.playshots.start_from_scratch')} onClick={handleFromScratch} />\n    </Modal.Actions>\n  </Modal>\n};\n\nexport default withRouter(withNamespaces()(PlayshotModal));\n\nconst SyncErrorMessage = (props: {error: string | {title: string, msg: string}}) => {\n  const title = typeof props.error === \"string\" ? undefined : props.error.title;\n  const msg = typeof props.error === \"string\" ? props.error : props.error.msg;\n\n  return <Message error={true}>\n    {title && <MessageHeader>{title}</MessageHeader>}\n    <p>\n      {msg}\n    </p>\n  </Message>\n}\n","import { History } from 'history'\nimport * as React from 'react';\nimport { I18nextProvider } from 'react-i18next';\nimport { Provider } from 'react-redux';\nimport {\n    BrowserRouter as Router,\n    Redirect,\n    Route,\n    RouteComponentProps, Switch, withRouter\n} from \"react-router-dom\";\nimport { Store } from 'redux';\nimport {\n  Button,\n  Container,\n  Grid,\n  GridColumn,\n  GridRow,\n  Icon,\n  Image,\n  Menu,\n  MenuItem,\n  Message, MessageContent,\n  Segment\n} from 'semantic-ui-react';\nimport i18n from './i18n';\nimport { BoardOverview, EditBoard, MxGraphBoard, UserProfile} from \"./InspectioBoards\";\nimport BoardHistory from \"./InspectioBoards/components/BoardHistory\";\nimport BoardInvitation from \"./InspectioBoards/components/BoardInvitation\";\nimport TeamInvitation from \"./InspectioTeams/components/TeamInvitation\";\nimport TeamOverview from \"./InspectioTeams/components/TeamOverview\";\nimport * as Layout from './Layout';\nimport Sidebar from \"./Layout/Sidebar\";\nimport {NotificationContainer} from './NotificationSystem';\nimport { ApplicationState } from './reducer';\nimport * as Routes from './routes';\nimport UpdatePage from \"./Updates/components/UpdatePage\";\nimport BoardElementDetails from \"./InspectioBoards/components/BoardElementDetails\";\nimport AcceptOrganizationInvitation from \"./Organization/components/AcceptOrganizationInvitation\";\nimport CodyConsole from \"./InspectioBoards/components/CodyConsole\";\nimport OrganizationOverview from \"./Organization/components/OrganizationOverview\";\nimport BoardImportFromLink from \"./InspectioBoards/components/BoardImportFromLink\";\nimport MxGraphBoardRedirect from \"./InspectioBoards/components/MxGraphBoardRedirect\";\n// tslint:disable-next-line\nimport './theme/semantic/semantic.css';\n// tslint:disable-next-line\nimport './theme/css/style.css';\nimport BoardTimer from \"./InspectioBoards/components/MxGraphBoard/BoardTimer\";\nimport PlayshotModal from \"./InspectioBoards/components/MxGraphBoard/PlayshotModal\";\nimport SideBySideDetails from \"./InspectioBoards/components/SideBySideDetails\";\n\n\n\n\n// The Main component renders one of provided\n// Routes (provided that one matches).\nconst Main = () => (\n    <Switch>\n        <Redirect exact={true} path={Routes.root} to={Routes.inspectio}/>\n        <Route exact={true} path={Routes.inspectio} component={BoardOverview}/>\n        <Route exact={true} path={Routes.inspectioEditBoard} component={EditBoard}/>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={MxGraphBoard}/>\n        <Route exact={true} path={Routes.boardInvitation} component={BoardInvitation} />\n        <Route exact={true} path={Routes.userProfile} component={UserProfile} />\n        <Route exact={true} path={Routes.teamOverview} component={TeamOverview} />\n        <Route exact={true} path={Routes.teamInvitation} component={TeamInvitation} />\n        <Route exact={true} path={Routes.Updates} component={UpdatePage} />\n        <Route exact={true} path={Routes.BoardRedirect} component={MxGraphBoardRedirect} />\n        <Route exact={true} path={Routes.organizationOverview} component={OrganizationOverview} />\n        <Route exact={true} path={Routes.organizationInvitation} component={AcceptOrganizationInvitation} />\n        <Route exact={true} path={Routes.boardImportLink} component={BoardImportFromLink} />\n    </Switch>\n);\n\nconst RootFC = (props: RouteComponentProps) => (\n    <Container fluid={true}>\n        <Layout.TopMenu />\n        <div style={{zIndex:103,position:\"fixed\",display:\"flex\",flexDirection:\"column\",top:\"0\",bottom:\"0\",left:\"0\",overflowX:\"hidden\",flex:\"1\"}}>\n        <Sidebar />\n        </div>\n        <div style={{marginLeft:\"250px\", paddingTop:\"90px\"}}>\n        <Main/>\n        </div>\n        <NotificationContainer/>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={CodyConsole} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardHistory} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={SideBySideDetails} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardElementDetails} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardTimer} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={PlayshotModal} />\n    </Container>\n);\n\nconst Root = withRouter(RootFC);\n\n// Separate props from state and props from dispatch to their own interfaces.\n\n// Any additional component props go here.\ninterface OwnProps {\n    store: Store<ApplicationState>\n    history: History\n}\n\n// Create an intersection type of the component props and our Redux props.\ntype AllProps =  OwnProps\n\nclass App extends React.Component<AllProps> {\n    public render() {\n        const { store } = this.props;\n\n        return (\n            <I18nextProvider i18n={i18n}>\n                <Provider store={store}>\n                    <Router basename=\"/\">\n                        <Root/>\n                    </Router>\n                </Provider>\n            </I18nextProvider>\n        )\n    }\n}\n\nexport default App;\n","import * as React from 'react';\nimport {withNamespaces, WithNamespaces} from \"react-i18next\";\nimport {useDispatch} from \"react-redux\";\nimport {RouteComponentProps, withRouter} from \"react-router\";\nimport {NavLink} from \"react-router-dom\";\nimport { pure } from 'recompose';\nimport {Dropdown} from \"semantic-ui-react\";\nimport {\n    toggleBoardHistory,\n    toggleCodyConsole,\n    toggleElementDetails, togglePlayshotModal,\n    triggerExportBoard,\n    triggerImportBoard\n} from \"../../../InspectioBoards/actions/commands\";\nimport {BoardId} from \"../../../InspectioBoards/model/Board\";\nimport * as Routes from \"../../../routes\";\nimport CollaborationInfoModal from \"../CollaborationInfoModal\";\nimport {useState} from \"react\";\n\ninterface BoardTopMenuRouteMatchParams {\n    uid: BoardId;\n}\n\ntype BoardTopMenuProps =  WithNamespaces & RouteComponentProps<BoardTopMenuRouteMatchParams>;\n\nconst BoardTopMenu = pure((props: BoardTopMenuProps) => {\n\n    const [infoModalOpen, setInfoModalOpen] = useState(false);\n\n    const dispatch = useDispatch();\n\n    return <><Dropdown item={true} icon=\"ellipsis vertical\">\n        <Dropdown.Menu direction=\"left\">\n            <Dropdown.Item icon=\"history\" text=\"Activity\" onClick={() => setInfoModalOpen(true)} />\n            <Dropdown.Item\n                icon={'clipboard outline'}\n                text={props.t('insp.top_menu.element_details')}\n                onClick={() => dispatch(toggleElementDetails(props.match.params.uid, true, false))}\n            />\n            <Dropdown.Item icon=\"code\" text=\"Cody\" onClick={() => dispatch(toggleCodyConsole(props.match.params.uid, true)) } />\n            <Dropdown.Item icon=\"play\" text=\"Cody Play\" onClick={() => dispatch(togglePlayshotModal(props.match.params.uid, true))} />\n            <Dropdown.Item icon=\"cog\" text=\"Settings\" to={Routes.compileInspectioBoardEdit(props.match.params.uid)} as={NavLink}/>\n            <Dropdown.Item icon=\"download\" text=\"Import Board\" onClick={() => dispatch(triggerImportBoard(props.match.params.uid))} />\n            <Dropdown.Item icon=\"upload\" text=\"Export Board\" onClick={() => dispatch(triggerExportBoard(props.match.params.uid))} />\n            <Dropdown.Item icon=\"question\" text=\"FAQs\" as=\"a\" href=\"https://wiki.prooph-board.com\" target=\"_blank\" />\n        </Dropdown.Menu>\n    </Dropdown>\n        <CollaborationInfoModal open={infoModalOpen} onClose={() => setInfoModalOpen(false)} headerKey={'header_history'} />\n    </>});\n\nexport default withNamespaces()(withRouter(BoardTopMenu));\n","import * as React from 'react';\nimport {useState} from \"react\";\nimport {Button, Icon, MenuItem} from \"semantic-ui-react\";\nimport CollaborationInfoModal from \"./CollaborationInfoModal\";\n\ninterface OwnProps {\n\n}\n\ntype ShareBoardButtonProps = OwnProps;\n\nconst ShareBoardButton = (props: ShareBoardButtonProps) => {\n    const [open, setOpen] = useState(false);\n\n    const handleClose = () => {\n        setOpen(false);\n    }\n\n    return <>\n        <MenuItem>\n            <Button icon={true} className=\"share\" onClick={() => setOpen(true)}><Icon name=\"share alternate\"/>&nbsp;share</Button>\n        </MenuItem>\n        <CollaborationInfoModal open={open} onClose={handleClose} headerKey='header_team' />\n    </>\n};\n\nexport default ShareBoardButton;\n","import * as React from 'react';\nimport { withNamespaces, WithNamespaces } from 'react-i18next';\nimport {useSelector} from \"react-redux\";\nimport {Route, RouteComponentProps, withRouter} from 'react-router';\nimport {Breadcrumb, Menu, MenuItem} from 'semantic-ui-react';\nimport * as Routes from '../../../routes';\nimport {makeGetSidebarSelector} from \"../../../Layout/selectors/sidebar\";\nimport BoardOverviewCrumb from \"../../../Layout/Breadcrumb/BoardOverviewCrumb\";\nimport UpdatesCrumb from \"../../../Layout/Breadcrumb/UpdatesCrumb\";\nimport BoardCrumb from \"../../../Layout/Breadcrumb/BoardCrumb\";\nimport BoardTopMenu from \"./BoardTopMenu\";\nimport ShareBoardButton from \"../ShareBoardButton\";\n\ntype TopMenuProps =  WithNamespaces & RouteComponentProps<{uid?: string}>;\n\nconst TopMenu = (props: TopMenuProps) => {\n    const sidebar = useSelector(makeGetSidebarSelector());\n    const isBoardWorkspace = Routes.isInspectioBoardWorkspace(props.location.pathname);\n\n    const paddingLeft = isBoardWorkspace? (sidebar.width + 20) + 'px' : '270px';\n\n    return (<Menu fixed=\"top\" inverted={false} id=\"topmenu\" style={{paddingLeft}} className=\"touch-only-pan\">\n        <Route path={Routes.inspectio}>\n            <MenuItem>\n                <Breadcrumb>\n                    <Route exact={true} path={[Routes.inspectio, Routes.inspectioBoardWorkspace, Routes.inspectioEditBoard]} component={BoardOverviewCrumb} />\n                    <Route exact={true} path={Routes.Updates} component={UpdatesCrumb} />\n                    <Route exact={true} path={[Routes.inspectioBoardWorkspace, Routes.inspectioEditBoard]} component={BoardCrumb} />\n                </Breadcrumb>\n            </MenuItem>\n        </Route>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={ShareBoardButton} />\n        <Menu.Menu position='right' />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardTopMenu} />\n    </Menu>);\n};\n\nexport default withNamespaces()(withRouter(TopMenu));\n","import { History } from 'history'\nimport * as React from 'react';\nimport { I18nextProvider } from 'react-i18next';\nimport { Provider } from 'react-redux';\nimport {\n    BrowserRouter as Router,\n    Redirect,\n    Route,\n    RouteComponentProps, Switch, withRouter\n} from \"react-router-dom\";\nimport { Store } from 'redux';\nimport { Button, Container, Grid, GridColumn, GridRow, Icon, Image, Menu, MenuItem, Segment } from 'semantic-ui-react';\nimport i18n from './i18n';\nimport { BoardOverview, EditBoard, MxGraphBoard, UserProfile} from \"./InspectioBoards\";\nimport BoardHistory from \"./InspectioBoards/components/BoardHistory\";\nimport Sidebar from \"./Layout/Sidebar\";\nimport {NotificationContainer} from './NotificationSystem';\nimport { ApplicationState } from './reducer';\nimport * as Routes from './routes';\nimport UpdatePage from \"./Updates/components/UpdatePage\";\nimport BoardElementDetails from \"./InspectioBoards/components/BoardElementDetails\";\nimport CodyConsole from \"./InspectioBoards/components/CodyConsole\";\nimport MxGraphBoardRedirect from \"./InspectioBoards/components/MxGraphBoardRedirect\";\nimport TopMenu from \"./standalone/components/Layout/TopMenu\";\nimport BoardImportFromLink from \"./InspectioBoards/components/BoardImportFromLink\";\n// tslint:disable-next-line\nimport './theme/semantic/semantic.css';\n// tslint:disable-next-line\nimport './theme/css/style.css';\nimport PlayshotModal from \"./InspectioBoards/components/MxGraphBoard/PlayshotModal\";\nimport SideBySideDetails from \"./InspectioBoards/components/SideBySideDetails\";\n\n\n\n// The Main component renders one of provided\n// Routes (provided that one matches).\nconst Main = () => (\n    <Switch>\n        <Redirect exact={true} path={Routes.root} to={Routes.inspectio}/>\n        <Route exact={true} path={Routes.inspectio} component={BoardOverview}/>\n        <Route exact={true} path={Routes.inspectioEditBoard} component={EditBoard}/>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={MxGraphBoard}/>\n        <Route exact={true} path={Routes.Updates} component={UpdatePage} />\n        <Route exact={true} path={Routes.BoardRedirect} component={MxGraphBoardRedirect} />\n    </Switch>\n);\n\nconst RootFC = (props: RouteComponentProps) => (\n    <Container fluid={true}>\n        <TopMenu />\n        <div style={{zIndex:103,position:\"fixed\",display:\"flex\",flexDirection:\"column\",top:\"0\",bottom:\"0\",left:\"0\",overflowX:\"hidden\",flex:\"1\"}}>\n            <Sidebar />\n        </div>\n        <div style={{marginLeft:\"250px\", paddingTop:\"90px\"}}>\n            <Main/>\n        </div>\n        <NotificationContainer/>\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={CodyConsole} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardHistory} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={SideBySideDetails} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={BoardElementDetails} />\n        <Route exact={true} path={Routes.boardImportLink} component={BoardImportFromLink} />\n        <Route exact={true} path={Routes.inspectioBoardWorkspace} component={PlayshotModal} />\n    </Container>\n);\n\nconst Root = withRouter(RootFC);\n\n// Separate props from state and props from dispatch to their own interfaces.\n\n// Any additional component props go here.\ninterface OwnProps {\n    store: Store<ApplicationState>\n    history: History\n}\n\n// Create an intersection type of the component props and our Redux props.\ntype AllProps =  OwnProps\n\nclass App extends React.Component<AllProps> {\n    public render() {\n        const { store } = this.props;\n\n        const baseName = window.location.pathname.search(/^\\/free-version/) === 0 ? '/free-version/' : '/';\n\n        return (\n            <I18nextProvider i18n={i18n}>\n                <Provider store={store}>\n                    <Router basename={baseName}>\n                        <Root/>\n                    </Router>\n                </Provider>\n            </I18nextProvider>\n        )\n    }\n}\n\nexport default App;\n","import { Map } from 'immutable';\nimport { Reducer } from 'redux';\nimport {\n    AUTHENTICATE\n} from \"../actions/constants\";\nimport { AuthAction } from './index';\n\nexport interface AuthState extends Map<string, any>{\n}\n\nexport const initialState = Map<string, null>();\n\nconst reducer: Reducer<AuthState, AuthAction> = (state: AuthState = initialState, action: AuthAction): AuthState => {\n    switch (action.type) {\n        case AUTHENTICATE:\n            return state.set('token', action.payload.auth.token);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as applyAuth };","import { fromJS } from 'immutable';\nimport { combineReducers } from 'redux-immutable';\nimport { ActionType } from 'typesafe-actions';\nimport * as Commands from '../actions/commands';\nimport { applyAuth, AuthState } from './applyAuth';\n\nexport type AuthAction = ActionType<typeof Commands>;\n\nexport interface InspectioAuthState {\n    auth: AuthState\n}\n\nexport const authReducer = combineReducers<InspectioAuthState, AuthAction>({\n    auth: applyAuth,\n}, () => fromJS({}));","import {List, Map} from 'immutable';\nimport {forEach} from 'lodash';\nimport {Reducer} from 'redux';\nimport {Action as TeamAction} from \"../../InspectioTeams\";\nimport {Team} from \"../../InspectioTeams/model\";\nimport {UserModel} from \"../../User/model\";\nimport {\n    ABORT_BOARD_DELETION,\n    ADD_BOARD,\n    BOARD_ACCESS_REVOKED,\n    BOARD_EXPORTED,\n    BOARD_IMPORT_STARTED,\n    BOARD_IMPORTED,\n    BOARD_SHARED_WITH_ANYONE,\n    BOARD_SHARED_WITH_ORGANIZATION_MEMBERS,\n    CHANGE_BOARD_ABBREVIATION,\n    CHANGE_RESPONSIBLE_TEAM,\n    CLEAR_BOARD_HISTORY,\n    CONFIRM_DELETE_BOARD,\n    DELETE_BOARD,\n    FORCE_UPDATE_BOARDS,\n    RENAME_BOARD,\n    SAVE_BOARD,\n    SET_BOARD_DETAILS_FETCHED,\n    SET_BOARD_TAGS,\n    SET_BOARD_TO_SNAPSHOT,\n    TOGGLE_BOARD_HISTORY,\n    TOGGLE_CODY_CONSOLE,\n    TOGGLE_CODY_SUGGEST_ENABLED,\n    TOGGLE_ELEMENT_DETAILS,\n    TOGGLE_EVENT_MODELING_ENABLED,\n    TOGGLE_PLAYSHOT_MODAL,\n    TOGGLE_TIMER_MODAL,\n    TOGGLE_VIDEO_SESSION,\n    TRIGGER_EXPORT_BOARD,\n    TRIGGER_IMPORT_BOARD,\n    UPDATE_BOARDS,\n    USER_BOARD_MOVED_TO_ORGANIZATION,\n} from '../actions/constants';\nimport {BoardModel} from '../model';\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardsState extends Map<string, BoardModel.Board> {\n}\n\nexport const initialState: BoardsState = Map<string, BoardModel.Board>();\n\nconst reducer: Reducer<BoardsState, InspectioBoardsAction> = (state: BoardsState = initialState, action: InspectioBoardsAction): BoardsState => {\n    switch (action.type) {\n        case ADD_BOARD:\n            const newBoard = action.payload.board;\n            return state.set(newBoard.uid, newBoard);\n        case UPDATE_BOARDS:\n            const boards = action.payload;\n            forEach(boards, (board: BoardModel.Board) => {\n                // Do not override already fetched boards\n                if(!state.get(board.uid)) {\n                    state = state.set(board.uid, board)\n                } else {\n                    const existingBoard = state.get(board.uid);\n                    state = state.set(board.uid, existingBoard!.syncSummaryInfo(board));\n                }\n            });\n            return state;\n        case FORCE_UPDATE_BOARDS:\n            forEach(action.payload, (board: BoardModel.Board) => {\n                state = state.set(board.uid, board)\n            });\n            return state;\n        case SET_BOARD_TO_SNAPSHOT:\n            let boardToUpdate: BoardModel.Board | undefined = state.get(action.payload.snapshot.boardId);\n\n            if(boardToUpdate) {\n                boardToUpdate = boardToUpdate.updateXmlFromSnapshot(action.payload.snapshot);\n                boardToUpdate = boardToUpdate.set('detailsFetched', true);\n                state = state.set(action.payload.snapshot.boardId, boardToUpdate);\n            }\n            return state;\n        case SET_BOARD_DETAILS_FETCHED:\n            let boardToUpdateFetched: BoardModel.Board | undefined = state.get(action.payload.boardId);\n\n            if(boardToUpdateFetched) {\n                boardToUpdateFetched = boardToUpdateFetched.set('detailsFetched', true);\n                boardToUpdateFetched = boardToUpdateFetched.set('writeAccess', action.payload.writeAccess);\n                state = state.set(action.payload.boardId, boardToUpdateFetched);\n            }\n            return state;\n        case CLEAR_BOARD_HISTORY:\n            // We use this action to also reset the detailsFetched flag, it is triggered by MxGraphBoard on component will unmount\n            let boardToResetFetched: BoardModel.Board | undefined = state.get(action.payload.boardId);\n\n            if(boardToResetFetched) {\n                boardToResetFetched = boardToResetFetched.set('detailsFetched', false);\n                state = state.set(action.payload.boardId, boardToResetFetched);\n            }\n            return state;\n        case SAVE_BOARD:\n            let boardToSave = state.get(action.payload.board.uid);\n\n            if(boardToSave) {\n                boardToSave = boardToSave.updateXmlAndVersionFromBoard(action.payload.board);\n                state = state.set(action.payload.board.uid, boardToSave);\n            }\n            return state;\n        case RENAME_BOARD:\n        case CHANGE_BOARD_ABBREVIATION:\n        case SET_BOARD_TAGS:\n        case CHANGE_RESPONSIBLE_TEAM:\n        case TOGGLE_CODY_SUGGEST_ENABLED:\n        case TOGGLE_EVENT_MODELING_ENABLED:\n            return  state.setIn([action.payload.board.uid], action.payload.board);\n        case CONFIRM_DELETE_BOARD:\n            return state.setIn([action.payload.boardId, 'inDeletion'], true);\n        case ABORT_BOARD_DELETION:\n            return state.setIn([action.payload.boardId, 'inDeletion'], false);\n        case DELETE_BOARD:\n            return state.removeIn([action.payload.boardId]);\n        case TRIGGER_IMPORT_BOARD:\n            return state.setIn([action.payload.boardId, 'shouldImport'], true);\n        case BOARD_IMPORTED:\n        case BOARD_IMPORT_STARTED:\n            return state.setIn([action.payload.boardId, 'shouldImport'], false);\n        case TRIGGER_EXPORT_BOARD:\n            return state.setIn([action.payload.boardId, 'shouldExport'], true);\n        case BOARD_EXPORTED:\n            return state.setIn([action.payload.boardId, 'shouldExport'], false);\n        case TOGGLE_BOARD_HISTORY:\n            if (action.payload.visible) {\n                state = state.setIn([action.payload.boardId, 'shouldShowElementDetails'], false);\n            }\n\n            return state.setIn([action.payload.boardId, 'shouldShowHistory'], action.payload.visible);\n        case TOGGLE_ELEMENT_DETAILS:\n            if (action.payload.visible) {\n                state = state.setIn([action.payload.boardId, 'shouldShowHistory'], false);\n            }\n\n            state = state.setIn([action.payload.boardId, 'shouldFocusMetadataEditor'], action.payload.focusEditor);\n\n            return state.setIn([action.payload.boardId, 'shouldShowElementDetails'], action.payload.visible);\n        case TOGGLE_CODY_CONSOLE:\n            return state.setIn([action.payload.boardId, 'shouldShowCodyConsole'], action.payload.visible);\n        case TOGGLE_PLAYSHOT_MODAL:\n            return state.setIn([action.payload.boardId, 'shouldShowPlayshotModal'], action.payload.visible)\n        case TOGGLE_TIMER_MODAL:\n            state = state.setIn([action.payload.boardId, 'shouldShowTimerModal'], action.payload.visible);\n            return state;\n        case TOGGLE_VIDEO_SESSION:\n            state = state.setIn([action.payload.boardId, 'videoSessionActive'], action.payload.active);\n            return state;\n        case BOARD_ACCESS_REVOKED:\n            const members: List<UserModel.UserId> = state.getIn([action.payload.boardId, 'sharedWith'], List());\n            return state.setIn([action.payload.boardId, 'sharedWith'], members.filter(m => m !== action.payload.userId));\n        case USER_BOARD_MOVED_TO_ORGANIZATION:\n            return state.set(action.payload.uid, action.payload);\n        // Team Events\n        case TeamAction.Type.TEAM_ACCESS_TO_BOARD_GRANTED:\n            const teamsAdd: List<Team.TeamId> = state.getIn([action.payload.boardId, 'assignedTeams'], List());\n            return state.setIn([action.payload.boardId, 'assignedTeams'], teamsAdd.push(action.payload.teamId));\n        case TeamAction.Type.TEAM_ACCESS_TO_BOARD_REVOKED:\n            const teamsRevoke: List<Team.TeamId> = state.getIn([action.payload.boardId, 'assignedTeams'], List());\n            return state.setIn([action.payload.boardId, 'assignedTeams'], teamsRevoke.filter(t => t !== action.payload.teamId));\n        case BOARD_SHARED_WITH_ORGANIZATION_MEMBERS:\n            state = state.setIn([action.payload.boardId, 'orgaMemberPermissions'], action.payload.permissions);\n            return state;\n        case BOARD_SHARED_WITH_ANYONE:\n            state = state.setIn([action.payload.boardId, 'anyonePermissions'], action.payload.permissions);\n            return state;\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveBoardReducer };\n","import {List, Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {\n    BOARD_CLIENT_FETCHED, BOARD_CLIENT_NOT_CONFIGURED, BOARD_CLIENT_SECRET_FETCHED,\n} from '../actions/constants';\nimport {BoardClient} from \"../model/BoardClient\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardClientsState extends Map<string, BoardClient|null> {\n}\n\nexport const initialState: BoardClientsState = Map<string, BoardClient|null>();\n\nconst reducer: Reducer<BoardClientsState, InspectioBoardsAction> = (state: BoardClientsState = initialState, action: InspectioBoardsAction): BoardClientsState => {\n    switch (action.type) {\n        case BOARD_CLIENT_FETCHED:\n            return state.set(action.payload.boardId, action.payload.client);\n        case BOARD_CLIENT_NOT_CONFIGURED:\n            return state.set(action.payload.boardId, null);\n        case BOARD_CLIENT_SECRET_FETCHED:\n            return state.setIn([action.payload.boardId, 'clientSecret'], action.payload.clientSecret);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveBoardClientsReducer };\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {\n    BOARD_GRAPH_ELEMENTS_FETCHED,\n} from '../actions/constants';\nimport {BoardGraphElement} from \"../model\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardGraphElementsState extends Map<string, Map<string, BoardGraphElement.BoardGraphElement>> {\n}\n\nexport const initialState: BoardGraphElementsState = Map<string, Map<string, BoardGraphElement.BoardGraphElement>>();\n\nconst reducer: Reducer<BoardGraphElementsState, InspectioBoardsAction> = (state: BoardGraphElementsState = initialState, action: InspectioBoardsAction): BoardGraphElementsState => {\n    switch (action.type) {\n        case BOARD_GRAPH_ELEMENTS_FETCHED:\n            const boardElementsState = state.get(action.payload.boardId) || Map<string, BoardGraphElement.BoardGraphElement>();\n            return state.set(action.payload.boardId, upsertAggregates(boardElementsState, action.payload.elements));\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveBoardGraphElementsReducer };\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {updateAggregate, upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {BOARD_INVITATION_RESENT, BOARD_INVITATION_REVOKED, OPEN_BOARD_INVITATIONS_FETCHED} from '../actions/constants';\nimport {BoardInvitation} from \"../model\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardInvitationState extends Map<string, BoardInvitation.BoardInvitation> {\n}\n\nexport const initialState: BoardInvitationState = Map<string, BoardInvitation.BoardInvitation>();\n\nconst reducer: Reducer<BoardInvitationState, InspectioBoardsAction> = (state: BoardInvitationState = initialState, action: InspectioBoardsAction): BoardInvitationState => {\n    switch (action.type) {\n        case OPEN_BOARD_INVITATIONS_FETCHED:\n            return upsertAggregates(state, action.payload.boardInvitations);\n        case BOARD_INVITATION_RESENT:\n            return updateAggregate(state, action.payload.boardInvitation);\n        case BOARD_INVITATION_REVOKED:\n            return updateAggregate(state, action.payload.boardInvitation);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveBoardInvitationReducer };\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {updateAggregate, upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {BOARD_PERMISSIONS_FOR_TEAMS_FETCHED, TEAM_BOARD_PERMISSIONS_CHANGED} from '../actions/constants';\nimport {BoardPermissionForTeam} from \"../model\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardPermissionsForTeamsState extends Map<string, BoardPermissionForTeam.BoardPermissionForTeam> {\n}\n\nexport const initialState: BoardPermissionsForTeamsState = Map<string, BoardPermissionForTeam.BoardPermissionForTeam>();\n\nconst reducer: Reducer<BoardPermissionsForTeamsState, InspectioBoardsAction> = (state: BoardPermissionsForTeamsState = initialState, action: InspectioBoardsAction): BoardPermissionsForTeamsState => {\n    switch (action.type) {\n        case BOARD_PERMISSIONS_FOR_TEAMS_FETCHED:\n            return upsertAggregates(state, action.payload.boardPermissions);\n        case TEAM_BOARD_PERMISSIONS_CHANGED:\n            return updateAggregate(state, action.payload);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveBoardPermissionsForTeamsReducer };\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {\n    BOARD_ACCESS_REVOKED,\n    BOARD_PERMISSIONS_CHANGED,\n    BOARD_PERMISSIONS_FOR_USERS_FETCHED,\n} from '../actions/constants';\nimport {BoardPermissionForUser} from \"../model\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardPermissionsForUsersState extends Map<string, BoardPermissionForUser.BoardPermissionForUser> {\n}\n\nexport const initialState: BoardPermissionsForUsersState = Map<string, BoardPermissionForUser.BoardPermissionForUser>();\n\nconst reducer: Reducer<BoardPermissionsForUsersState, InspectioBoardsAction> = (state: BoardPermissionsForUsersState = initialState, action: InspectioBoardsAction): BoardPermissionsForUsersState => {\n    switch (action.type) {\n        case BOARD_PERMISSIONS_FOR_USERS_FETCHED:\n            return upsertAggregates(state, action.payload.boardPermissions);\n        case BOARD_PERMISSIONS_CHANGED: {\n            const boardId = action.payload.boardId;\n            const userId = action.payload.userId;\n            const boardPermission: BoardPermissionForUser.BoardPermissionForUser | undefined = state.valueSeq().toArray()\n                .find(permissionEntry => permissionEntry.boardId === boardId && permissionEntry.userId === userId);\n\n            if (boardPermission) {\n                return state.setIn([boardPermission.uid, 'permissions'], action.payload.permissions);\n            }\n\n            return state;\n        }\n        case BOARD_ACCESS_REVOKED: {\n            const boardId = action.payload.boardId;\n            const userId = action.payload.userId;\n            const boardPermission: BoardPermissionForUser.BoardPermissionForUser | undefined = state.valueSeq().toArray()\n                .find(permissionEntry => permissionEntry.boardId === boardId && permissionEntry.userId === userId);\n\n            if (boardPermission) {\n                return state.remove(boardPermission.uid);\n            }\n\n            return state;\n        }\n        default:\n            return state;\n    }\n};\n\nexport { reducer as saveBoardPermissionsForUsersReducer };\n","import {List, Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {\n    FILTER_ELEMENTS_TREE,\n    UPDATE_BOARD_ELEMENTS_TREE\n} from \"../actions/constants\";\nimport {ElementsTree} from \"../model/ElementsTree\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface ElementsTreeState extends Map<string, ElementsTree>{\n\n}\n\nexport const initialState: ElementsTreeState = Map<string, ElementsTree>();\n\nconst reducer: Reducer<ElementsTreeState, InspectioBoardsAction> = (state: ElementsTreeState = initialState, action: InspectioBoardsAction): ElementsTreeState => {\n    switch (action.type) {\n        case UPDATE_BOARD_ELEMENTS_TREE:\n            const oldElementsTree = state.get(action.payload.boardId, new ElementsTree({elements: List()}));\n            return state.set(action.payload.boardId, oldElementsTree.mergeTree(new ElementsTree({elements: action.payload.elements})));\n        case FILTER_ELEMENTS_TREE:\n            const oldFilteredTree = state.get(action.payload.boardId, new ElementsTree({elements: List()}));\n            return state.set(action.payload.boardId, oldFilteredTree.set('filter', action.payload.filter).set('focus', action.payload.focus || false));\n        default:\n            return state;\n    }\n};\n\nexport {reducer as elementsTreeReducer};\n","import {Record} from 'immutable';\nimport {Reducer} from \"redux\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {\n    DISMISS_MAINTENANCE_MESSAGE,\n    FILTER_BOARD_OVERVIEW,\n    FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM,\n    HIDE_OWN_BOARDS_ON_OVERVIEW,\n    HIDE_SHARED_BOARDS_ON_OVERVIEW,\n    SORT_BOARD_OVERVIEW\n} from \"../actions/constants\";\nimport {SORT_OPTIONS} from \"../components/BoardOverview/Sorting\";\nimport {InspectioBoardsAction} from './index';\n\nexport interface BoardOverviewStateData {\n    filter: string;\n    sortBy: SORT_OPTIONS;\n    responsibleTeam?: TeamId;\n    allSharedBoardsHidden: boolean;\n    allOwnBoardsHidden: boolean;\n    showMaintenanceMessage: boolean;\n}\n\nconst defaultBoardOverviewState: BoardOverviewStateData = {\n    filter: '',\n    sortBy: SORT_OPTIONS.LAST_MODIFIED_DESC,\n    responsibleTeam: undefined,\n    allSharedBoardsHidden: false,\n    allOwnBoardsHidden: false,\n    showMaintenanceMessage: false,\n};\n\nexport class BoardOverviewState extends Record(defaultBoardOverviewState) implements BoardOverviewStateData {}\n\nexport const initialState = new BoardOverviewState();\n\nconst reducer: Reducer<BoardOverviewState, InspectioBoardsAction> = (state: BoardOverviewState = initialState, action: InspectioBoardsAction): BoardOverviewState => {\n    switch (action.type) {\n        case FILTER_BOARD_OVERVIEW:\n            return state.set('filter', action.payload.filter);\n        case SORT_BOARD_OVERVIEW:\n            return state.set('sortBy', action.payload.sort);\n        case FILTER_BOARD_OVERVIEW_BY_RESPONSIBLE_TEAM:\n            return state.set('responsibleTeam', action.payload.teamId);\n        case HIDE_SHARED_BOARDS_ON_OVERVIEW:\n            return state.set('allSharedBoardsHidden', action.payload.hide);\n        case HIDE_OWN_BOARDS_ON_OVERVIEW:\n            return state.set('allOwnBoardsHidden', action.payload.hide);\n        case DISMISS_MAINTENANCE_MESSAGE:\n            return state.set('showMaintenanceMessage', false);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as boardOverviewReducer };\n","import {List, Map} from \"immutable\";\nimport moment from \"moment\";\nimport { Reducer } from 'redux';\nimport {\n    APPEND_HISTORY_ENTRIES,\n    CLEAR_BOARD_HISTORY,\n    PREPEND_HISTORY_ENTRIES,\n    SET_IS_LOADING_HISTORY, SET_NO_MORE_HISTORY_AVAILABLE\n} from \"../actions/constants\";\nimport {BoardHistory, HistoryAction, HistoryCellType, HistoryEntry} from \"../model/HistoryEntry\";\nimport {HistoryState} from \"../model/HistoryState\";\nimport {InspectioBoardsAction} from \"./index\";\n\nexport interface BoardHistoryState extends Map<string, HistoryState>{\n\n}\n\nconst filterDuplicates = (history: BoardHistory): BoardHistory => {\n    const filteredEntries: HistoryEntry[] = [];\n    const historyArr = history.toArray();\n\n    let skipNext: boolean = false;\n    let setPrevLabel: boolean = false;\n    let prevLabel: string = '';\n    let prevRecordedAt: string|null = null;\n    let prevAction: HistoryAction|null = null;\n\n    historyArr.forEach((entry, i) => {\n\n        if(!skipNext && setPrevLabel) {\n            entry = entry.set('label', prevLabel);\n            setPrevLabel = false;\n            prevLabel = '';\n        }\n\n        if(i+1 < historyArr.length) {\n            const next = historyArr[i+1];\n\n            if(entry.userId !== next.userId) {\n                filteredEntries.push(entry);\n                skipNext = false;\n                setPrevLabel = false;\n                prevLabel = '';\n                prevRecordedAt = null;\n                prevAction = null;\n                return true;\n            }\n\n            if(prevRecordedAt && prevAction === entry.action) {\n                entry = entry.set('date', prevRecordedAt);\n            }\n\n            prevRecordedAt = null;\n            prevAction = null;\n\n            if(entry.cellId === next.cellId) {\n                if(entry.action === next.action) {\n                    if(entry.cellType !== HistoryCellType.multiple && entry.cellType !== HistoryCellType.misc) {\n                        prevLabel = entry.label;\n                        prevRecordedAt = entry.date;\n                        prevAction = entry.action;\n                        // Skipping current, so that two edited entries + one added result in one added with label\n                        skipNext = false;\n                        setPrevLabel = true;\n                        return true;\n                    }\n\n                    if(!skipNext) {\n                        filteredEntries.push(entry);\n                    }\n\n                    skipNext = true;\n                    return true;\n                }\n\n                if(entry.action === HistoryAction.edited && next.action === HistoryAction.added) {\n                    skipNext = false;\n                    setPrevLabel = true;\n                    prevLabel = entry.label;\n                    return true;\n                }\n            }\n        }\n\n        if(!skipNext) {\n            filteredEntries.push(entry);\n        }\n\n        skipNext = false;\n        prevLabel = '';\n        setPrevLabel = false;\n        prevAction = null;\n        prevRecordedAt = null;\n    });\n\n    const filteredEntriesList: BoardHistory = List(filteredEntries);\n\n    return filteredEntriesList;\n}\n\nexport const initialState: BoardHistoryState = Map<string, HistoryState>();\n\nconst reducer: Reducer<BoardHistoryState, InspectioBoardsAction> = (state: BoardHistoryState = initialState, action: InspectioBoardsAction): BoardHistoryState => {\n    switch (action.type) {\n        case APPEND_HISTORY_ENTRIES:\n            let aBoardHistory: HistoryState = state.get(action.payload.boardId, new HistoryState());\n            let aNewEntries = action.payload.entries;\n\n            if(aBoardHistory.history.count() > 0) {\n                const currentLastEntry: HistoryEntry = aBoardHistory.history.last();\n                aBoardHistory = aBoardHistory.set(\"history\", aBoardHistory.history.pop());\n                aNewEntries = aNewEntries.unshift(currentLastEntry);\n            }\n\n            aNewEntries = filterDuplicates(aNewEntries);\n            const lastEntry = action.payload.entries.last(new HistoryEntry());\n\n            aBoardHistory = aBoardHistory.set(\"history\", aBoardHistory.history.push(...aNewEntries.toArray()));\n            aBoardHistory = aBoardHistory.set(\"oldestBoardVersion\", lastEntry.boardVersion);\n\n            // Stop if old history entry without cellId is found\n            if(!lastEntry.cellId && lastEntry.cellType === HistoryCellType.misc) {\n\n                const entryDate = moment(lastEntry.date, moment.ISO_8601);\n\n                if(entryDate.isBefore(moment('2019-07-29'))) {\n                    aBoardHistory = aBoardHistory.set('olderPatchesAvailable', false);\n                }\n            }\n\n            return state.set(action.payload.boardId, aBoardHistory);\n        case PREPEND_HISTORY_ENTRIES:\n            let pBoardHistory: HistoryState = state.get(action.payload.boardId, new HistoryState());\n            let pNewEntries = action.payload.entries;\n\n            if(pBoardHistory.history.count() > 0) {\n                const firstEntry: HistoryEntry = pBoardHistory.history.first();\n                pBoardHistory = pBoardHistory.set(\"history\", pBoardHistory.history.shift());\n                pNewEntries = pNewEntries.push(firstEntry);\n            }\n\n            pNewEntries = filterDuplicates(pNewEntries);\n\n            pBoardHistory = pBoardHistory.set(\"history\", pBoardHistory.history.unshift(...pNewEntries.toArray()));\n\n            const pLastEntry = action.payload.entries.last(new HistoryEntry());\n\n            if(!pBoardHistory.oldestBoardVersion) {\n                pBoardHistory = pBoardHistory.set(\"oldestBoardVersion\", pLastEntry.boardVersion);\n            }\n\n            // Stop if old history entry without cellId is found\n            if(!pLastEntry.cellId && pLastEntry.cellType === HistoryCellType.misc) {\n                const entryDate = moment(pLastEntry.date, moment.ISO_8601);\n\n                if(entryDate.isBefore(moment('2019-07-29'))) {\n                    pBoardHistory = pBoardHistory.set('olderPatchesAvailable', false);\n                }\n            }\n\n            return state.set(action.payload.boardId, pBoardHistory);\n        case SET_IS_LOADING_HISTORY:\n            let loadingHistoryState = state.get(action.payload.boardId, new HistoryState());\n            loadingHistoryState = loadingHistoryState.set('loading', action.payload.loading);\n            return state.set(action.payload.boardId, loadingHistoryState);\n        case SET_NO_MORE_HISTORY_AVAILABLE:\n            return state.setIn([action.payload.boardId, 'olderPatchesAvailable'], false);\n        case CLEAR_BOARD_HISTORY:\n            return state.remove(action.payload.boardId);\n        default:\n            return state;\n    }\n\n}\n\nexport {reducer as manageBoardHistory};\n","import {List, Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport {upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {\n    BOARD_STICKY_TEMPLATES_FETCHED,\n    STICKY_ADVANCED_CONFIG_UPDATED,\n    STICKY_TEMPLATE_SET,\n    STICKY_TEMPLATES_IMPORTED\n} from \"../actions/constants\";\nimport * as Events from \"../actions/events\";\nimport {StickyTemplate} from \"../model/StickyTemplate\";\nimport {InspectioBoardsAction} from './index';\n\ntype Event = ActionType<typeof Events>;\n\nexport interface StickyTemplateState extends Map<string, StickyTemplate> {\n}\n\nexport const initialState: StickyTemplateState = Map<string, StickyTemplate>();\n\nconst reducer: Reducer<StickyTemplateState, InspectioBoardsAction> = (state: StickyTemplateState = initialState, event: InspectioBoardsAction): StickyTemplateState => {\n    switch (event.type) {\n        case BOARD_STICKY_TEMPLATES_FETCHED:\n        case STICKY_TEMPLATES_IMPORTED:\n            return upsertAggregates(state, event.payload.stickyTemplates);\n        case STICKY_TEMPLATE_SET:\n            return upsertAggregates(state, List([event.payload.stickyTemplate]));\n        case STICKY_ADVANCED_CONFIG_UPDATED:\n            return upsertAggregates(state, List([event.payload.stickyTemplate]));\n        default:\n            return state;\n    }\n};\n\nexport {reducer as saveStickyTemplateReducer};\n","import {Map} from 'immutable';\nimport {Reducer} from 'redux';\nimport {removeAllAggregates, upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport {PLAYSHOT_SUMMARY_LIST_FETCHED} from \"../actions/constants\";\nimport {PlayshotSummary} from \"../model/PlayshotSummary\";\nimport {InspectioBoardsAction} from './index';\n\n\nexport interface PlayshotState extends Map<string, PlayshotSummary> {\n}\n\nexport const initialState: PlayshotState = Map<string, PlayshotSummary>();\n\nconst reducer: Reducer<PlayshotState, InspectioBoardsAction> = (state: PlayshotState = initialState, event: InspectioBoardsAction): PlayshotState => {\n  switch (event.type) {\n    case PLAYSHOT_SUMMARY_LIST_FETCHED:\n      return upsertAggregates(removeAllAggregates(state), event.payload.summaries);\n    default:\n      return state;\n  }\n};\n\nexport {reducer as savePlayshotReducer};\n","import {fromJS} from \"immutable\";\nimport { combineReducers } from 'redux-immutable';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as TeamAction} from \"../../InspectioTeams\";\nimport * as Commands from \"../actions/commands\";\nimport * as Events from \"../actions/events\";\nimport * as Queries from \"../actions/queries\";\nimport {ActiveGraphElementState, saveActiveGraphElementReducer} from \"./applyActiveGraphElementActions\";\nimport {BoardsState, saveBoardReducer} from \"./applyBoardActions\";\nimport {BoardClientsState, saveBoardClientsReducer} from \"./applyBoardClientActions\";\nimport {BoardGraphElementsState, saveBoardGraphElementsReducer} from \"./applyBoardGraphElementActions\";\nimport {BoardInvitationState, saveBoardInvitationReducer} from \"./applyBoardInvitationActions\";\nimport {\n    BoardPermissionsForTeamsState,\n    saveBoardPermissionsForTeamsReducer\n} from \"./applyBoardPermissionsForTeamsActions\";\nimport {\n    BoardPermissionsForUsersState,\n    saveBoardPermissionsForUsersReducer\n} from \"./applyBoardPermissionsForUsersActions\";\nimport {elementsTreeReducer, ElementsTreeState} from \"./applyElementsTreeActions\";\nimport {initialBoardListLoadedReducer} from \"./applyInitialBoardListLoaded\";\nimport {loadBoardsReducer} from \"./applyLoadingBoards\";\nimport {boardOverviewReducer, BoardOverviewState} from \"./applyOverviewActions\";\nimport {BoardHistoryState, manageBoardHistory} from \"./manageBoardHistory\";\nimport {RunCodyOption, saveRunCodyOnReducer} from \"./RunCodyOn\";\nimport {saveStickyTemplateReducer, StickyTemplateState} from \"./StickyTemplate\";\nimport {PlayshotState, savePlayshotReducer} from \"./applyPlayshotEvents\";\n\nexport type InspectioBoardsAction = ActionType<typeof Commands & typeof Events  & typeof Queries & typeof TeamAction.Event>;\n\nexport interface InspectioBoardsState {\n    boards: BoardsState,\n    boardPermissionsForUsers: BoardPermissionsForUsersState,\n    boardPermissionsForTeams: BoardPermissionsForTeamsState,\n    boardInvitations: BoardInvitationState,\n    boardClients: BoardClientsState,\n    boardGraphElements: BoardGraphElementsState,\n    history: BoardHistoryState,\n    loadingBoards: boolean,\n    initialBoardListLoaded: boolean,\n    overview: BoardOverviewState,\n    elementsTree: ElementsTreeState,\n    activeGraphElements: ActiveGraphElementState,\n    StickyTemplate: StickyTemplateState,\n    runCodyOn: RunCodyOption,\n    playshots: PlayshotState,\n}\n\nexport const inspectioBoardsReducer = combineReducers<InspectioBoardsState, InspectioBoardsAction>({\n    boards: saveBoardReducer,\n    boardPermissionsForUsers: saveBoardPermissionsForUsersReducer,\n    boardPermissionsForTeams: saveBoardPermissionsForTeamsReducer,\n    boardInvitations: saveBoardInvitationReducer,\n    boardClients: saveBoardClientsReducer,\n    boardGraphElements: saveBoardGraphElementsReducer,\n    history: manageBoardHistory,\n    loadingBoards:loadBoardsReducer,\n    initialBoardListLoaded: initialBoardListLoadedReducer,\n    overview: boardOverviewReducer,\n    elementsTree: elementsTreeReducer,\n    activeGraphElements: saveActiveGraphElementReducer,\n    StickyTemplate: saveStickyTemplateReducer,\n    runCodyOn: saveRunCodyOnReducer,\n    playshots: savePlayshotReducer,\n}, () => fromJS({\n    boards: undefined,\n    StickyTemplate: undefined,\n    runCodyOn: 'auto',\n    playshots: undefined\n}));\n","import { Reducer } from 'redux';\nimport {START_FETCH_USER_BOARDS, UPDATE_BOARDS} from \"../actions/constants\";\nimport {InspectioBoardsAction} from \"./index\";\n\nconst reducer: Reducer<boolean, InspectioBoardsAction> = (state: boolean = true, action: InspectioBoardsAction): boolean => {\n    switch (action.type) {\n        case START_FETCH_USER_BOARDS:\n            return  true;\n        case UPDATE_BOARDS:\n            return false;\n        default:\n            return state;\n    }\n};\n\nexport { reducer as loadBoardsReducer };","import { Reducer } from 'redux';\nimport {INITIAL_BOARD_LIST_LOADED} from \"../actions/constants\";\nimport {InspectioBoardsAction} from \"./index\";\n\nconst reducer: Reducer<boolean, InspectioBoardsAction> = (state: boolean = false, action: InspectioBoardsAction): boolean => {\n    switch (action.type) {\n        case INITIAL_BOARD_LIST_LOADED:\n            return  true;\n        default:\n            return state;\n    }\n};\n\nexport { reducer as initialBoardListLoadedReducer };\n","import {Reducer} from \"redux\";\nimport {ActionType} from \"typesafe-actions\";\nimport {RUN_CODY_ON_CHANGED} from \"../actions/constants\";\nimport * as Events from \"../actions/events\";\nimport {InspectioBoardsAction} from \"./index\";\n\nexport type RunCodyOption = 'play' | 'engine' | 'auto';\n\ntype Event = ActionType<typeof Events>;\n\nexport const initialState: RunCodyOption = 'auto';\n\nconst reducer: Reducer<RunCodyOption, InspectioBoardsAction> = (state: RunCodyOption = initialState, event: InspectioBoardsAction): RunCodyOption => {\n  switch (event.type) {\n    case RUN_CODY_ON_CHANGED:\n      return event.payload.runCodyOn;\n    default:\n      return state;\n  }\n}\n\nexport {reducer as saveRunCodyOnReducer};\n","import {fromJS} from \"immutable\";\nimport {combineReducers} from \"redux-immutable\";\nimport {ActionType} from \"typesafe-actions\";\nimport {Command} from \"../actions\";\nimport {sidebarReducer, SidebarState} from \"./applySidebarActions\";\n\n\nexport type InspectioLayoutAction = ActionType<typeof Command>;\n\nexport interface InspectioSidebarState {\n    sidebar: SidebarState\n}\n\nexport const inspectioSidebarReducer = combineReducers<InspectioSidebarState, InspectioLayoutAction>({\n    sidebar: sidebarReducer\n}, () => fromJS({sidebar: undefined}));\n\n","import { List } from 'immutable';\nimport { Reducer } from 'redux';\nimport {MESSAGE_HANDLED, NOTIFY} from \"../actions/constants\";\nimport { NotificationModel } from '../model';\nimport {NotificationsAction} from \"./index\";\n\nexport interface MessagesState extends List<NotificationModel.Message> {\n}\n\n// Type-safe initialState!\nexport const initialState: MessagesState = List<NotificationModel.Message>();\n\n\n// Thanks to Redux 4's much simpler typings, we can take away a lot of typings on the reducer side,\n// everything will remain type-safe.\nconst reducer: Reducer<MessagesState, NotificationsAction> = (state: MessagesState = initialState, action: NotificationsAction): MessagesState => {\n    switch (action.type) {\n        case NOTIFY:\n        case MESSAGE_HANDLED:\n            const idx = state.findIndex(lMsg => lMsg.uid === action.payload.uid);\n\n            if (idx > -1) {\n                if (action.payload.handled) {\n                    state = state.remove(idx);\n                } else {\n                    state = state.set(idx, action.payload);\n                }\n            } else {\n                state = state.push(action.payload);\n            }\n            return state;\n        default:\n            return state;\n    }\n};\n\n// Instead of using default export, we use named exports. That way we can group these exports\n// inside the `index.js` folder.\nexport { reducer as applyReducer };\n","import {fromJS} from \"immutable\";\nimport { combineReducers } from 'redux-immutable';\nimport {ActionType} from \"typesafe-actions\";\nimport * as Commands from \"../actions/commands\";\nimport * as Events from \"../actions/events\";\nimport { applyReducer, MessagesState } from './applyNotify';\n\nexport type NotificationsAction = ActionType<typeof Commands> | ActionType<typeof Events>;\n\nexport interface NotificationSystemState {\n    messages: MessagesState\n}\n\nexport const NotificationSystemReducer = combineReducers<NotificationSystemState, NotificationsAction>({\n    messages: applyReducer\n}, () => fromJS({messages: undefined}));\n\n","import { Reducer } from 'redux';\nimport * as actions from '../actions';\nimport { StatusModel } from '../model';\nimport { SocketAction } from './index';\n\nexport interface StatusState extends StatusModel.Status {\n}\n\nexport const initialState = StatusModel.disconnectedStatus();\n\nconst reducer: Reducer<StatusState, SocketAction> = (state: StatusState = initialState, action: SocketAction): StatusState => {\n    switch (action.type) {\n        case actions.Type.CONNECT_SOCKET:\n            return StatusModel.fromtString(StatusModel.STATUS_CONNECTING);\n        case actions.Type.SOCKET_CONNECTED:\n            return StatusModel.fromtString(StatusModel.STATUS_CONNECTED);\n        case actions.Type.SOCKET_DISCONNECTED:\n            return StatusModel.fromtString(StatusModel.STATUS_DISCONNECTED);\n        case actions.Type.DISCONNECT_SOCKET:\n            return StatusModel.fromtString(StatusModel.STATUS_DISCONNECTING);\n        case actions.Type.SOCKET_CONNECTION_LOST:\n            return StatusModel.fromtString(StatusModel.STATUS_CONNECTION_LOST);\n        default:\n            return state;\n    }\n};\n\nexport { reducer as statusReducer };","import { fromJS } from 'immutable';\nimport { combineReducers } from 'redux-immutable';\nimport { ActionType } from 'typesafe-actions';\nimport {\n    connectSocket,\n    disconnectSocket,\n    sendSocketCmd,\n    socketConnected, socketConnectionLost, socketDisconnected,\n} from '../actions/actions';\nimport { statusReducer, StatusState } from './applyStatusActions';\n\nexport type SocketAction = ActionType<typeof sendSocketCmd>\n    | ActionType<typeof socketConnected>\n    | ActionType<typeof socketDisconnected>\n    | ActionType<typeof socketConnectionLost>\n    | ActionType<typeof disconnectSocket>\n    | ActionType<typeof connectSocket>\n    ;\n\nexport interface SocketState {\n    status: StatusState\n}\n\nconst reducer = combineReducers<SocketState, SocketAction>({\n    status: statusReducer,\n}, () => fromJS({status: undefined}));\n\n\nexport { reducer as socketReducer };","import {Map} from \"immutable\";\nimport { Reducer } from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport {upsertAggregates} from \"../../core/reducer/applyAggregateChanged\";\nimport * as Action from \"../actions\";\nimport * as Events from \"../actions/events\";\nimport {IioUserInfo} from \"../model/IioUserInfo\";\n\nexport interface IioUserInfoState extends Map<string, IioUserInfo> {\n\n}\n\nexport const initialState = Map<string, IioUserInfo>();\n\ntype Event = ActionType<typeof Events>;\n\nconst reducer: Reducer<IioUserInfoState, Event> = (state: IioUserInfoState = initialState, event: Event): IioUserInfoState => {\n    switch (event.type) {\n        case Action.Type.IIO_USERS_INFO_LOADED:\n            return upsertAggregates(state, event.payload.usersInfo);\n        default:\n            return  state;\n    }\n};\n\nexport {reducer as iioUserInfoReducer};","import {Map} from \"immutable\";\nimport { Reducer } from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as BoardAction} from \"../../InspectioBoards\";\nimport {Action as TeamAction} from \"../../InspectioTeams\";\nimport {ACTIVE_ORGANIZATION_SWITCHED, SIGN_IN, UPDATE_PROFILE} from \"../actions/constants\";\nimport {UserModel} from '../model';\nimport {InspectioUserAction} from \"./index\";\n\nexport interface UserState extends Map<string, UserModel.UserInfo> {\n\n}\n\nexport const initialState = Map<string, UserModel.UserInfo>().set('currentUser', new UserModel.UserInfo(UserModel.defaultUserProps));\n\ntype ReducerActionType = ActionType<typeof BoardAction.Command.addBoard> | ActionType<typeof BoardAction.Command.deleteBoard> | ActionType<InspectioUserAction>;\n\nconst reducer: Reducer<UserState, ReducerActionType> = (state: UserState = initialState, action: ReducerActionType): UserState => {\n    switch (action.type) {\n        case SIGN_IN:\n            return state.set('currentUser', action.payload.user);\n        case BoardAction.Type.ADD_BOARD:\n        case BoardAction.Type.IMPORT_NEW_BOARD:\n            return state.setIn(['currentUser', 'quota'], state.getIn(['currentUser', 'quota']) - 1);\n        case BoardAction.Type.DELETE_BOARD:\n            return state.setIn(['currentUser', 'quota'], state.getIn(['currentUser', 'quota']) + 1);\n        case TeamAction.Type.TEAM_ADDED:\n            return state.setIn(['currentUser', 'teamQuota'], state.getIn(['currentUser', 'teamQuota']) - 1);\n        case TeamAction.Type.TEAM_DELETED:\n            return state.setIn(['currentUser', 'teamQuota'], state.getIn(['currentUser', 'teamQuota']) + 1);\n        case UPDATE_PROFILE:\n            return state.setIn(['currentUser'], action.payload.user);\n        case ACTIVE_ORGANIZATION_SWITCHED:\n            return state.setIn(['currentUser', 'activeOrganization'], action.payload.activeOrganization);\n        default:\n            return state;\n    }\n};\n\nexport {reducer as userReducer}\n","import {Map} from \"immutable\";\nimport { Reducer } from 'redux';\nimport {ActionType} from \"typesafe-actions\";\nimport * as Action from \"../actions\";\nimport * as Events from \"../actions/events\";\n\nexport interface UserSettingsState extends Map<string, number|boolean> {\n\n}\n\nexport const initialState = Map<string, number|boolean>();\n\ntype Event = ActionType<typeof Events>;\n\nconst reducer: Reducer<UserSettingsState, Event> = (state: UserSettingsState = initialState, event: Event): UserSettingsState => {\n    switch (event.type) {\n        case Action.Type.USER_SETTINGS_LOADED:\n            return state.merge(event.payload.userSettings.values, { settings_loaded: true });\n        case Action.Type.USER_SETTING_UPSERTED:\n            return state.set(event.payload.key, event.payload.value);\n        default:\n            return state;\n    }\n};\n\nexport {reducer as userSettingsReducer};","import {fromJS} from \"immutable\";\nimport {combineReducers} from \"redux-immutable\";\nimport {ActionType} from \"typesafe-actions\";\nimport * as Commands from \"../actions/commands\";\nimport * as Events from \"../actions/events\";\nimport {iioUserInfoReducer, IioUserInfoState} from \"./applyIioUsersActions\";\nimport {userReducer, UserState} from \"./applyUserActions\";\nimport {userSettingsReducer, UserSettingsState} from \"./applyUserSettingsActions\";\n\nexport type InspectioUserAction = ActionType<typeof Commands> & ActionType<typeof Events>;\n\nexport interface InspectioUsersState {\n    users: UserState\n    userSettings: UserSettingsState,\n    iioUsersInfo: IioUserInfoState\n}\n\nexport const inspectioUserReducer = combineReducers<InspectioUsersState, InspectioUserAction>({\n    users: userReducer,\n    userSettings: userSettingsReducer,\n    iioUsersInfo: iioUserInfoReducer,\n}, () => fromJS({users: undefined, userSettings: undefined, iioUsersInfo: undefined}));","import { fromJS } from 'immutable';\nimport { Action, AnyAction, Dispatch } from 'redux';\nimport { FormStateMap } from 'redux-form';\nimport { reducer as formReducer } from 'redux-form/immutable';\nimport { combineReducers } from 'redux-immutable';\nimport { ActionType } from 'typesafe-actions';\nimport { authReducer, InspectioAuthState } from './Auth/reducers';\nimport { inspectioBoardsReducer, InspectioBoardsState } from './InspectioBoards/reducers';\nimport {Reducer as InspectioTeams} from \"./InspectioTeams\";\nimport {Reducer as InspectioOrganizations} from \"./Organization\";\nimport {inspectioSidebarReducer, InspectioSidebarState} from \"./Layout/reducers\";\nimport { NotificationSystemReducer, NotificationSystemState } from './NotificationSystem/reducers';\nimport { socketReducer, SocketState } from './Socket/reducers';\nimport { inspectioUserReducer, InspectioUsersState } from './User/reducers';\n\nexport interface ApplicationState {\n    notificationSystem: NotificationSystemState,\n    inspectioBoards: InspectioBoardsState,\n    inspectioUsers: InspectioUsersState,\n    inspectioTeams: InspectioTeams.InspectioTeamsState,\n    inspectioOrganizations: InspectioOrganizations.InspectioOrganizationsState,\n    inspectioSidebar: InspectioSidebarState,\n    form: FormStateMap,\n    auth: InspectioAuthState,\n    socket: SocketState,\n}\n\n// Additional props for connected React components. This prop is passed by default with `connect()`\nexport interface ConnectedReduxProps<A extends Action = AnyAction> {\n    dispatch: Dispatch<A>\n}\n\n// Whenever an action is dispatched, Redux will update each top-level application state property\n// using the reducer with the matching name. It's important that the names match exactly, and that\n// the reducer acts on the corresponding ApplicationState property type.\nexport const rootReducer = combineReducers<ApplicationState, ActionType<any>>(\n    {\n        notificationSystem: NotificationSystemReducer,\n        inspectioBoards: inspectioBoardsReducer,\n        inspectioUsers: inspectioUserReducer,\n        inspectioTeams: InspectioTeams.inspectioTeamsReducer,\n        inspectioOrganizations: InspectioOrganizations.inspectioOrganizationsReducer,\n        inspectioSidebar: inspectioSidebarReducer,\n        form: formReducer,\n        auth: authReducer,\n        socket: socketReducer,\n    },\n    () => fromJS({\n        notificationSystem: undefined,\n        inspectioBoards: undefined,\n        inspectioUsers: undefined,\n        inspectioTeams: undefined,\n        inspectioOrganizations: undefined,\n        inspectioSidebar: undefined,\n        auth: undefined,\n        socket: undefined,\n    }),\n);\n","import {fork, put, take, call} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {standaloneStorageManager} from \"../util\";\n\ntype FlowAction = ActionType<typeof Action.Command.deleteBoard>;\n\nfunction* onDeleteBoard(action: FlowAction) {\n    yield call(standaloneStorageManager.deleteBoard, action.payload.boardId);\n    yield put(NotifyAction.Command.info('Board deleted', 'Board deleted'));\n}\n\nexport function* standaloneDeleteBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take(Action.Type.DELETE_BOARD);\n        yield fork(onDeleteBoard, action);\n    }\n}\n","import {call, fork, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {StandaloneBoard} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\n\ntype FlowAction = ActionType<typeof Action.Command.renameBoard | typeof Action.Command.changeBoardAbbreviation | typeof Action.Command.setBoardTags>;\n\nfunction* onSaveBoard(action: FlowAction) {\n    const board: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, action.payload.board.uid);\n    if (board && !action.payload.board.tempBoard) {\n        yield call(standaloneStorageManager.updateBoard, {\n            ...board,\n            name: action.payload.board.name,\n            nameAbbreviation: action.payload.board.nameAbbreviation,\n            tags: action.payload.board.tags.toJS(),\n            codySuggestEnabled: action.payload.board.codySuggestEnabled,\n            eventModelingEnabled: action.payload.board.eventModelingEnabled,\n        });\n    }\n}\n\nexport function* standaloneEditBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([\n            Action.Type.RENAME_BOARD,\n            Action.Type.CHANGE_BOARD_ABBREVIATION,\n            Action.Type.SET_BOARD_TAGS,\n            Action.Type.TOGGLE_CODY_SUGGEST_ENABLED,\n            Action.Type.TOGGLE_EVENT_MODELING_ENABLED,\n        ]);\n        yield fork(onSaveBoard, action);\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../../InspectioBoards/index\";\nimport {StandaloneBoard} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\nimport {createStickyTemplateFromServerData} from \"../../InspectioBoards/model/StickyTemplate\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype Query = ActionType<typeof Action.Query.fetchBoardStickyTemplates>\n\nfunction* handleFetchBoardStickyTemplates(query: Query) {\n    const boardData: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, query.payload.boardId);\n\n    if (!boardData) {\n        return;\n    }\n\n    const result = pipe(\n        boardData.stickyTemplates as any,\n        execValidate([isArray(), \"Response data is not of type Array\"]),\n        execForEach((stickyTemplateData: any) => {\n            return createStickyTemplateFromServerData({\n                boardId: query.payload.boardId,\n                cellType: stickyTemplateData.cellType,\n                template: stickyTemplateData.template,\n                templateType: stickyTemplateData.templateType,\n                templateSchema: stickyTemplateData.templateSchema,\n            });\n        }),\n    );\n\n    if (isFailure(result)) {\n        yield put(NotifyAction.Command.error('Request Error', 'Could not load sticky templates'));\n    }\n\n    if (isSuccess(result)) {\n        const stickyTemplates = List(result.value);\n        yield put(Action.Event.boardStickyTemplatesFetched(stickyTemplates));\n    }\n}\n\nexport function* standaloneFetchBoardStickyTemplatesFlow() {\n    while (true) {\n        const query: Query = yield take([\n            Action.Type.FETCH_BOARD_STICKY_TEMPLATES\n        ]);\n\n        yield fork(handleFetchBoardStickyTemplates, query);\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {execForEach, execValidate, isFailure, isSuccess, pipe} from \"../../core/validation/either\";\nimport {isArray} from \"../../core/validation/predicates\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {createPlayshotSummaryFromServerData, PlayshotSummary} from \"../../InspectioBoards/model/PlayshotSummary\";\nimport {loadLocalPlayshots} from \"../../InspectioBoards/service/playshot-storage\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchPlayshotSummaryList>;\n\nconst onFetchPlayshotSummaryList = function* (action: FlowAction) {\n  const shots = loadLocalPlayshots(action.payload.boardId);\n\n    const result = pipe(\n      shots as unknown as PlayshotSummary[],\n      execValidate([isArray(), \"Local storage playshot item is not of type Array\"]),\n      execForEach((data: any) => {\n        console.log(\"shot data\", data);\n        return createPlayshotSummaryFromServerData(data);\n      }),\n    );\n\n    if (isFailure(result)) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Failed to process playshot summaries from local storage\", result.value, shots);\n      yield put(NotifyAction.Command.error('Request Error', 'Could not load playshots'));\n    }\n\n    if (isSuccess(result)) {\n      const summaries = List(result.value);\n      yield put(Action.Event.playshotSummaryListFetched(summaries));\n    }\n}\n\nexport function* standaloneFetchPlayshotSummaryListFlow() {\n\n  while (true) {\n    const action: FlowAction = yield take([Action.Type.FETCH_PLAYSHOT_SUMMARY_LIST]);\n\n    yield fork(onFetchPlayshotSummaryList, action);\n  }\n}\n","import {List} from \"immutable\";\nimport { call, fork, put, take } from 'redux-saga/effects';\nimport * as Action from '../../InspectioBoards/actions';\nimport {updateBoards} from \"../../InspectioBoards/actions/commands\";\nimport {initialBoardListLoaded} from \"../../InspectioBoards/actions/events\";\nimport {BoardModel} from \"../../InspectioBoards/model\";\nimport {deriveAbbreviationFromBoardName} from \"../../InspectioBoards/model/Board\";\nimport {BoardVersion, defaultBoardVersionProps} from \"../../InspectioBoards/model/BoardVersion\";\nimport {Action as UserAction, UserModel} from \"../../User\";\nimport {UserSettings, UserSettingsValue} from \"../../User/model/UserSettings\";\nimport {StandaloneBoard, StandaloneUserSetting} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\nimport {DEFAULT_PERMISSIONS} from \"../../InspectioBoards/model/BoardPermissionForUser\";\n\nfunction* onLoadUserSettings() {\n    const userSettings: StandaloneUserSetting[] = yield call(standaloneStorageManager.getUserSettings);\n    const values: Record<string, UserSettingsValue> = {};\n\n    userSettings.forEach(setting => {\n        values[setting.key] = setting.value;\n    });\n\n    yield put(UserAction.Event.userSettingsLoaded(new UserSettings({\n        userId: standaloneStorageManager.getUser().userId,\n        values,\n    })));\n}\n\nfunction* onSignIn() {\n    yield put(UserAction.Command.signIn({\n        uid: standaloneStorageManager.getUser().userId,\n        name: 'standalone',\n        email: '',\n        givenName: '',\n        familyName: '',\n        roles: {\n            roleMap: {\n                anonymous: {\n                    type: 'anonymous'\n                }\n            } as any\n        } as any,\n        account: {\n            accountType: 'free'\n        },\n        quota: 1000,\n        teamQuota: 1,\n        displayName: 'standalone',\n        avatarUrl: '',\n        companyName: '',\n        jobTitle: '',\n        signedIn: true\n    } as UserModel.UserInfo));\n}\n\nexport function* onFetchUserBoards() {\n    yield put(Action.Query.startFetchUserBoards());\n\n    const data: StandaloneBoard[] = yield call(standaloneStorageManager.getBoards);\n    yield put(updateBoards(data.map(boardData => new BoardModel.Board({\n        uid: boardData.boardId,\n        name: boardData.name,\n        nameAbbreviation: boardData.nameAbbreviation || deriveAbbreviationFromBoardName(boardData.name),\n        tags: List(boardData.tags || []),\n        createdAt: boardData.createdAt || boardData.lastModified,\n        lastModified: boardData.lastModified,\n        version: new BoardVersion(defaultBoardVersionProps),\n        shared: false,\n        sharedWith: List(),\n        assignedTeams: List(),\n        example: false,\n        owner: standaloneStorageManager.getUser().userId,\n        creator: null,\n        organization: null,\n        tempBoard: false,\n        orgaMemberPermissions: DEFAULT_PERMISSIONS,\n        anyonePermissions: DEFAULT_PERMISSIONS,\n        codySuggestEnabled: typeof boardData.codySuggestEnabled !== 'undefined' ? boardData.codySuggestEnabled : true,\n        eventModelingEnabled: typeof boardData.eventModelingEnabled !== 'undefined' ? boardData.eventModelingEnabled : true,\n    }))));\n\n    yield put(initialBoardListLoaded());\n}\n\nexport function* standaloneFetchUserBoardsFlow() {\n    while (true) {\n        yield take(Action.Type.FETCH_USER_BOARDS);\n        yield fork(onFetchUserBoards);\n        yield fork(onSignIn);\n        yield fork(onLoadUserSettings);\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, select, take } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport * as Action from '../../InspectioBoards/actions';\nimport {setBoardToSnapshot} from \"../../InspectioBoards/actions/commands\";\nimport {BoardSnapshot, BoardVersioning} from \"../../InspectioBoards/model\";\nimport {Board} from \"../../InspectioBoards/model/Board\";\nimport {defaultBoardVersionProps} from \"../../InspectioBoards/model/BoardVersion\";\nimport {makeBoardByIdSelector} from \"../../InspectioBoards/selectors/board\";\nimport {makeGetAllBoards} from \"../../InspectioBoards/selectors/boardList\";\nimport {StandaloneBoard} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\nimport {onFetchUserBoards} from \"./fetchUserBoardsFlow\";\n\ntype FlowAction = ActionType<typeof Action.Query.fetchUserBoard>;\n\nconst onFetchUserBoard = function* (action: FlowAction) {\n    // Make sure that the board list is loaded; Relevant for deep-links to a specific board\n    const boards: List<Board> = yield select(makeGetAllBoards());\n    if (boards.size < 1) {\n        yield call(onFetchUserBoards);\n    }\n\n    const tempBoard = yield select(makeBoardByIdSelector(action.payload.boardId))\n\n    if(tempBoard && tempBoard.tempBoard) {\n        yield put(Action.Command.setBoardDetailsFetched(action.payload.boardId, false));\n        return;\n    }\n\n    const boardData: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, action.payload.boardId);\n    if (!boardData) {\n        return;\n    }\n\n    const snapshot = new BoardSnapshot.BoardSnapshot({\n        boardId: boardData.boardId,\n        xml: boardData.xml,\n        boardVersion: new BoardVersioning.BoardVersion(defaultBoardVersionProps)\n    });\n\n    yield put(setBoardToSnapshot(snapshot));\n    yield put(Action.Command.setBoardDetailsFetched(action.payload.boardId, true));\n}\n\nexport function* standaloneFetchUserBoardFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take(Action.Type.FETCH_USER_BOARD);\n        yield fork(onFetchUserBoard, action);\n    }\n}\n","import {call, fork, put, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport {Action as Notify} from \"../../NotificationSystem\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {StandaloneBoard} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\n\ntype FlowAction = ActionType<typeof Action.Command.importExistingBoard>;\n\nfunction* onImportExistingBoard(action: FlowAction) {\n    const board: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, action.payload.board.uid);\n    if (board) {\n        yield call(standaloneStorageManager.updateBoard, {\n            ...board,\n            xml: action.payload.board.xml!,\n            lastModified: (() => new Date())().toISOString(),\n        });\n\n        yield put(Action.Command.forceUpdateBoards([action.payload.board]));\n        yield put(Notify.Command.info('Board imported:', action.payload.board.name));\n    }\n}\n\nexport function* standaloneImportExistingBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.IMPORT_EXISTING_BOARD]);\n\n        yield fork(onImportExistingBoard, action);\n    }\n}\n","import {List} from \"immutable\";\nimport {call, fork, put, select, take} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport * as uuid from \"uuid\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {useGraph} from \"../../InspectioBoards/hooks/useGraph\";\nimport {Board, deriveAbbreviationFromBoardName} from \"../../InspectioBoards/model/Board\";\nimport {BoardVersion} from \"../../InspectioBoards/model/BoardVersion\";\nimport {makeEmptyGraph} from \"../../InspectioBoards/model/Graph\";\nimport {TeamId} from \"../../InspectioTeams/model/Team\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {UserSelector} from \"../../User\";\nimport {UserId, UserInfo} from \"../../User/model/UserInfo\";\nimport {standaloneStorageManager} from \"../util\";\nimport {onFetchUserBoards} from \"./fetchUserBoardsFlow\";\nimport {DEFAULT_PERMISSIONS} from \"../../InspectioBoards/model/BoardPermissionForUser\";\n\ntype FlowAction = ActionType<typeof Action.Command.importNewBoard>;\n\nfunction* onImportNewBoard(action: FlowAction) {\n    const boardId = action.payload.boardId || uuid.v4();\n\n    if(!action.payload.importTemporary) {\n        yield call(standaloneStorageManager.addBoard, {\n            boardId,\n            name: action.payload.boardName,\n            lastModified: (new Date()).toISOString(),\n            createdAt: (new Date()).toISOString(),\n            xml: action.payload.boardXml,\n            stickyTemplates: [],\n        });\n\n        yield put(NotifyAction.Command.info('Board created', 'Board created'));\n        yield fork(onFetchUserBoards);\n    } else {\n        const getUser = UserSelector.makeGetCurrentUser();\n        const user: UserInfo = yield select(getUser);\n\n        const board = new Board({\n            uid: boardId,\n            name: action.payload.boardName,\n            nameAbbreviation: deriveAbbreviationFromBoardName(action.payload.boardName),\n            tags: List(),\n            createdAt: (() => new Date())().toISOString(),\n            xml: action.payload.boardXml,\n            version: new BoardVersion({\n                userId: user.uid,\n                version: 1\n            }),\n            shared: false,\n            sharedWith: List<UserId>(),\n            assignedTeams: List<TeamId>(),\n            owner: null,\n            creator: user.uid,\n            organization: null,\n            tempBoard: true,\n            orgaMemberPermissions: DEFAULT_PERMISSIONS,\n            anyonePermissions: DEFAULT_PERMISSIONS,\n            codySuggestEnabled: true,\n            eventModelingEnabled: true,\n        })\n        yield put(Action.Command.updateBoards([board]));\n\n        const [graph, setGraph] = useGraph();\n\n        const emptyGraphWithXml = makeEmptyGraph(board.xml || undefined);\n\n        setGraph(emptyGraphWithXml);\n\n        yield put(Action.Command.saveBoard(board, emptyGraphWithXml));\n    }\n}\n\nexport function* standaloneImportNewBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take([Action.Type.IMPORT_NEW_BOARD]);\n\n        yield fork(onImportNewBoard, action);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../../InspectioBoards/index\";\nimport {StandaloneBoard} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {List} from \"immutable\";\n\ntype Command = ActionType<typeof Action.Command.importStickyTemplates>\n\nfunction* handleImportStickyTemplates(command: Command) {\n    const board: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, command.payload.boardId);\n    if (!board) {\n        return;\n    }\n\n    const templates = command.payload.stickyTemplates.map(tpl => ({\n        cellType: tpl.cellType,\n        template: tpl.template,\n        templateType: tpl.templateType,\n        templateSchema: tpl.templateSchema || null\n    }));\n\n    yield call(standaloneStorageManager.updateBoard, {\n        ...board,\n        stickyTemplates: templates.toArray()\n    });\n\n    yield put(NotifyAction.Command.info('Card Templates imported', 'You can now use them on the board!'));\n    yield put(Action.Event.stickyTemplatesImported(List(command.payload.stickyTemplates)));\n    command.payload.finishedCb();\n}\n\nexport function* importStickyTemplates() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.IMPORT_STICKY_TEMPLATES\n        ]);\n\n        yield fork(handleImportStickyTemplates, command);\n    }\n}\n","import { call, take, fork } from 'redux-saga/effects';\nimport { ActionType } from 'typesafe-actions';\nimport * as Routes from '../../routes';\nimport * as Action from '../../InspectioBoards/actions';\nimport {standaloneStorageManager} from \"../util\";\n\ntype FlowAction = ActionType<typeof Action.Command.addBoard>;\n\nfunction* onInstallUserBoard(action: FlowAction) {\n    yield call(standaloneStorageManager.addBoard, {\n        boardId: action.payload.board.uid,\n        name: action.payload.board.name,\n        createdAt: (new Date()).toISOString(),\n        lastModified: (new Date()).toISOString(),\n        xml: '',\n        stickyTemplates: [],\n        codySuggestEnabled: action.payload.board.codySuggestEnabled,\n        eventModelingEnabled: action.payload.board.eventModelingEnabled,\n    });\n\n    yield call(action.payload.history.push, Routes.compileInspectioBoardWorkspace(action.payload.board.uid) as any);\n}\n\nexport function* standaloneInstallUserBoardFlow() {\n\n    while (true) {\n        const action: FlowAction = yield take(Action.Type.ADD_BOARD);\n        yield fork(onInstallUserBoard, action);\n    }\n}\n","import { fork, put, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {\n    loadFirstBoardHistoryChunk,\n    loadNextBoardHistoryChunk,\n    setIsLoadingHistory,\n    setNoMoreHistoryAvailable\n} from \"../../InspectioBoards/actions/commands\";\nimport {LOAD_FIRST_BOARD_HISTORY_CHUNK} from \"../../InspectioBoards/actions/constants\";\n\ntype FlowAction = ActionType<typeof loadNextBoardHistoryChunk> & ActionType<typeof loadFirstBoardHistoryChunk>;\n\nfunction* onLoadFirst(action: ActionType<typeof loadFirstBoardHistoryChunk>) {\n    yield put(setIsLoadingHistory(action.payload.boardId, true));\n    yield put(setNoMoreHistoryAvailable(action.payload.boardId));\n    yield put(setIsLoadingHistory(action.payload.boardId, false));\n}\n\nexport function* standaloneLoadBoardHistoryFlow() {\n    while (true) {\n        const action: FlowAction = yield take(LOAD_FIRST_BOARD_HISTORY_CHUNK);\n        yield fork(onLoadFirst, action);\n    }\n}\n","import {fork, take, call} from \"redux-saga/effects\";\nimport {ActionType} from \"typesafe-actions\";\nimport * as Action from \"../../InspectioBoards/actions\";\nimport {useGraph} from \"../../InspectioBoards/hooks/useGraph\";\nimport {standaloneStorageManager} from \"../util\";\nimport {StandaloneBoard} from \"../storage/types\";\n\ntype FlowAction = ActionType<typeof Action.Command.saveBoard>;\n\nfunction* onSaveBoard(action: FlowAction) {\n    const [graph] = useGraph();\n\n    const board: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, action.payload.board.uid);\n    if (board && !action.payload.board.tempBoard) {\n        yield call(standaloneStorageManager.updateBoard, {\n            ...board,\n            xml: graph.exportXmlSnapshot(),\n            lastModified: (() => new Date())().toISOString(),\n        });\n    }\n}\n\nexport function* standaloneSaveBoardFlow() {\n    while (true) {\n        const action: FlowAction = yield take(Action.Type.SAVE_BOARD);\n        yield fork(onSaveBoard, action);\n    }\n}\n","import {call, fork, put, select, take} from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport {Action} from \"../../InspectioBoards/index\";\nimport {createStickyTemplateFromDefault, deriveStickTemplateId} from \"../../InspectioBoards/model/StickyTemplate\";\nimport {makeStickyTemplateSelector} from \"../../InspectioBoards/selectors/StickyTemplate\";\nimport {Action as NotifyAction} from \"../../NotificationSystem\";\nimport {StandaloneBoard} from \"../storage/types\";\nimport {standaloneStorageManager} from \"../util\";\n\ntype SetStickyCommand = ActionType<typeof Action.Command.setStickyTemplate>;\ntype UpdateStickyAdvancedConfigCommand = ActionType<typeof Action.Command.updateStickyAdvancedConfig>;\ntype Command = SetStickyCommand & UpdateStickyAdvancedConfigCommand;\n\nfunction* handleSetStickyTemplate(command: SetStickyCommand) {\n    let stickyTemplate = yield select(makeStickyTemplateSelector(deriveStickTemplateId(command.payload.boardId, command.payload.cellType)));\n\n    const {boardId, cellType, template} = command.payload;\n\n    if (!stickyTemplate) {\n        stickyTemplate = createStickyTemplateFromDefault(\n            boardId,\n            cellType,\n            template\n        )\n    }\n\n    const board: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, command.payload.boardId);\n    if (!board) {\n        return;\n    }\n\n    const oldStickyTemplateData = board.stickyTemplates.find(\n        stickyTemplateData => stickyTemplateData.cellType === stickyTemplate.cellType\n    ) || {\n        cellType,\n        templateType: stickyTemplate.templateType,\n        templateSchema: stickyTemplate.templateSchema || null,\n    };\n\n    yield call(standaloneStorageManager.updateBoard, {\n        ...board,\n        stickyTemplates: [\n            ...board.stickyTemplates.filter(stickyTemplateData => stickyTemplateData.cellType !== stickyTemplate.cellType),\n            {\n                ...oldStickyTemplateData,\n                template,\n            },\n        ]\n    });\n\n    yield put(NotifyAction.Command.info('Sticky Template set', 'Sticky template for ' + cellType + ' set'));\n    yield put(Action.Event.stickyTemplateSet(stickyTemplate.setTemplate(template)));\n}\n\nfunction* handleUpdateStickyAdvancedConfig(command: UpdateStickyAdvancedConfigCommand) {yield null;\n    let stickyTemplate = yield select(makeStickyTemplateSelector(deriveStickTemplateId(command.payload.boardId, command.payload.cellType)));\n\n    if (!stickyTemplate) {\n        stickyTemplate = createStickyTemplateFromDefault(\n            command.payload.boardId,\n            command.payload.cellType,\n            ''\n        );\n    }\n\n    const board: StandaloneBoard|null = yield call(standaloneStorageManager.getBoard, command.payload.boardId);\n    if (!board) {\n        return;\n    }\n\n    const oldStickyTemplateData = board.stickyTemplates.find(\n        stickyTemplateData => stickyTemplateData.cellType === stickyTemplate.cellType\n    ) || {\n        cellType: stickyTemplate.cellType,\n        template: stickyTemplate.template,\n    };\n\n    yield call(standaloneStorageManager.updateBoard, {\n        ...board,\n        stickyTemplates: [\n            ...board.stickyTemplates.filter(stickyTemplateData => stickyTemplateData.cellType !== stickyTemplate.cellType),\n            {\n                ...oldStickyTemplateData,\n                templateType: command.payload.templateType,\n                templateSchema: command.payload.templateSchema || null\n            },\n        ]\n    });\n\n    yield put(NotifyAction.Command.info('Advanced Sticky Config updated', 'Advanced Sticky Config for ' + stickyTemplate.cellType + ' updated'));\n    stickyTemplate = stickyTemplate.setTemplateType(command.payload.templateType);\n\n    if (command.payload.templateSchema) {\n        stickyTemplate = stickyTemplate.setTemplateSchema(command.payload.templateSchema);\n    }\n\n    yield put(Action.Event.stickyAdvancedConfigUpdated(stickyTemplate));\n}\n\nexport function* standaloneUpdateStickyTemplateFlow() {\n    while (true) {\n        const command: Command = yield take([\n            Action.Type.SET_STICKY_TEMPLATE,\n            Action.Type.UPDATE_STICKY_ADVANCED_CONFIG\n        ]);\n\n        if (command.type === Action.Type.SET_STICKY_TEMPLATE) {\n            yield fork(handleSetStickyTemplate, command);\n        } else {\n            yield fork(handleUpdateStickyAdvancedConfig, command);\n        }\n    }\n}\n","import { call, fork, put, take } from 'redux-saga/effects';\nimport {ActionType} from \"typesafe-actions\";\nimport * as Action from \"../../User/actions\";\nimport {standaloneStorageManager} from \"../util\";\n\ntype FlowAction = ActionType<typeof Action.Command.upsertUserSetting>;\n\nfunction* onUpsertUserSetting(action: FlowAction) {\n    yield call(standaloneStorageManager.setUserSetting, action.payload);\n    yield put(Action.Event.userSettingUpserted(action.payload.key, action.payload.value));\n}\n\nexport function* standaloneUpsertUserSetting() {\n    while (true) {\n        const action: FlowAction = yield take(Action.Type.UPSERT_USER_SETTING);\n\n        yield fork(onUpsertUserSetting, action)\n    }\n}\n","import {storeOverviewSettingsFlow, syncElementsTreeFlow} from \"../../InspectioBoards/sagas\";\nimport {standaloneDeleteBoardFlow} from \"./deleteBoardFlow\";\nimport {standaloneEditBoardFlow} from \"./editBoardFlow\";\nimport {standaloneFetchBoardStickyTemplatesFlow} from \"./fetchBoardStickyTemplates\";\nimport {standaloneFetchPlayshotSummaryListFlow} from \"./fetchPlayshotSummaryListFlow\";\nimport {standaloneFetchUserBoardFlow} from \"./fetchUserBoardFlow\";\nimport {standaloneFetchUserBoardsFlow} from \"./fetchUserBoardsFlow\";\nimport {standaloneImportExistingBoardFlow} from \"./importExistingBoardFlow\";\nimport {standaloneImportNewBoardFlow} from \"./importNewBoardFlow\";\nimport {importStickyTemplates} from \"./importStickyTemplates\";\nimport {standaloneInstallUserBoardFlow} from \"./installUserBoardFlow\";\nimport {standaloneLoadBoardHistoryFlow} from \"./loadBoardHistoryFlow\";\nimport {standaloneSaveBoardFlow} from \"./saveBoardFlow\";\nimport {standaloneUpdateStickyTemplateFlow} from \"./updateStickyTemplate\";\nimport {standaloneUpsertUserSetting} from \"./upsertUserSettingFlow\";\n\nconst StandaloneSaga = {\n    standaloneDeleteBoardFlow,\n    standaloneFetchBoardStickyTemplatesFlow,\n    standaloneFetchUserBoardsFlow,\n    standaloneFetchUserBoardFlow,\n    standaloneImportNewBoardFlow,\n    standaloneImportExistingBoardFlow,\n    standaloneInstallUserBoardFlow,\n    standaloneLoadBoardHistoryFlow,\n    standaloneSaveBoardFlow,\n    standaloneUpdateStickyTemplateFlow,\n    standaloneUpsertUserSetting,\n    standaloneEditBoardFlow,\n    syncElementsTreeFlow,\n    importStickyTemplates,\n    storeOverviewSettingsFlow,\n    standaloneFetchPlayshotSummaryListFlow,\n};\n\nexport default StandaloneSaga;\n","import { all, call, delay, spawn, takeEvery } from 'redux-saga/effects';\nimport { sendHttpRequestFlow } from './api/WebData';\nimport * as Auth from './Auth';\nimport { Saga as IbSaga } from \"./InspectioBoards\";\nimport { Saga as TeamsSaga } from \"./InspectioTeams\";\nimport { Saga as SocketSaga } from './Socket';\nimport {Saga as UserSaga} from \"./User\";\nimport { Saga as OrganizationSaga } from \"./Organization\";\nimport {isStandalone} from \"./standalone/util\";\nimport StandaloneSaga from \"./standalone/sagas\";\n\n// Here we use `redux-saga` to trigger actions asynchronously. `redux-saga` uses something called a\n// \"generator function\", which you can read about here:\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*\n\nconst makeRestartable = (saga: any) => {\n    return function* () {\n        yield spawn(function* () {\n            while (true) {\n                try {\n                    yield call(saga);\n                    console.error('unexpected root saga termination. The root sagas are supposed to be sagas that live during the whole app lifetime!', saga);\n                } catch (e) {\n                    console.error('Saga error, the saga will be restarted', e);\n                }\n                yield delay(1000); // Workaround to avoid infinite error loops\n            }\n        });\n    };\n};\n\nconst sagas = isStandalone() ? Object.values(StandaloneSaga) : [\n    Auth.Saga.tokenRefreshFlow,\n    IbSaga.deleteBoardFlow,\n    IbSaga.fetchUserBoardsFlow,\n    IbSaga.fetchUserBoardFlow,\n    IbSaga.fetchBoardPermissionsFlow,\n    IbSaga.fetchOpenBoardInvitationsFlow,\n    IbSaga.fetchPlayshotSummaryListFlow,\n    IbSaga.installUserBoardFlow,\n    IbSaga.saveBoardFlow,\n    IbSaga.renameBoardFlow,\n    IbSaga.toggleCodySuggestEnabled,\n    IbSaga.toggleEventModelingEnabled,\n    IbSaga.changeBoardAbbreviationFlow,\n    IbSaga.changeResponsibleTeamFlow,\n    IbSaga.setBoardTagsFlow,\n    IbSaga.shareBoardFlow,\n    IbSaga.resendBoardInvitationFlow,\n    IbSaga.revokeBoardInvitationFlow,\n    IbSaga.prepareBoardHistoryFlow,\n    IbSaga.loadBoardHistoryFlow,\n    IbSaga.importNewBoardFlow,\n    IbSaga.importExistingBoardFlow,\n    IbSaga.syncElementsTreeFlow,\n    IbSaga.revokeAccessToBoardFlow,\n    IbSaga.changeBoardPermissionsFlow,\n    IbSaga.adminChangeTeamBoardPermissions,\n    IbSaga.fetchBoardClientFlow,\n    IbSaga.fetchBoardGraphElementsFlow,\n    IbSaga.fetchBoardStickyTemplates,\n    IbSaga.updateStickyTemplate,\n    IbSaga.importStickyTemplates,\n    IbSaga.moveUserBoardToOrganization,\n    IbSaga.storeOverviewSettingsFlow,\n    IbSaga.shareBoardWithOrganizationMembersFlow,\n    IbSaga.shareBoardWithAnyoneFlow,\n    TeamsSaga.addTeam,\n    TeamsSaga.renameTeam,\n    TeamsSaga.changeTeamDescription,\n    TeamsSaga.inviteUserToTeam,\n    TeamsSaga.removeMemberFromTeam,\n    TeamsSaga.adminGrantTeamAccessToBoard,\n    TeamsSaga.deleteTeam,\n    TeamsSaga.resendTeamInvitation,\n    TeamsSaga.revokeTeamInvitation,\n    TeamsSaga.refreshUserTeams,\n    TeamsSaga.moveTeamToOrganization,\n    SocketSaga.manageSocketConnection,\n    sendHttpRequestFlow,\n    UserSaga.syncUsername,\n    UserSaga.lazyLoadInspectioUserInfo,\n    UserSaga.updateProfile,\n    UserSaga.updatePassword,\n    UserSaga.upsertUserSetting,\n    UserSaga.switchActiveOrganization,\n    OrganizationSaga.fetchOrganizationFlow,\n    OrganizationSaga.fetchUserOrganizations,\n    OrganizationSaga.setUpExplicitOrganization,\n    OrganizationSaga.inviteUserToOrganization,\n    OrganizationSaga.revokeUserOrganizationInvitation,\n    OrganizationSaga.resendUserOrganizationInvitation,\n    OrganizationSaga.promoteUserToOrganizationAdmin,\n    OrganizationSaga.demoteUserToOrganizationMember,\n    OrganizationSaga.removeUserFromOrganization,\n    OrganizationSaga.renameOrganization,\n    OrganizationSaga.removeGuestFromOrganization,\n    OrganizationSaga.turnGuestIntoMember,\n];\n\nconst rootSagas = sagas.map(makeRestartable);\n\nexport default function* rootSaga() {\n    console.log('root saga started');\n    yield all(rootSagas.map((saga: any) => call(saga)));\n}\n","// If you use react-router, don't forget to pass in your history type.\nimport { History } from 'history';\nimport { applyMiddleware, createStore, Store } from 'redux';\n// `react-router-redux` is deprecated, so we use `connected-react-router`.\n// This provides a Redux middleware which connects to our `react-router` instance.\n// We'll be using Redux Devtools. We can use the `composeWithDevTools()`\n// directive so we can pass our middleware along with it\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport createSagaMiddleware from 'redux-saga';\nimport { ApplicationState, rootReducer } from './reducer';\nimport rootSaga from './saga';\n\n// Import the state interface and our combined reducers/sagas.\n\nconst configureStore = (\n    history: History,\n    initialState: ApplicationState,\n): Store<ApplicationState> => {\n    // create the composing function for our middlewares\n    const composeEnhancers = composeWithDevTools({});\n    // create the redux-saga middleware\n    const sagaMiddleware = createSagaMiddleware();\n\n    // We'll create our store with the combined reducers/sagas, and the initial Redux state that\n    // we'll be passing from our entry point.\n\n    const store = createStore(\n        rootReducer,\n        initialState,\n        composeEnhancers(applyMiddleware(sagaMiddleware)),\n    ) as Store<ApplicationState> | any;\n\n    // Don't forget to run the root saga, and return the store object.\n    sagaMiddleware.run(rootSaga);\n    return store;\n};\n\nexport default configureStore;","// We use hash history because this example is going to be hosted statically.\n// Normally you would use browser history.\nimport { createBrowserHistory } from 'history';\n\nexport const history = createBrowserHistory();","import Notify from 'notifyjs';\n\nconst logo = require('./theme/img/prooph-software-logo-icon.png');\n\nfunction onPermissionGranted() {\n    console.log('Permission has been granted by the user');\n}\n\nfunction onPermissionDenied() {\n    console.warn('Permission has been denied by the user');\n}\n\nexport const doNotification = (title: string, body: string, link ?: string) => {\n    const notify = new Notify(title, {\n        body,\n        icon: logo,\n        notifyClick () {\n            if (link) {\n                window.location.href=link;\n            }\n            notify.close();\n        }\n    });\n    notify.show();\n};\n\nexport const doNotificationWithPageReload = (title: string, body: string) => {\n    const notify = new Notify(title, {\n        body,\n        icon: logo,\n        notifyClick () {\n            location.reload();\n            notify.close();\n        },\n    });\n    notify.show();\n};\n\nexport default function notify() {\n    if (!Notify.needsPermission) {\n    } else if (Notify.isSupported()) {\n        Notify.requestPermission(onPermissionGranted, onPermissionDenied);\n    }\n};\n","import { fromJS } from 'immutable';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { initJwtVerify, TokenParsed } from './api/ConfiguredJwtVerify';\nimport {distributeNewToken, removeLoginToken} from \"./api/util\";\nimport App from './App';\nimport AppStandalone from './AppStandalone';\nimport { Action as Auth } from './Auth';\nimport configureStore from './configureStore';\nimport { history } from './history';\nimport { Action as Notify } from './NotificationSystem';\nimport notify from './notify';\nimport { ApplicationState } from './reducer';\nimport {fetchUserBoards} from \"./InspectioBoards/actions/queries\";\nimport {isStandalone} from \"./standalone/util\";\nimport Keycloak from 'keycloak-js';\n\nconst error: any = null;\n\nconst kc = Keycloak({\n    url: process.env.REACT_APP_IG_KC_BASE_URL + 'auth',\n    realm: process.env.REACT_APP_IG_KC_REALM || '',\n    clientId: process.env.REACT_APP_IG_KC_CLIENT_ID || '',\n});\n\nif (isStandalone()) {\n    const initialState: ApplicationState = fromJS({});\n\n    const store = configureStore(history, initialState);\n    store.dispatch(fetchUserBoards());\n\n    ReactDOM.render(<AppStandalone store={store} history={history}/>, document.getElementById('root'));\n}\n\nif (!isStandalone()) {\n    // TODO use promiseType: 'native'\n    kc.init({onLoad: 'login-required'})\n        .success((authenticated: any) => {\n            if (authenticated) {\n                const boards = null; /* loadInspectioBoards((err) => {\n                error = err;\n            });*/\n\n                initJwtVerify(kc.token!, kc.tokenParsed as TokenParsed);\n                distributeNewToken(kc.token!);\n                removeLoginToken();\n\n                const initialState: ApplicationState = boards !== null ? fromJS({\n                    inspectioBoards: fromJS({boards}),\n                }) : fromJS({});\n\n                const store = configureStore(history, initialState);\n\n                store.dispatch(Auth.Event.userAuthenticated(kc));\n\n                if (error) {\n                    const errorMsg: Error = error;\n                    store.dispatch(Notify.Command.error('Failed to load inspectio board from local storage', errorMsg.message));\n                }\n                ReactDOM.render(<App store={store} history={history}/>, document.getElementById('root'));\n            }\n        })\n        // TODO use error component\n        .error((kcError: any) => console.warn({kcError}));\n\n    notify();\n}\n\nexport const logout = () => kc.logout();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\n// disabled due self signed certificate\n// serviceWorker.register();\n","module.exports = {\"de\":{\"translation\":{\"app\":{\"title\":\"React + Redux + Semantic UI Skeleton\",\"welcome\":\"Willkommen beim React + Redux + Semantic UI Skeleton\",\"topmenu\":{\"profile\":\"Profil\"},\"form\":{\"rename\":\"Umbenennen\",\"save\":\"Speichern\",\"change\":\"ndern\",\"cancel\":\"Abbrechen\",\"confirm\":\"Ok\",\"delete\":\"Lschen\",\"remove\":\"Entfernen\",\"upload\":\"Hochladen\",\"resend\":\"Erneut Senden\",\"revoke\":\"Widerrufen\",\"yes\":\"Ja\",\"no\":\"Nein\",\"back\":\"Zurck\",\"generateTemplate\":\"Template generieren\",\"finish\":\"Abschlieen\",\"close\":\"Schlieen\"},\"showLess\":\"Weniger anzeigen\",\"showAll\":\"Alle anzeigen\",\"open\":\"ffnen\",\"learnMore\":\"Mehr erfahren\",\"stickyTypes\":{\"event\":\"Event\",\"command\":\"Command\",\"aggregate\":\"Aggregate\",\"document\":\"Information\",\"role\":\"Role\",\"hotSpot\":\"Hot Spot\",\"ui\":\"UI / API\",\"externalSystem\":\"External System\",\"boundedContext\":\"Bounded Context\",\"feature\":\"Feature\",\"slice\":\"Slice\",\"swimlanes\":\"Swimlanes\",\"edge\":\"Connector\",\"policy\":\"Policy\",\"freeText\":\"Text\",\"textCard\":\"Text\",\"icon\":\"Icon\",\"image\":\"Image\"}},\"insp\":{\"hint\":{\"learn_more\":\"Mehr erfahren\",\"got_it\":\"Alles klar\",\"new_logo_header\":\"Neues Logo\",\"new_logo_text\":\"InspectIO ist jetzt prooph board\",\"new_domain_header\":\"Neue Domain\",\"new_domain_text\":\"InspectIO ist jetzt prooph board und ab sofort erreichbar unter https://prooph-board.com. Aktualisiere am besten gleich deine bookmarks!\"},\"overview\":{\"all_boards\":\"Meine Boards\",\"add_board\":\"Neues Board\",\"last_modified\":\"Zuletzt gendert\",\"fetch_board_error\":\"Es gibt ein technisches Problem beim Laden des Boards. Bitte spter erneut versuchen oder den Support kontaktieren.\",\"shared_board\":\"Dieses Board wurde mit dir geteilt. Du kannst die Board-Eigenschaften nicht bearbeiten.\",\"empty_space\":\"Hi, deine bersicht sieht leer aus. Bist du neu hier? Starte mit deinem ersten Board und schau fr weitere Infos im Wiki vorbei!\",\"sort\":{\"NAME\":\"Name\",\"CREATED_AT\":\"Erstellungsdatum\",\"LAST_MODIFIED\":\"Bearbeitungsdatum\"},\"teamFilter\":{\"all\":\"Alle Teams\"},\"search\":{\"label\":\"Suche ...\"}},\"sidebar\":{\"element_details\":{\"json_invalid_title\":\"Schema Ungltig\",\"json_invalid_text\":\"Das Schema ist kein gltiges JSON Dokument\",\"no_element_selected\":\"Markiere ein Element auf dem Board, um dessen Metadaten zu bearbeiten.\",\"disconnect_from_similar_elements_text\":\"Die Metadaten werden mit Cards vom gleichen Typ und gleichem Namen ({{number}}) synchronisiert.\",\"disconnect_from_similar_elements_link\":\"Synchronisation deaktivieren\",\"connect_with_similar_elements_text\":\"Metadaten werden nicht synchronisiert.\",\"connect_with_similar_elements_link\":\"Synchronisation aktivieren\"},\"no_boards_left_warning\":\"Keine Boards mehr verfgbar\",\"boards_left_warning\":\"Nur noch {{board_count}} Board verfgbar\",\"boards_left_warning_upgrade\":\"Deine Organisation bentigt ein Upgrade\"},\"top_menu\":{\"activity\":\"Activity\",\"element_details\":\"Metadata\",\"import_board\":\"Import Board\",\"export_board\":\"Export Board\",\"activate_lite_mode\":\"Aktiviere den Lite Modus fr mehr Performance auf groen Boards und whrend Video Calls.\",\"lite_mode_is_active\":\"Du befindest dich im Lite Modus.\",\"lite_mode_is_active_details\":\"Details werden beim Zoomen nicht automatisch eingeblendet, um Rechenleistung zu sparen. Du kannst Details durch Doppelklick einblenden und durch Strg/Cmd + Doppelklick wieder ausblenden.\"},\"cody_wizard\":{\"unsupported_node\":\"Cards vom Typen \\\"{{type}}\\\" werden vom Cody Wizard entweder noch nicht untersttzt oder \\\"{{name}}\\\" ist nicht richtig konfiguriert! Bitte whle eine andere Card oder prfe die Verbindungen und Metadaten der Card.\",\"run_cody\":\"Starte Cody\",\"node_select\":{\"unique_name_error\":\"Der Name ist bereits vergeben\",\"default_placeholder\":\"Whle ein Element\",\"select_data_entity\":\"Whle eine existierende Information (Grne Cards)\",\"select_aggregate_event\":\"Whle ein existierendes Business Model Event (Orangene Cards)\",\"select_aggregate\":\"Whle ein existierendes Aggregate (Gelbe Cards)\",\"select_command\":\"Existierende Commands knnen nicht gewhlt werden. Erstelle ein Neues!\",\"select_ui\":\"Whle eine existierende UI Seite (Schwarze Cards)\",\"select_policy\":\"Existierende Policies knnen nicht gewhlt werden. Erstelle eine Neue!\",\"select_feature\":\"Existierende Features knnen nicht gewhlt werden. Erstelle ein Neues!\"},\"advanced_settings\":{\"button_label\":\"Erweiterte Konfiguration\"},\"schema_editor\":{\"invalid_json\":\"Das Schema ist nicht valide und kann nicht gespeichert werden. Bitte prfe deine Eingabe.\",\"copy_state_schema\":\"Information Schema\",\"copy_command_schema\":\"Vom Command bernehmen\"},\"query_schema_editor\":{\"invalid_json\":\"Das Query Schema ist nicht valide und kann nicht gespeichert werden. Bitte prfe deine Eingabe.\"},\"ui_schema_editor\":{\"invalid_json\":\"Das UI Schema ist nicht valide und kann nicht gespeichert werden. Bitte prfe deine Eingabe.\",\"choose_icon\":\"Icon Suche\"},\"identifier_select\":{\"placeholder\":\"Whle ein Schema Attribut als Identifier (Format: uuid)\"},\"feature_status_select\":{\"placeholder\":\"Whle einen Status\"},\"step_header\":\"Aktion whlen\",\"step_state\":{\"new_data_entity\":\"Neue Information\",\"copy_command_ui_schema\":\"Vom Command bernehmen\"},\"step_any_vo\":{\"is_stored_in_db_label\":\"Wird in der Datenbank gespeichert\",\"is_entity_label\":\"Ist eine Entitt\",\"is_queryable_label\":\"Ist abfragbar\",\"is_projection_label\":\"Ist eine Projektion\"},\"step_aggregate_event\":{\"new_event\":\"Neues Event\"},\"step_aggregate\":{\"new_aggregate\":\"Neues Aggregate\",\"rules_label\":\"Business Regeln\",\"manage_dependencies\":\"Dependencies\",\"dependencies_label\":\"Dependencies\",\"dependencies_placeholder\":\"Bitte whlen\"},\"step_command\":{\"new_command\":\"Neues Command\",\"new_aggregate_select_label\":\"Durch dieses Command wird eine neue Information erzeugt\",\"new_aggregate_select_placeholder\":\"Bitte whlen\",\"delete_state_label\":\"Durch dieses Command wird die verknpfte Information gelscht\",\"delete_history_label\":\"zustzlich werden alle aufgezeichneten Events gelscht\",\"delete_history_warning\":\"Durch dieses Command wird die gesamte Historie der Information unwiderruflich gelscht. Dies sollte nur fr sensitive Informationen verwendet werden, z.B. durch die DSGVO geschtzte Daten.\",\"copy_state_ui_schema\":\"Information UI Schema\"},\"step_ui\":{\"new_ui\":\"Neue UI Seite\",\"accessible_from_select_label\":\"Erreichbar ber:\",\"type_top_level\":\"bersicht\",\"type_sub_level\":\"Details\",\"view_models_label\":\"Angezeigte Informationen\",\"select_view_models_placeholder\":\"Angezeigte Informationen?\",\"page_config_label\":\"Konfiguration der Seite\",\"page_content_label\":\"Inhalte der Seite\"},\"step_policy\":{\"new_policy\":\"Neue Policy\",\"rules_label\":\"Prozess Regeln\",\"manage_dependencies\":\"Dependencies\",\"dependencies_label\":\"Dependencies\",\"dependencies_placeholder\":\"Bitte whlen\",\"targets_placeholder\":\"Weitere Prozess-Schritte\"},\"step_select_context\":{\"header_dddAction\":\"Human Task\",\"meta_dddAction\":\"Daten-Verarbeitung ber User Interface\",\"desc_dddAction\":\"Daten-Verarbeitung wird ber ein \\\"UI\\\" durch ein \\\"Command\\\" angestoen und vom System ausgefhrt. \\\"Business Rules\\\" entscheiden, ob die verknpfte Information gendert werden darf. nderungen werden mittels \\\"Domain Events\\\" aufgezeichnet. Die \\\"Information\\\" ergibt sich dann aus den Events.\",\"header_policy\":\"Automated Task\",\"meta_policy\":\"Digitalisierte Ablufe gesteurt durch Events\",\"desc_policy\":\"Mithilfe eines \\\"Processor\\\" kann das System auf ein Event reagieren und automatisch weitere Commands anstelle eines Users anstoen oder externe Systeme aufrufen.\"},\"step_feature\":{\"new_feature\":\"Neues Feature\"},\"step_run_cody\":{\"action_connect\":{\"title\":\"Verbinden\",\"desc\":\"Zu Cody verbinden\"},\"action_generate\":{\"desc\":\"Source Code generieren\"},\"action_healthcheck\":{\"desc\":\"Erreichbarkeit prfen\"},\"message_install_cody_engine\":\"Der Cody Wizard setzt vorraus, dass du die Cody Engine installiert und gestartet hast. Du kannst die Cody Engine mittels Git von Github laden und installieren. ber den Link erfhrst du mehr dazu:\",\"message_restart_cody\":\"Die Cody Engine ist auf einen Fehler gestoen, der nicht von Cody abgefangen wurde. Das kann ab und zu passieren und lsst sich in den meisten Fllen durch einen Neustart der Cody Engine beheben.\",\"message_perform_cody_restart\":\"Wechsel dazu in das Terminal wo du die Cody Engine mit 'npm run serve' gestartet hast. Dort kannst du die Cody Engine mit der Tastenkombination: 'Ctrl+C' stoppen und erneut mit 'npm run serve' starten.\",\"message_cody_still_failing\":\"Sollte dir trotz Neustart weiterhin ein Fehler im Terminal angezeigt werden, ist bei der Code Generierung etwas schief gelaufen. Schau dir den Fehler an und achte vorallem auf Tippfehler im Schema und Regeln. Solltest du Hilfe bentigen, wende dich bitte an das prooph board Team.\",\"message_cody_failed_get_help\":\"Hilfe holen\"},\"connections\":{\"help1\":\"Zeigt alle verbundenen Elemente.\",\"help2\":\"Quellen (->) zeigen auf das aktive Element. Ziele (<-) werden vom aktiven Element referenziert.\",\"help3\":\"Gibt es auf dem Board weitere Elemente vom gleichen Typ und gleichen Namen, werden die Verbindungen der hnlichen Elemente mit angezeigt.\",\"help4\":\"Durch Klick auf eine Verbindung, wird diese auf dem Board fokussiert.\",\"help5\":\"Strg/Cmd + Klick ffnet  das Element in der Side-by-Side Ansicht\"},\"editor\":{\"autocomplete\":\"Auto-Vervollstndigung: Ctrl+Space\",\"contextVariables\":\"Kontext Variablen:\",\"schema\":{\"help1\":\"Beschreibt die Datenstruktur mittels JSON Schema.\",\"help2\":\"Cody versteht auch eine vereinfachte und krze Variante von JSON Schema.\",\"help3\":\"Cody Suggest: Hat ein verknpftes Element ein Schema definiert, wird dieses kopiert. Alternativ schaut Cody, ob das Schema in der Beschreibung des Elements definiert ist.\"},\"uiSchema\":{\"help1command\":\"Beschreibt Look & Feel des Formulars, das anhand des Command Schemas generiert wird.\",\"help1state\":\"Beschreibt das Look & Feel der Datenansicht, die anhand des Informations-Schemas generiert wird.\",\"help1table\":\"Beschreibt das Look & Feel der Tabelle, die anhand des Informations-Schemas generiert wird.\"},\"businessRules\":{\"help1\":\"Regeln zur Verarbeitung des Commands.\",\"help2\":\"Als Ergebnis sollten ein oder mehrere Events aufgezeichnet werden.\"},\"dependencies\":{\"help1\":\"Lade Dependencies in den Ausfhrungs-Kontext.\",\"help2\":\"Verbinde Information, Event, oder Service Cards mit der aktuellen Card und nutze Cody Suggest fr Vorschlge.\"},\"resolver\":{\"help1\":\"Definiere Regeln zur Beantwortung der Informations-Abfrage.\",\"help2\":\"Sind die Informationen direkt in der Datenbank gespeichert, gengt eine \\\"where\\\" Regel, ansonsten nutze die \\\"rules\\\" Konfiguration.\"},\"projector\":{\"help1\":\"Definiere pro Event, wie das Lesemodell der Projektion verndert wird.\",\"help2\":\"Nutze insert, upsert, update, replace und delete information Regeln, um das Lesemodell anzpassen.\",\"help3\":\"Verbinde ein Event mit der Information Card und nutze Cody Suggest, um einen neuen Projection Case zu generieren.\"},\"processor\":{\"help1\":\"Definiere Regeln, die automatisch ausgefhrt werden, wenn das verbundene Event aufgezeichnet wurde.\",\"help2\":\"Typischerweise wird entweder ein Service aufgerufen oder ein weiteres Command angestoen.\"}}},\"collaboration_modal\":{\"header_team\":\"Team Collaboration\",\"header_history\":\"Change History\",\"text\":\"Diese Funktion ist in der freien Version leider nicht verfgbar.\"},\"board\":{\"add\":\"Neues Board\",\"advanced_settings\":\"Erweiterte Einstellungen\",\"import\":\"Board Import\",\"import_existing_board\":\"Ein Board mit dem Namen \\\"%name%\\\" existiert bereits. Du kannst das Board mit dem Import berschreiben oder eine Kopie importieren. Was mchtest du tun?\",\"btn_replace_board\":\"Board berschreiben\",\"btn_import_as_new\":\"Als Kopie importieren\",\"edit_header\":\"Board Einstellungen\",\"edit\":\"%name%\",\"share\":\"Permissions\",\"share_sub\":\"Lade andere User ein auf dein Board zu schauen oder es zu bearbeiten.\",\"delete_txt1\":\"Wenn Du das Board nicht mehr bentigst, kannst Du es hier \",\"delete_link\":\"lschen\",\"delete_txt2\":\".\",\"really_delete\":\"Bitte besttige die Lschung, indem du den Board Namen eingibst. Diese Aktion kann nicht rckgngig gemacht werden!\",\"tags_sub\":\"Setze Tags um Boards zu gruppieren und ber die Suche zu finden\",\"cody_suggest_sub\":\"Cody untersttzt dich im event-basierten Design\",\"event_modeling_sub\":\"Cody verwendet bei der Positionierung von Cards den Event Modeling Style.\",\"form\":{\"board_name\":\"Board Name\",\"board_abbr\":\"Krzel\",\"responsible_team\":\"Zustndiges Team\",\"btn_add_save\":\"Los geht's\",\"btn_share\":\"Share\",\"btn_send_invitation\":\"Einladung versenden\",\"btn_send\":\"Send\",\"email\":\"eMail\",\"team_name\":\"Teamname\",\"cody_suggest\":\"Cody Vorschlge\",\"event_modeling\":\"Event Modeling Modus\"},\"invite_user\":\"User einladen\",\"user_email\":\"Email-Adresse des Users\",\"remove_user_confirm_title\":\"User vom Board entfernen?\",\"remove_user_confirm_text\":\"Soll der User \\\"{{user_name}}\\\" wirklich vom Board entfernt werden?\",\"joined\":{\"title\":\"Board Zugriff\",\"details\":\"Du hast nun Zugriff auf das Board: {{name}}.\"},\"upload\":{\"select_image\":\"Bild auswhlen\",\"drag_and_drop_info\":\"Bilder in diesen Bereich ziehen, aus der Zwischenablage einfgen oder hier klicken\",\"upload_failed_title\":\"Upload fehlgeschlagen\",\"upload_failed_text\":\"Bild konnte nicht aktualisiert werden.\",\"deletion_failed_title\":\"Lschung fehlgeschlagen\",\"deletion_failed_text\":\"Bild konnte nicht gelscht werden.\",\"paste_failed\":\"Einfgen fehlgeschlagen\",\"invalid_file_pasted\":\"Es konnte keine jpeg/png Datei in der Zwischenablage gefunden werden.\"},\"link\":{\"headline\":\"Board verlinken\",\"select_board\":\"Whle ein Board\",\"select_event\":\"Whle ein Event\"},\"tasklink\":{\"headline\":\"Task verlinken\"},\"notify\":{\"invitation_resend\":{\"success\":{\"title\":\"Einladung erneut gesendet\",\"msg\":\"Die Einladung wurde erneut versendet\"}},\"invitation_revoke\":{\"success\":{\"title\":\"Einladung widerrufen\",\"msg\":\"Die Einladung wurde widerrufen\"}}},\"sticky_templates\":{\"headline\":\"Card Templates\",\"descriptions\":\"Hinterlege ein Metadata Template pro Card Typ\",\"advanced_config\":\"Erweiterte Konfiguration\",\"upload_info\":\"JSON-Schema Datei (.json) in diesen Bereich ziehen oder hier klicken, um den Upload-Dialog zu ffnen\",\"uploaded_schema_invalid_title\":\"Datei ungltig\",\"uploaded_schema_invalid_text\":\"Die hochgeladene Datei ist kein gltiges Schema\"},\"layers\":{\"moved_to_sidebar_header\":\"Ebenen sind jetzt in der Sidebar\",\"moved_to_sidebar_details\":\"Wir haben die Ebenen-Funktion in die linke Sidebar integriert, fr mehr bersicht und schnelleren Zugriff. Im prooph board Wiki erfhrst du mehr ber die nderung. Der Meneintrag wird demnchst ebenfalls entfernt.\",\"moved_to_sidebar_wiki_text\":\"Hier geht's zum Wiki Eintrag\",\"delete_confirmation\":\"Wirklich?\",\"add_layer\":\"Ebene hinzufgen\",\"set_global_visibility\":\"Deine Sichtbarkeit der Ebenen mit allen teilen\",\"refresh_layers\":\"neueste nderungen vom Board bernehmen\",\"folder_title\":\"Einfacher Klick ffnet die Ebene und markiert sie als aktiv.\\nDoppelklick ffnet das Bearbeiten-Menu.\",\"delete_layer\":\"Ebene lschen\",\"visibility\":\"Ebene ein/ausblenden\",\"lock_layer\":\"Ebene sperren/entsperren\",\"edit_name\":\"Name der Ebene ndern\",\"insert_selection\":\"Auf dem Board markierte Elemente in die aktive Ebene verschieben\"},\"move_to_organization_title\":\"Zu Organisation verschieben\",\"move_to_organization_sub_title\":\"Teile das Board mit Mitgliedern einer Organisation\",\"move_to_organization_desc\":\"Du kannst dieses Board in eine Organisation verschieben, um es mit Mitgliedern zu teilen. User, die direkt auf das Board berechtigt, aber keine Mitglieder der Organisation sind, werden als Gste in der Organisation registriert und das User Kontingent der Organisation wird entsprechend reduziert.\",\"move_to_organization_select\":\"Whle eine Organisation\",\"move_to_organization_submit\":\"Verschieben\",\"timer\":{\"modal_header\":\"Timer einstellen\",\"hint\":\"Neue Timer Funktion! Ein laufender Timer ist fr alle User auf dem Board sichtbar. Der Ersteller des Timers kann ihn pausieren und stoppen.\"},\"permissions\":{\"all\":\"Alle\",\"anyonePane\":{\"orgaMembers\":\"Mitglieder der Organisation\",\"anyone\":\"Jeder\"}}},\"organisation\":{\"switch_hint_header\":\"Neu: Organisationen\",\"switch_hint\":\"ber eine Organisation kann das Board und User Kontingent eines Accounts mit anderen Usern geteilt werden. Mitglieder knnen Boards direkt miteinander teilen. ber die Sidebar hast du Zugriff auf das Setup.\",\"switch_hint_ok\":\"Alles klar\",\"create_btn\":\"Organisation erstellen\",\"name\":\"Name der Organisation\",\"not_explicit\":\"Erstelle eine Organisation um Mitarbeiter oder Teamkollegen einzuladen, die dein Board und User Kontingent mit nutzen knnen.\",\"no_member_quota\":\"Du kannst keine weiteren User in deine Organisation einladen, da dein Kontingent erschpft ist. Du bentigst ein Upgrade.\",\"no_admin\":\"Du bist kein Administrator fr diese Organisation und hast keinen Zugiff auf die Userverwaltung\",\"invite_user\":\"User einladen\",\"user_email\":\"Email-Adresse des Users\",\"remove_user_confirm_title\":\"User von der Organisation entfernen?\",\"remove_user_confirm_text\":\"Soll der User \\\"{{user_name}}\\\" ({{email}}) wirklich von der Organisation entfernt werden?\",\"remove_user_confirm_button\":\"Entfernen\",\"send_invitation\":\"Einladung senden\",\"open_invitations\":\"Offene Einladungen\",\"empty_invitations\":\"Es gibt keine offenen Einladungen\",\"promote_to_admin\":\"Zum Admin ernennen\",\"demote_to_member\":\"Admin Berechtigung entziehen\",\"promote_to_member\":\"Zum Mitglied ernennen\",\"member\":\"Mitglieder\",\"guests\":\"Gste\",\"notify\":{\"invitation_resend\":{\"success\":{\"title\":\"Einladung erneut gesendet\",\"msg\":\"Die Einladung wurde erneut versendet an: {{email}}\"}},\"invitation_revoke\":{\"success\":{\"title\":\"Einladung widerrufen\",\"msg\":\"Die Einladung wurde widerrufen.\"}}},\"joined\":{\"title\":\"Organisation beigetreten\",\"details\":\"Du bist der Organisation {{name}} beigetreten.\"}},\"team\":{\"overview_add\":\"Add Team\",\"add\":\"Neues Team\",\"team_name\":\"Teamname\",\"team_description\":\"Teambeschreibung\",\"add_user\":\"Add User\",\"invite_user\":\"User einladen\",\"user_email\":\"Email-Adresse des Users\",\"remove_user_confirm_title\":\"User vom Team entfernen?\",\"remove_user_confirm_text\":\"Soll der User \\\"{{user_name}}\\\" wirklich vom Team entfernt werden?\",\"remove_user_confirm_button\":\"Entfernen\",\"remove_board_confirm_title\":\"Team vom Board entfernen?\",\"remove_board_confirm_text\":\"Soll das Team wirklich vom Board \\\"{{board_name}}\\\" entfernt werden?\",\"remove_board_confirm_button\":\"Entfernen\",\"joined\":{\"title\":\"Team beigetreten\",\"details\":\"Du bist dem Team {{team}} beigetreten.\"},\"add_to_board\":\"Team Zugriff auf {{board_name}} einrichten.\",\"grant_access\":\"Team Zugriff einrichten.\",\"choose\":\"Whle ein Team ...\",\"choose_board\":\"Whle ein Board ...\",\"remove_from_board_confirm_title\":\"Team vom Board entfernen?\",\"remove_from_board_confirm_text\":\"Soll das Team \\\"{{team_name}}\\\" wirklich vom Board entfernt werden?\",\"remove_team_confirm_title\":\"Team entfernen?\",\"remove_team_confirm_text\":\"Soll das Team \\\"{{team_name}}\\\" wirklich entfernt werden?\",\"open_invitations\":\"Offene Einladungen\",\"empty_invitations\":\"Es gibt keine offenen Einladungen\",\"error_loading_invitations\":\"Beim Laden der Einladungen ist ein Fehler aufgetreten. Bitte spter erneut probieren.\",\"send_invitation\":\"Einladung senden\",\"notify\":{\"invitation_resend\":{\"success\":{\"title\":\"Einladung erneut gesendet\",\"msg\":\"Die Einladung wurde erneut versendet an: {{email}}\"}},\"invitation_revoke\":{\"success\":{\"title\":\"Einladung widerrufen\",\"msg\":\"Die Einladung wurde widerrufen.\"}}},\"no_teams\":\"Du hast noch keine Teams angelegt. Nutze Teams um Arbeitsgruppen zu organisieren und mehreren Usern gleichzeitig Berechtigungen auf Boards zu geben.\",\"move_to_organization_title\":\"Zu Organisation verschieben\",\"move_to_organization_desc\":\"Du kannst dieses Team in eine Organisation verschieben. Mitglieder des Teams, die keine Mitglieder der Organisation sind, werden als Gste in der Organisation registriert und das User Kontingent der Organisation wird entsprechend reduziert.\",\"move_to_organization_select\":\"Whle eine Organisation\",\"move_to_organization_submit\":\"Verschieben\"},\"user\":{\"profile_headline\":\"{{user_name}}\",\"profile_subline\":\"Benutzerprofil bearbeiten\",\"quota_reached\":\"Die maximale Anzahl an Boards ist erreicht. Deine Organization bentigt ein Upgrade.\",\"quota_reached_user\":\"Die maximale Anzahl an Boards ist erreicht. Du bentigst ein Upgrade.\",\"quota_reached_guest\":\"Du bist Gast in der aktuellen Organization und kannst keine Boards erstellen.\",\"team_quota_reached\":\"Du hast die maximale Anzahl an Teams erreicht. Mit einem Free Account ist 1 Team mglich. Nach Abschluss der Betaphase wird es die Mglichkeit fr ein Upgrade auf eine Basic oder Pro Subscription geben.\",\"form\":{\"labels\":{\"display_name\":\"Anzeigename\",\"email\":\"E-Mail\",\"company\":\"Firma\",\"position\":\"Position\",\"password1\":\"Passwort\",\"password2\":\"Passwort (Wiederholen)\"},\"fields\":{\"display_name\":\"Mein Anzeige Name\",\"email\":\"ich@firma.de\",\"company\":\"Meine Firma\",\"position\":\"Entwickler / CEO / Manager\"}},\"avatar_upload\":{\"select_photo\":\"Foto auswhlen\",\"drag_and_drop_info\":\"Bilder in diesen Bereich ziehen oder hier klicken\",\"upload_failed_title\":\"Upload fehlgeschlagen\",\"upload_failed_text\":\"Profilbild konnte nicht aktualisiert werden.\",\"deletion_failed_title\":\"Lschung fehlgeschlagen\",\"deletion_failed_text\":\"Profilbild konnte nicht gelscht werden.\"},\"change_password\":{\"passwords_not_matching_title\":\"Passwrter stimmen nicht berein\",\"passwords_not_matching_text\":\"Die eingegebenen Passwrter stimmen nicht berein. Bitte versuche es erneut.\"},\"delete_account\":{\"headline\":\"Account Lschen\",\"message\":\"Das Lschen deines Accounts ist aktuell noch nicht ber die Weboberflche mglich. Wir werden die Funktionalitt in Zukunft hier bereitstellen. Bis dahin schicke uns bitte eine Email an: \"}},\"history\":{\"today\":\"Heute\",\"yesterday\":\"Gestern\",\"twoDaysAgo\":\"Vor 2 Tagen\",\"threeDaysAgo\":\"Vor 3 Tagen\",\"fourDaysAgo\":\"Vor 4 Tagen\",\"fiveDaysAgo\":\"Vor 5 Tagen\",\"sixDaysAgo\":\"Vor 6 Tagen\",\"lastWeek\":\"Letzte Woche\",\"twoWeeksAgo\":\"Vor 2 Wochen\",\"threeWeeksAgo\":\"Vor 3 Wochen\",\"fourWeeksAgo\":\"Vor 4 Wochen\",\"lastMonth\":\"Letzten Monat\",\"older\":\"lter\"},\"feedback\":{\"info_text\":\"Fr den Austausch mit der Community steht ein Chat auf Gitter bereit. Dort lassen sich Fragen klren, Ideen diskutieren und Probleme analysieren. Zustzlich steht ein Issue Tracker auf Github bereit, wo Feature Requests und Bugs gemeldet werden knnen.\",\"direct_msg\":\"Mchtest du uns lieber ein direktes Feedback schreiben, kannst du unser Feedback Formular nutzen. Deine Nachricht wird in dem Fall nicht verffentlicht.\",\"header\":\"Wir freuen uns auf dein Feedback\",\"placeholder\":\"Deine Nachricht an uns\",\"send\":\"Nachricht senden\"},\"subscribe\":{\"betaModal\":{\"header\":\"Beta Phase\",\"content\":\"In der Free Version werden deine Boards im Local Storage deines Browsers gespeichert. Du solltest deine Arbeit regelmig exportieren, damit sie nicht verloren geht! Die prooph board SaaS Version befindet sich aktuell in der Betaphase und wird von ausgewhlten Teams getestet. In Krze aktivieren wir das Subscription-Modell und ermglichen weiteren Teams Zugriff zur SaaS Variante, die prooph board unter anderem um Team Kollaboration und Cloud Speicher erweitert. Willst du schon jetzt diese Features nutzen oder bist an einem Workshop oder Training interessiert, sende uns bitte eine Email an contact@prooph.de. Wir freuen uns auf deine Anfrage!\"}},\"playshots\":{\"select_playshot\":\"Starte Cody Play mit einem gespeicherten Playshot oder beginne eine neue Session.\",\"start_from_scratch\":\"Neue Session Starten\",\"sync_playshot\":\"nderungen aufs Board bertragen\",\"sync_success\":\"Cody hat alle nderungen erfolgreich bertragen!\",\"sync_error\":\"Cody hat bei der bertragung der nderungen einen Fehler bemerkt. Prfe den Fehler in der Cody Console!\",\"empty\":\"Es wurden noch keine Playshots gespeichert. Starte mit einer neuen Cody Play Session und benutze den Speichern Button, den du in Cody Play unten rechts findest.\"}}}},\"en\":{\"translation\":{\"app\":{\"title\":\"React + Redux + Semantic UI Skeleton\",\"welcome\":\"Welcome to React + Redux + Semantic UI Skeleton\",\"topmenu\":{\"profile\":\"Profil\"},\"form\":{\"rename\":\"Rename\",\"save\":\"Save\",\"change\":\"Change\",\"cancel\":\"Cancel\",\"confirm\":\"Confirm\",\"delete\":\"Delete\",\"remove\":\"Remove\",\"upload\":\"Upload\",\"resend\":\"Resend\",\"revoke\":\"Revoke\",\"reset\":\"Reset\",\"yes\":\"Yes\",\"no\":\"No\",\"back\":\"Back\",\"generateTemplate\":\"Generate template\",\"finish\":\"Finish\",\"close\":\"Close\"},\"showLess\":\"Show less\",\"showAll\":\"Show all\",\"open\":\"Open\",\"learnMore\":\"Learn more\",\"stickyTypes\":{\"event\":\"Event\",\"command\":\"Command\",\"aggregate\":\"Aggregate\",\"document\":\"Information\",\"role\":\"Role\",\"hotSpot\":\"Hot Spot\",\"ui\":\"UI / API\",\"externalSystem\":\"External System\",\"boundedContext\":\"Bounded Context\",\"feature\":\"Feature\",\"slice\":\"Slice\",\"swimlanes\":\"Swimlanes\",\"edge\":\"Connector\",\"policy\":\"Policy\",\"freeText\":\"Text\",\"textCard\":\"Text\",\"icon\":\"Icon\",\"image\":\"Image\"}},\"insp\":{\"hint\":{\"learn_more\":\"Learn more\",\"got_it\":\"Got it\",\"new_logo_header\":\"New Logo\",\"new_logo_text\":\"InspectIO becomes prooph board\",\"new_domain_header\":\"New Logo\",\"new_domain_text\":\"InspectIO becomes prooph board and is now available at https://prooph-board.com.\"},\"overview\":{\"all_boards\":\"My Boards\",\"add_board\":\"Add Board\",\"last_modified\":\"Last modified\",\"fetch_board_error\":\"Technical error when loading the board. Please try again later or contact support.\",\"shared_board\":\"This is a shared board. You cannot edit the settings.\",\"empty_space\":\"Hi, that space looks empty. New here? Add a board to get started and have a look at the wiki to learn more.\",\"sort\":{\"NAME\":\"Name\",\"CREATED_AT\":\"Created At\",\"LAST_MODIFIED\":\"Last Modified\"},\"teamFilter\":{\"all\":\"All Teams\"},\"search\":{\"label\":\"Search ...\"}},\"sidebar\":{\"element_details\":{\"json_invalid_title\":\"Schema Invalid\",\"json_invalid_text\":\"The Payload-Schema is not a valid JSON document\",\"no_element_selected\":\"Select an element on the board to edit its metadata.\",\"disconnect_from_similar_elements_text\":\"Metadata is synchronized with Cards of same type and same name ({{number}}).\",\"disconnect_from_similar_elements_link\":\"Deactivate synchronization\",\"connect_with_similar_elements_text\":\"Metadata is not synchronized.\",\"connect_with_similar_elements_link\":\"Activate synchronization\"},\"no_boards_left_warning\":\"No boards left\",\"boards_left_warning\":\"Only {{board_count}} board left\",\"boards_left_warning_upgrade\":\"Your organization needs an upgrade.\"},\"top_menu\":{\"activity\":\"Activity\",\"element_details\":\"Metadata\",\"import_board\":\"Import Board\",\"export_board\":\"Export Board\",\"activate_lite_mode\":\"Activate Lite Mode for extra performance on large boards and during video calls.\",\"lite_mode_is_active\":\"Lite Mode is active.\",\"lite_mode_is_active_details\":\"Details are not shown automatically when zooming in to save CPU time. You can show the details of a frame by double clicking on it, and hide the details again by pressing Ctrl/Cmd while double clicking.\"},\"cody_wizard\":{\"unsupported_node\":\"Either Cards of type \\\"{{type}}\\\" are not supported by Cody Wizard or \\\"{{name}}\\\" is not configured correctly! Please select another card or check connections and metadata.\",\"run_cody\":\"Run Cody\",\"node_select\":{\"unique_name_error\":\"The name is already in use by another Card!\",\"default_placeholder\":\"Select an Element\",\"select_data_entity\":\"Select existing information (Green Cards)\",\"select_aggregate_event\":\"Select existing business model event (Orange Cards)\",\"select_aggregate\":\"Select an existing aggregate (Yellow Cards)\",\"select_command\":\"Existing commands cannot be selected. Please create a new one!\",\"select_ui\":\"Select an existing UI page (Black Cards)\",\"select_policy\":\"Existing policies cannot be selected. Please create a new one!\",\"select_feature\":\"Existing features cannot be selected. Please create a new one!\"},\"advanced_settings\":{\"button_label\":\"Advanced Settings\"},\"schema_editor\":{\"invalid_json\":\"The schema is invalid and cannot be saved. Please check your input.\",\"copy_state_schema\":\"Use from Information\",\"copy_command_schema\":\"Use from Command\"},\"query_schema_editor\":{\"invalid_json\":\"The query schema is invalid and cannot be saved. Please check your input.\"},\"ui_schema_editor\":{\"invalid_json\":\"The ui schema is invalid and cannot be saved. Please check your input.\",\"choose_icon\":\"Icon Search\"},\"identifier_select\":{\"placeholder\":\"Select a schema property as identifier (format: uuid)\"},\"feature_status_select\":{\"placeholder\":\"Select a status\"},\"step_header\":\"Select Action\",\"step_state\":{\"new_data_entity\":\"New Information\",\"copy_command_ui_schema\":\"Use from Command\"},\"step_any_vo\":{\"is_stored_in_db_label\":\"Is stored in the database.\",\"is_entity_label\":\"Is an entity\",\"is_queryable_label\":\"Is queryable\",\"is_projection_label\":\"Is a projection\"},\"step_aggregate_event\":{\"new_event\":\"New Event\"},\"step_aggregate\":{\"new_aggregate\":\"New Aggregate\",\"rules_label\":\"Business Rules\",\"manage_dependencies\":\"Dependencies\",\"dependencies_label\":\"Dependencies\",\"dependencies_placeholder\":\"Please choose\"},\"step_command\":{\"new_command\":\"New Command\",\"new_aggregate_select_label\":\"This Command creates a new Information\",\"new_aggregate_select_placeholder\":\"Please choose\",\"delete_state_label\":\"This Command deletes the connected Information\",\"delete_history_label\":\"Additionally, It deletes all recorded Events\",\"delete_history_warning\":\"This command will delete the entire history of the Information. Use it only for sensitive information, e.g. private data protected by GDPR.\",\"copy_state_ui_schema\":\"Use from Information\"},\"step_ui\":{\"new_ui\":\"New UI Page\",\"accessible_from_select_label\":\"Accessible from:\",\"type_top_level\":\"Overview\",\"type_sub_level\":\"Details\",\"view_models_label\":\"Displayed Information\",\"select_view_models_placeholder\":\"Displayed Information?\",\"page_config_label\":\"Page Configuration\",\"page_content_label\":\"Page Content\"},\"step_policy\":{\"new_policy\":\"New Policy\",\"rules_label\":\"Process Rules\",\"manage_dependencies\":\"Dependencies\",\"dependencies_label\":\"Dependencies\",\"dependencies_placeholder\":\"Please choose\",\"targets_placeholder\":\"Next process steps\"},\"step_select_context\":{\"header_dddAction\":\"Human Task\",\"meta_dddAction\":\"Data processing triggered via User Interface\",\"desc_dddAction\":\"Data processing is triggered by an \\\"Actor\\\" in a \\\"UI\\\" through a \\\"Command\\\". The system handles the command and \\\"Business Rules\\\" decide whether connected \\\"Information\\\" can be changed or not. Every decision is recorded as a \\\"Domain Event\\\". The new or updated \\\"Information\\\" is then derived from the events.\",\"header_policy\":\"Automated Task\",\"meta_policy\":\"Digitized processes can be controlled by events\",\"desc_policy\":\"With the help of a \\\"Processor\\\", the system can react on an event and automatically trigger new \\\"Commands\\\" in behalf of a user or call \\\"External Systems\\\".\"},\"step_feature\":{\"new_feature\":\"New Feature\"},\"step_run_cody\":{\"action_connect\":{\"title\":\"Connect\",\"desc\":\"Connect to Cody\"},\"action_generate\":{\"desc\":\"Generate source code\"},\"action_healthcheck\":{\"desc\":\"Check system availability\"},\"message_install_cody_engine\":\"The Cody Wizard requires an installed and running Cody Engine application. You can install Cody Engien via Git from Github. Follow the link for more information:\",\"message_restart_cody\":\"The Cody Engine run into an error not caught by Cody. This can happen from time to time and can usually be solved by restarting the Cody Engine.\",\"message_perform_cody_restart\":\"Please switch to the terminal where you started Cody Engine with 'npm run serve'. There you can stop it with the key combination 'Ctrl+C' and start it again with 'npm run serve'.\",\"message_cody_still_failing\":\"If the error is still shown in the terminal after restart, something went wrong with the code generation. Please check the error and keep an eye on typos especially in schema and rules configuration. If you cannot resolve the error, please contact the prooph board team.\",\"message_cody_failed_get_help\":\"Get Help\"},\"connections\":{\"help1\":\"Shows all connected elements.\",\"help2\":\"Sources (->) point to the active element. Targets (<-) are connected from the active element.\",\"help3\":\"If there are other elements on the board with same card type and name, connections of those similar elements are listed too.\",\"help4\":\"A click on a connection moves the element into focus.\",\"help5\":\"Ctrl/Cmd + click opens the element in the Side-by-Side View.\"},\"editor\":{\"autocomplete\":\"Auto completion: Ctrl+Space\",\"contextVariables\":\"Context variables:\",\"schema\":{\"help1\":\"Describes the data structure using JSON Schema.\",\"help2\":\"Cody understands a shortened and simplified syntax.\",\"help3\":\"Cody Suggest: If a connected element has a schema defined, it's copied. Alternatively, Cody inspects the element description to read a schema from it.\"},\"uiSchema\":{\"help1command\":\"Describes Look & Feel of the form that gets generated based on the command schema.\",\"help1state\":\"Describes Look & Feel of the data view that gets generated based on the information schema\",\"help1table\":\"Describes Look & Feel of the table that gets generated based on the information schema\"},\"businessRules\":{\"help1\":\"Command processing rules.\",\"help2\":\"The result should be to record one or more events.\"},\"dependencies\":{\"help1\":\"Inject dependencies into the execution context.\",\"help2\":\"Connect Information, Event, or Service cards with the active card and use Cody Suggest to get suggestions.\"},\"resolver\":{\"help1\":\"Define rules to answer an information query.\",\"help2\":\"If information is stored in the database, you can use a \\\"where\\\" rule, otherwise use the \\\"rules\\\" configuration.\"},\"projector\":{\"help1\":\"For each event, define how it changes the read model of the projection.\",\"help2\":\"Use insert, upsert, update, replace, and delete information rules to change the read model.\",\"help3\":\"Connect an Event with the Information card and use Cody Suggest to generate a new projection case.\"},\"processor\":{\"help1\":\"Define rules that are automatically executed whenever a connected Event is recorded.\",\"help2\":\"Usually, a Service is called or a follow up Command is triggered.\"}}},\"collaboration_modal\":{\"header_team\":\"Team Collaboration\",\"header_history\":\"Change History\",\"text\":\"Unfortunately, this function is not available in the free version.\"},\"board\":{\"add\":\"New Board\",\"advanced_settings\":\"Advanced Settings\",\"import\":\"Import Board\",\"import_existing_board\":\"A board with name \\\"%name%\\\" already exists. You can override the existing one or import a copy. What do you want to do?\",\"btn_replace_board\":\"Override Board\",\"btn_import_as_new\":\"Import copy\",\"edit_header\":\"Manage your preferences\",\"edit\":\"%name%\",\"share\":\"Permissions\",\"share_sub\":\"Invite other people to view and/or edit your board.\",\"delete_txt1\":\"If you don't need the board anymore, you can \",\"delete_link\":\"delete\",\"delete_txt2\":\" it here.\",\"really_delete\":\"Please confirm deletion by entering the board name. This action cannot be undone!\",\"tags_sub\":\"Set tags to group boards and find them via search\",\"cody_suggest_sub\":\"Cody supports your event-centric design\",\"event_modeling_sub\":\"Cody positions cards using Event Modeling style\",\"form\":{\"board_name\":\"Board Name\",\"board_abbr\":\"Abbr\",\"responsible_team\":\"Responsible Team\",\"btn_add_save\":\"Let's go\",\"btn_share\":\"Share\",\"btn_send_invitation\":\"Send Invitation\",\"btn_send\":\"Send\",\"email\":\"email\",\"team_name\":\"Team Name\",\"cody_suggest\":\"Cody Suggestions\",\"event_modeling\":\"Event Modeling Mode\"},\"invite_user\":\"Invite User\",\"user_email\":\"Email Address of User\",\"remove_user_confirm_title\":\"Remove user from board?\",\"remove_user_confirm_text\":\"Do you really want to remove the user \\\"{{user_name}}\\\" from the board?\",\"joined\":{\"title\":\"Board Access\",\"details\":\"You now have access to board: {{name}}.\"},\"upload\":{\"select_image\":\"Select an image\",\"drag_and_drop_info\":\"Drag 'n' drop a file here, paste from clipboard or click to select one\",\"upload_failed_title\":\"Upload failed\",\"upload_failed_text\":\"Image could not be updated.\",\"deletion_failed_title\":\"Deletion failed\",\"deletion_failed_text\":\"Image could not be deleted.\",\"paste_failed\":\"Paste failed\",\"invalid_file_pasted\":\"Could not find any jpeg/png files in the clipboard.\"},\"link\":{\"headline\":\"Link to Board\",\"select_board\":\"Select a Board\",\"select_event\":\"Select an Event\"},\"tasklink\":{\"headline\":\"Link to Task\"},\"notify\":{\"invitation_resend\":{\"success\":{\"title\":\"Invitation sent\",\"msg\":\"Invitation was resent successfully\"}},\"invitation_revoke\":{\"success\":{\"title\":\"Invitation revoked\",\"msg\":\"The invitation has been revoked\"}}},\"client\":{\"headline\":\"Board API\",\"description\":\"Configure your board client in order to access its content from your own service.\",\"notConfigured\":\"There is currently no external API client configured for this board.\",\"createClient\":\"Click here to create one\",\"clientId\":\"Client-Id\",\"clientSecret\":\"Client-Secret\",\"retrieveSecret\":\"Click here to retrieve\",\"createConfirmTitle\":\"Create an API-Client for the board\",\"createConfirmText\":\"Do you really want to create a new API-Client for this board? You should only do so if you intend to use the API to access board information from an external service.\",\"resetConfirmTitle\":\"Reset the Client-Secret\",\"resetConfirmText\":\"Do you really want to reset the Client-Secret for this board? The old Client-Secret will be rendered invalid and cannot be used to access the API anymore.\",\"removeConfirmTitle\":\"Remove the Client-Secret\",\"removeConfirmText\":\"Do you really want to remove your client? Be aware that any services relying on this client will loose access to the board.\",\"removeText\":\"If you do not need your client anymore you can remove it here. Be aware that any services relying on this client will loose access to the board.\",\"copyToClipboard\":\"Copy to Clipboard\"},\"sticky_templates\":{\"headline\":\"Card Templates\",\"description\":\"Set a metadata template for each card type\",\"advanced_config\":\"Advanced Config\",\"upload_info\":\"Drop a JSON-Schema file (.json) or click here to open the upload dialog\",\"uploaded_schema_invalid_title\":\"Uploaded file invalid\",\"uploaded_schema_invalid_text\":\"The uploaded file is not a valid schema file.\"},\"layers\":{\"moved_to_sidebar_header\":\"Layers are now part of the sidebar\",\"moved_to_sidebar_details\":\"We've moved the layer functionality into the left sidebar for more overview and quicker access. You can read more about the changes in our Wiki. The menu entry will be removed soon.\",\"moved_to_sidebar_wiki_text\":\"Here you can find the wiki page\",\"delete_confirmation\":\"Really?\",\"add_layer\":\"Add layer\",\"set_global_visibility\":\"Share your layer visibility settings with all\",\"refresh_layers\":\"Refresh tree with latest board changes\",\"folder_title\":\"Single click opens the layer and marks it as active.\\nDouble click opens the edit menu.\",\"delete_layer\":\"Delete layer\",\"visibility\":\"Show/hide layer\",\"lock_layer\":\"Lock/unlock layer\",\"edit_name\":\"Change layer name\",\"insert_selection\":\"Move selected elements into active layer\"},\"move_to_organization_title\":\"Move To Organization\",\"move_to_organization_sub_title\":\"Share the board with organization members\",\"move_to_organization_desc\":\"You can move this board to an organization to share it with members. Users who are not member of the organization but have direct access to the board, are registered as guests in the organization. This requires enough user quota, otherwise they will loose access to the board.\",\"move_to_organization_select\":\"Select organization\",\"move_to_organization_submit\":\"Move\",\"timer\":{\"modal_header\":\"Set Timer\",\"hint\":\"New timer feature! A running timer is visible for everybody on the board. The creator of a timer is able to pause and stop it.\"},\"permissions\":{\"all\":\"All\",\"anyonePane\":{\"orgaMembers\":\"Organization Members\",\"anyone\":\"Anyone\"}}},\"organisation\":{\"switch_hint_header\":\"New: Organizations\",\"switch_hint\":\"An organization allows to share your board and user quota with others. Members of an organization can share boards directly. In the sidebar you can switch to another organization or create your own.\",\"switch_hint_ok\":\"Got It\",\"create_btn\":\"Create Organisation\",\"name\":\"Name of the organisation\",\"not_explicit\":\"Create an organisation and invite colleagues to share your board and user quota with them.\",\"no_member_quota\":\"The organisation user quota is reached. If you want to invite more users, please upgrade your subscription.\",\"no_admin\":\"Access denied to organisation management. You're missing administration rights.\",\"invite_user\":\"Invite User\",\"user_email\":\"Email Address of User\",\"remove_user_confirm_title\":\"Remove user from organisation?\",\"remove_user_confirm_text\":\"Do you really want to remove the user \\\"{{user_name}}\\\" ({{email}}) from the organisation?\",\"remove_user_confirm_button\":\"Remove\",\"send_invitation\":\"Send Invitation\",\"open_invitations\":\"Open Invitations\",\"empty_invitations\":\"No open invitations\",\"promote_to_admin\":\"Promote to admin\",\"demote_to_member\":\"Demote to member\",\"promote_to_member\":\"Promote to member\",\"member\":\"Member\",\"guests\":\"Guests\",\"notify\":{\"invitation_resend\":{\"success\":{\"title\":\"Invitation sent\",\"msg\":\"Invitation sent again to: {{email}}\"}},\"invitation_revoke\":{\"success\":{\"title\":\"Invitation revoked\",\"msg\":\"The invitation has been revoked.\"}}},\"joined\":{\"title\":\"Organisation joined\",\"details\":\"You joined the organisation {{name}}.\"}},\"team\":{\"overview_add\":\"Add Team\",\"add\":\"New Team\",\"team_name\":\"Team name\",\"team_description\":\"Team Description\",\"add_user\":\"Add User\",\"invite_user\":\"Invite User\",\"user_email\":\"Email Address of User\",\"remove_user_confirm_title\":\"Remove user from team?\",\"remove_user_confirm_text\":\"Do you really want to remove the user \\\"{{user_name}}\\\" from the team?\",\"remove_user_confirm_button\":\"Remove\",\"remove_board_confirm_title\":\"Remove team from board?\",\"remove_board_confirm_text\":\"Do you really want to remove the team from board \\\"{{board_name}}\\\"?\",\"remove_board_confirm_button\":\"Remove\",\"joined\":{\"title\":\"Team joined\",\"details\":\"You joined the team {{team}}.\"},\"add_to_board\":\"Set up team access to {{board_name}}.\",\"grant_access\":\"Set up team access.\",\"choose\":\"Choose a team ...\",\"choose_board\":\"Choose a board ...\",\"remove_from_board_confirm_title\":\"Remove team from board?\",\"remove_from_board_confirm_text\":\"Do you really want to remove the team \\\"{{team_name}}\\\" from the board?\",\"remove_team_confirm_title\":\"Remove team?\",\"remove_team_confirm_text\":\"Do you really want to remove the team \\\"{{team_name}}\\\"?\",\"open_invitations\":\"Open Invitations\",\"empty_invitations\":\"No open invitations\",\"error_loading_invitations\":\"Failed to load invitations. Please try again later.\",\"send_invitation\":\"Send Invitation\",\"notify\":{\"invitation_resend\":{\"success\":{\"title\":\"Invitation sent\",\"msg\":\"Invitation sent again to: {{email}}\"}},\"invitation_revoke\":{\"success\":{\"title\":\"Invitation revoked\",\"msg\":\"The invitation has been revoked.\"}}},\"no_teams\":\"You did not create a team yet. Use teams to organise working groups and assign board permissions to many users at once.\",\"move_to_organization_title\":\"Move To Organization\",\"move_to_organization_desc\":\"You can move this team to an organization. Users who are not already member of the organization will be registered as guests. This requires enough user quota, otherwise they will be removed from the team.\",\"move_to_organization_select\":\"Select organization\",\"move_to_organization_submit\":\"Move\"},\"user\":{\"profile_headline\":\"{{user_name}}\",\"profile_subline\":\"Edit User Profile\",\"quota_reached\":\"The board quota is reached. Your organization needs an upgrade.\",\"quota_reached_user\":\"The board quota is reached. You need an upgrade.\",\"quota_reached_guest\":\"You're guest of the active organization. Guests are not allowed to create organization boards.\",\"team_quota_reached\":\"The team quota is reached. With a free account you can have 1 team maximum. After our beta phase you can upgrade to a basic or professional subscription and increase the quota.\",\"form\":{\"labels\":{\"display_name\":\"Display Name\",\"email\":\"E-Mail\",\"company\":\"Company\",\"position\":\"Job Title\",\"password1\":\"Password\",\"password2\":\"Password (re-enter)\"},\"fields\":{\"display_name\":\"your display name\",\"email\":\"my@company.com\",\"company\":\"My Company\",\"position\":\"Developer / CEO / Manager\"}},\"avatar_upload\":{\"select_photo\":\"Select a Photo\",\"drag_and_drop_info\":\"Drag 'n' drop some files here, or click to select files\",\"upload_failed_title\":\"Upload failed\",\"upload_failed_text\":\"Profile picture could not be updated.\",\"deletion_failed_title\":\"Deletion failed\",\"deletion_failed_text\":\"Profile picture could not be deleted.\"},\"change_password\":{\"passwords_not_matching_title\":\"Passwords do not match\",\"passwords_not_matching_text\":\"The passwords you entered do not match, please try again.\"},\"delete_account\":{\"headline\":\"Delete Account\",\"message\":\"Account deletion is not possible yet using the UI. We'll provide the functionality in the future. For now please send us an email: \"}},\"history\":{\"today\":\"Today\",\"yesterday\":\"Yesterday\",\"twoDaysAgo\":\"2 days ago\",\"threeDaysAgo\":\"3 days ago\",\"fourDaysAgo\":\"4 days ago\",\"fiveDaysAgo\":\"5 days ago\",\"sixDaysAgo\":\"6 days ago\",\"lastWeek\":\"Last week\",\"twoWeeksAgo\":\"2 weeks ago\",\"threeWeeksAgo\":\"3 weeks ago\",\"fourWeeksAgo\":\"4 weeks ago\",\"lastMonth\":\"Last month\",\"older\":\"Older\"},\"feedback\":{\"info_text\":\"If you want to chat with us and other community members about prooph board you can join our Gitter Chat. Feature requests and bugs can also be submitted to our public Github issue tracker.\",\"direct_msg\":\"To send us a direct message you can use the feedback form below. In this case we don't publish your message.\",\"header\":\"Looking forward to your feedback\",\"placeholder\":\"Your feedback\",\"send\":\"Send message\"},\"subscribe\":{\"betaModal\":{\"header\":\"Beta Phase\",\"content\":\"The free version of prooph board saves all boards in your browser's local storage. Make sure to regularly export your work to avoid losing it! The prooph board SaaS version is currently beta. Selected teams are testing it right now. We will activate our subscription model soon that enables more teams to use advanced features like team collaboration and cloud storage. If you can't wait or looking for prooph board training, please send an email to contact@prooph.de. We're looking forward to hear from you!\"}},\"playshots\":{\"select_playshot\":\"Open Cody Play from a saved Playshot or start from scratch.\",\"start_from_scratch\":\"Start From Scratch\",\"sync_playshot\":\"Apply changes to the board\",\"sync_success\":\"Cody applied the changes successfully!\",\"sync_error\":\"Cody ran into an error while applying the changes. Please check the error in the Cody Console!\",\"empty\":\"There are no Playshots yet. Start Cody Play from scratch and use the save button, that you can find in the bottom right corner of Cody Play.\"}}}}}"],"sourceRoot":""}